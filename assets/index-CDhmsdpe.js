function i_(s,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in s)){const o=Object.getOwnPropertyDescriptor(n,r);o&&Object.defineProperty(s,r,o.get?o:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function Cb(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Fh={exports:{}},Fo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fx;function r_(){if(Fx)return Fo;Fx=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,o){var l=null;if(o!==void 0&&(l=""+o),r.key!==void 0&&(l=""+r.key),"key"in r){o={};for(var c in r)c!=="key"&&(o[c]=r[c])}else o=r;return r=o.ref,{$$typeof:s,type:n,key:l,ref:r!==void 0?r:null,props:o}}return Fo.Fragment=e,Fo.jsx=t,Fo.jsxs=t,Fo}var Ux;function a_(){return Ux||(Ux=1,Fh.exports=r_()),Fh.exports}var T=a_(),Uh={exports:{}},Uo={},Bh={exports:{}},$h={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bx;function o_(){return Bx||(Bx=1,(function(s){function e(F,z){var j=F.length;F.push(z);e:for(;0<j;){var oe=j-1>>>1,fe=F[oe];if(0<r(fe,z))F[oe]=z,F[j]=fe,j=oe;else break e}}function t(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var z=F[0],j=F.pop();if(j!==z){F[0]=j;e:for(var oe=0,fe=F.length,k=fe>>>1;oe<k;){var G=2*(oe+1)-1,te=F[G],le=G+1,he=F[le];if(0>r(te,j))le<fe&&0>r(he,te)?(F[oe]=he,F[le]=j,oe=le):(F[oe]=te,F[G]=j,oe=G);else if(le<fe&&0>r(he,j))F[oe]=he,F[le]=j,oe=le;else break e}}return z}function r(F,z){var j=F.sortIndex-z.sortIndex;return j!==0?j:F.id-z.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();s.unstable_now=function(){return l.now()-c}}var f=[],d=[],m=1,g=null,p=3,E=!1,v=!1,S=!1,b=!1,R=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function D(F){for(var z=t(d);z!==null;){if(z.callback===null)n(d);else if(z.startTime<=F)n(d),z.sortIndex=z.expirationTime,e(f,z);else break;z=t(d)}}function N(F){if(S=!1,D(F),!v)if(t(f)!==null)v=!0,B||(B=!0,V());else{var z=t(d);z!==null&&re(N,z.startTime-F)}}var B=!1,I=-1,P=5,M=-1;function U(){return b?!0:!(s.unstable_now()-M<P)}function q(){if(b=!1,B){var F=s.unstable_now();M=F;var z=!0;try{e:{v=!1,S&&(S=!1,C(I),I=-1),E=!0;var j=p;try{t:{for(D(F),g=t(f);g!==null&&!(g.expirationTime>F&&U());){var oe=g.callback;if(typeof oe=="function"){g.callback=null,p=g.priorityLevel;var fe=oe(g.expirationTime<=F);if(F=s.unstable_now(),typeof fe=="function"){g.callback=fe,D(F),z=!0;break t}g===t(f)&&n(f),D(F)}else n(f);g=t(f)}if(g!==null)z=!0;else{var k=t(d);k!==null&&re(N,k.startTime-F),z=!1}}break e}finally{g=null,p=j,E=!1}z=void 0}}finally{z?V():B=!1}}}var V;if(typeof _=="function")V=function(){_(q)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,Z=ee.port2;ee.port1.onmessage=q,V=function(){Z.postMessage(null)}}else V=function(){R(q,0)};function re(F,z){I=R(function(){F(s.unstable_now())},z)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(F){F.callback=null},s.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<F?Math.floor(1e3/F):5},s.unstable_getCurrentPriorityLevel=function(){return p},s.unstable_next=function(F){switch(p){case 1:case 2:case 3:var z=3;break;default:z=p}var j=p;p=z;try{return F()}finally{p=j}},s.unstable_requestPaint=function(){b=!0},s.unstable_runWithPriority=function(F,z){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var j=p;p=F;try{return z()}finally{p=j}},s.unstable_scheduleCallback=function(F,z,j){var oe=s.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?oe+j:oe):j=oe,F){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=j+fe,F={id:m++,callback:z,priorityLevel:F,startTime:j,expirationTime:fe,sortIndex:-1},j>oe?(F.sortIndex=j,e(d,F),t(f)===null&&F===t(d)&&(S?(C(I),I=-1):S=!0,re(N,j-oe))):(F.sortIndex=fe,e(f,F),v||E||(v=!0,B||(B=!0,V()))),F},s.unstable_shouldYield=U,s.unstable_wrapCallback=function(F){var z=p;return function(){var j=p;p=z;try{return F.apply(this,arguments)}finally{p=j}}}})($h)),$h}var $x;function l_(){return $x||($x=1,Bh.exports=o_()),Bh.exports}var jh={exports:{}},ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jx;function c_(){if(jx)return ke;jx=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),p=Symbol.iterator;function E(k){return k===null||typeof k!="object"?null:(k=p&&k[p]||k["@@iterator"],typeof k=="function"?k:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,b={};function R(k,G,te){this.props=k,this.context=G,this.refs=b,this.updater=te||v}R.prototype.isReactComponent={},R.prototype.setState=function(k,G){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,G,"setState")},R.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function C(){}C.prototype=R.prototype;function _(k,G,te){this.props=k,this.context=G,this.refs=b,this.updater=te||v}var D=_.prototype=new C;D.constructor=_,S(D,R.prototype),D.isPureReactComponent=!0;var N=Array.isArray;function B(){}var I={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function M(k,G,te){var le=te.ref;return{$$typeof:s,type:k,key:G,ref:le!==void 0?le:null,props:te}}function U(k,G){return M(k.type,G,k.props)}function q(k){return typeof k=="object"&&k!==null&&k.$$typeof===s}function V(k){var G={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(te){return G[te]})}var ee=/\/+/g;function Z(k,G){return typeof k=="object"&&k!==null&&k.key!=null?V(""+k.key):G.toString(36)}function re(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(B,B):(k.status="pending",k.then(function(G){k.status==="pending"&&(k.status="fulfilled",k.value=G)},function(G){k.status==="pending"&&(k.status="rejected",k.reason=G)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function F(k,G,te,le,he){var pe=typeof k;(pe==="undefined"||pe==="boolean")&&(k=null);var ye=!1;if(k===null)ye=!0;else switch(pe){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(k.$$typeof){case s:case e:ye=!0;break;case m:return ye=k._init,F(ye(k._payload),G,te,le,he)}}if(ye)return he=he(k),ye=le===""?"."+Z(k,0):le,N(he)?(te="",ye!=null&&(te=ye.replace(ee,"$&/")+"/"),F(he,G,te,"",function(dt){return dt})):he!=null&&(q(he)&&(he=U(he,te+(he.key==null||k&&k.key===he.key?"":(""+he.key).replace(ee,"$&/")+"/")+ye)),G.push(he)),1;ye=0;var Ne=le===""?".":le+":";if(N(k))for(var De=0;De<k.length;De++)le=k[De],pe=Ne+Z(le,De),ye+=F(le,G,te,pe,he);else if(De=E(k),typeof De=="function")for(k=De.call(k),De=0;!(le=k.next()).done;)le=le.value,pe=Ne+Z(le,De++),ye+=F(le,G,te,pe,he);else if(pe==="object"){if(typeof k.then=="function")return F(re(k),G,te,le,he);throw G=String(k),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return ye}function z(k,G,te){if(k==null)return k;var le=[],he=0;return F(k,le,"","",function(pe){return G.call(te,pe,he++)}),le}function j(k){if(k._status===-1){var G=k._result;G=G(),G.then(function(te){(k._status===0||k._status===-1)&&(k._status=1,k._result=te)},function(te){(k._status===0||k._status===-1)&&(k._status=2,k._result=te)}),k._status===-1&&(k._status=0,k._result=G)}if(k._status===1)return k._result.default;throw k._result}var oe=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},fe={map:z,forEach:function(k,G,te){z(k,function(){G.apply(this,arguments)},te)},count:function(k){var G=0;return z(k,function(){G++}),G},toArray:function(k){return z(k,function(G){return G})||[]},only:function(k){if(!q(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return ke.Activity=g,ke.Children=fe,ke.Component=R,ke.Fragment=t,ke.Profiler=r,ke.PureComponent=_,ke.StrictMode=n,ke.Suspense=f,ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,ke.__COMPILER_RUNTIME={__proto__:null,c:function(k){return I.H.useMemoCache(k)}},ke.cache=function(k){return function(){return k.apply(null,arguments)}},ke.cacheSignal=function(){return null},ke.cloneElement=function(k,G,te){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var le=S({},k.props),he=k.key;if(G!=null)for(pe in G.key!==void 0&&(he=""+G.key),G)!P.call(G,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&G.ref===void 0||(le[pe]=G[pe]);var pe=arguments.length-2;if(pe===1)le.children=te;else if(1<pe){for(var ye=Array(pe),Ne=0;Ne<pe;Ne++)ye[Ne]=arguments[Ne+2];le.children=ye}return M(k.type,he,le)},ke.createContext=function(k){return k={$$typeof:l,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:o,_context:k},k},ke.createElement=function(k,G,te){var le,he={},pe=null;if(G!=null)for(le in G.key!==void 0&&(pe=""+G.key),G)P.call(G,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(he[le]=G[le]);var ye=arguments.length-2;if(ye===1)he.children=te;else if(1<ye){for(var Ne=Array(ye),De=0;De<ye;De++)Ne[De]=arguments[De+2];he.children=Ne}if(k&&k.defaultProps)for(le in ye=k.defaultProps,ye)he[le]===void 0&&(he[le]=ye[le]);return M(k,pe,he)},ke.createRef=function(){return{current:null}},ke.forwardRef=function(k){return{$$typeof:c,render:k}},ke.isValidElement=q,ke.lazy=function(k){return{$$typeof:m,_payload:{_status:-1,_result:k},_init:j}},ke.memo=function(k,G){return{$$typeof:d,type:k,compare:G===void 0?null:G}},ke.startTransition=function(k){var G=I.T,te={};I.T=te;try{var le=k(),he=I.S;he!==null&&he(te,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(B,oe)}catch(pe){oe(pe)}finally{G!==null&&te.types!==null&&(G.types=te.types),I.T=G}},ke.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},ke.use=function(k){return I.H.use(k)},ke.useActionState=function(k,G,te){return I.H.useActionState(k,G,te)},ke.useCallback=function(k,G){return I.H.useCallback(k,G)},ke.useContext=function(k){return I.H.useContext(k)},ke.useDebugValue=function(){},ke.useDeferredValue=function(k,G){return I.H.useDeferredValue(k,G)},ke.useEffect=function(k,G){return I.H.useEffect(k,G)},ke.useEffectEvent=function(k){return I.H.useEffectEvent(k)},ke.useId=function(){return I.H.useId()},ke.useImperativeHandle=function(k,G,te){return I.H.useImperativeHandle(k,G,te)},ke.useInsertionEffect=function(k,G){return I.H.useInsertionEffect(k,G)},ke.useLayoutEffect=function(k,G){return I.H.useLayoutEffect(k,G)},ke.useMemo=function(k,G){return I.H.useMemo(k,G)},ke.useOptimistic=function(k,G){return I.H.useOptimistic(k,G)},ke.useReducer=function(k,G,te){return I.H.useReducer(k,G,te)},ke.useRef=function(k){return I.H.useRef(k)},ke.useState=function(k){return I.H.useState(k)},ke.useSyncExternalStore=function(k,G,te){return I.H.useSyncExternalStore(k,G,te)},ke.useTransition=function(){return I.H.useTransition()},ke.version="19.2.0",ke}var Gx;function Qu(){return Gx||(Gx=1,jh.exports=c_()),jh.exports}var Gh={exports:{}},en={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hx;function u_(){if(Hx)return en;Hx=1;var s=Qu();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(f,d,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:f,containerInfo:d,implementation:m}}var l=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return en.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,en.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(f,d,null,m)},en.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},en.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},en.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},en.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,g=c(m,d.crossOrigin),p=typeof d.integrity=="string"?d.integrity:void 0,E=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:p,fetchPriority:E}):m==="script"&&n.d.X(f,{crossOrigin:g,integrity:p,fetchPriority:E,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},en.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},en.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,g=c(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},en.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=c(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},en.requestFormReset=function(f){n.d.r(f)},en.unstable_batchedUpdates=function(f,d){return f(d)},en.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},en.useFormStatus=function(){return l.H.useHostTransitionStatus()},en.version="19.2.0",en}var zx;function _b(){if(zx)return Gh.exports;zx=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Gh.exports=u_(),Gh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vx;function d_(){if(Vx)return Uo;Vx=1;var s=l_(),e=Qu(),t=_b();function n(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var a=i,u=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(u=a.return),i=a.return;while(i)}return a.tag===3?u:null}function l(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function c(i){if(i.tag===31){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(n(188))}function d(i){var a=i.alternate;if(!a){if(a=o(i),a===null)throw Error(n(188));return a!==i?null:i}for(var u=i,h=a;;){var y=u.return;if(y===null)break;var x=y.alternate;if(x===null){if(h=y.return,h!==null){u=h;continue}break}if(y.child===x.child){for(x=y.child;x;){if(x===u)return f(y),i;if(x===h)return f(y),a;x=x.sibling}throw Error(n(188))}if(u.return!==h.return)u=y,h=x;else{for(var w=!1,O=y.child;O;){if(O===u){w=!0,u=y,h=x;break}if(O===h){w=!0,h=y,u=x;break}O=O.sibling}if(!w){for(O=x.child;O;){if(O===u){w=!0,u=x,h=y;break}if(O===h){w=!0,h=x,u=y;break}O=O.sibling}if(!w)throw Error(n(189))}}if(u.alternate!==h)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?i:a}function m(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=m(i),a!==null)return a;i=i.sibling}return null}var g=Object.assign,p=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),_=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function V(i){return i===null||typeof i!="object"?null:(i=q&&i[q]||i["@@iterator"],typeof i=="function"?i:null)}var ee=Symbol.for("react.client.reference");function Z(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===ee?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case S:return"Fragment";case R:return"Profiler";case b:return"StrictMode";case N:return"Suspense";case B:return"SuspenseList";case M:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case v:return"Portal";case _:return i.displayName||"Context";case C:return(i._context.displayName||"Context")+".Consumer";case D:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case I:return a=i.displayName||null,a!==null?a:Z(i.type)||"Memo";case P:a=i._payload,i=i._init;try{return Z(i(a))}catch{}}return null}var re=Array.isArray,F=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},oe=[],fe=-1;function k(i){return{current:i}}function G(i){0>fe||(i.current=oe[fe],oe[fe]=null,fe--)}function te(i,a){fe++,oe[fe]=i.current,i.current=a}var le=k(null),he=k(null),pe=k(null),ye=k(null);function Ne(i,a){switch(te(pe,a),te(he,i),te(le,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?ax(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=ax(a),i=ox(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}G(le),te(le,i)}function De(){G(le),G(he),G(pe)}function dt(i){i.memoizedState!==null&&te(ye,i);var a=le.current,u=ox(a,i.type);a!==u&&(te(he,i),te(le,u))}function ot(i){he.current===i&&(G(le),G(he)),ye.current===i&&(G(ye),No._currentValue=j)}var we,nn;function vn(i){if(we===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);we=a&&a[1]||"",nn=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+we+i+nn}var Ki=!1;function Ue(i,a){if(!i||Ki)return"";Ki=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(a){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(se){var J=se}Reflect.construct(i,[],de)}else{try{de.call()}catch(se){J=se}i.call(de.prototype)}}else{try{throw Error()}catch(se){J=se}(de=i())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(se){if(se&&J&&typeof se.stack=="string")return[se.stack,J.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=h.DetermineComponentFrameRoot(),w=x[0],O=x[1];if(w&&O){var $=w.split(`
`),Q=O.split(`
`);for(y=h=0;h<$.length&&!$[h].includes("DetermineComponentFrameRoot");)h++;for(;y<Q.length&&!Q[y].includes("DetermineComponentFrameRoot");)y++;if(h===$.length||y===Q.length)for(h=$.length-1,y=Q.length-1;1<=h&&0<=y&&$[h]!==Q[y];)y--;for(;1<=h&&0<=y;h--,y--)if($[h]!==Q[y]){if(h!==1||y!==1)do if(h--,y--,0>y||$[h]!==Q[y]){var ae=`
`+$[h].replace(" at new "," at ");return i.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",i.displayName)),ae}while(1<=h&&0<=y);break}}}finally{Ki=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?vn(u):""}function At(i,a){switch(i.tag){case 26:case 27:case 5:return vn(i.type);case 16:return vn("Lazy");case 13:return i.child!==a&&a!==null?vn("Suspense Fallback"):vn("Suspense");case 19:return vn("SuspenseList");case 0:case 15:return Ue(i.type,!1);case 11:return Ue(i.type.render,!1);case 1:return Ue(i.type,!0);case 31:return vn("Activity");default:return""}}function _t(i){try{var a="",u=null;do a+=At(i,u),u=i,i=i.return;while(i);return a}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Jt=Object.prototype.hasOwnProperty,Ht=s.unstable_scheduleCallback,Mn=s.unstable_cancelCallback,Xn=s.unstable_shouldYield,wr=s.unstable_requestPaint,Dt=s.unstable_now,Lr=s.unstable_getCurrentPriorityLevel,ls=s.unstable_ImmediatePriority,ai=s.unstable_UserBlockingPriority,Is=s.unstable_NormalPriority,oi=s.unstable_LowPriority,li=s.unstable_IdlePriority,Os=s.log,ie=s.unstable_setDisableYieldValue,me=null,ge=null;function Ce(i){if(typeof Os=="function"&&ie(i),ge&&typeof ge.setStrictMode=="function")try{ge.setStrictMode(me,i)}catch{}}var He=Math.clz32?Math.clz32:ci,ft=Math.log,Ye=Math.LN2;function ci(i){return i>>>=0,i===0?32:31-(ft(i)/Ye|0)|0}var qi=256,zt=262144,Yi=4194304;function Wi(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Sl(i,a,u){var h=i.pendingLanes;if(h===0)return 0;var y=0,x=i.suspendedLanes,w=i.pingedLanes;i=i.warmLanes;var O=h&134217727;return O!==0?(h=O&~x,h!==0?y=Wi(h):(w&=O,w!==0?y=Wi(w):u||(u=O&~i,u!==0&&(y=Wi(u))))):(O=h&~x,O!==0?y=Wi(O):w!==0?y=Wi(w):u||(u=h&~i,u!==0&&(y=Wi(u)))),y===0?0:a!==0&&a!==y&&(a&x)===0&&(x=y&-y,u=a&-a,x>=u||x===32&&(u&4194048)!==0)?a:y}function Va(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function Vw(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jp(){var i=Yi;return Yi<<=1,(Yi&62914560)===0&&(Yi=4194304),i}function Ad(i){for(var a=[],u=0;31>u;u++)a.push(i);return a}function Ka(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Kw(i,a,u,h,y,x){var w=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var O=i.entanglements,$=i.expirationTimes,Q=i.hiddenUpdates;for(u=w&~u;0<u;){var ae=31-He(u),de=1<<ae;O[ae]=0,$[ae]=-1;var J=Q[ae];if(J!==null)for(Q[ae]=null,ae=0;ae<J.length;ae++){var se=J[ae];se!==null&&(se.lane&=-536870913)}u&=~de}h!==0&&Gp(i,h,0),x!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=x&~(w&~a))}function Gp(i,a,u){i.pendingLanes|=a,i.suspendedLanes&=~a;var h=31-He(a);i.entangledLanes|=a,i.entanglements[h]=i.entanglements[h]|1073741824|u&261930}function Hp(i,a){var u=i.entangledLanes|=a;for(i=i.entanglements;u;){var h=31-He(u),y=1<<h;y&a|i[h]&a&&(i[h]|=a),u&=~y}}function zp(i,a){var u=a&-a;return u=(u&42)!==0?1:Rd(u),(u&(i.suspendedLanes|a))!==0?0:u}function Rd(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function wd(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Vp(){var i=z.p;return i!==0?i:(i=window.event,i===void 0?32:Dx(i.type))}function Kp(i,a){var u=z.p;try{return z.p=i,a()}finally{z.p=u}}var ui=Math.random().toString(36).slice(2),Vt="__reactFiber$"+ui,on="__reactProps$"+ui,Cr="__reactContainer$"+ui,Ld="__reactEvents$"+ui,qw="__reactListeners$"+ui,Yw="__reactHandles$"+ui,qp="__reactResources$"+ui,qa="__reactMarker$"+ui;function Cd(i){delete i[Vt],delete i[on],delete i[Ld],delete i[qw],delete i[Yw]}function _r(i){var a=i[Vt];if(a)return a;for(var u=i.parentNode;u;){if(a=u[Cr]||u[Vt]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(i=mx(i);i!==null;){if(u=i[Vt])return u;i=mx(i)}return a}i=u,u=i.parentNode}return null}function Dr(i){if(i=i[Vt]||i[Cr]){var a=i.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return i}return null}function Ya(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(n(33))}function Ir(i){var a=i[qp];return a||(a=i[qp]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function $t(i){i[qa]=!0}var Yp=new Set,Wp={};function Xi(i,a){Or(i,a),Or(i+"Capture",a)}function Or(i,a){for(Wp[i]=a,i=0;i<a.length;i++)Yp.add(a[i])}var Ww=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Xp={},Qp={};function Xw(i){return Jt.call(Qp,i)?!0:Jt.call(Xp,i)?!1:Ww.test(i)?Qp[i]=!0:(Xp[i]=!0,!1)}function bl(i,a,u){if(Xw(a))if(u===null)i.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var h=a.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+u)}}function Tl(i,a,u){if(u===null)i.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+u)}}function Ns(i,a,u,h){if(h===null)i.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(a,u,""+h)}}function Pn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Zp(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Qw(i,a,u){var h=Object.getOwnPropertyDescriptor(i.constructor.prototype,a);if(!i.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var y=h.get,x=h.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return y.call(this)},set:function(w){u=""+w,x.call(this,w)}}),Object.defineProperty(i,a,{enumerable:h.enumerable}),{getValue:function(){return u},setValue:function(w){u=""+w},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function _d(i){if(!i._valueTracker){var a=Zp(i)?"checked":"value";i._valueTracker=Qw(i,a,""+i[a])}}function Jp(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var u=a.getValue(),h="";return i&&(h=Zp(i)?i.checked?"true":"false":i.value),i=h,i!==u?(a.setValue(i),!0):!1}function Al(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Zw=/[\n"\\]/g;function Fn(i){return i.replace(Zw,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Dd(i,a,u,h,y,x,w,O){i.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?i.type=w:i.removeAttribute("type"),a!=null?w==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+Pn(a)):i.value!==""+Pn(a)&&(i.value=""+Pn(a)):w!=="submit"&&w!=="reset"||i.removeAttribute("value"),a!=null?Id(i,w,Pn(a)):u!=null?Id(i,w,Pn(u)):h!=null&&i.removeAttribute("value"),y==null&&x!=null&&(i.defaultChecked=!!x),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?i.name=""+Pn(O):i.removeAttribute("name")}function e0(i,a,u,h,y,x,w,O){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.type=x),a!=null||u!=null){if(!(x!=="submit"&&x!=="reset"||a!=null)){_d(i);return}u=u!=null?""+Pn(u):"",a=a!=null?""+Pn(a):u,O||a===i.value||(i.value=a),i.defaultValue=a}h=h??y,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=O?i.checked:!!h,i.defaultChecked=!!h,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(i.name=w),_d(i)}function Id(i,a,u){a==="number"&&Al(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function Nr(i,a,u,h){if(i=i.options,a){a={};for(var y=0;y<u.length;y++)a["$"+u[y]]=!0;for(u=0;u<i.length;u++)y=a.hasOwnProperty("$"+i[u].value),i[u].selected!==y&&(i[u].selected=y),y&&h&&(i[u].defaultSelected=!0)}else{for(u=""+Pn(u),a=null,y=0;y<i.length;y++){if(i[y].value===u){i[y].selected=!0,h&&(i[y].defaultSelected=!0);return}a!==null||i[y].disabled||(a=i[y])}a!==null&&(a.selected=!0)}}function t0(i,a,u){if(a!=null&&(a=""+Pn(a),a!==i.value&&(i.value=a),u==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=u!=null?""+Pn(u):""}function n0(i,a,u,h){if(a==null){if(h!=null){if(u!=null)throw Error(n(92));if(re(h)){if(1<h.length)throw Error(n(93));h=h[0]}u=h}u==null&&(u=""),a=u}u=Pn(a),i.defaultValue=u,h=i.textContent,h===u&&h!==""&&h!==null&&(i.value=h),_d(i)}function kr(i,a){if(a){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=a;return}}i.textContent=a}var Jw=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function s0(i,a,u){var h=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":h?i.setProperty(a,u):typeof u!="number"||u===0||Jw.has(a)?a==="float"?i.cssFloat=u:i[a]=(""+u).trim():i[a]=u+"px"}function i0(i,a,u){if(a!=null&&typeof a!="object")throw Error(n(62));if(i=i.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||a!=null&&a.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var y in a)h=a[y],a.hasOwnProperty(y)&&u[y]!==h&&s0(i,y,h)}else for(var x in a)a.hasOwnProperty(x)&&s0(i,x,a[x])}function Od(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eL=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),tL=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Rl(i){return tL.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ks(){}var Nd=null;function kd(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Mr=null,Pr=null;function r0(i){var a=Dr(i);if(a&&(i=a.stateNode)){var u=i[on]||null;e:switch(i=a.stateNode,a.type){case"input":if(Dd(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Fn(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var h=u[a];if(h!==i&&h.form===i.form){var y=h[on]||null;if(!y)throw Error(n(90));Dd(h,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(a=0;a<u.length;a++)h=u[a],h.form===i.form&&Jp(h)}break e;case"textarea":t0(i,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&Nr(i,!!u.multiple,a,!1)}}}var Md=!1;function a0(i,a,u){if(Md)return i(a,u);Md=!0;try{var h=i(a);return h}finally{if(Md=!1,(Mr!==null||Pr!==null)&&(fc(),Mr&&(a=Mr,i=Pr,Pr=Mr=null,r0(a),i)))for(a=0;a<i.length;a++)r0(i[a])}}function Wa(i,a){var u=i.stateNode;if(u===null)return null;var h=u[on]||null;if(h===null)return null;u=h[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(n(231,a,typeof u));return u}var Ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pd=!1;if(Ms)try{var Xa={};Object.defineProperty(Xa,"passive",{get:function(){Pd=!0}}),window.addEventListener("test",Xa,Xa),window.removeEventListener("test",Xa,Xa)}catch{Pd=!1}var di=null,Fd=null,wl=null;function o0(){if(wl)return wl;var i,a=Fd,u=a.length,h,y="value"in di?di.value:di.textContent,x=y.length;for(i=0;i<u&&a[i]===y[i];i++);var w=u-i;for(h=1;h<=w&&a[u-h]===y[x-h];h++);return wl=y.slice(i,1<h?1-h:void 0)}function Ll(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function Cl(){return!0}function l0(){return!1}function ln(i){function a(u,h,y,x,w){this._reactName=u,this._targetInst=y,this.type=h,this.nativeEvent=x,this.target=w,this.currentTarget=null;for(var O in i)i.hasOwnProperty(O)&&(u=i[O],this[O]=u?u(x):x[O]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Cl:l0,this.isPropagationStopped=l0,this}return g(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Cl)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Cl)},persist:function(){},isPersistent:Cl}),a}var Qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_l=ln(Qi),Qa=g({},Qi,{view:0,detail:0}),nL=ln(Qa),Ud,Bd,Za,Dl=g({},Qa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jd,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Za&&(Za&&i.type==="mousemove"?(Ud=i.screenX-Za.screenX,Bd=i.screenY-Za.screenY):Bd=Ud=0,Za=i),Ud)},movementY:function(i){return"movementY"in i?i.movementY:Bd}}),c0=ln(Dl),sL=g({},Dl,{dataTransfer:0}),iL=ln(sL),rL=g({},Qa,{relatedTarget:0}),$d=ln(rL),aL=g({},Qi,{animationName:0,elapsedTime:0,pseudoElement:0}),oL=ln(aL),lL=g({},Qi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),cL=ln(lL),uL=g({},Qi,{data:0}),u0=ln(uL),dL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mL(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=hL[i])?!!a[i]:!1}function jd(){return mL}var gL=g({},Qa,{key:function(i){if(i.key){var a=dL[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=Ll(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?fL[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jd,charCode:function(i){return i.type==="keypress"?Ll(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ll(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),pL=ln(gL),yL=g({},Dl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),d0=ln(yL),vL=g({},Qa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jd}),xL=ln(vL),EL=g({},Qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),SL=ln(EL),bL=g({},Dl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),TL=ln(bL),AL=g({},Qi,{newState:0,oldState:0}),RL=ln(AL),wL=[9,13,27,32],Gd=Ms&&"CompositionEvent"in window,Ja=null;Ms&&"documentMode"in document&&(Ja=document.documentMode);var LL=Ms&&"TextEvent"in window&&!Ja,f0=Ms&&(!Gd||Ja&&8<Ja&&11>=Ja),h0=" ",m0=!1;function g0(i,a){switch(i){case"keyup":return wL.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p0(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Fr=!1;function CL(i,a){switch(i){case"compositionend":return p0(a);case"keypress":return a.which!==32?null:(m0=!0,h0);case"textInput":return i=a.data,i===h0&&m0?null:i;default:return null}}function _L(i,a){if(Fr)return i==="compositionend"||!Gd&&g0(i,a)?(i=o0(),wl=Fd=di=null,Fr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return f0&&a.locale!=="ko"?null:a.data;default:return null}}var DL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function y0(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!DL[i.type]:a==="textarea"}function v0(i,a,u,h){Mr?Pr?Pr.push(h):Pr=[h]:Mr=h,a=xc(a,"onChange"),0<a.length&&(u=new _l("onChange","change",null,u,h),i.push({event:u,listeners:a}))}var eo=null,to=null;function IL(i){ex(i,0)}function Il(i){var a=Ya(i);if(Jp(a))return i}function x0(i,a){if(i==="change")return a}var E0=!1;if(Ms){var Hd;if(Ms){var zd="oninput"in document;if(!zd){var S0=document.createElement("div");S0.setAttribute("oninput","return;"),zd=typeof S0.oninput=="function"}Hd=zd}else Hd=!1;E0=Hd&&(!document.documentMode||9<document.documentMode)}function b0(){eo&&(eo.detachEvent("onpropertychange",T0),to=eo=null)}function T0(i){if(i.propertyName==="value"&&Il(to)){var a=[];v0(a,to,i,kd(i)),a0(IL,a)}}function OL(i,a,u){i==="focusin"?(b0(),eo=a,to=u,eo.attachEvent("onpropertychange",T0)):i==="focusout"&&b0()}function NL(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Il(to)}function kL(i,a){if(i==="click")return Il(a)}function ML(i,a){if(i==="input"||i==="change")return Il(a)}function PL(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var xn=typeof Object.is=="function"?Object.is:PL;function no(i,a){if(xn(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var u=Object.keys(i),h=Object.keys(a);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var y=u[h];if(!Jt.call(a,y)||!xn(i[y],a[y]))return!1}return!0}function A0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function R0(i,a){var u=A0(i);i=0;for(var h;u;){if(u.nodeType===3){if(h=i+u.textContent.length,i<=a&&h>=a)return{node:u,offset:a-i};i=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=A0(u)}}function w0(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?w0(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function L0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=Al(i.document);a instanceof i.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)i=a.contentWindow;else break;a=Al(i.document)}return a}function Vd(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var FL=Ms&&"documentMode"in document&&11>=document.documentMode,Ur=null,Kd=null,so=null,qd=!1;function C0(i,a,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;qd||Ur==null||Ur!==Al(h)||(h=Ur,"selectionStart"in h&&Vd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),so&&no(so,h)||(so=h,h=xc(Kd,"onSelect"),0<h.length&&(a=new _l("onSelect","select",null,a,u),i.push({event:a,listeners:h}),a.target=Ur)))}function Zi(i,a){var u={};return u[i.toLowerCase()]=a.toLowerCase(),u["Webkit"+i]="webkit"+a,u["Moz"+i]="moz"+a,u}var Br={animationend:Zi("Animation","AnimationEnd"),animationiteration:Zi("Animation","AnimationIteration"),animationstart:Zi("Animation","AnimationStart"),transitionrun:Zi("Transition","TransitionRun"),transitionstart:Zi("Transition","TransitionStart"),transitioncancel:Zi("Transition","TransitionCancel"),transitionend:Zi("Transition","TransitionEnd")},Yd={},_0={};Ms&&(_0=document.createElement("div").style,"AnimationEvent"in window||(delete Br.animationend.animation,delete Br.animationiteration.animation,delete Br.animationstart.animation),"TransitionEvent"in window||delete Br.transitionend.transition);function Ji(i){if(Yd[i])return Yd[i];if(!Br[i])return i;var a=Br[i],u;for(u in a)if(a.hasOwnProperty(u)&&u in _0)return Yd[i]=a[u];return i}var D0=Ji("animationend"),I0=Ji("animationiteration"),O0=Ji("animationstart"),UL=Ji("transitionrun"),BL=Ji("transitionstart"),$L=Ji("transitioncancel"),N0=Ji("transitionend"),k0=new Map,Wd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wd.push("scrollEnd");function Qn(i,a){k0.set(i,a),Xi(a,[i])}var Ol=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Un=[],$r=0,Xd=0;function Nl(){for(var i=$r,a=Xd=$r=0;a<i;){var u=Un[a];Un[a++]=null;var h=Un[a];Un[a++]=null;var y=Un[a];Un[a++]=null;var x=Un[a];if(Un[a++]=null,h!==null&&y!==null){var w=h.pending;w===null?y.next=y:(y.next=w.next,w.next=y),h.pending=y}x!==0&&M0(u,y,x)}}function kl(i,a,u,h){Un[$r++]=i,Un[$r++]=a,Un[$r++]=u,Un[$r++]=h,Xd|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function Qd(i,a,u,h){return kl(i,a,u,h),Ml(i)}function er(i,a){return kl(i,null,null,a),Ml(i)}function M0(i,a,u){i.lanes|=u;var h=i.alternate;h!==null&&(h.lanes|=u);for(var y=!1,x=i.return;x!==null;)x.childLanes|=u,h=x.alternate,h!==null&&(h.childLanes|=u),x.tag===22&&(i=x.stateNode,i===null||i._visibility&1||(y=!0)),i=x,x=x.return;return i.tag===3?(x=i.stateNode,y&&a!==null&&(y=31-He(u),i=x.hiddenUpdates,h=i[y],h===null?i[y]=[a]:h.push(a),a.lane=u|536870912),x):null}function Ml(i){if(50<wo)throw wo=0,oh=null,Error(n(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var jr={};function jL(i,a,u,h){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function En(i,a,u,h){return new jL(i,a,u,h)}function Zd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ps(i,a){var u=i.alternate;return u===null?(u=En(i.tag,a,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=a,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,a=i.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function P0(i,a){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,a=u.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function Pl(i,a,u,h,y,x){var w=0;if(h=i,typeof i=="function")Zd(i)&&(w=1);else if(typeof i=="string")w=KC(i,u,le.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case M:return i=En(31,u,a,y),i.elementType=M,i.lanes=x,i;case S:return tr(u.children,y,x,a);case b:w=8,y|=24;break;case R:return i=En(12,u,a,y|2),i.elementType=R,i.lanes=x,i;case N:return i=En(13,u,a,y),i.elementType=N,i.lanes=x,i;case B:return i=En(19,u,a,y),i.elementType=B,i.lanes=x,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case _:w=10;break e;case C:w=9;break e;case D:w=11;break e;case I:w=14;break e;case P:w=16,h=null;break e}w=29,u=Error(n(130,i===null?"null":typeof i,"")),h=null}return a=En(w,u,a,y),a.elementType=i,a.type=h,a.lanes=x,a}function tr(i,a,u,h){return i=En(7,i,h,a),i.lanes=u,i}function Jd(i,a,u){return i=En(6,i,null,a),i.lanes=u,i}function F0(i){var a=En(18,null,null,0);return a.stateNode=i,a}function ef(i,a,u){return a=En(4,i.children!==null?i.children:[],i.key,a),a.lanes=u,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var U0=new WeakMap;function Bn(i,a){if(typeof i=="object"&&i!==null){var u=U0.get(i);return u!==void 0?u:(a={value:i,source:a,stack:_t(a)},U0.set(i,a),a)}return{value:i,source:a,stack:_t(a)}}var Gr=[],Hr=0,Fl=null,io=0,$n=[],jn=0,fi=null,cs=1,us="";function Fs(i,a){Gr[Hr++]=io,Gr[Hr++]=Fl,Fl=i,io=a}function B0(i,a,u){$n[jn++]=cs,$n[jn++]=us,$n[jn++]=fi,fi=i;var h=cs;i=us;var y=32-He(h)-1;h&=~(1<<y),u+=1;var x=32-He(a)+y;if(30<x){var w=y-y%5;x=(h&(1<<w)-1).toString(32),h>>=w,y-=w,cs=1<<32-He(a)+y|u<<y|h,us=x+i}else cs=1<<x|u<<y|h,us=i}function tf(i){i.return!==null&&(Fs(i,1),B0(i,1,0))}function nf(i){for(;i===Fl;)Fl=Gr[--Hr],Gr[Hr]=null,io=Gr[--Hr],Gr[Hr]=null;for(;i===fi;)fi=$n[--jn],$n[jn]=null,us=$n[--jn],$n[jn]=null,cs=$n[--jn],$n[jn]=null}function $0(i,a){$n[jn++]=cs,$n[jn++]=us,$n[jn++]=fi,cs=a.id,us=a.overflow,fi=i}var Kt=null,gt=null,We=!1,hi=null,Gn=!1,sf=Error(n(519));function mi(i){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ro(Bn(a,i)),sf}function j0(i){var a=i.stateNode,u=i.type,h=i.memoizedProps;switch(a[Vt]=i,a[on]=h,u){case"dialog":Ve("cancel",a),Ve("close",a);break;case"iframe":case"object":case"embed":Ve("load",a);break;case"video":case"audio":for(u=0;u<Co.length;u++)Ve(Co[u],a);break;case"source":Ve("error",a);break;case"img":case"image":case"link":Ve("error",a),Ve("load",a);break;case"details":Ve("toggle",a);break;case"input":Ve("invalid",a),e0(a,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Ve("invalid",a);break;case"textarea":Ve("invalid",a),n0(a,h.value,h.defaultValue,h.children)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||h.suppressHydrationWarning===!0||ix(a.textContent,u)?(h.popover!=null&&(Ve("beforetoggle",a),Ve("toggle",a)),h.onScroll!=null&&Ve("scroll",a),h.onScrollEnd!=null&&Ve("scrollend",a),h.onClick!=null&&(a.onclick=ks),a=!0):a=!1,a||mi(i,!0)}function G0(i){for(Kt=i.return;Kt;)switch(Kt.tag){case 5:case 31:case 13:Gn=!1;return;case 27:case 3:Gn=!0;return;default:Kt=Kt.return}}function zr(i){if(i!==Kt)return!1;if(!We)return G0(i),We=!0,!1;var a=i.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||bh(i.type,i.memoizedProps)),u=!u),u&&gt&&mi(i),G0(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));gt=hx(i)}else if(a===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));gt=hx(i)}else a===27?(a=gt,Ci(i.type)?(i=Lh,Lh=null,gt=i):gt=a):gt=Kt?zn(i.stateNode.nextSibling):null;return!0}function nr(){gt=Kt=null,We=!1}function rf(){var i=hi;return i!==null&&(fn===null?fn=i:fn.push.apply(fn,i),hi=null),i}function ro(i){hi===null?hi=[i]:hi.push(i)}var af=k(null),sr=null,Us=null;function gi(i,a,u){te(af,a._currentValue),a._currentValue=u}function Bs(i){i._currentValue=af.current,G(af)}function of(i,a,u){for(;i!==null;){var h=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),i===u)break;i=i.return}}function lf(i,a,u,h){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var x=y.dependencies;if(x!==null){var w=y.child;x=x.firstContext;e:for(;x!==null;){var O=x;x=y;for(var $=0;$<a.length;$++)if(O.context===a[$]){x.lanes|=u,O=x.alternate,O!==null&&(O.lanes|=u),of(x.return,u,i),h||(w=null);break e}x=O.next}}else if(y.tag===18){if(w=y.return,w===null)throw Error(n(341));w.lanes|=u,x=w.alternate,x!==null&&(x.lanes|=u),of(w,u,i),w=null}else w=y.child;if(w!==null)w.return=y;else for(w=y;w!==null;){if(w===i){w=null;break}if(y=w.sibling,y!==null){y.return=w.return,w=y;break}w=w.return}y=w}}function Vr(i,a,u,h){i=null;for(var y=a,x=!1;y!==null;){if(!x){if((y.flags&524288)!==0)x=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var w=y.alternate;if(w===null)throw Error(n(387));if(w=w.memoizedProps,w!==null){var O=y.type;xn(y.pendingProps.value,w.value)||(i!==null?i.push(O):i=[O])}}else if(y===ye.current){if(w=y.alternate,w===null)throw Error(n(387));w.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(No):i=[No])}y=y.return}i!==null&&lf(a,i,u,h),a.flags|=262144}function Ul(i){for(i=i.firstContext;i!==null;){if(!xn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ir(i){sr=i,Us=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function qt(i){return H0(sr,i)}function Bl(i,a){return sr===null&&ir(i),H0(i,a)}function H0(i,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},Us===null){if(i===null)throw Error(n(308));Us=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else Us=Us.next=a;return u}var GL=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(u,h){i.push(h)}};this.abort=function(){a.aborted=!0,i.forEach(function(u){return u()})}},HL=s.unstable_scheduleCallback,zL=s.unstable_NormalPriority,It={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function cf(){return{controller:new GL,data:new Map,refCount:0}}function ao(i){i.refCount--,i.refCount===0&&HL(zL,function(){i.controller.abort()})}var oo=null,uf=0,Kr=0,qr=null;function VL(i,a){if(oo===null){var u=oo=[];uf=0,Kr=hh(),qr={status:"pending",value:void 0,then:function(h){u.push(h)}}}return uf++,a.then(z0,z0),a}function z0(){if(--uf===0&&oo!==null){qr!==null&&(qr.status="fulfilled");var i=oo;oo=null,Kr=0,qr=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function KL(i,a){var u=[],h={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return i.then(function(){h.status="fulfilled",h.value=a;for(var y=0;y<u.length;y++)(0,u[y])(a)},function(y){for(h.status="rejected",h.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),h}var V0=F.S;F.S=function(i,a){Cv=Dt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&VL(i,a),V0!==null&&V0(i,a)};var rr=k(null);function df(){var i=rr.current;return i!==null?i:lt.pooledCache}function $l(i,a){a===null?te(rr,rr.current):te(rr,a.pool)}function K0(){var i=df();return i===null?null:{parent:It._currentValue,pool:i}}var Yr=Error(n(460)),ff=Error(n(474)),jl=Error(n(542)),Gl={then:function(){}};function q0(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Y0(i,a,u){switch(u=i[u],u===void 0?i.push(a):u!==a&&(a.then(ks,ks),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,X0(i),i;default:if(typeof a.status=="string")a.then(ks,ks);else{if(i=lt,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=a,i.status="pending",i.then(function(h){if(a.status==="pending"){var y=a;y.status="fulfilled",y.value=h}},function(h){if(a.status==="pending"){var y=a;y.status="rejected",y.reason=h}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,X0(i),i}throw or=a,Yr}}function ar(i){try{var a=i._init;return a(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(or=u,Yr):u}}var or=null;function W0(){if(or===null)throw Error(n(459));var i=or;return or=null,i}function X0(i){if(i===Yr||i===jl)throw Error(n(483))}var Wr=null,lo=0;function Hl(i){var a=lo;return lo+=1,Wr===null&&(Wr=[]),Y0(Wr,i,a)}function co(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function zl(i,a){throw a.$$typeof===p?Error(n(525)):(i=Object.prototype.toString.call(a),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function Q0(i){function a(K,H){if(i){var X=K.deletions;X===null?(K.deletions=[H],K.flags|=16):X.push(H)}}function u(K,H){if(!i)return null;for(;H!==null;)a(K,H),H=H.sibling;return null}function h(K){for(var H=new Map;K!==null;)K.key!==null?H.set(K.key,K):H.set(K.index,K),K=K.sibling;return H}function y(K,H){return K=Ps(K,H),K.index=0,K.sibling=null,K}function x(K,H,X){return K.index=X,i?(X=K.alternate,X!==null?(X=X.index,X<H?(K.flags|=67108866,H):X):(K.flags|=67108866,H)):(K.flags|=1048576,H)}function w(K){return i&&K.alternate===null&&(K.flags|=67108866),K}function O(K,H,X,ue){return H===null||H.tag!==6?(H=Jd(X,K.mode,ue),H.return=K,H):(H=y(H,X),H.return=K,H)}function $(K,H,X,ue){var Re=X.type;return Re===S?ae(K,H,X.props.children,ue,X.key):H!==null&&(H.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===P&&ar(Re)===H.type)?(H=y(H,X.props),co(H,X),H.return=K,H):(H=Pl(X.type,X.key,X.props,null,K.mode,ue),co(H,X),H.return=K,H)}function Q(K,H,X,ue){return H===null||H.tag!==4||H.stateNode.containerInfo!==X.containerInfo||H.stateNode.implementation!==X.implementation?(H=ef(X,K.mode,ue),H.return=K,H):(H=y(H,X.children||[]),H.return=K,H)}function ae(K,H,X,ue,Re){return H===null||H.tag!==7?(H=tr(X,K.mode,ue,Re),H.return=K,H):(H=y(H,X),H.return=K,H)}function de(K,H,X){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Jd(""+H,K.mode,X),H.return=K,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case E:return X=Pl(H.type,H.key,H.props,null,K.mode,X),co(X,H),X.return=K,X;case v:return H=ef(H,K.mode,X),H.return=K,H;case P:return H=ar(H),de(K,H,X)}if(re(H)||V(H))return H=tr(H,K.mode,X,null),H.return=K,H;if(typeof H.then=="function")return de(K,Hl(H),X);if(H.$$typeof===_)return de(K,Bl(K,H),X);zl(K,H)}return null}function J(K,H,X,ue){var Re=H!==null?H.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return Re!==null?null:O(K,H,""+X,ue);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case E:return X.key===Re?$(K,H,X,ue):null;case v:return X.key===Re?Q(K,H,X,ue):null;case P:return X=ar(X),J(K,H,X,ue)}if(re(X)||V(X))return Re!==null?null:ae(K,H,X,ue,null);if(typeof X.then=="function")return J(K,H,Hl(X),ue);if(X.$$typeof===_)return J(K,H,Bl(K,X),ue);zl(K,X)}return null}function se(K,H,X,ue,Re){if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return K=K.get(X)||null,O(H,K,""+ue,Re);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case E:return K=K.get(ue.key===null?X:ue.key)||null,$(H,K,ue,Re);case v:return K=K.get(ue.key===null?X:ue.key)||null,Q(H,K,ue,Re);case P:return ue=ar(ue),se(K,H,X,ue,Re)}if(re(ue)||V(ue))return K=K.get(X)||null,ae(H,K,ue,Re,null);if(typeof ue.then=="function")return se(K,H,X,Hl(ue),Re);if(ue.$$typeof===_)return se(K,H,X,Bl(H,ue),Re);zl(H,ue)}return null}function Ee(K,H,X,ue){for(var Re=null,Xe=null,Te=H,Fe=H=0,qe=null;Te!==null&&Fe<X.length;Fe++){Te.index>Fe?(qe=Te,Te=null):qe=Te.sibling;var Qe=J(K,Te,X[Fe],ue);if(Qe===null){Te===null&&(Te=qe);break}i&&Te&&Qe.alternate===null&&a(K,Te),H=x(Qe,H,Fe),Xe===null?Re=Qe:Xe.sibling=Qe,Xe=Qe,Te=qe}if(Fe===X.length)return u(K,Te),We&&Fs(K,Fe),Re;if(Te===null){for(;Fe<X.length;Fe++)Te=de(K,X[Fe],ue),Te!==null&&(H=x(Te,H,Fe),Xe===null?Re=Te:Xe.sibling=Te,Xe=Te);return We&&Fs(K,Fe),Re}for(Te=h(Te);Fe<X.length;Fe++)qe=se(Te,K,Fe,X[Fe],ue),qe!==null&&(i&&qe.alternate!==null&&Te.delete(qe.key===null?Fe:qe.key),H=x(qe,H,Fe),Xe===null?Re=qe:Xe.sibling=qe,Xe=qe);return i&&Te.forEach(function(Ni){return a(K,Ni)}),We&&Fs(K,Fe),Re}function Le(K,H,X,ue){if(X==null)throw Error(n(151));for(var Re=null,Xe=null,Te=H,Fe=H=0,qe=null,Qe=X.next();Te!==null&&!Qe.done;Fe++,Qe=X.next()){Te.index>Fe?(qe=Te,Te=null):qe=Te.sibling;var Ni=J(K,Te,Qe.value,ue);if(Ni===null){Te===null&&(Te=qe);break}i&&Te&&Ni.alternate===null&&a(K,Te),H=x(Ni,H,Fe),Xe===null?Re=Ni:Xe.sibling=Ni,Xe=Ni,Te=qe}if(Qe.done)return u(K,Te),We&&Fs(K,Fe),Re;if(Te===null){for(;!Qe.done;Fe++,Qe=X.next())Qe=de(K,Qe.value,ue),Qe!==null&&(H=x(Qe,H,Fe),Xe===null?Re=Qe:Xe.sibling=Qe,Xe=Qe);return We&&Fs(K,Fe),Re}for(Te=h(Te);!Qe.done;Fe++,Qe=X.next())Qe=se(Te,K,Fe,Qe.value,ue),Qe!==null&&(i&&Qe.alternate!==null&&Te.delete(Qe.key===null?Fe:Qe.key),H=x(Qe,H,Fe),Xe===null?Re=Qe:Xe.sibling=Qe,Xe=Qe);return i&&Te.forEach(function(s_){return a(K,s_)}),We&&Fs(K,Fe),Re}function rt(K,H,X,ue){if(typeof X=="object"&&X!==null&&X.type===S&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case E:e:{for(var Re=X.key;H!==null;){if(H.key===Re){if(Re=X.type,Re===S){if(H.tag===7){u(K,H.sibling),ue=y(H,X.props.children),ue.return=K,K=ue;break e}}else if(H.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===P&&ar(Re)===H.type){u(K,H.sibling),ue=y(H,X.props),co(ue,X),ue.return=K,K=ue;break e}u(K,H);break}else a(K,H);H=H.sibling}X.type===S?(ue=tr(X.props.children,K.mode,ue,X.key),ue.return=K,K=ue):(ue=Pl(X.type,X.key,X.props,null,K.mode,ue),co(ue,X),ue.return=K,K=ue)}return w(K);case v:e:{for(Re=X.key;H!==null;){if(H.key===Re)if(H.tag===4&&H.stateNode.containerInfo===X.containerInfo&&H.stateNode.implementation===X.implementation){u(K,H.sibling),ue=y(H,X.children||[]),ue.return=K,K=ue;break e}else{u(K,H);break}else a(K,H);H=H.sibling}ue=ef(X,K.mode,ue),ue.return=K,K=ue}return w(K);case P:return X=ar(X),rt(K,H,X,ue)}if(re(X))return Ee(K,H,X,ue);if(V(X)){if(Re=V(X),typeof Re!="function")throw Error(n(150));return X=Re.call(X),Le(K,H,X,ue)}if(typeof X.then=="function")return rt(K,H,Hl(X),ue);if(X.$$typeof===_)return rt(K,H,Bl(K,X),ue);zl(K,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,H!==null&&H.tag===6?(u(K,H.sibling),ue=y(H,X),ue.return=K,K=ue):(u(K,H),ue=Jd(X,K.mode,ue),ue.return=K,K=ue),w(K)):u(K,H)}return function(K,H,X,ue){try{lo=0;var Re=rt(K,H,X,ue);return Wr=null,Re}catch(Te){if(Te===Yr||Te===jl)throw Te;var Xe=En(29,Te,null,K.mode);return Xe.lanes=ue,Xe.return=K,Xe}finally{}}}var lr=Q0(!0),Z0=Q0(!1),pi=!1;function hf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mf(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function yi(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function vi(i,a,u){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Ze&2)!==0){var y=h.pending;return y===null?a.next=a:(a.next=y.next,y.next=a),h.pending=a,a=Ml(i),M0(i,null,u),a}return kl(i,h,a,u),Ml(i)}function uo(i,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var h=a.lanes;h&=i.pendingLanes,u|=h,a.lanes=u,Hp(i,u)}}function gf(i,a){var u=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var y=null,x=null;if(u=u.firstBaseUpdate,u!==null){do{var w={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};x===null?y=x=w:x=x.next=w,u=u.next}while(u!==null);x===null?y=x=a:x=x.next=a}else y=x=a;u={baseState:h.baseState,firstBaseUpdate:y,lastBaseUpdate:x,shared:h.shared,callbacks:h.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=a:i.next=a,u.lastBaseUpdate=a}var pf=!1;function fo(){if(pf){var i=qr;if(i!==null)throw i}}function ho(i,a,u,h){pf=!1;var y=i.updateQueue;pi=!1;var x=y.firstBaseUpdate,w=y.lastBaseUpdate,O=y.shared.pending;if(O!==null){y.shared.pending=null;var $=O,Q=$.next;$.next=null,w===null?x=Q:w.next=Q,w=$;var ae=i.alternate;ae!==null&&(ae=ae.updateQueue,O=ae.lastBaseUpdate,O!==w&&(O===null?ae.firstBaseUpdate=Q:O.next=Q,ae.lastBaseUpdate=$))}if(x!==null){var de=y.baseState;w=0,ae=Q=$=null,O=x;do{var J=O.lane&-536870913,se=J!==O.lane;if(se?(Ke&J)===J:(h&J)===J){J!==0&&J===Kr&&(pf=!0),ae!==null&&(ae=ae.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Ee=i,Le=O;J=a;var rt=u;switch(Le.tag){case 1:if(Ee=Le.payload,typeof Ee=="function"){de=Ee.call(rt,de,J);break e}de=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Le.payload,J=typeof Ee=="function"?Ee.call(rt,de,J):Ee,J==null)break e;de=g({},de,J);break e;case 2:pi=!0}}J=O.callback,J!==null&&(i.flags|=64,se&&(i.flags|=8192),se=y.callbacks,se===null?y.callbacks=[J]:se.push(J))}else se={lane:J,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ae===null?(Q=ae=se,$=de):ae=ae.next=se,w|=J;if(O=O.next,O===null){if(O=y.shared.pending,O===null)break;se=O,O=se.next,se.next=null,y.lastBaseUpdate=se,y.shared.pending=null}}while(!0);ae===null&&($=de),y.baseState=$,y.firstBaseUpdate=Q,y.lastBaseUpdate=ae,x===null&&(y.shared.lanes=0),Ti|=w,i.lanes=w,i.memoizedState=de}}function J0(i,a){if(typeof i!="function")throw Error(n(191,i));i.call(a)}function ey(i,a){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)J0(u[i],a)}var Xr=k(null),Vl=k(0);function ty(i,a){i=Ys,te(Vl,i),te(Xr,a),Ys=i|a.baseLanes}function yf(){te(Vl,Ys),te(Xr,Xr.current)}function vf(){Ys=Vl.current,G(Xr),G(Vl)}var Sn=k(null),Hn=null;function xi(i){var a=i.alternate;te(Rt,Rt.current&1),te(Sn,i),Hn===null&&(a===null||Xr.current!==null||a.memoizedState!==null)&&(Hn=i)}function xf(i){te(Rt,Rt.current),te(Sn,i),Hn===null&&(Hn=i)}function ny(i){i.tag===22?(te(Rt,Rt.current),te(Sn,i),Hn===null&&(Hn=i)):Ei()}function Ei(){te(Rt,Rt.current),te(Sn,Sn.current)}function bn(i){G(Sn),Hn===i&&(Hn=null),G(Rt)}var Rt=k(0);function Kl(i){for(var a=i;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||Rh(u)||wh(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var $s=0,Me=null,st=null,Ot=null,ql=!1,Qr=!1,cr=!1,Yl=0,mo=0,Zr=null,qL=0;function Et(){throw Error(n(321))}function Ef(i,a){if(a===null)return!1;for(var u=0;u<a.length&&u<i.length;u++)if(!xn(i[u],a[u]))return!1;return!0}function Sf(i,a,u,h,y,x){return $s=x,Me=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,F.H=i===null||i.memoizedState===null?By:Pf,cr=!1,x=u(h,y),cr=!1,Qr&&(x=iy(a,u,h,y)),sy(i),x}function sy(i){F.H=yo;var a=st!==null&&st.next!==null;if($s=0,Ot=st=Me=null,ql=!1,mo=0,Zr=null,a)throw Error(n(300));i===null||Nt||(i=i.dependencies,i!==null&&Ul(i)&&(Nt=!0))}function iy(i,a,u,h){Me=i;var y=0;do{if(Qr&&(Zr=null),mo=0,Qr=!1,25<=y)throw Error(n(301));if(y+=1,Ot=st=null,i.updateQueue!=null){var x=i.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}F.H=$y,x=a(u,h)}while(Qr);return x}function YL(){var i=F.H,a=i.useState()[0];return a=typeof a.then=="function"?go(a):a,i=i.useState()[0],(st!==null?st.memoizedState:null)!==i&&(Me.flags|=1024),a}function bf(){var i=Yl!==0;return Yl=0,i}function Tf(i,a,u){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~u}function Af(i){if(ql){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}ql=!1}$s=0,Ot=st=Me=null,Qr=!1,mo=Yl=0,Zr=null}function sn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?Me.memoizedState=Ot=i:Ot=Ot.next=i,Ot}function wt(){if(st===null){var i=Me.alternate;i=i!==null?i.memoizedState:null}else i=st.next;var a=Ot===null?Me.memoizedState:Ot.next;if(a!==null)Ot=a,st=i;else{if(i===null)throw Me.alternate===null?Error(n(467)):Error(n(310));st=i,i={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},Ot===null?Me.memoizedState=Ot=i:Ot=Ot.next=i}return Ot}function Wl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function go(i){var a=mo;return mo+=1,Zr===null&&(Zr=[]),i=Y0(Zr,i,a),a=Me,(Ot===null?a.memoizedState:Ot.next)===null&&(a=a.alternate,F.H=a===null||a.memoizedState===null?By:Pf),i}function Xl(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return go(i);if(i.$$typeof===_)return qt(i)}throw Error(n(438,String(i)))}function Rf(i){var a=null,u=Me.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var h=Me.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(a={data:h.data.map(function(y){return y.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=Wl(),Me.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(i),h=0;h<i;h++)u[h]=U;return a.index++,u}function js(i,a){return typeof a=="function"?a(i):a}function Ql(i){var a=wt();return wf(a,st,i)}function wf(i,a,u){var h=i.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=u;var y=i.baseQueue,x=h.pending;if(x!==null){if(y!==null){var w=y.next;y.next=x.next,x.next=w}a.baseQueue=y=x,h.pending=null}if(x=i.baseState,y===null)i.memoizedState=x;else{a=y.next;var O=w=null,$=null,Q=a,ae=!1;do{var de=Q.lane&-536870913;if(de!==Q.lane?(Ke&de)===de:($s&de)===de){var J=Q.revertLane;if(J===0)$!==null&&($=$.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),de===Kr&&(ae=!0);else if(($s&J)===J){Q=Q.next,J===Kr&&(ae=!0);continue}else de={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},$===null?(O=$=de,w=x):$=$.next=de,Me.lanes|=J,Ti|=J;de=Q.action,cr&&u(x,de),x=Q.hasEagerState?Q.eagerState:u(x,de)}else J={lane:de,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},$===null?(O=$=J,w=x):$=$.next=J,Me.lanes|=de,Ti|=de;Q=Q.next}while(Q!==null&&Q!==a);if($===null?w=x:$.next=O,!xn(x,i.memoizedState)&&(Nt=!0,ae&&(u=qr,u!==null)))throw u;i.memoizedState=x,i.baseState=w,i.baseQueue=$,h.lastRenderedState=x}return y===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function Lf(i){var a=wt(),u=a.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=i;var h=u.dispatch,y=u.pending,x=a.memoizedState;if(y!==null){u.pending=null;var w=y=y.next;do x=i(x,w.action),w=w.next;while(w!==y);xn(x,a.memoizedState)||(Nt=!0),a.memoizedState=x,a.baseQueue===null&&(a.baseState=x),u.lastRenderedState=x}return[x,h]}function ry(i,a,u){var h=Me,y=wt(),x=We;if(x){if(u===void 0)throw Error(n(407));u=u()}else u=a();var w=!xn((st||y).memoizedState,u);if(w&&(y.memoizedState=u,Nt=!0),y=y.queue,Df(ly.bind(null,h,y,i),[i]),y.getSnapshot!==a||w||Ot!==null&&Ot.memoizedState.tag&1){if(h.flags|=2048,Jr(9,{destroy:void 0},oy.bind(null,h,y,u,a),null),lt===null)throw Error(n(349));x||($s&127)!==0||ay(h,a,u)}return u}function ay(i,a,u){i.flags|=16384,i={getSnapshot:a,value:u},a=Me.updateQueue,a===null?(a=Wl(),Me.updateQueue=a,a.stores=[i]):(u=a.stores,u===null?a.stores=[i]:u.push(i))}function oy(i,a,u,h){a.value=u,a.getSnapshot=h,cy(a)&&uy(i)}function ly(i,a,u){return u(function(){cy(a)&&uy(i)})}function cy(i){var a=i.getSnapshot;i=i.value;try{var u=a();return!xn(i,u)}catch{return!0}}function uy(i){var a=er(i,2);a!==null&&hn(a,i,2)}function Cf(i){var a=sn();if(typeof i=="function"){var u=i;if(i=u(),cr){Ce(!0);try{u()}finally{Ce(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:i},a}function dy(i,a,u,h){return i.baseState=u,wf(i,st,typeof h=="function"?h:js)}function WL(i,a,u,h,y){if(ec(i))throw Error(n(485));if(i=a.action,i!==null){var x={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){x.listeners.push(w)}};F.T!==null?u(!0):x.isTransition=!1,h(x),u=a.pending,u===null?(x.next=a.pending=x,fy(a,x)):(x.next=u.next,a.pending=u.next=x)}}function fy(i,a){var u=a.action,h=a.payload,y=i.state;if(a.isTransition){var x=F.T,w={};F.T=w;try{var O=u(y,h),$=F.S;$!==null&&$(w,O),hy(i,a,O)}catch(Q){_f(i,a,Q)}finally{x!==null&&w.types!==null&&(x.types=w.types),F.T=x}}else try{x=u(y,h),hy(i,a,x)}catch(Q){_f(i,a,Q)}}function hy(i,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){my(i,a,h)},function(h){return _f(i,a,h)}):my(i,a,u)}function my(i,a,u){a.status="fulfilled",a.value=u,gy(a),i.state=u,a=i.pending,a!==null&&(u=a.next,u===a?i.pending=null:(u=u.next,a.next=u,fy(i,u)))}function _f(i,a,u){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do a.status="rejected",a.reason=u,gy(a),a=a.next;while(a!==h)}i.action=null}function gy(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function py(i,a){return a}function yy(i,a){if(We){var u=lt.formState;if(u!==null){e:{var h=Me;if(We){if(gt){t:{for(var y=gt,x=Gn;y.nodeType!==8;){if(!x){y=null;break t}if(y=zn(y.nextSibling),y===null){y=null;break t}}x=y.data,y=x==="F!"||x==="F"?y:null}if(y){gt=zn(y.nextSibling),h=y.data==="F!";break e}}mi(h)}h=!1}h&&(a=u[0])}}return u=sn(),u.memoizedState=u.baseState=a,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:py,lastRenderedState:a},u.queue=h,u=Py.bind(null,Me,h),h.dispatch=u,h=Cf(!1),x=Mf.bind(null,Me,!1,h.queue),h=sn(),y={state:a,dispatch:null,action:i,pending:null},h.queue=y,u=WL.bind(null,Me,y,x,u),y.dispatch=u,h.memoizedState=i,[a,u,!1]}function vy(i){var a=wt();return xy(a,st,i)}function xy(i,a,u){if(a=wf(i,a,py)[0],i=Ql(js)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var h=go(a)}catch(w){throw w===Yr?jl:w}else h=a;a=wt();var y=a.queue,x=y.dispatch;return u!==a.memoizedState&&(Me.flags|=2048,Jr(9,{destroy:void 0},XL.bind(null,y,u),null)),[h,x,i]}function XL(i,a){i.action=a}function Ey(i){var a=wt(),u=st;if(u!==null)return xy(a,u,i);wt(),a=a.memoizedState,u=wt();var h=u.queue.dispatch;return u.memoizedState=i,[a,h,!1]}function Jr(i,a,u,h){return i={tag:i,create:u,deps:h,inst:a,next:null},a=Me.updateQueue,a===null&&(a=Wl(),Me.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=i.next=i:(h=u.next,u.next=i,i.next=h,a.lastEffect=i),i}function Sy(){return wt().memoizedState}function Zl(i,a,u,h){var y=sn();Me.flags|=i,y.memoizedState=Jr(1|a,{destroy:void 0},u,h===void 0?null:h)}function Jl(i,a,u,h){var y=wt();h=h===void 0?null:h;var x=y.memoizedState.inst;st!==null&&h!==null&&Ef(h,st.memoizedState.deps)?y.memoizedState=Jr(a,x,u,h):(Me.flags|=i,y.memoizedState=Jr(1|a,x,u,h))}function by(i,a){Zl(8390656,8,i,a)}function Df(i,a){Jl(2048,8,i,a)}function QL(i){Me.flags|=4;var a=Me.updateQueue;if(a===null)a=Wl(),Me.updateQueue=a,a.events=[i];else{var u=a.events;u===null?a.events=[i]:u.push(i)}}function Ty(i){var a=wt().memoizedState;return QL({ref:a,nextImpl:i}),function(){if((Ze&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function Ay(i,a){return Jl(4,2,i,a)}function Ry(i,a){return Jl(4,4,i,a)}function wy(i,a){if(typeof a=="function"){i=i();var u=a(i);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function Ly(i,a,u){u=u!=null?u.concat([i]):null,Jl(4,4,wy.bind(null,a,i),u)}function If(){}function Cy(i,a){var u=wt();a=a===void 0?null:a;var h=u.memoizedState;return a!==null&&Ef(a,h[1])?h[0]:(u.memoizedState=[i,a],i)}function _y(i,a){var u=wt();a=a===void 0?null:a;var h=u.memoizedState;if(a!==null&&Ef(a,h[1]))return h[0];if(h=i(),cr){Ce(!0);try{i()}finally{Ce(!1)}}return u.memoizedState=[h,a],h}function Of(i,a,u){return u===void 0||($s&1073741824)!==0&&(Ke&261930)===0?i.memoizedState=a:(i.memoizedState=u,i=Dv(),Me.lanes|=i,Ti|=i,u)}function Dy(i,a,u,h){return xn(u,a)?u:Xr.current!==null?(i=Of(i,u,h),xn(i,a)||(Nt=!0),i):($s&42)===0||($s&1073741824)!==0&&(Ke&261930)===0?(Nt=!0,i.memoizedState=u):(i=Dv(),Me.lanes|=i,Ti|=i,a)}function Iy(i,a,u,h,y){var x=z.p;z.p=x!==0&&8>x?x:8;var w=F.T,O={};F.T=O,Mf(i,!1,a,u);try{var $=y(),Q=F.S;if(Q!==null&&Q(O,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var ae=KL($,h);po(i,a,ae,Rn(i))}else po(i,a,h,Rn(i))}catch(de){po(i,a,{then:function(){},status:"rejected",reason:de},Rn())}finally{z.p=x,w!==null&&O.types!==null&&(w.types=O.types),F.T=w}}function ZL(){}function Nf(i,a,u,h){if(i.tag!==5)throw Error(n(476));var y=Oy(i).queue;Iy(i,y,a,j,u===null?ZL:function(){return Ny(i),u(h)})}function Oy(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:j},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:u},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function Ny(i){var a=Oy(i);a.next===null&&(a=i.alternate.memoizedState),po(i,a.next.queue,{},Rn())}function kf(){return qt(No)}function ky(){return wt().memoizedState}function My(){return wt().memoizedState}function JL(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var u=Rn();i=yi(u);var h=vi(a,i,u);h!==null&&(hn(h,a,u),uo(h,a,u)),a={cache:cf()},i.payload=a;return}a=a.return}}function eC(i,a,u){var h=Rn();u={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ec(i)?Fy(a,u):(u=Qd(i,a,u,h),u!==null&&(hn(u,i,h),Uy(u,a,h)))}function Py(i,a,u){var h=Rn();po(i,a,u,h)}function po(i,a,u,h){var y={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(ec(i))Fy(a,y);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=a.lastRenderedReducer,x!==null))try{var w=a.lastRenderedState,O=x(w,u);if(y.hasEagerState=!0,y.eagerState=O,xn(O,w))return kl(i,a,y,0),lt===null&&Nl(),!1}catch{}finally{}if(u=Qd(i,a,y,h),u!==null)return hn(u,i,h),Uy(u,a,h),!0}return!1}function Mf(i,a,u,h){if(h={lane:2,revertLane:hh(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},ec(i)){if(a)throw Error(n(479))}else a=Qd(i,u,h,2),a!==null&&hn(a,i,2)}function ec(i){var a=i.alternate;return i===Me||a!==null&&a===Me}function Fy(i,a){Qr=ql=!0;var u=i.pending;u===null?a.next=a:(a.next=u.next,u.next=a),i.pending=a}function Uy(i,a,u){if((u&4194048)!==0){var h=a.lanes;h&=i.pendingLanes,u|=h,a.lanes=u,Hp(i,u)}}var yo={readContext:qt,use:Xl,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useLayoutEffect:Et,useInsertionEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useSyncExternalStore:Et,useId:Et,useHostTransitionStatus:Et,useFormState:Et,useActionState:Et,useOptimistic:Et,useMemoCache:Et,useCacheRefresh:Et};yo.useEffectEvent=Et;var By={readContext:qt,use:Xl,useCallback:function(i,a){return sn().memoizedState=[i,a===void 0?null:a],i},useContext:qt,useEffect:by,useImperativeHandle:function(i,a,u){u=u!=null?u.concat([i]):null,Zl(4194308,4,wy.bind(null,a,i),u)},useLayoutEffect:function(i,a){return Zl(4194308,4,i,a)},useInsertionEffect:function(i,a){Zl(4,2,i,a)},useMemo:function(i,a){var u=sn();a=a===void 0?null:a;var h=i();if(cr){Ce(!0);try{i()}finally{Ce(!1)}}return u.memoizedState=[h,a],h},useReducer:function(i,a,u){var h=sn();if(u!==void 0){var y=u(a);if(cr){Ce(!0);try{u(a)}finally{Ce(!1)}}}else y=a;return h.memoizedState=h.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},h.queue=i,i=i.dispatch=eC.bind(null,Me,i),[h.memoizedState,i]},useRef:function(i){var a=sn();return i={current:i},a.memoizedState=i},useState:function(i){i=Cf(i);var a=i.queue,u=Py.bind(null,Me,a);return a.dispatch=u,[i.memoizedState,u]},useDebugValue:If,useDeferredValue:function(i,a){var u=sn();return Of(u,i,a)},useTransition:function(){var i=Cf(!1);return i=Iy.bind(null,Me,i.queue,!0,!1),sn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,u){var h=Me,y=sn();if(We){if(u===void 0)throw Error(n(407));u=u()}else{if(u=a(),lt===null)throw Error(n(349));(Ke&127)!==0||ay(h,a,u)}y.memoizedState=u;var x={value:u,getSnapshot:a};return y.queue=x,by(ly.bind(null,h,x,i),[i]),h.flags|=2048,Jr(9,{destroy:void 0},oy.bind(null,h,x,u,a),null),u},useId:function(){var i=sn(),a=lt.identifierPrefix;if(We){var u=us,h=cs;u=(h&~(1<<32-He(h)-1)).toString(32)+u,a="_"+a+"R_"+u,u=Yl++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=qL++,a="_"+a+"r_"+u.toString(32)+"_";return i.memoizedState=a},useHostTransitionStatus:kf,useFormState:yy,useActionState:yy,useOptimistic:function(i){var a=sn();a.memoizedState=a.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=Mf.bind(null,Me,!0,u),u.dispatch=a,[i,a]},useMemoCache:Rf,useCacheRefresh:function(){return sn().memoizedState=JL.bind(null,Me)},useEffectEvent:function(i){var a=sn(),u={impl:i};return a.memoizedState=u,function(){if((Ze&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},Pf={readContext:qt,use:Xl,useCallback:Cy,useContext:qt,useEffect:Df,useImperativeHandle:Ly,useInsertionEffect:Ay,useLayoutEffect:Ry,useMemo:_y,useReducer:Ql,useRef:Sy,useState:function(){return Ql(js)},useDebugValue:If,useDeferredValue:function(i,a){var u=wt();return Dy(u,st.memoizedState,i,a)},useTransition:function(){var i=Ql(js)[0],a=wt().memoizedState;return[typeof i=="boolean"?i:go(i),a]},useSyncExternalStore:ry,useId:ky,useHostTransitionStatus:kf,useFormState:vy,useActionState:vy,useOptimistic:function(i,a){var u=wt();return dy(u,st,i,a)},useMemoCache:Rf,useCacheRefresh:My};Pf.useEffectEvent=Ty;var $y={readContext:qt,use:Xl,useCallback:Cy,useContext:qt,useEffect:Df,useImperativeHandle:Ly,useInsertionEffect:Ay,useLayoutEffect:Ry,useMemo:_y,useReducer:Lf,useRef:Sy,useState:function(){return Lf(js)},useDebugValue:If,useDeferredValue:function(i,a){var u=wt();return st===null?Of(u,i,a):Dy(u,st.memoizedState,i,a)},useTransition:function(){var i=Lf(js)[0],a=wt().memoizedState;return[typeof i=="boolean"?i:go(i),a]},useSyncExternalStore:ry,useId:ky,useHostTransitionStatus:kf,useFormState:Ey,useActionState:Ey,useOptimistic:function(i,a){var u=wt();return st!==null?dy(u,st,i,a):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:Rf,useCacheRefresh:My};$y.useEffectEvent=Ty;function Ff(i,a,u,h){a=i.memoizedState,u=u(h,a),u=u==null?a:g({},a,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Uf={enqueueSetState:function(i,a,u){i=i._reactInternals;var h=Rn(),y=yi(h);y.payload=a,u!=null&&(y.callback=u),a=vi(i,y,h),a!==null&&(hn(a,i,h),uo(a,i,h))},enqueueReplaceState:function(i,a,u){i=i._reactInternals;var h=Rn(),y=yi(h);y.tag=1,y.payload=a,u!=null&&(y.callback=u),a=vi(i,y,h),a!==null&&(hn(a,i,h),uo(a,i,h))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var u=Rn(),h=yi(u);h.tag=2,a!=null&&(h.callback=a),a=vi(i,h,u),a!==null&&(hn(a,i,u),uo(a,i,u))}};function jy(i,a,u,h,y,x,w){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,x,w):a.prototype&&a.prototype.isPureReactComponent?!no(u,h)||!no(y,x):!0}function Gy(i,a,u,h){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,h),a.state!==i&&Uf.enqueueReplaceState(a,a.state,null)}function ur(i,a){var u=a;if("ref"in a){u={};for(var h in a)h!=="ref"&&(u[h]=a[h])}if(i=i.defaultProps){u===a&&(u=g({},u));for(var y in i)u[y]===void 0&&(u[y]=i[y])}return u}function Hy(i){Ol(i)}function zy(i){console.error(i)}function Vy(i){Ol(i)}function tc(i,a){try{var u=i.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(h){setTimeout(function(){throw h})}}function Ky(i,a,u){try{var h=i.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Bf(i,a,u){return u=yi(u),u.tag=3,u.payload={element:null},u.callback=function(){tc(i,a)},u}function qy(i){return i=yi(i),i.tag=3,i}function Yy(i,a,u,h){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var x=h.value;i.payload=function(){return y(x)},i.callback=function(){Ky(a,u,h)}}var w=u.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(i.callback=function(){Ky(a,u,h),typeof y!="function"&&(Ai===null?Ai=new Set([this]):Ai.add(this));var O=h.stack;this.componentDidCatch(h.value,{componentStack:O!==null?O:""})})}function tC(i,a,u,h,y){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(a=u.alternate,a!==null&&Vr(a,u,y,!0),u=Sn.current,u!==null){switch(u.tag){case 31:case 13:return Hn===null?hc():u.alternate===null&&St===0&&(St=3),u.flags&=-257,u.flags|=65536,u.lanes=y,h===Gl?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([h]):a.add(h),uh(i,h,y)),!1;case 22:return u.flags|=65536,h===Gl?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([h]):u.add(h)),uh(i,h,y)),!1}throw Error(n(435,u.tag))}return uh(i,h,y),hc(),!1}if(We)return a=Sn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=y,h!==sf&&(i=Error(n(422),{cause:h}),ro(Bn(i,u)))):(h!==sf&&(a=Error(n(423),{cause:h}),ro(Bn(a,u))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,h=Bn(h,u),y=Bf(i.stateNode,h,y),gf(i,y),St!==4&&(St=2)),!1;var x=Error(n(520),{cause:h});if(x=Bn(x,u),Ro===null?Ro=[x]:Ro.push(x),St!==4&&(St=2),a===null)return!0;h=Bn(h,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,i=y&-y,u.lanes|=i,i=Bf(u.stateNode,h,i),gf(u,i),!1;case 1:if(a=u.type,x=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ai===null||!Ai.has(x))))return u.flags|=65536,y&=-y,u.lanes|=y,y=qy(y),Yy(y,i,u,h),gf(u,y),!1}u=u.return}while(u!==null);return!1}var $f=Error(n(461)),Nt=!1;function Yt(i,a,u,h){a.child=i===null?Z0(a,null,u,h):lr(a,i.child,u,h)}function Wy(i,a,u,h,y){u=u.render;var x=a.ref;if("ref"in h){var w={};for(var O in h)O!=="ref"&&(w[O]=h[O])}else w=h;return ir(a),h=Sf(i,a,u,w,x,y),O=bf(),i!==null&&!Nt?(Tf(i,a,y),Gs(i,a,y)):(We&&O&&tf(a),a.flags|=1,Yt(i,a,h,y),a.child)}function Xy(i,a,u,h,y){if(i===null){var x=u.type;return typeof x=="function"&&!Zd(x)&&x.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=x,Qy(i,a,x,h,y)):(i=Pl(u.type,null,h,a,a.mode,y),i.ref=a.ref,i.return=a,a.child=i)}if(x=i.child,!Yf(i,y)){var w=x.memoizedProps;if(u=u.compare,u=u!==null?u:no,u(w,h)&&i.ref===a.ref)return Gs(i,a,y)}return a.flags|=1,i=Ps(x,h),i.ref=a.ref,i.return=a,a.child=i}function Qy(i,a,u,h,y){if(i!==null){var x=i.memoizedProps;if(no(x,h)&&i.ref===a.ref)if(Nt=!1,a.pendingProps=h=x,Yf(i,y))(i.flags&131072)!==0&&(Nt=!0);else return a.lanes=i.lanes,Gs(i,a,y)}return jf(i,a,u,h,y)}function Zy(i,a,u,h){var y=h.children,x=i!==null?i.memoizedState:null;if(i===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((a.flags&128)!==0){if(x=x!==null?x.baseLanes|u:u,i!==null){for(h=a.child=i.child,y=0;h!==null;)y=y|h.lanes|h.childLanes,h=h.sibling;h=y&~x}else h=0,a.child=null;return Jy(i,a,x,u,h)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&$l(a,x!==null?x.cachePool:null),x!==null?ty(a,x):yf(),ny(a);else return h=a.lanes=536870912,Jy(i,a,x!==null?x.baseLanes|u:u,u,h)}else x!==null?($l(a,x.cachePool),ty(a,x),Ei(),a.memoizedState=null):(i!==null&&$l(a,null),yf(),Ei());return Yt(i,a,y,u),a.child}function vo(i,a){return i!==null&&i.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Jy(i,a,u,h,y){var x=df();return x=x===null?null:{parent:It._currentValue,pool:x},a.memoizedState={baseLanes:u,cachePool:x},i!==null&&$l(a,null),yf(),ny(a),i!==null&&Vr(i,a,h,!0),a.childLanes=y,null}function nc(i,a){return a=ic({mode:a.mode,children:a.children},i.mode),a.ref=i.ref,i.child=a,a.return=i,a}function ev(i,a,u){return lr(a,i.child,null,u),i=nc(a,a.pendingProps),i.flags|=2,bn(a),a.memoizedState=null,i}function nC(i,a,u){var h=a.pendingProps,y=(a.flags&128)!==0;if(a.flags&=-129,i===null){if(We){if(h.mode==="hidden")return i=nc(a,h),a.lanes=536870912,vo(null,i);if(xf(a),(i=gt)?(i=fx(i,Gn),i=i!==null&&i.data==="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:fi!==null?{id:cs,overflow:us}:null,retryLane:536870912,hydrationErrors:null},u=F0(i),u.return=a,a.child=u,Kt=a,gt=null)):i=null,i===null)throw mi(a);return a.lanes=536870912,null}return nc(a,h)}var x=i.memoizedState;if(x!==null){var w=x.dehydrated;if(xf(a),y)if(a.flags&256)a.flags&=-257,a=ev(i,a,u);else if(a.memoizedState!==null)a.child=i.child,a.flags|=128,a=null;else throw Error(n(558));else if(Nt||Vr(i,a,u,!1),y=(u&i.childLanes)!==0,Nt||y){if(h=lt,h!==null&&(w=zp(h,u),w!==0&&w!==x.retryLane))throw x.retryLane=w,er(i,w),hn(h,i,w),$f;hc(),a=ev(i,a,u)}else i=x.treeContext,gt=zn(w.nextSibling),Kt=a,We=!0,hi=null,Gn=!1,i!==null&&$0(a,i),a=nc(a,h),a.flags|=4096;return a}return i=Ps(i.child,{mode:h.mode,children:h.children}),i.ref=a.ref,a.child=i,i.return=a,i}function sc(i,a){var u=a.ref;if(u===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(i===null||i.ref!==u)&&(a.flags|=4194816)}}function jf(i,a,u,h,y){return ir(a),u=Sf(i,a,u,h,void 0,y),h=bf(),i!==null&&!Nt?(Tf(i,a,y),Gs(i,a,y)):(We&&h&&tf(a),a.flags|=1,Yt(i,a,u,y),a.child)}function tv(i,a,u,h,y,x){return ir(a),a.updateQueue=null,u=iy(a,h,u,y),sy(i),h=bf(),i!==null&&!Nt?(Tf(i,a,x),Gs(i,a,x)):(We&&h&&tf(a),a.flags|=1,Yt(i,a,u,x),a.child)}function nv(i,a,u,h,y){if(ir(a),a.stateNode===null){var x=jr,w=u.contextType;typeof w=="object"&&w!==null&&(x=qt(w)),x=new u(h,x),a.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Uf,a.stateNode=x,x._reactInternals=a,x=a.stateNode,x.props=h,x.state=a.memoizedState,x.refs={},hf(a),w=u.contextType,x.context=typeof w=="object"&&w!==null?qt(w):jr,x.state=a.memoizedState,w=u.getDerivedStateFromProps,typeof w=="function"&&(Ff(a,u,w,h),x.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(w=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),w!==x.state&&Uf.enqueueReplaceState(x,x.state,null),ho(a,h,x,y),fo(),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308),h=!0}else if(i===null){x=a.stateNode;var O=a.memoizedProps,$=ur(u,O);x.props=$;var Q=x.context,ae=u.contextType;w=jr,typeof ae=="object"&&ae!==null&&(w=qt(ae));var de=u.getDerivedStateFromProps;ae=typeof de=="function"||typeof x.getSnapshotBeforeUpdate=="function",O=a.pendingProps!==O,ae||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(O||Q!==w)&&Gy(a,x,h,w),pi=!1;var J=a.memoizedState;x.state=J,ho(a,h,x,y),fo(),Q=a.memoizedState,O||J!==Q||pi?(typeof de=="function"&&(Ff(a,u,de,h),Q=a.memoizedState),($=pi||jy(a,u,$,h,J,Q,w))?(ae||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(a.flags|=4194308)):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=Q),x.props=h,x.state=Q,x.context=w,h=$):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{x=a.stateNode,mf(i,a),w=a.memoizedProps,ae=ur(u,w),x.props=ae,de=a.pendingProps,J=x.context,Q=u.contextType,$=jr,typeof Q=="object"&&Q!==null&&($=qt(Q)),O=u.getDerivedStateFromProps,(Q=typeof O=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(w!==de||J!==$)&&Gy(a,x,h,$),pi=!1,J=a.memoizedState,x.state=J,ho(a,h,x,y),fo();var se=a.memoizedState;w!==de||J!==se||pi||i!==null&&i.dependencies!==null&&Ul(i.dependencies)?(typeof O=="function"&&(Ff(a,u,O,h),se=a.memoizedState),(ae=pi||jy(a,u,ae,h,J,se,$)||i!==null&&i.dependencies!==null&&Ul(i.dependencies))?(Q||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,se,$),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,se,$)),typeof x.componentDidUpdate=="function"&&(a.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof x.componentDidUpdate!="function"||w===i.memoizedProps&&J===i.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&J===i.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=se),x.props=h,x.state=se,x.context=$,h=ae):(typeof x.componentDidUpdate!="function"||w===i.memoizedProps&&J===i.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&J===i.memoizedState||(a.flags|=1024),h=!1)}return x=h,sc(i,a),h=(a.flags&128)!==0,x||h?(x=a.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:x.render(),a.flags|=1,i!==null&&h?(a.child=lr(a,i.child,null,y),a.child=lr(a,null,u,y)):Yt(i,a,u,y),a.memoizedState=x.state,i=a.child):i=Gs(i,a,y),i}function sv(i,a,u,h){return nr(),a.flags|=256,Yt(i,a,u,h),a.child}var Gf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Hf(i){return{baseLanes:i,cachePool:K0()}}function zf(i,a,u){return i=i!==null?i.childLanes&~u:0,a&&(i|=An),i}function iv(i,a,u){var h=a.pendingProps,y=!1,x=(a.flags&128)!==0,w;if((w=x)||(w=i!==null&&i.memoizedState===null?!1:(Rt.current&2)!==0),w&&(y=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,i===null){if(We){if(y?xi(a):Ei(),(i=gt)?(i=fx(i,Gn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:fi!==null?{id:cs,overflow:us}:null,retryLane:536870912,hydrationErrors:null},u=F0(i),u.return=a,a.child=u,Kt=a,gt=null)):i=null,i===null)throw mi(a);return wh(i)?a.lanes=32:a.lanes=536870912,null}var O=h.children;return h=h.fallback,y?(Ei(),y=a.mode,O=ic({mode:"hidden",children:O},y),h=tr(h,y,u,null),O.return=a,h.return=a,O.sibling=h,a.child=O,h=a.child,h.memoizedState=Hf(u),h.childLanes=zf(i,w,u),a.memoizedState=Gf,vo(null,h)):(xi(a),Vf(a,O))}var $=i.memoizedState;if($!==null&&(O=$.dehydrated,O!==null)){if(x)a.flags&256?(xi(a),a.flags&=-257,a=Kf(i,a,u)):a.memoizedState!==null?(Ei(),a.child=i.child,a.flags|=128,a=null):(Ei(),O=h.fallback,y=a.mode,h=ic({mode:"visible",children:h.children},y),O=tr(O,y,u,null),O.flags|=2,h.return=a,O.return=a,h.sibling=O,a.child=h,lr(a,i.child,null,u),h=a.child,h.memoizedState=Hf(u),h.childLanes=zf(i,w,u),a.memoizedState=Gf,a=vo(null,h));else if(xi(a),wh(O)){if(w=O.nextSibling&&O.nextSibling.dataset,w)var Q=w.dgst;w=Q,h=Error(n(419)),h.stack="",h.digest=w,ro({value:h,source:null,stack:null}),a=Kf(i,a,u)}else if(Nt||Vr(i,a,u,!1),w=(u&i.childLanes)!==0,Nt||w){if(w=lt,w!==null&&(h=zp(w,u),h!==0&&h!==$.retryLane))throw $.retryLane=h,er(i,h),hn(w,i,h),$f;Rh(O)||hc(),a=Kf(i,a,u)}else Rh(O)?(a.flags|=192,a.child=i.child,a=null):(i=$.treeContext,gt=zn(O.nextSibling),Kt=a,We=!0,hi=null,Gn=!1,i!==null&&$0(a,i),a=Vf(a,h.children),a.flags|=4096);return a}return y?(Ei(),O=h.fallback,y=a.mode,$=i.child,Q=$.sibling,h=Ps($,{mode:"hidden",children:h.children}),h.subtreeFlags=$.subtreeFlags&65011712,Q!==null?O=Ps(Q,O):(O=tr(O,y,u,null),O.flags|=2),O.return=a,h.return=a,h.sibling=O,a.child=h,vo(null,h),h=a.child,O=i.child.memoizedState,O===null?O=Hf(u):(y=O.cachePool,y!==null?($=It._currentValue,y=y.parent!==$?{parent:$,pool:$}:y):y=K0(),O={baseLanes:O.baseLanes|u,cachePool:y}),h.memoizedState=O,h.childLanes=zf(i,w,u),a.memoizedState=Gf,vo(i.child,h)):(xi(a),u=i.child,i=u.sibling,u=Ps(u,{mode:"visible",children:h.children}),u.return=a,u.sibling=null,i!==null&&(w=a.deletions,w===null?(a.deletions=[i],a.flags|=16):w.push(i)),a.child=u,a.memoizedState=null,u)}function Vf(i,a){return a=ic({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function ic(i,a){return i=En(22,i,null,a),i.lanes=0,i}function Kf(i,a,u){return lr(a,i.child,null,u),i=Vf(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function rv(i,a,u){i.lanes|=a;var h=i.alternate;h!==null&&(h.lanes|=a),of(i.return,a,u)}function qf(i,a,u,h,y,x){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:y,treeForkCount:x}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=h,w.tail=u,w.tailMode=y,w.treeForkCount=x)}function av(i,a,u){var h=a.pendingProps,y=h.revealOrder,x=h.tail;h=h.children;var w=Rt.current,O=(w&2)!==0;if(O?(w=w&1|2,a.flags|=128):w&=1,te(Rt,w),Yt(i,a,h,u),h=We?io:0,!O&&i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&rv(i,u,a);else if(i.tag===19)rv(i,u,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(u=a.child,y=null;u!==null;)i=u.alternate,i!==null&&Kl(i)===null&&(y=u),u=u.sibling;u=y,u===null?(y=a.child,a.child=null):(y=u.sibling,u.sibling=null),qf(a,!1,y,u,x,h);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=a.child,a.child=null;y!==null;){if(i=y.alternate,i!==null&&Kl(i)===null){a.child=y;break}i=y.sibling,y.sibling=u,u=y,y=i}qf(a,!0,u,null,x,h);break;case"together":qf(a,!1,null,null,void 0,h);break;default:a.memoizedState=null}return a.child}function Gs(i,a,u){if(i!==null&&(a.dependencies=i.dependencies),Ti|=a.lanes,(u&a.childLanes)===0)if(i!==null){if(Vr(i,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(n(153));if(a.child!==null){for(i=a.child,u=Ps(i,i.pendingProps),a.child=u,u.return=a;i.sibling!==null;)i=i.sibling,u=u.sibling=Ps(i,i.pendingProps),u.return=a;u.sibling=null}return a.child}function Yf(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&Ul(i)))}function sC(i,a,u){switch(a.tag){case 3:Ne(a,a.stateNode.containerInfo),gi(a,It,i.memoizedState.cache),nr();break;case 27:case 5:dt(a);break;case 4:Ne(a,a.stateNode.containerInfo);break;case 10:gi(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,xf(a),null;break;case 13:var h=a.memoizedState;if(h!==null)return h.dehydrated!==null?(xi(a),a.flags|=128,null):(u&a.child.childLanes)!==0?iv(i,a,u):(xi(a),i=Gs(i,a,u),i!==null?i.sibling:null);xi(a);break;case 19:var y=(i.flags&128)!==0;if(h=(u&a.childLanes)!==0,h||(Vr(i,a,u,!1),h=(u&a.childLanes)!==0),y){if(h)return av(i,a,u);a.flags|=128}if(y=a.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),te(Rt,Rt.current),h)break;return null;case 22:return a.lanes=0,Zy(i,a,u,a.pendingProps);case 24:gi(a,It,i.memoizedState.cache)}return Gs(i,a,u)}function ov(i,a,u){if(i!==null)if(i.memoizedProps!==a.pendingProps)Nt=!0;else{if(!Yf(i,u)&&(a.flags&128)===0)return Nt=!1,sC(i,a,u);Nt=(i.flags&131072)!==0}else Nt=!1,We&&(a.flags&1048576)!==0&&B0(a,io,a.index);switch(a.lanes=0,a.tag){case 16:e:{var h=a.pendingProps;if(i=ar(a.elementType),a.type=i,typeof i=="function")Zd(i)?(h=ur(i,h),a.tag=1,a=nv(null,a,i,h,u)):(a.tag=0,a=jf(null,a,i,h,u));else{if(i!=null){var y=i.$$typeof;if(y===D){a.tag=11,a=Wy(null,a,i,h,u);break e}else if(y===I){a.tag=14,a=Xy(null,a,i,h,u);break e}}throw a=Z(i)||i,Error(n(306,a,""))}}return a;case 0:return jf(i,a,a.type,a.pendingProps,u);case 1:return h=a.type,y=ur(h,a.pendingProps),nv(i,a,h,y,u);case 3:e:{if(Ne(a,a.stateNode.containerInfo),i===null)throw Error(n(387));h=a.pendingProps;var x=a.memoizedState;y=x.element,mf(i,a),ho(a,h,null,u);var w=a.memoizedState;if(h=w.cache,gi(a,It,h),h!==x.cache&&lf(a,[It],u,!0),fo(),h=w.element,x.isDehydrated)if(x={element:h,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=x,a.memoizedState=x,a.flags&256){a=sv(i,a,h,u);break e}else if(h!==y){y=Bn(Error(n(424)),a),ro(y),a=sv(i,a,h,u);break e}else{switch(i=a.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(gt=zn(i.firstChild),Kt=a,We=!0,hi=null,Gn=!0,u=Z0(a,null,h,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(nr(),h===y){a=Gs(i,a,u);break e}Yt(i,a,h,u)}a=a.child}return a;case 26:return sc(i,a),i===null?(u=vx(a.type,null,a.pendingProps,null))?a.memoizedState=u:We||(u=a.type,i=a.pendingProps,h=Ec(pe.current).createElement(u),h[Vt]=a,h[on]=i,Wt(h,u,i),$t(h),a.stateNode=h):a.memoizedState=vx(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return dt(a),i===null&&We&&(h=a.stateNode=gx(a.type,a.pendingProps,pe.current),Kt=a,Gn=!0,y=gt,Ci(a.type)?(Lh=y,gt=zn(h.firstChild)):gt=y),Yt(i,a,a.pendingProps.children,u),sc(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&We&&((y=h=gt)&&(h=NC(h,a.type,a.pendingProps,Gn),h!==null?(a.stateNode=h,Kt=a,gt=zn(h.firstChild),Gn=!1,y=!0):y=!1),y||mi(a)),dt(a),y=a.type,x=a.pendingProps,w=i!==null?i.memoizedProps:null,h=x.children,bh(y,x)?h=null:w!==null&&bh(y,w)&&(a.flags|=32),a.memoizedState!==null&&(y=Sf(i,a,YL,null,null,u),No._currentValue=y),sc(i,a),Yt(i,a,h,u),a.child;case 6:return i===null&&We&&((i=u=gt)&&(u=kC(u,a.pendingProps,Gn),u!==null?(a.stateNode=u,Kt=a,gt=null,i=!0):i=!1),i||mi(a)),null;case 13:return iv(i,a,u);case 4:return Ne(a,a.stateNode.containerInfo),h=a.pendingProps,i===null?a.child=lr(a,null,h,u):Yt(i,a,h,u),a.child;case 11:return Wy(i,a,a.type,a.pendingProps,u);case 7:return Yt(i,a,a.pendingProps,u),a.child;case 8:return Yt(i,a,a.pendingProps.children,u),a.child;case 12:return Yt(i,a,a.pendingProps.children,u),a.child;case 10:return h=a.pendingProps,gi(a,a.type,h.value),Yt(i,a,h.children,u),a.child;case 9:return y=a.type._context,h=a.pendingProps.children,ir(a),y=qt(y),h=h(y),a.flags|=1,Yt(i,a,h,u),a.child;case 14:return Xy(i,a,a.type,a.pendingProps,u);case 15:return Qy(i,a,a.type,a.pendingProps,u);case 19:return av(i,a,u);case 31:return nC(i,a,u);case 22:return Zy(i,a,u,a.pendingProps);case 24:return ir(a),h=qt(It),i===null?(y=df(),y===null&&(y=lt,x=cf(),y.pooledCache=x,x.refCount++,x!==null&&(y.pooledCacheLanes|=u),y=x),a.memoizedState={parent:h,cache:y},hf(a),gi(a,It,y)):((i.lanes&u)!==0&&(mf(i,a),ho(a,null,null,u),fo()),y=i.memoizedState,x=a.memoizedState,y.parent!==h?(y={parent:h,cache:h},a.memoizedState=y,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=y),gi(a,It,h)):(h=x.cache,gi(a,It,h),h!==y.cache&&lf(a,[It],u,!0))),Yt(i,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Hs(i){i.flags|=4}function Wf(i,a,u,h,y){if((a=(i.mode&32)!==0)&&(a=!1),a){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(kv())i.flags|=8192;else throw or=Gl,ff}else i.flags&=-16777217}function lv(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Tx(a))if(kv())i.flags|=8192;else throw or=Gl,ff}function rc(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?jp():536870912,i.lanes|=a,sa|=a)}function xo(i,a){if(!We)switch(i.tailMode){case"hidden":a=i.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function pt(i){var a=i.alternate!==null&&i.alternate.child===i.child,u=0,h=0;if(a)for(var y=i.child;y!==null;)u|=y.lanes|y.childLanes,h|=y.subtreeFlags&65011712,h|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)u|=y.lanes|y.childLanes,h|=y.subtreeFlags,h|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=h,i.childLanes=u,a}function iC(i,a,u){var h=a.pendingProps;switch(nf(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(a),null;case 1:return pt(a),null;case 3:return u=a.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),Bs(It),De(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(zr(a)?Hs(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,rf())),pt(a),null;case 26:var y=a.type,x=a.memoizedState;return i===null?(Hs(a),x!==null?(pt(a),lv(a,x)):(pt(a),Wf(a,y,null,h,u))):x?x!==i.memoizedState?(Hs(a),pt(a),lv(a,x)):(pt(a),a.flags&=-16777217):(i=i.memoizedProps,i!==h&&Hs(a),pt(a),Wf(a,y,i,h,u)),null;case 27:if(ot(a),u=pe.current,y=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==h&&Hs(a);else{if(!h){if(a.stateNode===null)throw Error(n(166));return pt(a),null}i=le.current,zr(a)?j0(a):(i=gx(y,h,u),a.stateNode=i,Hs(a))}return pt(a),null;case 5:if(ot(a),y=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==h&&Hs(a);else{if(!h){if(a.stateNode===null)throw Error(n(166));return pt(a),null}if(x=le.current,zr(a))j0(a);else{var w=Ec(pe.current);switch(x){case 1:x=w.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:x=w.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":x=w.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":x=w.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":x=w.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof h.is=="string"?w.createElement("select",{is:h.is}):w.createElement("select"),h.multiple?x.multiple=!0:h.size&&(x.size=h.size);break;default:x=typeof h.is=="string"?w.createElement(y,{is:h.is}):w.createElement(y)}}x[Vt]=a,x[on]=h;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)x.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=x;e:switch(Wt(x,y,h),y){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Hs(a)}}return pt(a),Wf(a,a.type,i===null?null:i.memoizedProps,a.pendingProps,u),null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==h&&Hs(a);else{if(typeof h!="string"&&a.stateNode===null)throw Error(n(166));if(i=pe.current,zr(a)){if(i=a.stateNode,u=a.memoizedProps,h=null,y=Kt,y!==null)switch(y.tag){case 27:case 5:h=y.memoizedProps}i[Vt]=a,i=!!(i.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||ix(i.nodeValue,u)),i||mi(a,!0)}else i=Ec(i).createTextNode(h),i[Vt]=a,a.stateNode=i}return pt(a),null;case 31:if(u=a.memoizedState,i===null||i.memoizedState!==null){if(h=zr(a),u!==null){if(i===null){if(!h)throw Error(n(318));if(i=a.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[Vt]=a}else nr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;pt(a),i=!1}else u=rf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return a.flags&256?(bn(a),a):(bn(a),null);if((a.flags&128)!==0)throw Error(n(558))}return pt(a),null;case 13:if(h=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=zr(a),h!==null&&h.dehydrated!==null){if(i===null){if(!y)throw Error(n(318));if(y=a.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[Vt]=a}else nr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;pt(a),y=!1}else y=rf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return a.flags&256?(bn(a),a):(bn(a),null)}return bn(a),(a.flags&128)!==0?(a.lanes=u,a):(u=h!==null,i=i!==null&&i.memoizedState!==null,u&&(h=a.child,y=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(y=h.alternate.memoizedState.cachePool.pool),x=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==y&&(h.flags|=2048)),u!==i&&u&&(a.child.flags|=8192),rc(a,a.updateQueue),pt(a),null);case 4:return De(),i===null&&yh(a.stateNode.containerInfo),pt(a),null;case 10:return Bs(a.type),pt(a),null;case 19:if(G(Rt),h=a.memoizedState,h===null)return pt(a),null;if(y=(a.flags&128)!==0,x=h.rendering,x===null)if(y)xo(h,!1);else{if(St!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(x=Kl(i),x!==null){for(a.flags|=128,xo(h,!1),i=x.updateQueue,a.updateQueue=i,rc(a,i),a.subtreeFlags=0,i=u,u=a.child;u!==null;)P0(u,i),u=u.sibling;return te(Rt,Rt.current&1|2),We&&Fs(a,h.treeForkCount),a.child}i=i.sibling}h.tail!==null&&Dt()>uc&&(a.flags|=128,y=!0,xo(h,!1),a.lanes=4194304)}else{if(!y)if(i=Kl(x),i!==null){if(a.flags|=128,y=!0,i=i.updateQueue,a.updateQueue=i,rc(a,i),xo(h,!0),h.tail===null&&h.tailMode==="hidden"&&!x.alternate&&!We)return pt(a),null}else 2*Dt()-h.renderingStartTime>uc&&u!==536870912&&(a.flags|=128,y=!0,xo(h,!1),a.lanes=4194304);h.isBackwards?(x.sibling=a.child,a.child=x):(i=h.last,i!==null?i.sibling=x:a.child=x,h.last=x)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=Dt(),i.sibling=null,u=Rt.current,te(Rt,y?u&1|2:u&1),We&&Fs(a,h.treeForkCount),i):(pt(a),null);case 22:case 23:return bn(a),vf(),h=a.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(a.flags|=8192):h&&(a.flags|=8192),h?(u&536870912)!==0&&(a.flags&128)===0&&(pt(a),a.subtreeFlags&6&&(a.flags|=8192)):pt(a),u=a.updateQueue,u!==null&&rc(a,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==u&&(a.flags|=2048),i!==null&&G(rr),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Bs(It),pt(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function rC(i,a){switch(nf(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return Bs(It),De(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return ot(a),null;case 31:if(a.memoizedState!==null){if(bn(a),a.alternate===null)throw Error(n(340));nr()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 13:if(bn(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(n(340));nr()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return G(Rt),null;case 4:return De(),null;case 10:return Bs(a.type),null;case 22:case 23:return bn(a),vf(),i!==null&&G(rr),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return Bs(It),null;case 25:return null;default:return null}}function cv(i,a){switch(nf(a),a.tag){case 3:Bs(It),De();break;case 26:case 27:case 5:ot(a);break;case 4:De();break;case 31:a.memoizedState!==null&&bn(a);break;case 13:bn(a);break;case 19:G(Rt);break;case 10:Bs(a.type);break;case 22:case 23:bn(a),vf(),i!==null&&G(rr);break;case 24:Bs(It)}}function Eo(i,a){try{var u=a.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var y=h.next;u=y;do{if((u.tag&i)===i){h=void 0;var x=u.create,w=u.inst;h=x(),w.destroy=h}u=u.next}while(u!==y)}}catch(O){et(a,a.return,O)}}function Si(i,a,u){try{var h=a.updateQueue,y=h!==null?h.lastEffect:null;if(y!==null){var x=y.next;h=x;do{if((h.tag&i)===i){var w=h.inst,O=w.destroy;if(O!==void 0){w.destroy=void 0,y=a;var $=u,Q=O;try{Q()}catch(ae){et(y,$,ae)}}}h=h.next}while(h!==x)}}catch(ae){et(a,a.return,ae)}}function uv(i){var a=i.updateQueue;if(a!==null){var u=i.stateNode;try{ey(a,u)}catch(h){et(i,i.return,h)}}}function dv(i,a,u){u.props=ur(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(h){et(i,a,h)}}function So(i,a){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof u=="function"?i.refCleanup=u(h):u.current=h}}catch(y){et(i,a,y)}}function ds(i,a){var u=i.ref,h=i.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(y){et(i,a,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){et(i,a,y)}else u.current=null}function fv(i){var a=i.type,u=i.memoizedProps,h=i.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(y){et(i,i.return,y)}}function Xf(i,a,u){try{var h=i.stateNode;LC(h,i.type,u,a),h[on]=a}catch(y){et(i,i.return,y)}}function hv(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ci(i.type)||i.tag===4}function Qf(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||hv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ci(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Zf(i,a,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(i),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=ks));else if(h!==4&&(h===27&&Ci(i.type)&&(u=i.stateNode,a=null),i=i.child,i!==null))for(Zf(i,a,u),i=i.sibling;i!==null;)Zf(i,a,u),i=i.sibling}function ac(i,a,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,a?u.insertBefore(i,a):u.appendChild(i);else if(h!==4&&(h===27&&Ci(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(ac(i,a,u),i=i.sibling;i!==null;)ac(i,a,u),i=i.sibling}function mv(i){var a=i.stateNode,u=i.memoizedProps;try{for(var h=i.type,y=a.attributes;y.length;)a.removeAttributeNode(y[0]);Wt(a,h,u),a[Vt]=i,a[on]=u}catch(x){et(i,i.return,x)}}var zs=!1,kt=!1,Jf=!1,gv=typeof WeakSet=="function"?WeakSet:Set,jt=null;function aC(i,a){if(i=i.containerInfo,Eh=Lc,i=L0(i),Vd(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var y=h.anchorOffset,x=h.focusNode;h=h.focusOffset;try{u.nodeType,x.nodeType}catch{u=null;break e}var w=0,O=-1,$=-1,Q=0,ae=0,de=i,J=null;t:for(;;){for(var se;de!==u||y!==0&&de.nodeType!==3||(O=w+y),de!==x||h!==0&&de.nodeType!==3||($=w+h),de.nodeType===3&&(w+=de.nodeValue.length),(se=de.firstChild)!==null;)J=de,de=se;for(;;){if(de===i)break t;if(J===u&&++Q===y&&(O=w),J===x&&++ae===h&&($=w),(se=de.nextSibling)!==null)break;de=J,J=de.parentNode}de=se}u=O===-1||$===-1?null:{start:O,end:$}}else u=null}u=u||{start:0,end:0}}else u=null;for(Sh={focusedElem:i,selectionRange:u},Lc=!1,jt=a;jt!==null;)if(a=jt,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,jt=i;else for(;jt!==null;){switch(a=jt,x=a.alternate,i=a.flags,a.tag){case 0:if((i&4)!==0&&(i=a.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)y=i[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&x!==null){i=void 0,u=a,y=x.memoizedProps,x=x.memoizedState,h=u.stateNode;try{var Ee=ur(u.type,y);i=h.getSnapshotBeforeUpdate(Ee,x),h.__reactInternalSnapshotBeforeUpdate=i}catch(Le){et(u,u.return,Le)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,u=i.nodeType,u===9)Ah(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Ah(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=a.sibling,i!==null){i.return=a.return,jt=i;break}jt=a.return}}function pv(i,a,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:Ks(i,u),h&4&&Eo(5,u);break;case 1:if(Ks(i,u),h&4)if(i=u.stateNode,a===null)try{i.componentDidMount()}catch(w){et(u,u.return,w)}else{var y=ur(u.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(y,a,i.__reactInternalSnapshotBeforeUpdate)}catch(w){et(u,u.return,w)}}h&64&&uv(u),h&512&&So(u,u.return);break;case 3:if(Ks(i,u),h&64&&(i=u.updateQueue,i!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{ey(i,a)}catch(w){et(u,u.return,w)}}break;case 27:a===null&&h&4&&mv(u);case 26:case 5:Ks(i,u),a===null&&h&4&&fv(u),h&512&&So(u,u.return);break;case 12:Ks(i,u);break;case 31:Ks(i,u),h&4&&xv(i,u);break;case 13:Ks(i,u),h&4&&Ev(i,u),h&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=gC.bind(null,u),MC(i,u))));break;case 22:if(h=u.memoizedState!==null||zs,!h){a=a!==null&&a.memoizedState!==null||kt,y=zs;var x=kt;zs=h,(kt=a)&&!x?qs(i,u,(u.subtreeFlags&8772)!==0):Ks(i,u),zs=y,kt=x}break;case 30:break;default:Ks(i,u)}}function yv(i){var a=i.alternate;a!==null&&(i.alternate=null,yv(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&Cd(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var yt=null,cn=!1;function Vs(i,a,u){for(u=u.child;u!==null;)vv(i,a,u),u=u.sibling}function vv(i,a,u){if(ge&&typeof ge.onCommitFiberUnmount=="function")try{ge.onCommitFiberUnmount(me,u)}catch{}switch(u.tag){case 26:kt||ds(u,a),Vs(i,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:kt||ds(u,a);var h=yt,y=cn;Ci(u.type)&&(yt=u.stateNode,cn=!1),Vs(i,a,u),Do(u.stateNode),yt=h,cn=y;break;case 5:kt||ds(u,a);case 6:if(h=yt,y=cn,yt=null,Vs(i,a,u),yt=h,cn=y,yt!==null)if(cn)try{(yt.nodeType===9?yt.body:yt.nodeName==="HTML"?yt.ownerDocument.body:yt).removeChild(u.stateNode)}catch(x){et(u,a,x)}else try{yt.removeChild(u.stateNode)}catch(x){et(u,a,x)}break;case 18:yt!==null&&(cn?(i=yt,ux(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),da(i)):ux(yt,u.stateNode));break;case 4:h=yt,y=cn,yt=u.stateNode.containerInfo,cn=!0,Vs(i,a,u),yt=h,cn=y;break;case 0:case 11:case 14:case 15:Si(2,u,a),kt||Si(4,u,a),Vs(i,a,u);break;case 1:kt||(ds(u,a),h=u.stateNode,typeof h.componentWillUnmount=="function"&&dv(u,a,h)),Vs(i,a,u);break;case 21:Vs(i,a,u);break;case 22:kt=(h=kt)||u.memoizedState!==null,Vs(i,a,u),kt=h;break;default:Vs(i,a,u)}}function xv(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{da(i)}catch(u){et(a,a.return,u)}}}function Ev(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{da(i)}catch(u){et(a,a.return,u)}}function oC(i){switch(i.tag){case 31:case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new gv),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new gv),a;default:throw Error(n(435,i.tag))}}function oc(i,a){var u=oC(i);a.forEach(function(h){if(!u.has(h)){u.add(h);var y=pC.bind(null,i,h);h.then(y,y)}})}function un(i,a){var u=a.deletions;if(u!==null)for(var h=0;h<u.length;h++){var y=u[h],x=i,w=a,O=w;e:for(;O!==null;){switch(O.tag){case 27:if(Ci(O.type)){yt=O.stateNode,cn=!1;break e}break;case 5:yt=O.stateNode,cn=!1;break e;case 3:case 4:yt=O.stateNode.containerInfo,cn=!0;break e}O=O.return}if(yt===null)throw Error(n(160));vv(x,w,y),yt=null,cn=!1,x=y.alternate,x!==null&&(x.return=null),y.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Sv(a,i),a=a.sibling}var Zn=null;function Sv(i,a){var u=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:un(a,i),dn(i),h&4&&(Si(3,i,i.return),Eo(3,i),Si(5,i,i.return));break;case 1:un(a,i),dn(i),h&512&&(kt||u===null||ds(u,u.return)),h&64&&zs&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var y=Zn;if(un(a,i),dn(i),h&512&&(kt||u===null||ds(u,u.return)),h&4){var x=u!==null?u.memoizedState:null;if(h=i.memoizedState,u===null)if(h===null)if(i.stateNode===null){e:{h=i.type,u=i.memoizedProps,y=y.ownerDocument||y;t:switch(h){case"title":x=y.getElementsByTagName("title")[0],(!x||x[qa]||x[Vt]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=y.createElement(h),y.head.insertBefore(x,y.querySelector("head > title"))),Wt(x,h,u),x[Vt]=i,$t(x),h=x;break e;case"link":var w=Sx("link","href",y).get(h+(u.href||""));if(w){for(var O=0;O<w.length;O++)if(x=w[O],x.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&x.getAttribute("rel")===(u.rel==null?null:u.rel)&&x.getAttribute("title")===(u.title==null?null:u.title)&&x.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){w.splice(O,1);break t}}x=y.createElement(h),Wt(x,h,u),y.head.appendChild(x);break;case"meta":if(w=Sx("meta","content",y).get(h+(u.content||""))){for(O=0;O<w.length;O++)if(x=w[O],x.getAttribute("content")===(u.content==null?null:""+u.content)&&x.getAttribute("name")===(u.name==null?null:u.name)&&x.getAttribute("property")===(u.property==null?null:u.property)&&x.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&x.getAttribute("charset")===(u.charSet==null?null:u.charSet)){w.splice(O,1);break t}}x=y.createElement(h),Wt(x,h,u),y.head.appendChild(x);break;default:throw Error(n(468,h))}x[Vt]=i,$t(x),h=x}i.stateNode=h}else bx(y,i.type,i.stateNode);else i.stateNode=Ex(y,h,i.memoizedProps);else x!==h?(x===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):x.count--,h===null?bx(y,i.type,i.stateNode):Ex(y,h,i.memoizedProps)):h===null&&i.stateNode!==null&&Xf(i,i.memoizedProps,u.memoizedProps)}break;case 27:un(a,i),dn(i),h&512&&(kt||u===null||ds(u,u.return)),u!==null&&h&4&&Xf(i,i.memoizedProps,u.memoizedProps);break;case 5:if(un(a,i),dn(i),h&512&&(kt||u===null||ds(u,u.return)),i.flags&32){y=i.stateNode;try{kr(y,"")}catch(Ee){et(i,i.return,Ee)}}h&4&&i.stateNode!=null&&(y=i.memoizedProps,Xf(i,y,u!==null?u.memoizedProps:y)),h&1024&&(Jf=!0);break;case 6:if(un(a,i),dn(i),h&4){if(i.stateNode===null)throw Error(n(162));h=i.memoizedProps,u=i.stateNode;try{u.nodeValue=h}catch(Ee){et(i,i.return,Ee)}}break;case 3:if(Tc=null,y=Zn,Zn=Sc(a.containerInfo),un(a,i),Zn=y,dn(i),h&4&&u!==null&&u.memoizedState.isDehydrated)try{da(a.containerInfo)}catch(Ee){et(i,i.return,Ee)}Jf&&(Jf=!1,bv(i));break;case 4:h=Zn,Zn=Sc(i.stateNode.containerInfo),un(a,i),dn(i),Zn=h;break;case 12:un(a,i),dn(i);break;case 31:un(a,i),dn(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,oc(i,h)));break;case 13:un(a,i),dn(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(cc=Dt()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,oc(i,h)));break;case 22:y=i.memoizedState!==null;var $=u!==null&&u.memoizedState!==null,Q=zs,ae=kt;if(zs=Q||y,kt=ae||$,un(a,i),kt=ae,zs=Q,dn(i),h&8192)e:for(a=i.stateNode,a._visibility=y?a._visibility&-2:a._visibility|1,y&&(u===null||$||zs||kt||dr(i)),u=null,a=i;;){if(a.tag===5||a.tag===26){if(u===null){$=u=a;try{if(x=$.stateNode,y)w=x.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{O=$.stateNode;var de=$.memoizedProps.style,J=de!=null&&de.hasOwnProperty("display")?de.display:null;O.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(Ee){et($,$.return,Ee)}}}else if(a.tag===6){if(u===null){$=a;try{$.stateNode.nodeValue=y?"":$.memoizedProps}catch(Ee){et($,$.return,Ee)}}}else if(a.tag===18){if(u===null){$=a;try{var se=$.stateNode;y?dx(se,!0):dx($.stateNode,!1)}catch(Ee){et($,$.return,Ee)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}h&4&&(h=i.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,oc(i,u))));break;case 19:un(a,i),dn(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,oc(i,h)));break;case 30:break;case 21:break;default:un(a,i),dn(i)}}function dn(i){var a=i.flags;if(a&2){try{for(var u,h=i.return;h!==null;){if(hv(h)){u=h;break}h=h.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var y=u.stateNode,x=Qf(i);ac(i,x,y);break;case 5:var w=u.stateNode;u.flags&32&&(kr(w,""),u.flags&=-33);var O=Qf(i);ac(i,O,w);break;case 3:case 4:var $=u.stateNode.containerInfo,Q=Qf(i);Zf(i,Q,$);break;default:throw Error(n(161))}}catch(ae){et(i,i.return,ae)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function bv(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;bv(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function Ks(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)pv(i,a.alternate,a),a=a.sibling}function dr(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:Si(4,a,a.return),dr(a);break;case 1:ds(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&dv(a,a.return,u),dr(a);break;case 27:Do(a.stateNode);case 26:case 5:ds(a,a.return),dr(a);break;case 22:a.memoizedState===null&&dr(a);break;case 30:dr(a);break;default:dr(a)}i=i.sibling}}function qs(i,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var h=a.alternate,y=i,x=a,w=x.flags;switch(x.tag){case 0:case 11:case 15:qs(y,x,u),Eo(4,x);break;case 1:if(qs(y,x,u),h=x,y=h.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Q){et(h,h.return,Q)}if(h=x,y=h.updateQueue,y!==null){var O=h.stateNode;try{var $=y.shared.hiddenCallbacks;if($!==null)for(y.shared.hiddenCallbacks=null,y=0;y<$.length;y++)J0($[y],O)}catch(Q){et(h,h.return,Q)}}u&&w&64&&uv(x),So(x,x.return);break;case 27:mv(x);case 26:case 5:qs(y,x,u),u&&h===null&&w&4&&fv(x),So(x,x.return);break;case 12:qs(y,x,u);break;case 31:qs(y,x,u),u&&w&4&&xv(y,x);break;case 13:qs(y,x,u),u&&w&4&&Ev(y,x);break;case 22:x.memoizedState===null&&qs(y,x,u),So(x,x.return);break;case 30:break;default:qs(y,x,u)}a=a.sibling}}function eh(i,a){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&ao(u))}function th(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&ao(i))}function Jn(i,a,u,h){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Tv(i,a,u,h),a=a.sibling}function Tv(i,a,u,h){var y=a.flags;switch(a.tag){case 0:case 11:case 15:Jn(i,a,u,h),y&2048&&Eo(9,a);break;case 1:Jn(i,a,u,h);break;case 3:Jn(i,a,u,h),y&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&ao(i)));break;case 12:if(y&2048){Jn(i,a,u,h),i=a.stateNode;try{var x=a.memoizedProps,w=x.id,O=x.onPostCommit;typeof O=="function"&&O(w,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch($){et(a,a.return,$)}}else Jn(i,a,u,h);break;case 31:Jn(i,a,u,h);break;case 13:Jn(i,a,u,h);break;case 23:break;case 22:x=a.stateNode,w=a.alternate,a.memoizedState!==null?x._visibility&2?Jn(i,a,u,h):bo(i,a):x._visibility&2?Jn(i,a,u,h):(x._visibility|=2,ea(i,a,u,h,(a.subtreeFlags&10256)!==0||!1)),y&2048&&eh(w,a);break;case 24:Jn(i,a,u,h),y&2048&&th(a.alternate,a);break;default:Jn(i,a,u,h)}}function ea(i,a,u,h,y){for(y=y&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var x=i,w=a,O=u,$=h,Q=w.flags;switch(w.tag){case 0:case 11:case 15:ea(x,w,O,$,y),Eo(8,w);break;case 23:break;case 22:var ae=w.stateNode;w.memoizedState!==null?ae._visibility&2?ea(x,w,O,$,y):bo(x,w):(ae._visibility|=2,ea(x,w,O,$,y)),y&&Q&2048&&eh(w.alternate,w);break;case 24:ea(x,w,O,$,y),y&&Q&2048&&th(w.alternate,w);break;default:ea(x,w,O,$,y)}a=a.sibling}}function bo(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=i,h=a,y=h.flags;switch(h.tag){case 22:bo(u,h),y&2048&&eh(h.alternate,h);break;case 24:bo(u,h),y&2048&&th(h.alternate,h);break;default:bo(u,h)}a=a.sibling}}var To=8192;function ta(i,a,u){if(i.subtreeFlags&To)for(i=i.child;i!==null;)Av(i,a,u),i=i.sibling}function Av(i,a,u){switch(i.tag){case 26:ta(i,a,u),i.flags&To&&i.memoizedState!==null&&qC(u,Zn,i.memoizedState,i.memoizedProps);break;case 5:ta(i,a,u);break;case 3:case 4:var h=Zn;Zn=Sc(i.stateNode.containerInfo),ta(i,a,u),Zn=h;break;case 22:i.memoizedState===null&&(h=i.alternate,h!==null&&h.memoizedState!==null?(h=To,To=16777216,ta(i,a,u),To=h):ta(i,a,u));break;default:ta(i,a,u)}}function Rv(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function Ao(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var h=a[u];jt=h,Lv(h,i)}Rv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)wv(i),i=i.sibling}function wv(i){switch(i.tag){case 0:case 11:case 15:Ao(i),i.flags&2048&&Si(9,i,i.return);break;case 3:Ao(i);break;case 12:Ao(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,lc(i)):Ao(i);break;default:Ao(i)}}function lc(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var h=a[u];jt=h,Lv(h,i)}Rv(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:Si(8,a,a.return),lc(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,lc(a));break;default:lc(a)}i=i.sibling}}function Lv(i,a){for(;jt!==null;){var u=jt;switch(u.tag){case 0:case 11:case 15:Si(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:ao(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,jt=h;else e:for(u=i;jt!==null;){h=jt;var y=h.sibling,x=h.return;if(yv(h),h===u){jt=null;break e}if(y!==null){y.return=x,jt=y;break e}jt=x}}}var lC={getCacheForType:function(i){var a=qt(It),u=a.data.get(i);return u===void 0&&(u=i(),a.data.set(i,u)),u},cacheSignal:function(){return qt(It).controller.signal}},cC=typeof WeakMap=="function"?WeakMap:Map,Ze=0,lt=null,ze=null,Ke=0,Je=0,Tn=null,bi=!1,na=!1,nh=!1,Ys=0,St=0,Ti=0,fr=0,sh=0,An=0,sa=0,Ro=null,fn=null,ih=!1,cc=0,Cv=0,uc=1/0,dc=null,Ai=null,Mt=0,Ri=null,ia=null,Ws=0,rh=0,ah=null,_v=null,wo=0,oh=null;function Rn(){return(Ze&2)!==0&&Ke!==0?Ke&-Ke:F.T!==null?hh():Vp()}function Dv(){if(An===0)if((Ke&536870912)===0||We){var i=zt;zt<<=1,(zt&3932160)===0&&(zt=262144),An=i}else An=536870912;return i=Sn.current,i!==null&&(i.flags|=32),An}function hn(i,a,u){(i===lt&&(Je===2||Je===9)||i.cancelPendingCommit!==null)&&(ra(i,0),wi(i,Ke,An,!1)),Ka(i,u),((Ze&2)===0||i!==lt)&&(i===lt&&((Ze&2)===0&&(fr|=u),St===4&&wi(i,Ke,An,!1)),fs(i))}function Iv(i,a,u){if((Ze&6)!==0)throw Error(n(327));var h=!u&&(a&127)===0&&(a&i.expiredLanes)===0||Va(i,a),y=h?fC(i,a):ch(i,a,!0),x=h;do{if(y===0){na&&!h&&wi(i,a,0,!1);break}else{if(u=i.current.alternate,x&&!uC(u)){y=ch(i,a,!1),x=!1;continue}if(y===2){if(x=a,i.errorRecoveryDisabledLanes&x)var w=0;else w=i.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var O=i;y=Ro;var $=O.current.memoizedState.isDehydrated;if($&&(ra(O,w).flags|=256),w=ch(O,w,!1),w!==2){if(nh&&!$){O.errorRecoveryDisabledLanes|=x,fr|=x,y=4;break e}x=fn,fn=y,x!==null&&(fn===null?fn=x:fn.push.apply(fn,x))}y=w}if(x=!1,y!==2)continue}}if(y===1){ra(i,0),wi(i,a,0,!0);break}e:{switch(h=i,x=y,x){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:wi(h,a,An,!bi);break e;case 2:fn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(y=cc+300-Dt(),10<y)){if(wi(h,a,An,!bi),Sl(h,0,!0)!==0)break e;Ws=a,h.timeoutHandle=lx(Ov.bind(null,h,u,fn,dc,ih,a,An,fr,sa,bi,x,"Throttled",-0,0),y);break e}Ov(h,u,fn,dc,ih,a,An,fr,sa,bi,x,null,-0,0)}}break}while(!0);fs(i)}function Ov(i,a,u,h,y,x,w,O,$,Q,ae,de,J,se){if(i.timeoutHandle=-1,de=a.subtreeFlags,de&8192||(de&16785408)===16785408){de={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ks},Av(a,x,de);var Ee=(x&62914560)===x?cc-Dt():(x&4194048)===x?Cv-Dt():0;if(Ee=YC(de,Ee),Ee!==null){Ws=x,i.cancelPendingCommit=Ee($v.bind(null,i,a,x,u,h,y,w,O,$,ae,de,null,J,se)),wi(i,x,w,!Q);return}}$v(i,a,x,u,h,y,w,O,$)}function uC(i){for(var a=i;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var y=u[h],x=y.getSnapshot;y=y.value;try{if(!xn(x(),y))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function wi(i,a,u,h){a&=~sh,a&=~fr,i.suspendedLanes|=a,i.pingedLanes&=~a,h&&(i.warmLanes|=a),h=i.expirationTimes;for(var y=a;0<y;){var x=31-He(y),w=1<<x;h[x]=-1,y&=~w}u!==0&&Gp(i,u,a)}function fc(){return(Ze&6)===0?(Lo(0),!1):!0}function lh(){if(ze!==null){if(Je===0)var i=ze.return;else i=ze,Us=sr=null,Af(i),Wr=null,lo=0,i=ze;for(;i!==null;)cv(i.alternate,i),i=i.return;ze=null}}function ra(i,a){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,DC(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Ws=0,lh(),lt=i,ze=u=Ps(i.current,null),Ke=a,Je=0,Tn=null,bi=!1,na=Va(i,a),nh=!1,sa=An=sh=fr=Ti=St=0,fn=Ro=null,ih=!1,(a&8)!==0&&(a|=a&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=a;0<h;){var y=31-He(h),x=1<<y;a|=i[y],h&=~x}return Ys=a,Nl(),u}function Nv(i,a){Me=null,F.H=yo,a===Yr||a===jl?(a=W0(),Je=3):a===ff?(a=W0(),Je=4):Je=a===$f?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Tn=a,ze===null&&(St=1,tc(i,Bn(a,i.current)))}function kv(){var i=Sn.current;return i===null?!0:(Ke&4194048)===Ke?Hn===null:(Ke&62914560)===Ke||(Ke&536870912)!==0?i===Hn:!1}function Mv(){var i=F.H;return F.H=yo,i===null?yo:i}function Pv(){var i=F.A;return F.A=lC,i}function hc(){St=4,bi||(Ke&4194048)!==Ke&&Sn.current!==null||(na=!0),(Ti&134217727)===0&&(fr&134217727)===0||lt===null||wi(lt,Ke,An,!1)}function ch(i,a,u){var h=Ze;Ze|=2;var y=Mv(),x=Pv();(lt!==i||Ke!==a)&&(dc=null,ra(i,a)),a=!1;var w=St;e:do try{if(Je!==0&&ze!==null){var O=ze,$=Tn;switch(Je){case 8:lh(),w=6;break e;case 3:case 2:case 9:case 6:Sn.current===null&&(a=!0);var Q=Je;if(Je=0,Tn=null,aa(i,O,$,Q),u&&na){w=0;break e}break;default:Q=Je,Je=0,Tn=null,aa(i,O,$,Q)}}dC(),w=St;break}catch(ae){Nv(i,ae)}while(!0);return a&&i.shellSuspendCounter++,Us=sr=null,Ze=h,F.H=y,F.A=x,ze===null&&(lt=null,Ke=0,Nl()),w}function dC(){for(;ze!==null;)Fv(ze)}function fC(i,a){var u=Ze;Ze|=2;var h=Mv(),y=Pv();lt!==i||Ke!==a?(dc=null,uc=Dt()+500,ra(i,a)):na=Va(i,a);e:do try{if(Je!==0&&ze!==null){a=ze;var x=Tn;t:switch(Je){case 1:Je=0,Tn=null,aa(i,a,x,1);break;case 2:case 9:if(q0(x)){Je=0,Tn=null,Uv(a);break}a=function(){Je!==2&&Je!==9||lt!==i||(Je=7),fs(i)},x.then(a,a);break e;case 3:Je=7;break e;case 4:Je=5;break e;case 7:q0(x)?(Je=0,Tn=null,Uv(a)):(Je=0,Tn=null,aa(i,a,x,7));break;case 5:var w=null;switch(ze.tag){case 26:w=ze.memoizedState;case 5:case 27:var O=ze;if(w?Tx(w):O.stateNode.complete){Je=0,Tn=null;var $=O.sibling;if($!==null)ze=$;else{var Q=O.return;Q!==null?(ze=Q,mc(Q)):ze=null}break t}}Je=0,Tn=null,aa(i,a,x,5);break;case 6:Je=0,Tn=null,aa(i,a,x,6);break;case 8:lh(),St=6;break e;default:throw Error(n(462))}}hC();break}catch(ae){Nv(i,ae)}while(!0);return Us=sr=null,F.H=h,F.A=y,Ze=u,ze!==null?0:(lt=null,Ke=0,Nl(),St)}function hC(){for(;ze!==null&&!Xn();)Fv(ze)}function Fv(i){var a=ov(i.alternate,i,Ys);i.memoizedProps=i.pendingProps,a===null?mc(i):ze=a}function Uv(i){var a=i,u=a.alternate;switch(a.tag){case 15:case 0:a=tv(u,a,a.pendingProps,a.type,void 0,Ke);break;case 11:a=tv(u,a,a.pendingProps,a.type.render,a.ref,Ke);break;case 5:Af(a);default:cv(u,a),a=ze=P0(a,Ys),a=ov(u,a,Ys)}i.memoizedProps=i.pendingProps,a===null?mc(i):ze=a}function aa(i,a,u,h){Us=sr=null,Af(a),Wr=null,lo=0;var y=a.return;try{if(tC(i,y,a,u,Ke)){St=1,tc(i,Bn(u,i.current)),ze=null;return}}catch(x){if(y!==null)throw ze=y,x;St=1,tc(i,Bn(u,i.current)),ze=null;return}a.flags&32768?(We||h===1?i=!0:na||(Ke&536870912)!==0?i=!1:(bi=i=!0,(h===2||h===9||h===3||h===6)&&(h=Sn.current,h!==null&&h.tag===13&&(h.flags|=16384))),Bv(a,i)):mc(a)}function mc(i){var a=i;do{if((a.flags&32768)!==0){Bv(a,bi);return}i=a.return;var u=iC(a.alternate,a,Ys);if(u!==null){ze=u;return}if(a=a.sibling,a!==null){ze=a;return}ze=a=i}while(a!==null);St===0&&(St=5)}function Bv(i,a){do{var u=rC(i.alternate,i);if(u!==null){u.flags&=32767,ze=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(i=i.sibling,i!==null)){ze=i;return}ze=i=u}while(i!==null);St=6,ze=null}function $v(i,a,u,h,y,x,w,O,$){i.cancelPendingCommit=null;do gc();while(Mt!==0);if((Ze&6)!==0)throw Error(n(327));if(a!==null){if(a===i.current)throw Error(n(177));if(x=a.lanes|a.childLanes,x|=Xd,Kw(i,u,x,w,O,$),i===lt&&(ze=lt=null,Ke=0),ia=a,Ri=i,Ws=u,rh=x,ah=y,_v=h,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,yC(Is,function(){return Vv(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||h){h=F.T,F.T=null,y=z.p,z.p=2,w=Ze,Ze|=4;try{aC(i,a,u)}finally{Ze=w,z.p=y,F.T=h}}Mt=1,jv(),Gv(),Hv()}}function jv(){if(Mt===1){Mt=0;var i=Ri,a=ia,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=F.T,F.T=null;var h=z.p;z.p=2;var y=Ze;Ze|=4;try{Sv(a,i);var x=Sh,w=L0(i.containerInfo),O=x.focusedElem,$=x.selectionRange;if(w!==O&&O&&O.ownerDocument&&w0(O.ownerDocument.documentElement,O)){if($!==null&&Vd(O)){var Q=$.start,ae=$.end;if(ae===void 0&&(ae=Q),"selectionStart"in O)O.selectionStart=Q,O.selectionEnd=Math.min(ae,O.value.length);else{var de=O.ownerDocument||document,J=de&&de.defaultView||window;if(J.getSelection){var se=J.getSelection(),Ee=O.textContent.length,Le=Math.min($.start,Ee),rt=$.end===void 0?Le:Math.min($.end,Ee);!se.extend&&Le>rt&&(w=rt,rt=Le,Le=w);var K=R0(O,Le),H=R0(O,rt);if(K&&H&&(se.rangeCount!==1||se.anchorNode!==K.node||se.anchorOffset!==K.offset||se.focusNode!==H.node||se.focusOffset!==H.offset)){var X=de.createRange();X.setStart(K.node,K.offset),se.removeAllRanges(),Le>rt?(se.addRange(X),se.extend(H.node,H.offset)):(X.setEnd(H.node,H.offset),se.addRange(X))}}}}for(de=[],se=O;se=se.parentNode;)se.nodeType===1&&de.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<de.length;O++){var ue=de[O];ue.element.scrollLeft=ue.left,ue.element.scrollTop=ue.top}}Lc=!!Eh,Sh=Eh=null}finally{Ze=y,z.p=h,F.T=u}}i.current=a,Mt=2}}function Gv(){if(Mt===2){Mt=0;var i=Ri,a=ia,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=F.T,F.T=null;var h=z.p;z.p=2;var y=Ze;Ze|=4;try{pv(i,a.alternate,a)}finally{Ze=y,z.p=h,F.T=u}}Mt=3}}function Hv(){if(Mt===4||Mt===3){Mt=0,wr();var i=Ri,a=ia,u=Ws,h=_v;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Mt=5:(Mt=0,ia=Ri=null,zv(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(Ai=null),wd(u),a=a.stateNode,ge&&typeof ge.onCommitFiberRoot=="function")try{ge.onCommitFiberRoot(me,a,void 0,(a.current.flags&128)===128)}catch{}if(h!==null){a=F.T,y=z.p,z.p=2,F.T=null;try{for(var x=i.onRecoverableError,w=0;w<h.length;w++){var O=h[w];x(O.value,{componentStack:O.stack})}}finally{F.T=a,z.p=y}}(Ws&3)!==0&&gc(),fs(i),y=i.pendingLanes,(u&261930)!==0&&(y&42)!==0?i===oh?wo++:(wo=0,oh=i):wo=0,Lo(0)}}function zv(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,ao(a)))}function gc(){return jv(),Gv(),Hv(),Vv()}function Vv(){if(Mt!==5)return!1;var i=Ri,a=rh;rh=0;var u=wd(Ws),h=F.T,y=z.p;try{z.p=32>u?32:u,F.T=null,u=ah,ah=null;var x=Ri,w=Ws;if(Mt=0,ia=Ri=null,Ws=0,(Ze&6)!==0)throw Error(n(331));var O=Ze;if(Ze|=4,wv(x.current),Tv(x,x.current,w,u),Ze=O,Lo(0,!1),ge&&typeof ge.onPostCommitFiberRoot=="function")try{ge.onPostCommitFiberRoot(me,x)}catch{}return!0}finally{z.p=y,F.T=h,zv(i,a)}}function Kv(i,a,u){a=Bn(u,a),a=Bf(i.stateNode,a,2),i=vi(i,a,2),i!==null&&(Ka(i,2),fs(i))}function et(i,a,u){if(i.tag===3)Kv(i,i,u);else for(;a!==null;){if(a.tag===3){Kv(a,i,u);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ai===null||!Ai.has(h))){i=Bn(u,i),u=qy(2),h=vi(a,u,2),h!==null&&(Yy(u,h,a,i),Ka(h,2),fs(h));break}}a=a.return}}function uh(i,a,u){var h=i.pingCache;if(h===null){h=i.pingCache=new cC;var y=new Set;h.set(a,y)}else y=h.get(a),y===void 0&&(y=new Set,h.set(a,y));y.has(u)||(nh=!0,y.add(u),i=mC.bind(null,i,a,u),a.then(i,i))}function mC(i,a,u){var h=i.pingCache;h!==null&&h.delete(a),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,lt===i&&(Ke&u)===u&&(St===4||St===3&&(Ke&62914560)===Ke&&300>Dt()-cc?(Ze&2)===0&&ra(i,0):sh|=u,sa===Ke&&(sa=0)),fs(i)}function qv(i,a){a===0&&(a=jp()),i=er(i,a),i!==null&&(Ka(i,a),fs(i))}function gC(i){var a=i.memoizedState,u=0;a!==null&&(u=a.retryLane),qv(i,u)}function pC(i,a){var u=0;switch(i.tag){case 31:case 13:var h=i.stateNode,y=i.memoizedState;y!==null&&(u=y.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(a),qv(i,u)}function yC(i,a){return Ht(i,a)}var pc=null,oa=null,dh=!1,yc=!1,fh=!1,Li=0;function fs(i){i!==oa&&i.next===null&&(oa===null?pc=oa=i:oa=oa.next=i),yc=!0,dh||(dh=!0,xC())}function Lo(i,a){if(!fh&&yc){fh=!0;do for(var u=!1,h=pc;h!==null;){if(i!==0){var y=h.pendingLanes;if(y===0)var x=0;else{var w=h.suspendedLanes,O=h.pingedLanes;x=(1<<31-He(42|i)+1)-1,x&=y&~(w&~O),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(u=!0,Qv(h,x))}else x=Ke,x=Sl(h,h===lt?x:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(x&3)===0||Va(h,x)||(u=!0,Qv(h,x));h=h.next}while(u);fh=!1}}function vC(){Yv()}function Yv(){yc=dh=!1;var i=0;Li!==0&&_C()&&(i=Li);for(var a=Dt(),u=null,h=pc;h!==null;){var y=h.next,x=Wv(h,a);x===0?(h.next=null,u===null?pc=y:u.next=y,y===null&&(oa=u)):(u=h,(i!==0||(x&3)!==0)&&(yc=!0)),h=y}Mt!==0&&Mt!==5||Lo(i),Li!==0&&(Li=0)}function Wv(i,a){for(var u=i.suspendedLanes,h=i.pingedLanes,y=i.expirationTimes,x=i.pendingLanes&-62914561;0<x;){var w=31-He(x),O=1<<w,$=y[w];$===-1?((O&u)===0||(O&h)!==0)&&(y[w]=Vw(O,a)):$<=a&&(i.expiredLanes|=O),x&=~O}if(a=lt,u=Ke,u=Sl(i,i===a?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,u===0||i===a&&(Je===2||Je===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&Mn(h),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||Va(i,u)){if(a=u&-u,a===i.callbackPriority)return a;switch(h!==null&&Mn(h),wd(u)){case 2:case 8:u=ai;break;case 32:u=Is;break;case 268435456:u=li;break;default:u=Is}return h=Xv.bind(null,i),u=Ht(u,h),i.callbackPriority=a,i.callbackNode=u,a}return h!==null&&h!==null&&Mn(h),i.callbackPriority=2,i.callbackNode=null,2}function Xv(i,a){if(Mt!==0&&Mt!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(gc()&&i.callbackNode!==u)return null;var h=Ke;return h=Sl(i,i===lt?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(Iv(i,h,a),Wv(i,Dt()),i.callbackNode!=null&&i.callbackNode===u?Xv.bind(null,i):null)}function Qv(i,a){if(gc())return null;Iv(i,a,!0)}function xC(){IC(function(){(Ze&6)!==0?Ht(ls,vC):Yv()})}function hh(){if(Li===0){var i=Kr;i===0&&(i=qi,qi<<=1,(qi&261888)===0&&(qi=256)),Li=i}return Li}function Zv(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Rl(""+i)}function Jv(i,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,i.id&&u.setAttribute("form",i.id),a.parentNode.insertBefore(u,a),i=new FormData(i),u.parentNode.removeChild(u),i}function EC(i,a,u,h,y){if(a==="submit"&&u&&u.stateNode===y){var x=Zv((y[on]||null).action),w=h.submitter;w&&(a=(a=w[on]||null)?Zv(a.formAction):w.getAttribute("formAction"),a!==null&&(x=a,w=null));var O=new _l("action","action",null,h,y);i.push({event:O,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Li!==0){var $=w?Jv(y,w):new FormData(y);Nf(u,{pending:!0,data:$,method:y.method,action:x},null,$)}}else typeof x=="function"&&(O.preventDefault(),$=w?Jv(y,w):new FormData(y),Nf(u,{pending:!0,data:$,method:y.method,action:x},x,$))},currentTarget:y}]})}}for(var mh=0;mh<Wd.length;mh++){var gh=Wd[mh],SC=gh.toLowerCase(),bC=gh[0].toUpperCase()+gh.slice(1);Qn(SC,"on"+bC)}Qn(D0,"onAnimationEnd"),Qn(I0,"onAnimationIteration"),Qn(O0,"onAnimationStart"),Qn("dblclick","onDoubleClick"),Qn("focusin","onFocus"),Qn("focusout","onBlur"),Qn(UL,"onTransitionRun"),Qn(BL,"onTransitionStart"),Qn($L,"onTransitionCancel"),Qn(N0,"onTransitionEnd"),Or("onMouseEnter",["mouseout","mouseover"]),Or("onMouseLeave",["mouseout","mouseover"]),Or("onPointerEnter",["pointerout","pointerover"]),Or("onPointerLeave",["pointerout","pointerover"]),Xi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Co));function ex(i,a){a=(a&4)!==0;for(var u=0;u<i.length;u++){var h=i[u],y=h.event;h=h.listeners;e:{var x=void 0;if(a)for(var w=h.length-1;0<=w;w--){var O=h[w],$=O.instance,Q=O.currentTarget;if(O=O.listener,$!==x&&y.isPropagationStopped())break e;x=O,y.currentTarget=Q;try{x(y)}catch(ae){Ol(ae)}y.currentTarget=null,x=$}else for(w=0;w<h.length;w++){if(O=h[w],$=O.instance,Q=O.currentTarget,O=O.listener,$!==x&&y.isPropagationStopped())break e;x=O,y.currentTarget=Q;try{x(y)}catch(ae){Ol(ae)}y.currentTarget=null,x=$}}}}function Ve(i,a){var u=a[Ld];u===void 0&&(u=a[Ld]=new Set);var h=i+"__bubble";u.has(h)||(tx(a,i,2,!1),u.add(h))}function ph(i,a,u){var h=0;a&&(h|=4),tx(u,i,h,a)}var vc="_reactListening"+Math.random().toString(36).slice(2);function yh(i){if(!i[vc]){i[vc]=!0,Yp.forEach(function(u){u!=="selectionchange"&&(TC.has(u)||ph(u,!1,i),ph(u,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[vc]||(a[vc]=!0,ph("selectionchange",!1,a))}}function tx(i,a,u,h){switch(Dx(a)){case 2:var y=QC;break;case 8:y=ZC;break;default:y=Oh}u=y.bind(null,a,u,i),y=void 0,!Pd||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(y=!0),h?y!==void 0?i.addEventListener(a,u,{capture:!0,passive:y}):i.addEventListener(a,u,!0):y!==void 0?i.addEventListener(a,u,{passive:y}):i.addEventListener(a,u,!1)}function vh(i,a,u,h,y){var x=h;if((a&1)===0&&(a&2)===0&&h!==null)e:for(;;){if(h===null)return;var w=h.tag;if(w===3||w===4){var O=h.stateNode.containerInfo;if(O===y)break;if(w===4)for(w=h.return;w!==null;){var $=w.tag;if(($===3||$===4)&&w.stateNode.containerInfo===y)return;w=w.return}for(;O!==null;){if(w=_r(O),w===null)return;if($=w.tag,$===5||$===6||$===26||$===27){h=x=w;continue e}O=O.parentNode}}h=h.return}a0(function(){var Q=x,ae=kd(u),de=[];e:{var J=k0.get(i);if(J!==void 0){var se=_l,Ee=i;switch(i){case"keypress":if(Ll(u)===0)break e;case"keydown":case"keyup":se=pL;break;case"focusin":Ee="focus",se=$d;break;case"focusout":Ee="blur",se=$d;break;case"beforeblur":case"afterblur":se=$d;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=c0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=iL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=xL;break;case D0:case I0:case O0:se=oL;break;case N0:se=SL;break;case"scroll":case"scrollend":se=nL;break;case"wheel":se=TL;break;case"copy":case"cut":case"paste":se=cL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=d0;break;case"toggle":case"beforetoggle":se=RL}var Le=(a&4)!==0,rt=!Le&&(i==="scroll"||i==="scrollend"),K=Le?J!==null?J+"Capture":null:J;Le=[];for(var H=Q,X;H!==null;){var ue=H;if(X=ue.stateNode,ue=ue.tag,ue!==5&&ue!==26&&ue!==27||X===null||K===null||(ue=Wa(H,K),ue!=null&&Le.push(_o(H,ue,X))),rt)break;H=H.return}0<Le.length&&(J=new se(J,Ee,null,u,ae),de.push({event:J,listeners:Le}))}}if((a&7)===0){e:{if(J=i==="mouseover"||i==="pointerover",se=i==="mouseout"||i==="pointerout",J&&u!==Nd&&(Ee=u.relatedTarget||u.fromElement)&&(_r(Ee)||Ee[Cr]))break e;if((se||J)&&(J=ae.window===ae?ae:(J=ae.ownerDocument)?J.defaultView||J.parentWindow:window,se?(Ee=u.relatedTarget||u.toElement,se=Q,Ee=Ee?_r(Ee):null,Ee!==null&&(rt=o(Ee),Le=Ee.tag,Ee!==rt||Le!==5&&Le!==27&&Le!==6)&&(Ee=null)):(se=null,Ee=Q),se!==Ee)){if(Le=c0,ue="onMouseLeave",K="onMouseEnter",H="mouse",(i==="pointerout"||i==="pointerover")&&(Le=d0,ue="onPointerLeave",K="onPointerEnter",H="pointer"),rt=se==null?J:Ya(se),X=Ee==null?J:Ya(Ee),J=new Le(ue,H+"leave",se,u,ae),J.target=rt,J.relatedTarget=X,ue=null,_r(ae)===Q&&(Le=new Le(K,H+"enter",Ee,u,ae),Le.target=X,Le.relatedTarget=rt,ue=Le),rt=ue,se&&Ee)t:{for(Le=AC,K=se,H=Ee,X=0,ue=K;ue;ue=Le(ue))X++;ue=0;for(var Re=H;Re;Re=Le(Re))ue++;for(;0<X-ue;)K=Le(K),X--;for(;0<ue-X;)H=Le(H),ue--;for(;X--;){if(K===H||H!==null&&K===H.alternate){Le=K;break t}K=Le(K),H=Le(H)}Le=null}else Le=null;se!==null&&nx(de,J,se,Le,!1),Ee!==null&&rt!==null&&nx(de,rt,Ee,Le,!0)}}e:{if(J=Q?Ya(Q):window,se=J.nodeName&&J.nodeName.toLowerCase(),se==="select"||se==="input"&&J.type==="file")var Xe=x0;else if(y0(J))if(E0)Xe=ML;else{Xe=NL;var Te=OL}else se=J.nodeName,!se||se.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?Q&&Od(Q.elementType)&&(Xe=x0):Xe=kL;if(Xe&&(Xe=Xe(i,Q))){v0(de,Xe,u,ae);break e}Te&&Te(i,J,Q),i==="focusout"&&Q&&J.type==="number"&&Q.memoizedProps.value!=null&&Id(J,"number",J.value)}switch(Te=Q?Ya(Q):window,i){case"focusin":(y0(Te)||Te.contentEditable==="true")&&(Ur=Te,Kd=Q,so=null);break;case"focusout":so=Kd=Ur=null;break;case"mousedown":qd=!0;break;case"contextmenu":case"mouseup":case"dragend":qd=!1,C0(de,u,ae);break;case"selectionchange":if(FL)break;case"keydown":case"keyup":C0(de,u,ae)}var Fe;if(Gd)e:{switch(i){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else Fr?g0(i,u)&&(qe="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(qe="onCompositionStart");qe&&(f0&&u.locale!=="ko"&&(Fr||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&Fr&&(Fe=o0()):(di=ae,Fd="value"in di?di.value:di.textContent,Fr=!0)),Te=xc(Q,qe),0<Te.length&&(qe=new u0(qe,i,null,u,ae),de.push({event:qe,listeners:Te}),Fe?qe.data=Fe:(Fe=p0(u),Fe!==null&&(qe.data=Fe)))),(Fe=LL?CL(i,u):_L(i,u))&&(qe=xc(Q,"onBeforeInput"),0<qe.length&&(Te=new u0("onBeforeInput","beforeinput",null,u,ae),de.push({event:Te,listeners:qe}),Te.data=Fe)),EC(de,i,Q,u,ae)}ex(de,a)})}function _o(i,a,u){return{instance:i,listener:a,currentTarget:u}}function xc(i,a){for(var u=a+"Capture",h=[];i!==null;){var y=i,x=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||x===null||(y=Wa(i,u),y!=null&&h.unshift(_o(i,y,x)),y=Wa(i,a),y!=null&&h.push(_o(i,y,x))),i.tag===3)return h;i=i.return}return[]}function AC(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function nx(i,a,u,h,y){for(var x=a._reactName,w=[];u!==null&&u!==h;){var O=u,$=O.alternate,Q=O.stateNode;if(O=O.tag,$!==null&&$===h)break;O!==5&&O!==26&&O!==27||Q===null||($=Q,y?(Q=Wa(u,x),Q!=null&&w.unshift(_o(u,Q,$))):y||(Q=Wa(u,x),Q!=null&&w.push(_o(u,Q,$)))),u=u.return}w.length!==0&&i.push({event:a,listeners:w})}var RC=/\r\n?/g,wC=/\u0000|\uFFFD/g;function sx(i){return(typeof i=="string"?i:""+i).replace(RC,`
`).replace(wC,"")}function ix(i,a){return a=sx(a),sx(i)===a}function it(i,a,u,h,y,x){switch(u){case"children":typeof h=="string"?a==="body"||a==="textarea"&&h===""||kr(i,h):(typeof h=="number"||typeof h=="bigint")&&a!=="body"&&kr(i,""+h);break;case"className":Tl(i,"class",h);break;case"tabIndex":Tl(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Tl(i,u,h);break;case"style":i0(i,h,x);break;case"data":if(a!=="object"){Tl(i,"data",h);break}case"src":case"href":if(h===""&&(a!=="a"||u!=="href")){i.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(u);break}h=Rl(""+h),i.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(u==="formAction"?(a!=="input"&&it(i,a,"name",y.name,y,null),it(i,a,"formEncType",y.formEncType,y,null),it(i,a,"formMethod",y.formMethod,y,null),it(i,a,"formTarget",y.formTarget,y,null)):(it(i,a,"encType",y.encType,y,null),it(i,a,"method",y.method,y,null),it(i,a,"target",y.target,y,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(u);break}h=Rl(""+h),i.setAttribute(u,h);break;case"onClick":h!=null&&(i.onclick=ks);break;case"onScroll":h!=null&&Ve("scroll",i);break;case"onScrollEnd":h!=null&&Ve("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(u=h.__html,u!=null){if(y.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}u=Rl(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(u,""+h):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":h===!0?i.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(u,h):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(u,h):i.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(u):i.setAttribute(u,h);break;case"popover":Ve("beforetoggle",i),Ve("toggle",i),bl(i,"popover",h);break;case"xlinkActuate":Ns(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Ns(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Ns(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Ns(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Ns(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Ns(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Ns(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Ns(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Ns(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":bl(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=eL.get(u)||u,bl(i,u,h))}}function xh(i,a,u,h,y,x){switch(u){case"style":i0(i,h,x);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(u=h.__html,u!=null){if(y.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"children":typeof h=="string"?kr(i,h):(typeof h=="number"||typeof h=="bigint")&&kr(i,""+h);break;case"onScroll":h!=null&&Ve("scroll",i);break;case"onScrollEnd":h!=null&&Ve("scrollend",i);break;case"onClick":h!=null&&(i.onclick=ks);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wp.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),a=u.slice(2,y?u.length-7:void 0),x=i[on]||null,x=x!=null?x[u]:null,typeof x=="function"&&i.removeEventListener(a,x,y),typeof h=="function")){typeof x!="function"&&x!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(a,h,y);break e}u in i?i[u]=h:h===!0?i.setAttribute(u,""):bl(i,u,h)}}}function Wt(i,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ve("error",i),Ve("load",i);var h=!1,y=!1,x;for(x in u)if(u.hasOwnProperty(x)){var w=u[x];if(w!=null)switch(x){case"src":h=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:it(i,a,x,w,u,null)}}y&&it(i,a,"srcSet",u.srcSet,u,null),h&&it(i,a,"src",u.src,u,null);return;case"input":Ve("invalid",i);var O=x=w=y=null,$=null,Q=null;for(h in u)if(u.hasOwnProperty(h)){var ae=u[h];if(ae!=null)switch(h){case"name":y=ae;break;case"type":w=ae;break;case"checked":$=ae;break;case"defaultChecked":Q=ae;break;case"value":x=ae;break;case"defaultValue":O=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(n(137,a));break;default:it(i,a,h,ae,u,null)}}e0(i,x,O,$,Q,w,y,!1);return;case"select":Ve("invalid",i),h=w=x=null;for(y in u)if(u.hasOwnProperty(y)&&(O=u[y],O!=null))switch(y){case"value":x=O;break;case"defaultValue":w=O;break;case"multiple":h=O;default:it(i,a,y,O,u,null)}a=x,u=w,i.multiple=!!h,a!=null?Nr(i,!!h,a,!1):u!=null&&Nr(i,!!h,u,!0);return;case"textarea":Ve("invalid",i),x=y=h=null;for(w in u)if(u.hasOwnProperty(w)&&(O=u[w],O!=null))switch(w){case"value":h=O;break;case"defaultValue":y=O;break;case"children":x=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(n(91));break;default:it(i,a,w,O,u,null)}n0(i,h,y,x);return;case"option":for($ in u)if(u.hasOwnProperty($)&&(h=u[$],h!=null))switch($){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:it(i,a,$,h,u,null)}return;case"dialog":Ve("beforetoggle",i),Ve("toggle",i),Ve("cancel",i),Ve("close",i);break;case"iframe":case"object":Ve("load",i);break;case"video":case"audio":for(h=0;h<Co.length;h++)Ve(Co[h],i);break;case"image":Ve("error",i),Ve("load",i);break;case"details":Ve("toggle",i);break;case"embed":case"source":case"link":Ve("error",i),Ve("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in u)if(u.hasOwnProperty(Q)&&(h=u[Q],h!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:it(i,a,Q,h,u,null)}return;default:if(Od(a)){for(ae in u)u.hasOwnProperty(ae)&&(h=u[ae],h!==void 0&&xh(i,a,ae,h,u,void 0));return}}for(O in u)u.hasOwnProperty(O)&&(h=u[O],h!=null&&it(i,a,O,h,u,null))}function LC(i,a,u,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,x=null,w=null,O=null,$=null,Q=null,ae=null;for(se in u){var de=u[se];if(u.hasOwnProperty(se)&&de!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":$=de;default:h.hasOwnProperty(se)||it(i,a,se,null,h,de)}}for(var J in h){var se=h[J];if(de=u[J],h.hasOwnProperty(J)&&(se!=null||de!=null))switch(J){case"type":x=se;break;case"name":y=se;break;case"checked":Q=se;break;case"defaultChecked":ae=se;break;case"value":w=se;break;case"defaultValue":O=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(n(137,a));break;default:se!==de&&it(i,a,J,se,h,de)}}Dd(i,w,O,$,Q,ae,x,y);return;case"select":se=w=O=J=null;for(x in u)if($=u[x],u.hasOwnProperty(x)&&$!=null)switch(x){case"value":break;case"multiple":se=$;default:h.hasOwnProperty(x)||it(i,a,x,null,h,$)}for(y in h)if(x=h[y],$=u[y],h.hasOwnProperty(y)&&(x!=null||$!=null))switch(y){case"value":J=x;break;case"defaultValue":O=x;break;case"multiple":w=x;default:x!==$&&it(i,a,y,x,h,$)}a=O,u=w,h=se,J!=null?Nr(i,!!u,J,!1):!!h!=!!u&&(a!=null?Nr(i,!!u,a,!0):Nr(i,!!u,u?[]:"",!1));return;case"textarea":se=J=null;for(O in u)if(y=u[O],u.hasOwnProperty(O)&&y!=null&&!h.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:it(i,a,O,null,h,y)}for(w in h)if(y=h[w],x=u[w],h.hasOwnProperty(w)&&(y!=null||x!=null))switch(w){case"value":J=y;break;case"defaultValue":se=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==x&&it(i,a,w,y,h,x)}t0(i,J,se);return;case"option":for(var Ee in u)if(J=u[Ee],u.hasOwnProperty(Ee)&&J!=null&&!h.hasOwnProperty(Ee))switch(Ee){case"selected":i.selected=!1;break;default:it(i,a,Ee,null,h,J)}for($ in h)if(J=h[$],se=u[$],h.hasOwnProperty($)&&J!==se&&(J!=null||se!=null))switch($){case"selected":i.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:it(i,a,$,J,h,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Le in u)J=u[Le],u.hasOwnProperty(Le)&&J!=null&&!h.hasOwnProperty(Le)&&it(i,a,Le,null,h,J);for(Q in h)if(J=h[Q],se=u[Q],h.hasOwnProperty(Q)&&J!==se&&(J!=null||se!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(n(137,a));break;default:it(i,a,Q,J,h,se)}return;default:if(Od(a)){for(var rt in u)J=u[rt],u.hasOwnProperty(rt)&&J!==void 0&&!h.hasOwnProperty(rt)&&xh(i,a,rt,void 0,h,J);for(ae in h)J=h[ae],se=u[ae],!h.hasOwnProperty(ae)||J===se||J===void 0&&se===void 0||xh(i,a,ae,J,h,se);return}}for(var K in u)J=u[K],u.hasOwnProperty(K)&&J!=null&&!h.hasOwnProperty(K)&&it(i,a,K,null,h,J);for(de in h)J=h[de],se=u[de],!h.hasOwnProperty(de)||J===se||J==null&&se==null||it(i,a,de,J,h,se)}function rx(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function CC(){if(typeof performance.getEntriesByType=="function"){for(var i=0,a=0,u=performance.getEntriesByType("resource"),h=0;h<u.length;h++){var y=u[h],x=y.transferSize,w=y.initiatorType,O=y.duration;if(x&&O&&rx(w)){for(w=0,O=y.responseEnd,h+=1;h<u.length;h++){var $=u[h],Q=$.startTime;if(Q>O)break;var ae=$.transferSize,de=$.initiatorType;ae&&rx(de)&&($=$.responseEnd,w+=ae*($<O?1:(O-Q)/($-Q)))}if(--h,a+=8*(x+w)/(y.duration/1e3),i++,10<i)break}}if(0<i)return a/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Eh=null,Sh=null;function Ec(i){return i.nodeType===9?i:i.ownerDocument}function ax(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ox(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function bh(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Th=null;function _C(){var i=window.event;return i&&i.type==="popstate"?i===Th?!1:(Th=i,!0):(Th=null,!1)}var lx=typeof setTimeout=="function"?setTimeout:void 0,DC=typeof clearTimeout=="function"?clearTimeout:void 0,cx=typeof Promise=="function"?Promise:void 0,IC=typeof queueMicrotask=="function"?queueMicrotask:typeof cx<"u"?function(i){return cx.resolve(null).then(i).catch(OC)}:lx;function OC(i){setTimeout(function(){throw i})}function Ci(i){return i==="head"}function ux(i,a){var u=a,h=0;do{var y=u.nextSibling;if(i.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(h===0){i.removeChild(y),da(a);return}h--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")h++;else if(u==="html")Do(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,Do(u);for(var x=u.firstChild;x;){var w=x.nextSibling,O=x.nodeName;x[qa]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&x.rel.toLowerCase()==="stylesheet"||u.removeChild(x),x=w}}else u==="body"&&Do(i.ownerDocument.body);u=y}while(u);da(a)}function dx(i,a){var u=i;i=0;do{var h=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),h&&h.nodeType===8)if(u=h.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=h}while(u)}function Ah(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Ah(u),Cd(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function NC(i,a,u,h){for(;i.nodeType===1;){var y=u;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[qa])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(x=i.getAttribute("rel"),x==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(x!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(x=i.getAttribute("src"),(x!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&x&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var x=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===x)return i}else return i;if(i=zn(i.nextSibling),i===null)break}return null}function kC(i,a,u){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=zn(i.nextSibling),i===null))return null;return i}function fx(i,a){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=zn(i.nextSibling),i===null))return null;return i}function Rh(i){return i.data==="$?"||i.data==="$~"}function wh(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function MC(i,a){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=a;else if(i.data!=="$?"||u.readyState!=="loading")a();else{var h=function(){a(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function zn(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return i}var Lh=null;function hx(i){i=i.nextSibling;for(var a=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(a===0)return zn(i.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}i=i.nextSibling}return null}function mx(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return i;a--}else u!=="/$"&&u!=="/&"||a++}i=i.previousSibling}return null}function gx(i,a,u){switch(a=Ec(u),i){case"html":if(i=a.documentElement,!i)throw Error(n(452));return i;case"head":if(i=a.head,!i)throw Error(n(453));return i;case"body":if(i=a.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function Do(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);Cd(i)}var Vn=new Map,px=new Set;function Sc(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Xs=z.d;z.d={f:PC,r:FC,D:UC,C:BC,L:$C,m:jC,X:HC,S:GC,M:zC};function PC(){var i=Xs.f(),a=fc();return i||a}function FC(i){var a=Dr(i);a!==null&&a.tag===5&&a.type==="form"?Ny(a):Xs.r(i)}var la=typeof document>"u"?null:document;function yx(i,a,u){var h=la;if(h&&typeof a=="string"&&a){var y=Fn(a);y='link[rel="'+i+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),px.has(y)||(px.add(y),i={rel:i,crossOrigin:u,href:a},h.querySelector(y)===null&&(a=h.createElement("link"),Wt(a,"link",i),$t(a),h.head.appendChild(a)))}}function UC(i){Xs.D(i),yx("dns-prefetch",i,null)}function BC(i,a){Xs.C(i,a),yx("preconnect",i,a)}function $C(i,a,u){Xs.L(i,a,u);var h=la;if(h&&i&&a){var y='link[rel="preload"][as="'+Fn(a)+'"]';a==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+Fn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+Fn(u.imageSizes)+'"]')):y+='[href="'+Fn(i)+'"]';var x=y;switch(a){case"style":x=ca(i);break;case"script":x=ua(i)}Vn.has(x)||(i=g({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:i,as:a},u),Vn.set(x,i),h.querySelector(y)!==null||a==="style"&&h.querySelector(Io(x))||a==="script"&&h.querySelector(Oo(x))||(a=h.createElement("link"),Wt(a,"link",i),$t(a),h.head.appendChild(a)))}}function jC(i,a){Xs.m(i,a);var u=la;if(u&&i){var h=a&&typeof a.as=="string"?a.as:"script",y='link[rel="modulepreload"][as="'+Fn(h)+'"][href="'+Fn(i)+'"]',x=y;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=ua(i)}if(!Vn.has(x)&&(i=g({rel:"modulepreload",href:i},a),Vn.set(x,i),u.querySelector(y)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Oo(x)))return}h=u.createElement("link"),Wt(h,"link",i),$t(h),u.head.appendChild(h)}}}function GC(i,a,u){Xs.S(i,a,u);var h=la;if(h&&i){var y=Ir(h).hoistableStyles,x=ca(i);a=a||"default";var w=y.get(x);if(!w){var O={loading:0,preload:null};if(w=h.querySelector(Io(x)))O.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":a},u),(u=Vn.get(x))&&Ch(i,u);var $=w=h.createElement("link");$t($),Wt($,"link",i),$._p=new Promise(function(Q,ae){$.onload=Q,$.onerror=ae}),$.addEventListener("load",function(){O.loading|=1}),$.addEventListener("error",function(){O.loading|=2}),O.loading|=4,bc(w,a,h)}w={type:"stylesheet",instance:w,count:1,state:O},y.set(x,w)}}}function HC(i,a){Xs.X(i,a);var u=la;if(u&&i){var h=Ir(u).hoistableScripts,y=ua(i),x=h.get(y);x||(x=u.querySelector(Oo(y)),x||(i=g({src:i,async:!0},a),(a=Vn.get(y))&&_h(i,a),x=u.createElement("script"),$t(x),Wt(x,"link",i),u.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(y,x))}}function zC(i,a){Xs.M(i,a);var u=la;if(u&&i){var h=Ir(u).hoistableScripts,y=ua(i),x=h.get(y);x||(x=u.querySelector(Oo(y)),x||(i=g({src:i,async:!0,type:"module"},a),(a=Vn.get(y))&&_h(i,a),x=u.createElement("script"),$t(x),Wt(x,"link",i),u.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(y,x))}}function vx(i,a,u,h){var y=(y=pe.current)?Sc(y):null;if(!y)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=ca(u.href),u=Ir(y).hoistableStyles,h=u.get(a),h||(h={type:"style",instance:null,count:0,state:null},u.set(a,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=ca(u.href);var x=Ir(y).hoistableStyles,w=x.get(i);if(w||(y=y.ownerDocument||y,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(i,w),(x=y.querySelector(Io(i)))&&!x._p&&(w.instance=x,w.state.loading=5),Vn.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Vn.set(i,u),x||VC(y,i,u,w.state))),a&&h===null)throw Error(n(528,""));return w}if(a&&h!==null)throw Error(n(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=ua(u),u=Ir(y).hoistableScripts,h=u.get(a),h||(h={type:"script",instance:null,count:0,state:null},u.set(a,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function ca(i){return'href="'+Fn(i)+'"'}function Io(i){return'link[rel="stylesheet"]['+i+"]"}function xx(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function VC(i,a,u,h){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?h.loading=1:(a=i.createElement("link"),h.preload=a,a.addEventListener("load",function(){return h.loading|=1}),a.addEventListener("error",function(){return h.loading|=2}),Wt(a,"link",u),$t(a),i.head.appendChild(a))}function ua(i){return'[src="'+Fn(i)+'"]'}function Oo(i){return"script[async]"+i}function Ex(i,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var h=i.querySelector('style[data-href~="'+Fn(u.href)+'"]');if(h)return a.instance=h,$t(h),h;var y=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),$t(h),Wt(h,"style",y),bc(h,u.precedence,i),a.instance=h;case"stylesheet":y=ca(u.href);var x=i.querySelector(Io(y));if(x)return a.state.loading|=4,a.instance=x,$t(x),x;h=xx(u),(y=Vn.get(y))&&Ch(h,y),x=(i.ownerDocument||i).createElement("link"),$t(x);var w=x;return w._p=new Promise(function(O,$){w.onload=O,w.onerror=$}),Wt(x,"link",h),a.state.loading|=4,bc(x,u.precedence,i),a.instance=x;case"script":return x=ua(u.src),(y=i.querySelector(Oo(x)))?(a.instance=y,$t(y),y):(h=u,(y=Vn.get(x))&&(h=g({},u),_h(h,y)),i=i.ownerDocument||i,y=i.createElement("script"),$t(y),Wt(y,"link",h),i.head.appendChild(y),a.instance=y);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(h=a.instance,a.state.loading|=4,bc(h,u.precedence,i));return a.instance}function bc(i,a,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=h.length?h[h.length-1]:null,x=y,w=0;w<h.length;w++){var O=h[w];if(O.dataset.precedence===a)x=O;else if(x!==y)break}x?x.parentNode.insertBefore(i,x.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(i,a.firstChild))}function Ch(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function _h(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var Tc=null;function Sx(i,a,u){if(Tc===null){var h=new Map,y=Tc=new Map;y.set(u,h)}else y=Tc,h=y.get(u),h||(h=new Map,y.set(u,h));if(h.has(i))return h;for(h.set(i,null),u=u.getElementsByTagName(i),y=0;y<u.length;y++){var x=u[y];if(!(x[qa]||x[Vt]||i==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var w=x.getAttribute(a)||"";w=i+w;var O=h.get(w);O?O.push(x):h.set(w,[x])}}return h}function bx(i,a,u){i=i.ownerDocument||i,i.head.insertBefore(u,a==="title"?i.querySelector("head > title"):null)}function KC(i,a,u){if(u===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return i=a.disabled,typeof a.precedence=="string"&&i==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Tx(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function qC(i,a,u,h){if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=ca(h.href),x=a.querySelector(Io(y));if(x){a=x._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(i.count++,i=Ac.bind(i),a.then(i,i)),u.state.loading|=4,u.instance=x,$t(x);return}x=a.ownerDocument||a,h=xx(h),(y=Vn.get(y))&&Ch(h,y),x=x.createElement("link"),$t(x);var w=x;w._p=new Promise(function(O,$){w.onload=O,w.onerror=$}),Wt(x,"link",h),u.instance=x}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=Ac.bind(i),a.addEventListener("load",u),a.addEventListener("error",u))}}var Dh=0;function YC(i,a){return i.stylesheets&&i.count===0&&wc(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var h=setTimeout(function(){if(i.stylesheets&&wc(i,i.stylesheets),i.unsuspend){var x=i.unsuspend;i.unsuspend=null,x()}},6e4+a);0<i.imgBytes&&Dh===0&&(Dh=62500*CC());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&wc(i,i.stylesheets),i.unsuspend)){var x=i.unsuspend;i.unsuspend=null,x()}},(i.imgBytes>Dh?50:800)+a);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(h),clearTimeout(y)}}:null}function Ac(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)wc(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Rc=null;function wc(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Rc=new Map,a.forEach(WC,i),Rc=null,Ac.call(i))}function WC(i,a){if(!(a.state.loading&4)){var u=Rc.get(i);if(u)var h=u.get(null);else{u=new Map,Rc.set(i,u);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<y.length;x++){var w=y[x];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(u.set(w.dataset.precedence,w),h=w)}h&&u.set(null,h)}y=a.instance,w=y.getAttribute("data-precedence"),x=u.get(w)||h,x===h&&u.set(null,y),u.set(w,y),this.count++,h=Ac.bind(this),y.addEventListener("load",h),y.addEventListener("error",h),x?x.parentNode.insertBefore(y,x.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),a.state.loading|=4}}var No={$$typeof:_,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function XC(i,a,u,h,y,x,w,O,$){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ad(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ad(0),this.hiddenUpdates=Ad(null),this.identifierPrefix=h,this.onUncaughtError=y,this.onCaughtError=x,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=$,this.incompleteTransitions=new Map}function Ax(i,a,u,h,y,x,w,O,$,Q,ae,de){return i=new XC(i,a,u,w,$,Q,ae,de,O),a=1,x===!0&&(a|=24),x=En(3,null,null,a),i.current=x,x.stateNode=i,a=cf(),a.refCount++,i.pooledCache=a,a.refCount++,x.memoizedState={element:h,isDehydrated:u,cache:a},hf(x),i}function Rx(i){return i?(i=jr,i):jr}function wx(i,a,u,h,y,x){y=Rx(y),h.context===null?h.context=y:h.pendingContext=y,h=yi(a),h.payload={element:u},x=x===void 0?null:x,x!==null&&(h.callback=x),u=vi(i,h,a),u!==null&&(hn(u,i,a),uo(u,i,a))}function Lx(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<a?u:a}}function Ih(i,a){Lx(i,a),(i=i.alternate)&&Lx(i,a)}function Cx(i){if(i.tag===13||i.tag===31){var a=er(i,67108864);a!==null&&hn(a,i,67108864),Ih(i,67108864)}}function _x(i){if(i.tag===13||i.tag===31){var a=Rn();a=Rd(a);var u=er(i,a);u!==null&&hn(u,i,a),Ih(i,a)}}var Lc=!0;function QC(i,a,u,h){var y=F.T;F.T=null;var x=z.p;try{z.p=2,Oh(i,a,u,h)}finally{z.p=x,F.T=y}}function ZC(i,a,u,h){var y=F.T;F.T=null;var x=z.p;try{z.p=8,Oh(i,a,u,h)}finally{z.p=x,F.T=y}}function Oh(i,a,u,h){if(Lc){var y=Nh(h);if(y===null)vh(i,a,h,Cc,u),Ix(i,h);else if(e_(y,i,a,u,h))h.stopPropagation();else if(Ix(i,h),a&4&&-1<JC.indexOf(i)){for(;y!==null;){var x=Dr(y);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var w=Wi(x.pendingLanes);if(w!==0){var O=x;for(O.pendingLanes|=2,O.entangledLanes|=2;w;){var $=1<<31-He(w);O.entanglements[1]|=$,w&=~$}fs(x),(Ze&6)===0&&(uc=Dt()+500,Lo(0))}}break;case 31:case 13:O=er(x,2),O!==null&&hn(O,x,2),fc(),Ih(x,2)}if(x=Nh(h),x===null&&vh(i,a,h,Cc,u),x===y)break;y=x}y!==null&&h.stopPropagation()}else vh(i,a,h,null,u)}}function Nh(i){return i=kd(i),kh(i)}var Cc=null;function kh(i){if(Cc=null,i=_r(i),i!==null){var a=o(i);if(a===null)i=null;else{var u=a.tag;if(u===13){if(i=l(a),i!==null)return i;i=null}else if(u===31){if(i=c(a),i!==null)return i;i=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return Cc=i,null}function Dx(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Lr()){case ls:return 2;case ai:return 8;case Is:case oi:return 32;case li:return 268435456;default:return 32}default:return 32}}var Mh=!1,_i=null,Di=null,Ii=null,ko=new Map,Mo=new Map,Oi=[],JC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ix(i,a){switch(i){case"focusin":case"focusout":_i=null;break;case"dragenter":case"dragleave":Di=null;break;case"mouseover":case"mouseout":Ii=null;break;case"pointerover":case"pointerout":ko.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mo.delete(a.pointerId)}}function Po(i,a,u,h,y,x){return i===null||i.nativeEvent!==x?(i={blockedOn:a,domEventName:u,eventSystemFlags:h,nativeEvent:x,targetContainers:[y]},a!==null&&(a=Dr(a),a!==null&&Cx(a)),i):(i.eventSystemFlags|=h,a=i.targetContainers,y!==null&&a.indexOf(y)===-1&&a.push(y),i)}function e_(i,a,u,h,y){switch(a){case"focusin":return _i=Po(_i,i,a,u,h,y),!0;case"dragenter":return Di=Po(Di,i,a,u,h,y),!0;case"mouseover":return Ii=Po(Ii,i,a,u,h,y),!0;case"pointerover":var x=y.pointerId;return ko.set(x,Po(ko.get(x)||null,i,a,u,h,y)),!0;case"gotpointercapture":return x=y.pointerId,Mo.set(x,Po(Mo.get(x)||null,i,a,u,h,y)),!0}return!1}function Ox(i){var a=_r(i.target);if(a!==null){var u=o(a);if(u!==null){if(a=u.tag,a===13){if(a=l(u),a!==null){i.blockedOn=a,Kp(i.priority,function(){_x(u)});return}}else if(a===31){if(a=c(u),a!==null){i.blockedOn=a,Kp(i.priority,function(){_x(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function _c(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var u=Nh(i.nativeEvent);if(u===null){u=i.nativeEvent;var h=new u.constructor(u.type,u);Nd=h,u.target.dispatchEvent(h),Nd=null}else return a=Dr(u),a!==null&&Cx(a),i.blockedOn=u,!1;a.shift()}return!0}function Nx(i,a,u){_c(i)&&u.delete(a)}function t_(){Mh=!1,_i!==null&&_c(_i)&&(_i=null),Di!==null&&_c(Di)&&(Di=null),Ii!==null&&_c(Ii)&&(Ii=null),ko.forEach(Nx),Mo.forEach(Nx)}function Dc(i,a){i.blockedOn===a&&(i.blockedOn=null,Mh||(Mh=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,t_)))}var Ic=null;function kx(i){Ic!==i&&(Ic=i,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Ic===i&&(Ic=null);for(var a=0;a<i.length;a+=3){var u=i[a],h=i[a+1],y=i[a+2];if(typeof h!="function"){if(kh(h||u)===null)continue;break}var x=Dr(u);x!==null&&(i.splice(a,3),a-=3,Nf(x,{pending:!0,data:y,method:u.method,action:h},h,y))}}))}function da(i){function a($){return Dc($,i)}_i!==null&&Dc(_i,i),Di!==null&&Dc(Di,i),Ii!==null&&Dc(Ii,i),ko.forEach(a),Mo.forEach(a);for(var u=0;u<Oi.length;u++){var h=Oi[u];h.blockedOn===i&&(h.blockedOn=null)}for(;0<Oi.length&&(u=Oi[0],u.blockedOn===null);)Ox(u),u.blockedOn===null&&Oi.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var y=u[h],x=u[h+1],w=y[on]||null;if(typeof x=="function")w||kx(u);else if(w){var O=null;if(x&&x.hasAttribute("formAction")){if(y=x,w=x[on]||null)O=w.formAction;else if(kh(y)!==null)continue}else O=w.action;typeof O=="function"?u[h+1]=O:(u.splice(h,3),h-=3),kx(u)}}}function Mx(){function i(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(w){return y=w})},focusReset:"manual",scroll:"manual"})}function a(){y!==null&&(y(),y=null),h||setTimeout(u,20)}function u(){if(!h&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){h=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),y!==null&&(y(),y=null)}}}function Ph(i){this._internalRoot=i}Oc.prototype.render=Ph.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(n(409));var u=a.current,h=Rn();wx(u,h,i,a,null,null)},Oc.prototype.unmount=Ph.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;wx(i.current,2,null,i,null,null),fc(),a[Cr]=null}};function Oc(i){this._internalRoot=i}Oc.prototype.unstable_scheduleHydration=function(i){if(i){var a=Vp();i={blockedOn:null,target:i,priority:a};for(var u=0;u<Oi.length&&a!==0&&a<Oi[u].priority;u++);Oi.splice(u,0,i),u===0&&Ox(i)}};var Px=e.version;if(Px!=="19.2.0")throw Error(n(527,Px,"19.2.0"));z.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=d(a),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var n_={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nc.isDisabled&&Nc.supportsFiber)try{me=Nc.inject(n_),ge=Nc}catch{}}return Uo.createRoot=function(i,a){if(!r(i))throw Error(n(299));var u=!1,h="",y=Hy,x=zy,w=Vy;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(y=a.onUncaughtError),a.onCaughtError!==void 0&&(x=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=Ax(i,1,!1,null,null,u,h,null,y,x,w,Mx),i[Cr]=a.current,yh(i),new Ph(a)},Uo.hydrateRoot=function(i,a,u){if(!r(i))throw Error(n(299));var h=!1,y="",x=Hy,w=zy,O=Vy,$=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(x=u.onUncaughtError),u.onCaughtError!==void 0&&(w=u.onCaughtError),u.onRecoverableError!==void 0&&(O=u.onRecoverableError),u.formState!==void 0&&($=u.formState)),a=Ax(i,1,!0,a,u??null,h,y,$,x,w,O,Mx),a.context=Rx(null),u=a.current,h=Rn(),h=Rd(h),y=yi(h),y.callback=null,vi(u,y,h),u=h,a.current.lanes=u,Ka(a,u),fs(a),i[Cr]=a.current,yh(i),new Oc(a)},Uo.version="19.2.0",Uo}var Kx;function f_(){if(Kx)return Uh.exports;Kx=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Uh.exports=d_(),Uh.exports}var h_=f_();function m_(s,e){if(s instanceof RegExp)return{keys:!1,pattern:s};var t,n,r,o,l=[],c="",f=s.split("/");for(f[0]||f.shift();r=f.shift();)t=r[0],t==="*"?(l.push(t),c+=r[1]==="?"?"(?:/(.*))?":"/(.*)"):t===":"?(n=r.indexOf("?",1),o=r.indexOf(".",1),l.push(r.substring(1,~n?n:~o?o:r.length)),c+=~n&&!~o?"(?:/([^/]+?))?":"/([^/]+?)",~o&&(c+=(~n?"?":"")+"\\"+r.substring(o))):c+="/"+r;return{keys:l,pattern:new RegExp("^"+c+(e?"(?=$|/)":"/?$"),"i")}}var A=Qu();const ys=Cb(A),Zu=i_({__proto__:null,default:ys},[A]);var Hh={exports:{}},zh={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qx;function g_(){if(qx)return zh;qx=1;var s=Qu();function e(g,p){return g===p&&(g!==0||1/g===1/p)||g!==g&&p!==p}var t=typeof Object.is=="function"?Object.is:e,n=s.useState,r=s.useEffect,o=s.useLayoutEffect,l=s.useDebugValue;function c(g,p){var E=p(),v=n({inst:{value:E,getSnapshot:p}}),S=v[0].inst,b=v[1];return o(function(){S.value=E,S.getSnapshot=p,f(S)&&b({inst:S})},[g,E,p]),r(function(){return f(S)&&b({inst:S}),g(function(){f(S)&&b({inst:S})})},[g]),l(E),E}function f(g){var p=g.getSnapshot;g=g.value;try{var E=p();return!t(g,E)}catch{return!0}}function d(g,p){return p()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:c;return zh.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:m,zh}var Yx;function p_(){return Yx||(Yx=1,Hh.exports=g_()),Hh.exports}var y_=p_();const v_=Zu.useInsertionEffect,x_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",E_=x_?A.useLayoutEffect:A.useEffect,S_=v_||E_,Db=s=>{const e=A.useRef([s,(...t)=>e[0](...t)]).current;return S_(()=>{e[0]=s}),e[1]},b_="popstate",_g="pushState",Dg="replaceState",T_="hashchange",Wx=[b_,_g,Dg,T_],A_=s=>{for(const e of Wx)addEventListener(e,s);return()=>{for(const e of Wx)removeEventListener(e,s)}},Ib=(s,e)=>y_.useSyncExternalStore(A_,s,e),R_=()=>location.search,w_=({ssrSearch:s=""}={})=>Ib(R_,()=>s),Xx=()=>location.pathname,L_=({ssrPath:s}={})=>Ib(Xx,s?()=>s:Xx),C_=(s,{replace:e=!1,state:t=null}={})=>history[e?Dg:_g](t,"",s),__=(s={})=>[L_(s),C_],Qx=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Qx]>"u"){for(const s of[_g,Dg]){const e=history[s];history[s]=function(){const t=e.apply(this,arguments),n=new Event(s);return n.arguments=arguments,dispatchEvent(n),t}}Object.defineProperty(window,Qx,{value:!0})}const D_=(s,e)=>e.toLowerCase().indexOf(s.toLowerCase())?"~"+e:e.slice(s.length)||"/",Ob=(s="")=>s==="/"?"":s,I_=(s,e)=>s[0]==="~"?s.slice(1):Ob(e)+s,O_=(s="",e)=>D_(Zx(Ob(s)),Zx(e)),Zx=s=>{try{return decodeURI(s)}catch{return s}},Nb={hook:__,searchHook:w_,parser:m_,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:s=>s},kb=A.createContext(Nb),ol=()=>A.useContext(kb),Mb={},Pb=A.createContext(Mb),N_=()=>A.useContext(Pb),Ju=s=>{const[e,t]=s.hook(s);return[O_(s.base,e),Db((n,r)=>t(I_(n,s.base),r))]},Ig=()=>Ju(ol()),Fb=(s,e,t,n)=>{const{pattern:r,keys:o}=e instanceof RegExp?{keys:!1,pattern:e}:s(e||"*",n),l=r.exec(t)||[],[c,...f]=l;return c!==void 0?[!0,(()=>{const d=o!==!1?Object.fromEntries(o.map((g,p)=>[g,f[p]])):l.groups;let m={...f};return d&&Object.assign(m,d),m})(),...n?[c]:[]]:[!1,null]},k_=({children:s,...e})=>{const t=ol(),n=e.hook?Nb:t;let r=n;const[o,l]=e.ssrPath?.split("?")??[];l&&(e.ssrSearch=l,e.ssrPath=o),e.hrefs=e.hrefs??e.hook?.hrefs;let c=A.useRef({}),f=c.current,d=f;for(let m in n){const g=m==="base"?n[m]+(e[m]||""):e[m]||n[m];f===d&&g!==d[m]&&(c.current=d={...d}),d[m]=g,g!==n[m]&&(r=d)}return A.createElement(kb.Provider,{value:r,children:s})},Jx=({children:s,component:e},t)=>e?A.createElement(e,{params:t}):typeof s=="function"?s(t):s,M_=s=>{let e=A.useRef(Mb),t=e.current;for(const n in s)s[n]!==t[n]&&(t=s);return Object.keys(s).length===0&&(t=s),e.current=t},Vh=({path:s,nest:e,match:t,...n})=>{const r=ol(),[o]=Ju(r),[l,c,f]=t??Fb(r.parser,s,o,e),d=M_({...N_(),...c});if(!l)return null;const m=f?A.createElement(k_,{base:f},Jx(n,d)):Jx(n,d);return A.createElement(Pb.Provider,{value:d,children:m})};A.forwardRef((s,e)=>{const t=ol(),[n,r]=Ju(t),{to:o="",href:l=o,onClick:c,asChild:f,children:d,className:m,replace:g,state:p,...E}=s,v=Db(b=>{b.ctrlKey||b.metaKey||b.altKey||b.shiftKey||b.button!==0||(c?.(b),b.defaultPrevented||(b.preventDefault(),r(l,s)))}),S=t.hrefs(l[0]==="~"?l.slice(1):t.base+l,t);return f&&A.isValidElement(d)?A.cloneElement(d,{onClick:v,href:S}):A.createElement("a",{...E,onClick:v,href:S,className:m?.call?m(n===l):m,children:d,ref:e})});const Ub=s=>Array.isArray(s)?s.flatMap(e=>Ub(e&&e.type===A.Fragment?e.props.children:e)):[s],P_=({children:s,location:e})=>{const t=ol(),[n]=Ju(t);for(const r of Ub(s)){let o=0;if(A.isValidElement(r)&&(o=Fb(t.parser,r.props.path,e||n,r.props.nest))[0])return A.cloneElement(r,{match:o})}return null};var ed=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},td=typeof window>"u"||"Deno"in globalThis;function ns(){}function F_(s,e){return typeof s=="function"?s(e):s}function U_(s){return typeof s=="number"&&s>=0&&s!==1/0}function B_(s,e){return Math.max(s+(e||0)-Date.now(),0)}function eE(s,e){return typeof s=="function"?s(e):s}function $_(s,e){return typeof s=="function"?s(e):s}function tE(s,e){const{type:t="all",exact:n,fetchStatus:r,predicate:o,queryKey:l,stale:c}=s;if(l){if(n){if(e.queryHash!==Og(l,e.options))return!1}else if(!Xo(e.queryKey,l))return!1}if(t!=="all"){const f=e.isActive();if(t==="active"&&!f||t==="inactive"&&f)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||r&&r!==e.state.fetchStatus||o&&!o(e))}function nE(s,e){const{exact:t,status:n,predicate:r,mutationKey:o}=s;if(o){if(!e.options.mutationKey)return!1;if(t){if(Wo(e.options.mutationKey)!==Wo(o))return!1}else if(!Xo(e.options.mutationKey,o))return!1}return!(n&&e.state.status!==n||r&&!r(e))}function Og(s,e){return(e?.queryKeyHashFn||Wo)(s)}function Wo(s){return JSON.stringify(s,(e,t)=>Bm(t)?Object.keys(t).sort().reduce((n,r)=>(n[r]=t[r],n),{}):t)}function Xo(s,e){return s===e?!0:typeof s!=typeof e?!1:s&&e&&typeof s=="object"&&typeof e=="object"?!Object.keys(e).some(t=>!Xo(s[t],e[t])):!1}function Bb(s,e){if(s===e)return s;const t=sE(s)&&sE(e);if(t||Bm(s)&&Bm(e)){const n=t?s:Object.keys(s),r=n.length,o=t?e:Object.keys(e),l=o.length,c=t?[]:{};let f=0;for(let d=0;d<l;d++){const m=t?d:o[d];(!t&&n.includes(m)||t)&&s[m]===void 0&&e[m]===void 0?(c[m]=void 0,f++):(c[m]=Bb(s[m],e[m]),c[m]===s[m]&&s[m]!==void 0&&f++)}return r===l&&f===r?s:c}return e}function sE(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function Bm(s){if(!iE(s))return!1;const e=s.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!iE(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function iE(s){return Object.prototype.toString.call(s)==="[object Object]"}function j_(s){return new Promise(e=>{setTimeout(e,s)})}function G_(s,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(s,e):t.structuralSharing!==!1?Bb(s,e):e}function H_(s,e,t=0){const n=[...s,e];return t&&n.length>t?n.slice(1):n}function z_(s,e,t=0){const n=[e,...s];return t&&n.length>t?n.slice(0,-1):n}var Ng=Symbol();function $b(s,e){return!s.queryFn&&e?.initialPromise?()=>e.initialPromise:!s.queryFn||s.queryFn===Ng?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}var V_=class extends ed{#e;#t;#n;constructor(){super(),this.#n=s=>{if(!td&&window.addEventListener){const e=()=>s();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(s){this.#n=s,this.#t?.(),this.#t=s(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(s){this.#e!==s&&(this.#e=s,this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(e=>{e(s)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},jb=new V_,K_=class extends ed{#e=!0;#t;#n;constructor(){super(),this.#n=s=>{if(!td&&window.addEventListener){const e=()=>s(!0),t=()=>s(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(s){this.#n=s,this.#t?.(),this.#t=s(this.setOnline.bind(this))}setOnline(s){this.#e!==s&&(this.#e=s,this.listeners.forEach(t=>{t(s)}))}isOnline(){return this.#e}},Cu=new K_;function q_(){let s,e;const t=new Promise((r,o)=>{s=r,e=o});t.status="pending",t.catch(()=>{});function n(r){Object.assign(t,r),delete t.resolve,delete t.reject}return t.resolve=r=>{n({status:"fulfilled",value:r}),s(r)},t.reject=r=>{n({status:"rejected",reason:r}),e(r)},t}function Y_(s){return Math.min(1e3*2**s,3e4)}function Gb(s){return(s??"online")==="online"?Cu.isOnline():!0}var Hb=class extends Error{constructor(s){super("CancelledError"),this.revert=s?.revert,this.silent=s?.silent}};function Kh(s){return s instanceof Hb}function zb(s){let e=!1,t=0,n=!1,r;const o=q_(),l=S=>{n||(p(new Hb(S)),s.abort?.())},c=()=>{e=!0},f=()=>{e=!1},d=()=>jb.isFocused()&&(s.networkMode==="always"||Cu.isOnline())&&s.canRun(),m=()=>Gb(s.networkMode)&&s.canRun(),g=S=>{n||(n=!0,s.onSuccess?.(S),r?.(),o.resolve(S))},p=S=>{n||(n=!0,s.onError?.(S),r?.(),o.reject(S))},E=()=>new Promise(S=>{r=b=>{(n||d())&&S(b)},s.onPause?.()}).then(()=>{r=void 0,n||s.onContinue?.()}),v=()=>{if(n)return;let S;const b=t===0?s.initialPromise:void 0;try{S=b??s.fn()}catch(R){S=Promise.reject(R)}Promise.resolve(S).then(g).catch(R=>{if(n)return;const C=s.retry??(td?0:3),_=s.retryDelay??Y_,D=typeof _=="function"?_(t,R):_,N=C===!0||typeof C=="number"&&t<C||typeof C=="function"&&C(t,R);if(e||!N){p(R);return}t++,s.onFail?.(t,R),j_(D).then(()=>d()?void 0:E()).then(()=>{e?p(R):v()})})};return{promise:o,cancel:l,continue:()=>(r?.(),o),cancelRetry:c,continueRetry:f,canStart:m,start:()=>(m()?v():E().then(v),o)}}function W_(){let s=[],e=0,t=c=>{c()},n=c=>{c()},r=c=>setTimeout(c,0);const o=c=>{e?s.push(c):r(()=>{t(c)})},l=()=>{const c=s;s=[],c.length&&r(()=>{n(()=>{c.forEach(f=>{t(f)})})})};return{batch:c=>{let f;e++;try{f=c()}finally{e--,e||l()}return f},batchCalls:c=>(...f)=>{o(()=>{c(...f)})},schedule:o,setNotifyFunction:c=>{t=c},setBatchNotifyFunction:c=>{n=c},setScheduler:c=>{r=c}}}var rn=W_(),Vb=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),U_(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(td?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},X_=class extends Vb{#e;#t;#n;#s;#a;#r;constructor(s){super(),this.#r=!1,this.#a=s.defaultOptions,this.setOptions(s.options),this.observers=[],this.#n=s.cache,this.queryKey=s.queryKey,this.queryHash=s.queryHash,this.#e=Z_(this.options),this.state=s.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(s){this.options={...this.#a,...s},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(s,e){const t=G_(this.state.data,s,this.options);return this.#i({data:t,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),t}setState(s,e){this.#i({type:"setState",state:s,setStateOptions:e})}cancel(s){const e=this.#s?.promise;return this.#s?.cancel(s),e?e.then(ns).catch(ns):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(s=>$_(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ng||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(s=0){return this.state.isInvalidated||this.state.data===void 0||!B_(this.state.dataUpdatedAt,s)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(e=>e!==s),this.observers.length||(this.#s&&(this.#r?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}fetch(s,e){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(s&&this.setOptions(s),!this.options.queryFn){const c=this.observers.find(f=>f.options.queryFn);c&&this.setOptions(c.options)}const t=new AbortController,n=c=>{Object.defineProperty(c,"signal",{enumerable:!0,get:()=>(this.#r=!0,t.signal)})},r=()=>{const c=$b(this.options,e),f={queryKey:this.queryKey,meta:this.meta};return n(f),this.#r=!1,this.options.persister?this.options.persister(c,f,this):c(f)},o={fetchOptions:e,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:r};n(o),this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#i({type:"fetch",meta:o.fetchOptions?.meta});const l=c=>{Kh(c)&&c.silent||this.#i({type:"error",error:c}),Kh(c)||(this.#n.config.onError?.(c,this),this.#n.config.onSettled?.(this.state.data,c,this)),this.scheduleGc()};return this.#s=zb({initialPromise:e?.initialPromise,fn:o.fetchFn,abort:t.abort.bind(t),onSuccess:c=>{if(c===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(c)}catch(f){l(f);return}this.#n.config.onSuccess?.(c,this),this.#n.config.onSettled?.(c,this.state.error,this),this.scheduleGc()},onError:l,onFail:(c,f)=>{this.#i({type:"failed",failureCount:c,error:f})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}),this.#s.start()}#i(s){const e=t=>{switch(s.type){case"failed":return{...t,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...Q_(t.data,this.options),fetchMeta:s.meta??null};case"success":return{...t,data:s.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:s.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=s.error;return Kh(n)&&n.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...s.state}}};this.state=e(this.state),rn.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:s})})}};function Q_(s,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Gb(e.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function Z_(s){const e=typeof s.initialData=="function"?s.initialData():s.initialData,t=e!==void 0,n=t?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var J_=class extends ed{constructor(s={}){super(),this.config=s,this.#e=new Map}#e;build(s,e,t){const n=e.queryKey,r=e.queryHash??Og(n,e);let o=this.get(r);return o||(o=new X_({cache:this,queryKey:n,queryHash:r,options:s.defaultQueryOptions(e),state:t,defaultOptions:s.getQueryDefaults(n)}),this.add(o)),o}add(s){this.#e.has(s.queryHash)||(this.#e.set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const e=this.#e.get(s.queryHash);e&&(s.destroy(),e===s&&this.#e.delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){rn.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return this.#e.get(s)}getAll(){return[...this.#e.values()]}find(s){const e={exact:!0,...s};return this.getAll().find(t=>tE(e,t))}findAll(s={}){const e=this.getAll();return Object.keys(s).length>0?e.filter(t=>tE(s,t)):e}notify(s){rn.batch(()=>{this.listeners.forEach(e=>{e(s)})})}onFocus(){rn.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){rn.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},eD=class extends Vb{#e;#t;#n;constructor(s){super(),this.mutationId=s.mutationId,this.#t=s.mutationCache,this.#e=[],this.state=s.state||tD(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){this.#e.includes(s)||(this.#e.push(s),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){this.#e=this.#e.filter(e=>e!==s),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(s){this.#n=zb({fn:()=>this.options.mutationFn?this.options.mutationFn(s):Promise.reject(new Error("No mutationFn found")),onFail:(n,r)=>{this.#s({type:"failed",failureCount:n,error:r})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const e=this.state.status==="pending",t=!this.#n.canStart();try{if(!e){this.#s({type:"pending",variables:s,isPaused:t}),await this.#t.config.onMutate?.(s,this);const r=await this.options.onMutate?.(s);r!==this.state.context&&this.#s({type:"pending",context:r,variables:s,isPaused:t})}const n=await this.#n.start();return await this.#t.config.onSuccess?.(n,s,this.state.context,this),await this.options.onSuccess?.(n,s,this.state.context),await this.#t.config.onSettled?.(n,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(n,null,s,this.state.context),this.#s({type:"success",data:n}),n}catch(n){try{throw await this.#t.config.onError?.(n,s,this.state.context,this),await this.options.onError?.(n,s,this.state.context),await this.#t.config.onSettled?.(void 0,n,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,n,s,this.state.context),n}finally{this.#s({type:"error",error:n})}}finally{this.#t.runNext(this)}}#s(s){const e=t=>{switch(s.type){case"failed":return{...t,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...t,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:s.error,failureCount:t.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=e(this.state),rn.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(s)}),this.#t.notify({mutation:this,type:"updated",action:s})})}};function tD(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var nD=class extends ed{constructor(s={}){super(),this.config=s,this.#e=new Map,this.#t=Date.now()}#e;#t;build(s,e,t){const n=new eD({mutationCache:this,mutationId:++this.#t,options:s.defaultMutationOptions(e),state:t});return this.add(n),n}add(s){const e=kc(s),t=this.#e.get(e)??[];t.push(s),this.#e.set(e,t),this.notify({type:"added",mutation:s})}remove(s){const e=kc(s);if(this.#e.has(e)){const t=this.#e.get(e)?.filter(n=>n!==s);t&&(t.length===0?this.#e.delete(e):this.#e.set(e,t))}this.notify({type:"removed",mutation:s})}canRun(s){const e=this.#e.get(kc(s))?.find(t=>t.state.status==="pending");return!e||e===s}runNext(s){return this.#e.get(kc(s))?.find(t=>t!==s&&t.state.isPaused)?.continue()??Promise.resolve()}clear(){rn.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}getAll(){return[...this.#e.values()].flat()}find(s){const e={exact:!0,...s};return this.getAll().find(t=>nE(e,t))}findAll(s={}){return this.getAll().filter(e=>nE(s,e))}notify(s){rn.batch(()=>{this.listeners.forEach(e=>{e(s)})})}resumePausedMutations(){const s=this.getAll().filter(e=>e.state.isPaused);return rn.batch(()=>Promise.all(s.map(e=>e.continue().catch(ns))))}};function kc(s){return s.options.scope?.id??String(s.mutationId)}function rE(s){return{onFetch:(e,t)=>{const n=e.options,r=e.fetchOptions?.meta?.fetchMore?.direction,o=e.state.data?.pages||[],l=e.state.data?.pageParams||[];let c={pages:[],pageParams:[]},f=0;const d=async()=>{let m=!1;const g=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(e.signal.aborted?m=!0:e.signal.addEventListener("abort",()=>{m=!0}),e.signal)})},p=$b(e.options,e.fetchOptions),E=async(v,S,b)=>{if(m)return Promise.reject();if(S==null&&v.pages.length)return Promise.resolve(v);const R={queryKey:e.queryKey,pageParam:S,direction:b?"backward":"forward",meta:e.options.meta};g(R);const C=await p(R),{maxPages:_}=e.options,D=b?z_:H_;return{pages:D(v.pages,C,_),pageParams:D(v.pageParams,S,_)}};if(r&&o.length){const v=r==="backward",S=v?sD:aE,b={pages:o,pageParams:l},R=S(n,b);c=await E(b,R,v)}else{const v=s??o.length;do{const S=f===0?l[0]??n.initialPageParam:aE(n,c);if(f>0&&S==null)break;c=await E(c,S),f++}while(f<v)}return c};e.options.persister?e.fetchFn=()=>e.options.persister?.(d,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t):e.fetchFn=d}}}function aE(s,{pages:e,pageParams:t}){const n=e.length-1;return e.length>0?s.getNextPageParam(e[n],e,t[n],t):void 0}function sD(s,{pages:e,pageParams:t}){return e.length>0?s.getPreviousPageParam?.(e[0],e,t[0],t):void 0}var iD=class{#e;#t;#n;#s;#a;#r;#i;#o;constructor(s={}){this.#e=s.queryCache||new J_,this.#t=s.mutationCache||new nD,this.#n=s.defaultOptions||{},this.#s=new Map,this.#a=new Map,this.#r=0}mount(){this.#r++,this.#r===1&&(this.#i=jb.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#o=Cu.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#r--,this.#r===0&&(this.#i?.(),this.#i=void 0,this.#o?.(),this.#o=void 0)}isFetching(s){return this.#e.findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return this.#t.findAll({...s,status:"pending"}).length}getQueryData(s){const e=this.defaultQueryOptions({queryKey:s});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(s){const e=this.getQueryData(s.queryKey);if(e===void 0)return this.fetchQuery(s);{const t=this.defaultQueryOptions(s),n=this.#e.build(this,t);return s.revalidateIfStale&&n.isStaleByTime(eE(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(e)}}getQueriesData(s){return this.#e.findAll(s).map(({queryKey:e,state:t})=>{const n=t.data;return[e,n]})}setQueryData(s,e,t){const n=this.defaultQueryOptions({queryKey:s}),o=this.#e.get(n.queryHash)?.state.data,l=F_(e,o);if(l!==void 0)return this.#e.build(this,n).setData(l,{...t,manual:!0})}setQueriesData(s,e,t){return rn.batch(()=>this.#e.findAll(s).map(({queryKey:n})=>[n,this.setQueryData(n,e,t)]))}getQueryState(s){const e=this.defaultQueryOptions({queryKey:s});return this.#e.get(e.queryHash)?.state}removeQueries(s){const e=this.#e;rn.batch(()=>{e.findAll(s).forEach(t=>{e.remove(t)})})}resetQueries(s,e){const t=this.#e,n={type:"active",...s};return rn.batch(()=>(t.findAll(s).forEach(r=>{r.reset()}),this.refetchQueries(n,e)))}cancelQueries(s={},e={}){const t={revert:!0,...e},n=rn.batch(()=>this.#e.findAll(s).map(r=>r.cancel(t)));return Promise.all(n).then(ns).catch(ns)}invalidateQueries(s={},e={}){return rn.batch(()=>{if(this.#e.findAll(s).forEach(n=>{n.invalidate()}),s.refetchType==="none")return Promise.resolve();const t={...s,type:s.refetchType??s.type??"active"};return this.refetchQueries(t,e)})}refetchQueries(s={},e){const t={...e,cancelRefetch:e?.cancelRefetch??!0},n=rn.batch(()=>this.#e.findAll(s).filter(r=>!r.isDisabled()).map(r=>{let o=r.fetch(void 0,t);return t.throwOnError||(o=o.catch(ns)),r.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(ns)}fetchQuery(s){const e=this.defaultQueryOptions(s);e.retry===void 0&&(e.retry=!1);const t=this.#e.build(this,e);return t.isStaleByTime(eE(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(ns).catch(ns)}fetchInfiniteQuery(s){return s.behavior=rE(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(ns).catch(ns)}ensureInfiniteQueryData(s){return s.behavior=rE(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return Cu.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(s){this.#n=s}setQueryDefaults(s,e){this.#s.set(Wo(s),{queryKey:s,defaultOptions:e})}getQueryDefaults(s){const e=[...this.#s.values()];let t={};return e.forEach(n=>{Xo(s,n.queryKey)&&(t={...t,...n.defaultOptions})}),t}setMutationDefaults(s,e){this.#a.set(Wo(s),{mutationKey:s,defaultOptions:e})}getMutationDefaults(s){const e=[...this.#a.values()];let t={};return e.forEach(n=>{Xo(s,n.mutationKey)&&(t={...t,...n.defaultOptions})}),t}defaultQueryOptions(s){if(s._defaulted)return s;const e={...this.#n.queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return e.queryHash||(e.queryHash=Og(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===Ng&&(e.enabled=!1),e}defaultMutationOptions(s){return s?._defaulted?s:{...this.#n.mutations,...s?.mutationKey&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},rD=A.createContext(void 0),aD=({client:s,children:e})=>(A.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),T.jsx(rD.Provider,{value:s,children:e}));async function oD(s){if(!s.ok){const e=await s.text()||s.statusText;throw new Error(`${s.status}: ${e}`)}}const lD=({on401:s})=>async({queryKey:e})=>{const t=await fetch(e.join("/"),{credentials:"include"});return await oD(t),await t.json()},cD=new iD({defaultOptions:{queries:{queryFn:lD({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),uD=1,dD=1e6;let qh=0;function fD(){return qh=(qh+1)%Number.MAX_SAFE_INTEGER,qh.toString()}const Yh=new Map,oE=s=>{if(Yh.has(s))return;const e=setTimeout(()=>{Yh.delete(s),zo({type:"REMOVE_TOAST",toastId:s})},dD);Yh.set(s,e)},hD=(s,e)=>{switch(e.type){case"ADD_TOAST":return{...s,toasts:[e.toast,...s.toasts].slice(0,uD)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?oE(t):s.toasts.forEach(n=>{oE(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===t||t===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return e.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==e.toastId)}}},cu=[];let uu={toasts:[]};function zo(s){uu=hD(uu,s),cu.forEach(e=>{e(uu)})}function mD({...s}){const e=fD(),t=r=>zo({type:"UPDATE_TOAST",toast:{...r,id:e}}),n=()=>zo({type:"DISMISS_TOAST",toastId:e});return zo({type:"ADD_TOAST",toast:{...s,id:e,open:!0,onOpenChange:r=>{r||n()}}}),{id:e,dismiss:n,update:t}}function Kb(){const[s,e]=A.useState(uu);return A.useEffect(()=>(cu.push(e),()=>{const t=cu.indexOf(e);t>-1&&cu.splice(t,1)}),[s]),{...s,toast:mD,dismiss:t=>zo({type:"DISMISS_TOAST",toastId:t})}}var ll=_b();const qb=Cb(ll);function In(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}function lE(s,e){if(typeof s=="function")return s(e);s!=null&&(s.current=e)}function cl(...s){return e=>{let t=!1;const n=s.map(r=>{const o=lE(r,e);return!t&&typeof o=="function"&&(t=!0),o});if(t)return()=>{for(let r=0;r<n.length;r++){const o=n[r];typeof o=="function"?o():lE(s[r],null)}}}}function mt(...s){return A.useCallback(cl(...s),s)}function gD(s,e){const t=A.createContext(e),n=o=>{const{children:l,...c}=o,f=A.useMemo(()=>c,Object.values(c));return T.jsx(t.Provider,{value:f,children:l})};n.displayName=s+"Provider";function r(o){const l=A.useContext(t);if(l)return l;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${s}\``)}return[n,r]}function Rr(s,e=[]){let t=[];function n(o,l){const c=A.createContext(l),f=t.length;t=[...t,l];const d=g=>{const{scope:p,children:E,...v}=g,S=p?.[s]?.[f]||c,b=A.useMemo(()=>v,Object.values(v));return T.jsx(S.Provider,{value:b,children:E})};d.displayName=o+"Provider";function m(g,p){const E=p?.[s]?.[f]||c,v=A.useContext(E);if(v)return v;if(l!==void 0)return l;throw new Error(`\`${g}\` must be used within \`${o}\``)}return[d,m]}const r=()=>{const o=t.map(l=>A.createContext(l));return function(c){const f=c?.[s]||o;return A.useMemo(()=>({[`__scope${s}`]:{...c,[s]:f}}),[c,f])}};return r.scopeName=s,[n,pD(r,...e)]}function pD(...s){const e=s[0];if(s.length===1)return e;const t=()=>{const n=s.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(o){const l=n.reduce((c,{useScope:f,scopeName:d})=>{const g=f(o)[`__scope${d}`];return{...c,...g}},{});return A.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return t.scopeName=e.scopeName,t}function $m(s){const e=yD(s),t=A.forwardRef((n,r)=>{const{children:o,...l}=n,c=A.Children.toArray(o),f=c.find(xD);if(f){const d=f.props.children,m=c.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}function yD(s){const e=A.forwardRef((t,n)=>{const{children:r,...o}=t;if(A.isValidElement(r)){const l=SD(r),c=ED(o,r.props);return r.type!==A.Fragment&&(c.ref=n?cl(n,l):l),A.cloneElement(r,c)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var vD=Symbol("radix.slottable");function xD(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===vD}function ED(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...c)=>{o(...c),r(...c)}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function SD(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}function bD(s){const e=s+"CollectionProvider",[t,n]=Rr(e),[r,o]=t(e,{collectionRef:{current:null},itemMap:new Map}),l=S=>{const{scope:b,children:R}=S,C=ys.useRef(null),_=ys.useRef(new Map).current;return T.jsx(r,{scope:b,itemMap:_,collectionRef:C,children:R})};l.displayName=e;const c=s+"CollectionSlot",f=$m(c),d=ys.forwardRef((S,b)=>{const{scope:R,children:C}=S,_=o(c,R),D=mt(b,_.collectionRef);return T.jsx(f,{ref:D,children:C})});d.displayName=c;const m=s+"CollectionItemSlot",g="data-radix-collection-item",p=$m(m),E=ys.forwardRef((S,b)=>{const{scope:R,children:C,..._}=S,D=ys.useRef(null),N=mt(b,D),B=o(m,R);return ys.useEffect(()=>(B.itemMap.set(D,{ref:D,..._}),()=>void B.itemMap.delete(D))),T.jsx(p,{[g]:"",ref:N,children:C})});E.displayName=m;function v(S){const b=o(s+"CollectionConsumer",S);return ys.useCallback(()=>{const C=b.collectionRef.current;if(!C)return[];const _=Array.from(C.querySelectorAll(`[${g}]`));return Array.from(b.itemMap.values()).sort((B,I)=>_.indexOf(B.ref.current)-_.indexOf(I.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:l,Slot:d,ItemSlot:E},v,n]}var TD=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ls=TD.reduce((s,e)=>{const t=$m(`Primitive.${e}`),n=A.forwardRef((r,o)=>{const{asChild:l,...c}=r,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),T.jsx(f,{...c,ref:o})});return n.displayName=`Primitive.${e}`,{...s,[e]:n}},{});function Yb(s,e){s&&ll.flushSync(()=>s.dispatchEvent(e))}function Ct(s){const e=A.useRef(s);return A.useEffect(()=>{e.current=s}),A.useMemo(()=>(...t)=>e.current?.(...t),[])}function Wb(s,e=globalThis?.document){const t=Ct(s);A.useEffect(()=>{const n=r=>{r.key==="Escape"&&t(r)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var AD="DismissableLayer",jm="dismissableLayer.update",RD="dismissableLayer.pointerDownOutside",wD="dismissableLayer.focusOutside",cE,Xb=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Qb=A.forwardRef((s,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...f}=s,d=A.useContext(Xb),[m,g]=A.useState(null),p=m?.ownerDocument??globalThis?.document,[,E]=A.useState({}),v=mt(e,I=>g(I)),S=Array.from(d.layers),[b]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),R=S.indexOf(b),C=m?S.indexOf(m):-1,_=d.layersWithOutsidePointerEventsDisabled.size>0,D=C>=R,N=CD(I=>{const P=I.target,M=[...d.branches].some(U=>U.contains(P));!D||M||(r?.(I),l?.(I),I.defaultPrevented||c?.())},p),B=_D(I=>{const P=I.target;[...d.branches].some(U=>U.contains(P))||(o?.(I),l?.(I),I.defaultPrevented||c?.())},p);return Wb(I=>{C===d.layers.size-1&&(n?.(I),!I.defaultPrevented&&c&&(I.preventDefault(),c()))},p),A.useEffect(()=>{if(m)return t&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(cE=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(m)),d.layers.add(m),uE(),()=>{t&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=cE)}},[m,p,t,d]),A.useEffect(()=>()=>{m&&(d.layers.delete(m),d.layersWithOutsidePointerEventsDisabled.delete(m),uE())},[m,d]),A.useEffect(()=>{const I=()=>E({});return document.addEventListener(jm,I),()=>document.removeEventListener(jm,I)},[]),T.jsx(Ls.div,{...f,ref:v,style:{pointerEvents:_?D?"auto":"none":void 0,...s.style},onFocusCapture:In(s.onFocusCapture,B.onFocusCapture),onBlurCapture:In(s.onBlurCapture,B.onBlurCapture),onPointerDownCapture:In(s.onPointerDownCapture,N.onPointerDownCapture)})});Qb.displayName=AD;var LD="DismissableLayerBranch",Zb=A.forwardRef((s,e)=>{const t=A.useContext(Xb),n=A.useRef(null),r=mt(e,n);return A.useEffect(()=>{const o=n.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),T.jsx(Ls.div,{...s,ref:r})});Zb.displayName=LD;function CD(s,e=globalThis?.document){const t=Ct(s),n=A.useRef(!1),r=A.useRef(()=>{});return A.useEffect(()=>{const o=c=>{if(c.target&&!n.current){let f=function(){Jb(RD,t,d,{discrete:!0})};const d={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=f,e.addEventListener("click",r.current,{once:!0})):f()}else e.removeEventListener("click",r.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",r.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function _D(s,e=globalThis?.document){const t=Ct(s),n=A.useRef(!1);return A.useEffect(()=>{const r=o=>{o.target&&!n.current&&Jb(wD,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function uE(){const s=new CustomEvent(jm);document.dispatchEvent(s)}function Jb(s,e,t,{discrete:n}){const r=t.originalEvent.target,o=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:t});e&&r.addEventListener(s,e,{once:!0}),n?Yb(r,o):r.dispatchEvent(o)}var DD=Qb,ID=Zb,kn=globalThis?.document?A.useLayoutEffect:()=>{},OD="Portal",eT=A.forwardRef((s,e)=>{const{container:t,...n}=s,[r,o]=A.useState(!1);kn(()=>o(!0),[]);const l=t||r&&globalThis?.document?.body;return l?qb.createPortal(T.jsx(Ls.div,{...n,ref:e}),l):null});eT.displayName=OD;function ND(s,e){return A.useReducer((t,n)=>e[t][n]??t,s)}var tT=s=>{const{present:e,children:t}=s,n=kD(e),r=typeof t=="function"?t({present:n.isPresent}):A.Children.only(t),o=mt(n.ref,MD(r));return typeof t=="function"||n.isPresent?A.cloneElement(r,{ref:o}):null};tT.displayName="Presence";function kD(s){const[e,t]=A.useState(),n=A.useRef({}),r=A.useRef(s),o=A.useRef("none"),l=s?"mounted":"unmounted",[c,f]=ND(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const d=Mc(n.current);o.current=c==="mounted"?d:"none"},[c]),kn(()=>{const d=n.current,m=r.current;if(m!==s){const p=o.current,E=Mc(d);s?f("MOUNT"):E==="none"||d?.display==="none"?f("UNMOUNT"):f(m&&p!==E?"ANIMATION_OUT":"UNMOUNT"),r.current=s}},[s,f]),kn(()=>{if(e){let d;const m=e.ownerDocument.defaultView??window,g=E=>{const S=Mc(n.current).includes(E.animationName);if(E.target===e&&S&&(f("ANIMATION_END"),!r.current)){const b=e.style.animationFillMode;e.style.animationFillMode="forwards",d=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=b)})}},p=E=>{E.target===e&&(o.current=Mc(n.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{m.clearTimeout(d),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else f("ANIMATION_END")},[e,f]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:A.useCallback(d=>{d&&(n.current=getComputedStyle(d)),t(d)},[])}}function Mc(s){return s?.animationName||"none"}function MD(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}function PD({prop:s,defaultProp:e,onChange:t=()=>{}}){const[n,r]=FD({defaultProp:e,onChange:t}),o=s!==void 0,l=o?s:n,c=Ct(t),f=A.useCallback(d=>{if(o){const g=typeof d=="function"?d(s):d;g!==s&&c(g)}else r(d)},[o,s,r,c]);return[l,f]}function FD({defaultProp:s,onChange:e}){const t=A.useState(s),[n]=t,r=A.useRef(n),o=Ct(e);return A.useEffect(()=>{r.current!==n&&(o(n),r.current=n)},[n,r,o]),t}var UD="VisuallyHidden",kg=A.forwardRef((s,e)=>T.jsx(Ls.span,{...s,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...s.style}}));kg.displayName=UD;var Mg="ToastProvider",[Pg,BD,$D]=bD("Toast"),[nT]=Rr("Toast",[$D]),[jD,nd]=nT(Mg),sT=s=>{const{__scopeToast:e,label:t="Notification",duration:n=5e3,swipeDirection:r="right",swipeThreshold:o=50,children:l}=s,[c,f]=A.useState(null),[d,m]=A.useState(0),g=A.useRef(!1),p=A.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${Mg}\`. Expected non-empty \`string\`.`),T.jsx(Pg.Provider,{scope:e,children:T.jsx(jD,{scope:e,label:t,duration:n,swipeDirection:r,swipeThreshold:o,toastCount:d,viewport:c,onViewportChange:f,onToastAdd:A.useCallback(()=>m(E=>E+1),[]),onToastRemove:A.useCallback(()=>m(E=>E-1),[]),isFocusedToastEscapeKeyDownRef:g,isClosePausedRef:p,children:l})})};sT.displayName=Mg;var iT="ToastViewport",GD=["F8"],Gm="toast.viewportPause",Hm="toast.viewportResume",rT=A.forwardRef((s,e)=>{const{__scopeToast:t,hotkey:n=GD,label:r="Notifications ({hotkey})",...o}=s,l=nd(iT,t),c=BD(t),f=A.useRef(null),d=A.useRef(null),m=A.useRef(null),g=A.useRef(null),p=mt(e,g,l.onViewportChange),E=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=l.toastCount>0;A.useEffect(()=>{const b=R=>{n.length!==0&&n.every(_=>R[_]||R.code===_)&&g.current?.focus()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[n]),A.useEffect(()=>{const b=f.current,R=g.current;if(v&&b&&R){const C=()=>{if(!l.isClosePausedRef.current){const B=new CustomEvent(Gm);R.dispatchEvent(B),l.isClosePausedRef.current=!0}},_=()=>{if(l.isClosePausedRef.current){const B=new CustomEvent(Hm);R.dispatchEvent(B),l.isClosePausedRef.current=!1}},D=B=>{!b.contains(B.relatedTarget)&&_()},N=()=>{b.contains(document.activeElement)||_()};return b.addEventListener("focusin",C),b.addEventListener("focusout",D),b.addEventListener("pointermove",C),b.addEventListener("pointerleave",N),window.addEventListener("blur",C),window.addEventListener("focus",_),()=>{b.removeEventListener("focusin",C),b.removeEventListener("focusout",D),b.removeEventListener("pointermove",C),b.removeEventListener("pointerleave",N),window.removeEventListener("blur",C),window.removeEventListener("focus",_)}}},[v,l.isClosePausedRef]);const S=A.useCallback(({tabbingDirection:b})=>{const C=c().map(_=>{const D=_.ref.current,N=[D,...tI(D)];return b==="forwards"?N:N.reverse()});return(b==="forwards"?C.reverse():C).flat()},[c]);return A.useEffect(()=>{const b=g.current;if(b){const R=C=>{const _=C.altKey||C.ctrlKey||C.metaKey;if(C.key==="Tab"&&!_){const N=document.activeElement,B=C.shiftKey;if(C.target===b&&B){d.current?.focus();return}const M=S({tabbingDirection:B?"backwards":"forwards"}),U=M.findIndex(q=>q===N);Wh(M.slice(U+1))?C.preventDefault():B?d.current?.focus():m.current?.focus()}};return b.addEventListener("keydown",R),()=>b.removeEventListener("keydown",R)}},[c,S]),T.jsxs(ID,{ref:f,role:"region","aria-label":r.replace("{hotkey}",E),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&T.jsx(zm,{ref:d,onFocusFromOutsideViewport:()=>{const b=S({tabbingDirection:"forwards"});Wh(b)}}),T.jsx(Pg.Slot,{scope:t,children:T.jsx(Ls.ol,{tabIndex:-1,...o,ref:p})}),v&&T.jsx(zm,{ref:m,onFocusFromOutsideViewport:()=>{const b=S({tabbingDirection:"backwards"});Wh(b)}})]})});rT.displayName=iT;var aT="ToastFocusProxy",zm=A.forwardRef((s,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:n,...r}=s,o=nd(aT,t);return T.jsx(kg,{"aria-hidden":!0,tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:l=>{const c=l.relatedTarget;!o.viewport?.contains(c)&&n()}})});zm.displayName=aT;var sd="Toast",HD="toast.swipeStart",zD="toast.swipeMove",VD="toast.swipeCancel",KD="toast.swipeEnd",oT=A.forwardRef((s,e)=>{const{forceMount:t,open:n,defaultOpen:r,onOpenChange:o,...l}=s,[c=!0,f]=PD({prop:n,defaultProp:r,onChange:o});return T.jsx(tT,{present:t||c,children:T.jsx(WD,{open:c,...l,ref:e,onClose:()=>f(!1),onPause:Ct(s.onPause),onResume:Ct(s.onResume),onSwipeStart:In(s.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:In(s.onSwipeMove,d=>{const{x:m,y:g}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${m}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${g}px`)}),onSwipeCancel:In(s.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:In(s.onSwipeEnd,d=>{const{x:m,y:g}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${m}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${g}px`),f(!1)})})})});oT.displayName=sd;var[qD,YD]=nT(sd,{onClose(){}}),WD=A.forwardRef((s,e)=>{const{__scopeToast:t,type:n="foreground",duration:r,open:o,onClose:l,onEscapeKeyDown:c,onPause:f,onResume:d,onSwipeStart:m,onSwipeMove:g,onSwipeCancel:p,onSwipeEnd:E,...v}=s,S=nd(sd,t),[b,R]=A.useState(null),C=mt(e,Z=>R(Z)),_=A.useRef(null),D=A.useRef(null),N=r||S.duration,B=A.useRef(0),I=A.useRef(N),P=A.useRef(0),{onToastAdd:M,onToastRemove:U}=S,q=Ct(()=>{b?.contains(document.activeElement)&&S.viewport?.focus(),l()}),V=A.useCallback(Z=>{!Z||Z===1/0||(window.clearTimeout(P.current),B.current=new Date().getTime(),P.current=window.setTimeout(q,Z))},[q]);A.useEffect(()=>{const Z=S.viewport;if(Z){const re=()=>{V(I.current),d?.()},F=()=>{const z=new Date().getTime()-B.current;I.current=I.current-z,window.clearTimeout(P.current),f?.()};return Z.addEventListener(Gm,F),Z.addEventListener(Hm,re),()=>{Z.removeEventListener(Gm,F),Z.removeEventListener(Hm,re)}}},[S.viewport,N,f,d,V]),A.useEffect(()=>{o&&!S.isClosePausedRef.current&&V(N)},[o,N,S.isClosePausedRef,V]),A.useEffect(()=>(M(),()=>U()),[M,U]);const ee=A.useMemo(()=>b?mT(b):null,[b]);return S.viewport?T.jsxs(T.Fragment,{children:[ee&&T.jsx(XD,{__scopeToast:t,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:ee}),T.jsx(qD,{scope:t,onClose:q,children:ll.createPortal(T.jsx(Pg.ItemSlot,{scope:t,children:T.jsx(DD,{asChild:!0,onEscapeKeyDown:In(c,()=>{S.isFocusedToastEscapeKeyDownRef.current||q(),S.isFocusedToastEscapeKeyDownRef.current=!1}),children:T.jsx(Ls.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":S.swipeDirection,...v,ref:C,style:{userSelect:"none",touchAction:"none",...s.style},onKeyDown:In(s.onKeyDown,Z=>{Z.key==="Escape"&&(c?.(Z.nativeEvent),Z.nativeEvent.defaultPrevented||(S.isFocusedToastEscapeKeyDownRef.current=!0,q()))}),onPointerDown:In(s.onPointerDown,Z=>{Z.button===0&&(_.current={x:Z.clientX,y:Z.clientY})}),onPointerMove:In(s.onPointerMove,Z=>{if(!_.current)return;const re=Z.clientX-_.current.x,F=Z.clientY-_.current.y,z=!!D.current,j=["left","right"].includes(S.swipeDirection),oe=["left","up"].includes(S.swipeDirection)?Math.min:Math.max,fe=j?oe(0,re):0,k=j?0:oe(0,F),G=Z.pointerType==="touch"?10:2,te={x:fe,y:k},le={originalEvent:Z,delta:te};z?(D.current=te,Pc(zD,g,le,{discrete:!1})):dE(te,S.swipeDirection,G)?(D.current=te,Pc(HD,m,le,{discrete:!1}),Z.target.setPointerCapture(Z.pointerId)):(Math.abs(re)>G||Math.abs(F)>G)&&(_.current=null)}),onPointerUp:In(s.onPointerUp,Z=>{const re=D.current,F=Z.target;if(F.hasPointerCapture(Z.pointerId)&&F.releasePointerCapture(Z.pointerId),D.current=null,_.current=null,re){const z=Z.currentTarget,j={originalEvent:Z,delta:re};dE(re,S.swipeDirection,S.swipeThreshold)?Pc(KD,E,j,{discrete:!0}):Pc(VD,p,j,{discrete:!0}),z.addEventListener("click",oe=>oe.preventDefault(),{once:!0})}})})})}),S.viewport)})]}):null}),XD=s=>{const{__scopeToast:e,children:t,...n}=s,r=nd(sd,e),[o,l]=A.useState(!1),[c,f]=A.useState(!1);return JD(()=>l(!0)),A.useEffect(()=>{const d=window.setTimeout(()=>f(!0),1e3);return()=>window.clearTimeout(d)},[]),c?null:T.jsx(eT,{asChild:!0,children:T.jsx(kg,{...n,children:o&&T.jsxs(T.Fragment,{children:[r.label," ",t]})})})},QD="ToastTitle",lT=A.forwardRef((s,e)=>{const{__scopeToast:t,...n}=s;return T.jsx(Ls.div,{...n,ref:e})});lT.displayName=QD;var ZD="ToastDescription",cT=A.forwardRef((s,e)=>{const{__scopeToast:t,...n}=s;return T.jsx(Ls.div,{...n,ref:e})});cT.displayName=ZD;var uT="ToastAction",dT=A.forwardRef((s,e)=>{const{altText:t,...n}=s;return t.trim()?T.jsx(hT,{altText:t,asChild:!0,children:T.jsx(Fg,{...n,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${uT}\`. Expected non-empty \`string\`.`),null)});dT.displayName=uT;var fT="ToastClose",Fg=A.forwardRef((s,e)=>{const{__scopeToast:t,...n}=s,r=YD(fT,t);return T.jsx(hT,{asChild:!0,children:T.jsx(Ls.button,{type:"button",...n,ref:e,onClick:In(s.onClick,r.onClose)})})});Fg.displayName=fT;var hT=A.forwardRef((s,e)=>{const{__scopeToast:t,altText:n,...r}=s;return T.jsx(Ls.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...r,ref:e})});function mT(s){const e=[];return Array.from(s.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&e.push(n.textContent),eI(n)){const r=n.ariaHidden||n.hidden||n.style.display==="none",o=n.dataset.radixToastAnnounceExclude==="";if(!r)if(o){const l=n.dataset.radixToastAnnounceAlt;l&&e.push(l)}else e.push(...mT(n))}}),e}function Pc(s,e,t,{discrete:n}){const r=t.originalEvent.currentTarget,o=new CustomEvent(s,{bubbles:!0,cancelable:!0,detail:t});e&&r.addEventListener(s,e,{once:!0}),n?Yb(r,o):r.dispatchEvent(o)}var dE=(s,e,t=0)=>{const n=Math.abs(s.x),r=Math.abs(s.y),o=n>r;return e==="left"||e==="right"?o&&n>t:!o&&r>t};function JD(s=()=>{}){const e=Ct(s);kn(()=>{let t=0,n=0;return t=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(n)}},[e])}function eI(s){return s.nodeType===s.ELEMENT_NODE}function tI(s){const e=[],t=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const r=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||r?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function Wh(s){const e=document.activeElement;return s.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var nI=sT,gT=rT,pT=oT,yT=lT,vT=cT,xT=dT,ET=Fg;function ST(s){var e,t,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var r=s.length;for(e=0;e<r;e++)s[e]&&(t=ST(s[e]))&&(n&&(n+=" "),n+=t)}else for(t in s)s[t]&&(n&&(n+=" "),n+=t);return n}function bT(){for(var s,e,t=0,n="",r=arguments.length;t<r;t++)(s=arguments[t])&&(e=ST(s))&&(n&&(n+=" "),n+=e);return n}const fE=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,hE=bT,Ug=(s,e)=>t=>{var n;if(e?.variants==null)return hE(s,t?.class,t?.className);const{variants:r,defaultVariants:o}=e,l=Object.keys(r).map(d=>{const m=t?.[d],g=o?.[d];if(m===null)return null;const p=fE(m)||fE(g);return r[d][p]}),c=t&&Object.entries(t).reduce((d,m)=>{let[g,p]=m;return p===void 0||(d[g]=p),d},{}),f=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((d,m)=>{let{class:g,className:p,...E}=m;return Object.entries(E).every(v=>{let[S,b]=v;return Array.isArray(b)?b.includes({...o,...c}[S]):{...o,...c}[S]===b})?[...d,g,p]:d},[]);return hE(s,l,f,t?.class,t?.className)};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iI=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),mE=s=>{const e=iI(s);return e.charAt(0).toUpperCase()+e.slice(1)},TT=(...s)=>s.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),rI=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var aI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=A.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:r="",children:o,iconNode:l,...c},f)=>A.createElement("svg",{ref:f,...aI,width:e,height:e,stroke:s,strokeWidth:n?Number(t)*24/Number(e):t,className:TT("lucide",r),...!o&&!rI(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,m])=>A.createElement(d,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=(s,e)=>{const t=A.forwardRef(({className:n,...r},o)=>A.createElement(oI,{ref:o,iconNode:e,className:TT(`lucide-${sI(mE(s))}`,`lucide-${s}`,n),...r}));return t.displayName=mE(s),t};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],_u=Ge("arrow-left",lI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],uI=Ge("calendar",cI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],fI=Ge("chevron-down",dI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],id=Ge("chevron-left",hI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],rd=Ge("chevron-right",mI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Vm=Ge("circle-alert",gI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],yI=Ge("circle-check",pI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Bg=Ge("clock",vI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],gE=Ge("download",xI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],pE=Ge("external-link",EI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Du=Ge("eye",SI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],TI=Ge("flame",bI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],RI=Ge("globe",AI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],LI=Ge("grid-3x3",wI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Km=Ge("heart",CI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],DI=Ge("history",_I);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Xh=Ge("house",II);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],$g=Ge("loader-circle",OI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],kI=Ge("map-pin",NI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],PI=Ge("maximize",MI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],UI=Ge("menu",FI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],AT=Ge("message-circle",BI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $I=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],jI=Ge("minimize",$I);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],HI=Ge("pause",GI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ni=Ge("play",zI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VI=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],RT=Ge("rotate-ccw",VI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"M13 3H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-3",key:"i8wdob"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"m17 8 5-5",key:"fqif7o"}],["path",{d:"M17 3h5v5",key:"1o3tu8"}]],qI=Ge("screen-share",KI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],du=Ge("search",YI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],XI=Ge("settings",WI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],ZI=Ge("shield-alert",QI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],eO=Ge("skip-back",JI);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tO=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],nO=Ge("skip-forward",tO);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sO=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],jg=Ge("tag",sO);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],rO=Ge("trash-2",iO);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],oO=Ge("user",aO);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lO=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],cO=Ge("volume-2",lO);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uO=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],dO=Ge("volume-x",uO);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ul=Ge("x",fO),Gg="-",hO=s=>{const e=gO(s),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:l=>{const c=l.split(Gg);return c[0]===""&&c.length!==1&&c.shift(),wT(c,e)||mO(l)},getConflictingClassGroupIds:(l,c)=>{const f=t[l]||[];return c&&n[l]?[...f,...n[l]]:f}}},wT=(s,e)=>{if(s.length===0)return e.classGroupId;const t=s[0],n=e.nextPart.get(t),r=n?wT(s.slice(1),n):void 0;if(r)return r;if(e.validators.length===0)return;const o=s.join(Gg);return e.validators.find(({validator:l})=>l(o))?.classGroupId},yE=/^\[(.+)\]$/,mO=s=>{if(yE.test(s)){const e=yE.exec(s)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},gO=s=>{const{theme:e,classGroups:t}=s,n={nextPart:new Map,validators:[]};for(const r in t)qm(t[r],n,r,e);return n},qm=(s,e,t,n)=>{s.forEach(r=>{if(typeof r=="string"){const o=r===""?e:vE(e,r);o.classGroupId=t;return}if(typeof r=="function"){if(pO(r)){qm(r(n),e,t,n);return}e.validators.push({validator:r,classGroupId:t});return}Object.entries(r).forEach(([o,l])=>{qm(l,vE(e,o),t,n)})})},vE=(s,e)=>{let t=s;return e.split(Gg).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},pO=s=>s.isThemeGetter,yO=s=>{if(s<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const r=(o,l)=>{t.set(o,l),e++,e>s&&(e=0,n=t,t=new Map)};return{get(o){let l=t.get(o);if(l!==void 0)return l;if((l=n.get(o))!==void 0)return r(o,l),l},set(o,l){t.has(o)?t.set(o,l):r(o,l)}}},Ym="!",Wm=":",vO=Wm.length,xO=s=>{const{prefix:e,experimentalParseClassName:t}=s;let n=r=>{const o=[];let l=0,c=0,f=0,d;for(let v=0;v<r.length;v++){let S=r[v];if(l===0&&c===0){if(S===Wm){o.push(r.slice(f,v)),f=v+vO;continue}if(S==="/"){d=v;continue}}S==="["?l++:S==="]"?l--:S==="("?c++:S===")"&&c--}const m=o.length===0?r:r.substring(f),g=EO(m),p=g!==m,E=d&&d>f?d-f:void 0;return{modifiers:o,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:E}};if(e){const r=e+Wm,o=n;n=l=>l.startsWith(r)?o(l.substring(r.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(t){const r=n;n=o=>t({className:o,parseClassName:r})}return n},EO=s=>s.endsWith(Ym)?s.substring(0,s.length-1):s.startsWith(Ym)?s.substring(1):s,SO=s=>{const e=Object.fromEntries(s.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const r=[];let o=[];return n.forEach(l=>{l[0]==="["||e[l]?(r.push(...o.sort(),l),o=[]):o.push(l)}),r.push(...o.sort()),r}},bO=s=>({cache:yO(s.cacheSize),parseClassName:xO(s),sortModifiers:SO(s),...hO(s)}),TO=/\s+/,AO=(s,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:r,sortModifiers:o}=e,l=[],c=s.trim().split(TO);let f="";for(let d=c.length-1;d>=0;d-=1){const m=c[d],{isExternal:g,modifiers:p,hasImportantModifier:E,baseClassName:v,maybePostfixModifierPosition:S}=t(m);if(g){f=m+(f.length>0?" "+f:f);continue}let b=!!S,R=n(b?v.substring(0,S):v);if(!R){if(!b){f=m+(f.length>0?" "+f:f);continue}if(R=n(v),!R){f=m+(f.length>0?" "+f:f);continue}b=!1}const C=o(p).join(":"),_=E?C+Ym:C,D=_+R;if(l.includes(D))continue;l.push(D);const N=r(R,b);for(let B=0;B<N.length;++B){const I=N[B];l.push(_+I)}f=m+(f.length>0?" "+f:f)}return f};function RO(){let s=0,e,t,n="";for(;s<arguments.length;)(e=arguments[s++])&&(t=LT(e))&&(n&&(n+=" "),n+=t);return n}const LT=s=>{if(typeof s=="string")return s;let e,t="";for(let n=0;n<s.length;n++)s[n]&&(e=LT(s[n]))&&(t&&(t+=" "),t+=e);return t};function wO(s,...e){let t,n,r,o=l;function l(f){const d=e.reduce((m,g)=>g(m),s());return t=bO(d),n=t.cache.get,r=t.cache.set,o=c,c(f)}function c(f){const d=n(f);if(d)return d;const m=AO(f,t);return r(f,m),m}return function(){return o(RO.apply(null,arguments))}}const Pt=s=>{const e=t=>t[s]||[];return e.isThemeGetter=!0,e},CT=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,_T=/^\((?:(\w[\w-]*):)?(.+)\)$/i,LO=/^\d+\/\d+$/,CO=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,_O=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,DO=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,IO=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,OO=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,fa=s=>LO.test(s),Be=s=>!!s&&!Number.isNaN(Number(s)),ki=s=>!!s&&Number.isInteger(Number(s)),Qh=s=>s.endsWith("%")&&Be(s.slice(0,-1)),Qs=s=>CO.test(s),NO=()=>!0,kO=s=>_O.test(s)&&!DO.test(s),DT=()=>!1,MO=s=>IO.test(s),PO=s=>OO.test(s),FO=s=>!Se(s)&&!be(s),UO=s=>Ba(s,NT,DT),Se=s=>CT.test(s),hr=s=>Ba(s,kT,kO),Zh=s=>Ba(s,HO,Be),xE=s=>Ba(s,IT,DT),BO=s=>Ba(s,OT,PO),Fc=s=>Ba(s,MT,MO),be=s=>_T.test(s),Bo=s=>$a(s,kT),$O=s=>$a(s,zO),EE=s=>$a(s,IT),jO=s=>$a(s,NT),GO=s=>$a(s,OT),Uc=s=>$a(s,MT,!0),Ba=(s,e,t)=>{const n=CT.exec(s);return n?n[1]?e(n[1]):t(n[2]):!1},$a=(s,e,t=!1)=>{const n=_T.exec(s);return n?n[1]?e(n[1]):t:!1},IT=s=>s==="position"||s==="percentage",OT=s=>s==="image"||s==="url",NT=s=>s==="length"||s==="size"||s==="bg-size",kT=s=>s==="length",HO=s=>s==="number",zO=s=>s==="family-name",MT=s=>s==="shadow",VO=()=>{const s=Pt("color"),e=Pt("font"),t=Pt("text"),n=Pt("font-weight"),r=Pt("tracking"),o=Pt("leading"),l=Pt("breakpoint"),c=Pt("container"),f=Pt("spacing"),d=Pt("radius"),m=Pt("shadow"),g=Pt("inset-shadow"),p=Pt("text-shadow"),E=Pt("drop-shadow"),v=Pt("blur"),S=Pt("perspective"),b=Pt("aspect"),R=Pt("ease"),C=Pt("animate"),_=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],N=()=>[...D(),be,Se],B=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto","contain","none"],P=()=>[be,Se,f],M=()=>[fa,"full","auto",...P()],U=()=>[ki,"none","subgrid",be,Se],q=()=>["auto",{span:["full",ki,be,Se]},ki,be,Se],V=()=>[ki,"auto",be,Se],ee=()=>["auto","min","max","fr",be,Se],Z=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],re=()=>["start","end","center","stretch","center-safe","end-safe"],F=()=>["auto",...P()],z=()=>[fa,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...P()],j=()=>[s,be,Se],oe=()=>[...D(),EE,xE,{position:[be,Se]}],fe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],k=()=>["auto","cover","contain",jO,UO,{size:[be,Se]}],G=()=>[Qh,Bo,hr],te=()=>["","none","full",d,be,Se],le=()=>["",Be,Bo,hr],he=()=>["solid","dashed","dotted","double"],pe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ye=()=>[Be,Qh,EE,xE],Ne=()=>["","none",v,be,Se],De=()=>["none",Be,be,Se],dt=()=>["none",Be,be,Se],ot=()=>[Be,be,Se],we=()=>[fa,"full",...P()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Qs],breakpoint:[Qs],color:[NO],container:[Qs],"drop-shadow":[Qs],ease:["in","out","in-out"],font:[FO],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Qs],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Qs],shadow:[Qs],spacing:["px",Be],text:[Qs],"text-shadow":[Qs],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",fa,Se,be,b]}],container:["container"],columns:[{columns:[Be,Se,be,c]}],"break-after":[{"break-after":_()}],"break-before":[{"break-before":_()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:N()}],overflow:[{overflow:B()}],"overflow-x":[{"overflow-x":B()}],"overflow-y":[{"overflow-y":B()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:M()}],"inset-x":[{"inset-x":M()}],"inset-y":[{"inset-y":M()}],start:[{start:M()}],end:[{end:M()}],top:[{top:M()}],right:[{right:M()}],bottom:[{bottom:M()}],left:[{left:M()}],visibility:["visible","invisible","collapse"],z:[{z:[ki,"auto",be,Se]}],basis:[{basis:[fa,"full","auto",c,...P()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Be,fa,"auto","initial","none",Se]}],grow:[{grow:["",Be,be,Se]}],shrink:[{shrink:["",Be,be,Se]}],order:[{order:[ki,"first","last","none",be,Se]}],"grid-cols":[{"grid-cols":U()}],"col-start-end":[{col:q()}],"col-start":[{"col-start":V()}],"col-end":[{"col-end":V()}],"grid-rows":[{"grid-rows":U()}],"row-start-end":[{row:q()}],"row-start":[{"row-start":V()}],"row-end":[{"row-end":V()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ee()}],"auto-rows":[{"auto-rows":ee()}],gap:[{gap:P()}],"gap-x":[{"gap-x":P()}],"gap-y":[{"gap-y":P()}],"justify-content":[{justify:[...Z(),"normal"]}],"justify-items":[{"justify-items":[...re(),"normal"]}],"justify-self":[{"justify-self":["auto",...re()]}],"align-content":[{content:["normal",...Z()]}],"align-items":[{items:[...re(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...re(),{baseline:["","last"]}]}],"place-content":[{"place-content":Z()}],"place-items":[{"place-items":[...re(),"baseline"]}],"place-self":[{"place-self":["auto",...re()]}],p:[{p:P()}],px:[{px:P()}],py:[{py:P()}],ps:[{ps:P()}],pe:[{pe:P()}],pt:[{pt:P()}],pr:[{pr:P()}],pb:[{pb:P()}],pl:[{pl:P()}],m:[{m:F()}],mx:[{mx:F()}],my:[{my:F()}],ms:[{ms:F()}],me:[{me:F()}],mt:[{mt:F()}],mr:[{mr:F()}],mb:[{mb:F()}],ml:[{ml:F()}],"space-x":[{"space-x":P()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":P()}],"space-y-reverse":["space-y-reverse"],size:[{size:z()}],w:[{w:[c,"screen",...z()]}],"min-w":[{"min-w":[c,"screen","none",...z()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[l]},...z()]}],h:[{h:["screen","lh",...z()]}],"min-h":[{"min-h":["screen","lh","none",...z()]}],"max-h":[{"max-h":["screen","lh",...z()]}],"font-size":[{text:["base",t,Bo,hr]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,be,Zh]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Qh,Se]}],"font-family":[{font:[$O,Se,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,be,Se]}],"line-clamp":[{"line-clamp":[Be,"none",be,Zh]}],leading:[{leading:[o,...P()]}],"list-image":[{"list-image":["none",be,Se]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",be,Se]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:j()}],"text-color":[{text:j()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...he(),"wavy"]}],"text-decoration-thickness":[{decoration:[Be,"from-font","auto",be,hr]}],"text-decoration-color":[{decoration:j()}],"underline-offset":[{"underline-offset":[Be,"auto",be,Se]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",be,Se]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",be,Se]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:oe()}],"bg-repeat":[{bg:fe()}],"bg-size":[{bg:k()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ki,be,Se],radial:["",be,Se],conic:[ki,be,Se]},GO,BO]}],"bg-color":[{bg:j()}],"gradient-from-pos":[{from:G()}],"gradient-via-pos":[{via:G()}],"gradient-to-pos":[{to:G()}],"gradient-from":[{from:j()}],"gradient-via":[{via:j()}],"gradient-to":[{to:j()}],rounded:[{rounded:te()}],"rounded-s":[{"rounded-s":te()}],"rounded-e":[{"rounded-e":te()}],"rounded-t":[{"rounded-t":te()}],"rounded-r":[{"rounded-r":te()}],"rounded-b":[{"rounded-b":te()}],"rounded-l":[{"rounded-l":te()}],"rounded-ss":[{"rounded-ss":te()}],"rounded-se":[{"rounded-se":te()}],"rounded-ee":[{"rounded-ee":te()}],"rounded-es":[{"rounded-es":te()}],"rounded-tl":[{"rounded-tl":te()}],"rounded-tr":[{"rounded-tr":te()}],"rounded-br":[{"rounded-br":te()}],"rounded-bl":[{"rounded-bl":te()}],"border-w":[{border:le()}],"border-w-x":[{"border-x":le()}],"border-w-y":[{"border-y":le()}],"border-w-s":[{"border-s":le()}],"border-w-e":[{"border-e":le()}],"border-w-t":[{"border-t":le()}],"border-w-r":[{"border-r":le()}],"border-w-b":[{"border-b":le()}],"border-w-l":[{"border-l":le()}],"divide-x":[{"divide-x":le()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":le()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...he(),"hidden","none"]}],"divide-style":[{divide:[...he(),"hidden","none"]}],"border-color":[{border:j()}],"border-color-x":[{"border-x":j()}],"border-color-y":[{"border-y":j()}],"border-color-s":[{"border-s":j()}],"border-color-e":[{"border-e":j()}],"border-color-t":[{"border-t":j()}],"border-color-r":[{"border-r":j()}],"border-color-b":[{"border-b":j()}],"border-color-l":[{"border-l":j()}],"divide-color":[{divide:j()}],"outline-style":[{outline:[...he(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Be,be,Se]}],"outline-w":[{outline:["",Be,Bo,hr]}],"outline-color":[{outline:j()}],shadow:[{shadow:["","none",m,Uc,Fc]}],"shadow-color":[{shadow:j()}],"inset-shadow":[{"inset-shadow":["none",g,Uc,Fc]}],"inset-shadow-color":[{"inset-shadow":j()}],"ring-w":[{ring:le()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:j()}],"ring-offset-w":[{"ring-offset":[Be,hr]}],"ring-offset-color":[{"ring-offset":j()}],"inset-ring-w":[{"inset-ring":le()}],"inset-ring-color":[{"inset-ring":j()}],"text-shadow":[{"text-shadow":["none",p,Uc,Fc]}],"text-shadow-color":[{"text-shadow":j()}],opacity:[{opacity:[Be,be,Se]}],"mix-blend":[{"mix-blend":[...pe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":pe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Be]}],"mask-image-linear-from-pos":[{"mask-linear-from":ye()}],"mask-image-linear-to-pos":[{"mask-linear-to":ye()}],"mask-image-linear-from-color":[{"mask-linear-from":j()}],"mask-image-linear-to-color":[{"mask-linear-to":j()}],"mask-image-t-from-pos":[{"mask-t-from":ye()}],"mask-image-t-to-pos":[{"mask-t-to":ye()}],"mask-image-t-from-color":[{"mask-t-from":j()}],"mask-image-t-to-color":[{"mask-t-to":j()}],"mask-image-r-from-pos":[{"mask-r-from":ye()}],"mask-image-r-to-pos":[{"mask-r-to":ye()}],"mask-image-r-from-color":[{"mask-r-from":j()}],"mask-image-r-to-color":[{"mask-r-to":j()}],"mask-image-b-from-pos":[{"mask-b-from":ye()}],"mask-image-b-to-pos":[{"mask-b-to":ye()}],"mask-image-b-from-color":[{"mask-b-from":j()}],"mask-image-b-to-color":[{"mask-b-to":j()}],"mask-image-l-from-pos":[{"mask-l-from":ye()}],"mask-image-l-to-pos":[{"mask-l-to":ye()}],"mask-image-l-from-color":[{"mask-l-from":j()}],"mask-image-l-to-color":[{"mask-l-to":j()}],"mask-image-x-from-pos":[{"mask-x-from":ye()}],"mask-image-x-to-pos":[{"mask-x-to":ye()}],"mask-image-x-from-color":[{"mask-x-from":j()}],"mask-image-x-to-color":[{"mask-x-to":j()}],"mask-image-y-from-pos":[{"mask-y-from":ye()}],"mask-image-y-to-pos":[{"mask-y-to":ye()}],"mask-image-y-from-color":[{"mask-y-from":j()}],"mask-image-y-to-color":[{"mask-y-to":j()}],"mask-image-radial":[{"mask-radial":[be,Se]}],"mask-image-radial-from-pos":[{"mask-radial-from":ye()}],"mask-image-radial-to-pos":[{"mask-radial-to":ye()}],"mask-image-radial-from-color":[{"mask-radial-from":j()}],"mask-image-radial-to-color":[{"mask-radial-to":j()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":D()}],"mask-image-conic-pos":[{"mask-conic":[Be]}],"mask-image-conic-from-pos":[{"mask-conic-from":ye()}],"mask-image-conic-to-pos":[{"mask-conic-to":ye()}],"mask-image-conic-from-color":[{"mask-conic-from":j()}],"mask-image-conic-to-color":[{"mask-conic-to":j()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:oe()}],"mask-repeat":[{mask:fe()}],"mask-size":[{mask:k()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",be,Se]}],filter:[{filter:["","none",be,Se]}],blur:[{blur:Ne()}],brightness:[{brightness:[Be,be,Se]}],contrast:[{contrast:[Be,be,Se]}],"drop-shadow":[{"drop-shadow":["","none",E,Uc,Fc]}],"drop-shadow-color":[{"drop-shadow":j()}],grayscale:[{grayscale:["",Be,be,Se]}],"hue-rotate":[{"hue-rotate":[Be,be,Se]}],invert:[{invert:["",Be,be,Se]}],saturate:[{saturate:[Be,be,Se]}],sepia:[{sepia:["",Be,be,Se]}],"backdrop-filter":[{"backdrop-filter":["","none",be,Se]}],"backdrop-blur":[{"backdrop-blur":Ne()}],"backdrop-brightness":[{"backdrop-brightness":[Be,be,Se]}],"backdrop-contrast":[{"backdrop-contrast":[Be,be,Se]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Be,be,Se]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Be,be,Se]}],"backdrop-invert":[{"backdrop-invert":["",Be,be,Se]}],"backdrop-opacity":[{"backdrop-opacity":[Be,be,Se]}],"backdrop-saturate":[{"backdrop-saturate":[Be,be,Se]}],"backdrop-sepia":[{"backdrop-sepia":["",Be,be,Se]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":P()}],"border-spacing-x":[{"border-spacing-x":P()}],"border-spacing-y":[{"border-spacing-y":P()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",be,Se]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Be,"initial",be,Se]}],ease:[{ease:["linear","initial",R,be,Se]}],delay:[{delay:[Be,be,Se]}],animate:[{animate:["none",C,be,Se]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[S,be,Se]}],"perspective-origin":[{"perspective-origin":N()}],rotate:[{rotate:De()}],"rotate-x":[{"rotate-x":De()}],"rotate-y":[{"rotate-y":De()}],"rotate-z":[{"rotate-z":De()}],scale:[{scale:dt()}],"scale-x":[{"scale-x":dt()}],"scale-y":[{"scale-y":dt()}],"scale-z":[{"scale-z":dt()}],"scale-3d":["scale-3d"],skew:[{skew:ot()}],"skew-x":[{"skew-x":ot()}],"skew-y":[{"skew-y":ot()}],transform:[{transform:[be,Se,"","none","gpu","cpu"]}],"transform-origin":[{origin:N()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:we()}],"translate-x":[{"translate-x":we()}],"translate-y":[{"translate-y":we()}],"translate-z":[{"translate-z":we()}],"translate-none":["translate-none"],accent:[{accent:j()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:j()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",be,Se]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",be,Se]}],fill:[{fill:["none",...j()]}],"stroke-w":[{stroke:[Be,Bo,hr,Zh]}],stroke:[{stroke:["none",...j()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},KO=wO(VO);function Oe(...s){return KO(bT(s))}const SE="https://www.xvideos.com/";function qO(s){return s.startsWith(SE)?s.slice(SE.length):s.startsWith("http://www.xvideos.com/")?s.slice(23):s}function Qo(s){const e=qO(s);return`/watch?url=${encodeURIComponent(e)}`}const YO=nI,PT=A.forwardRef(({className:s,...e},t)=>T.jsx(gT,{ref:t,className:Oe("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...e}));PT.displayName=gT.displayName;const WO=Ug("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),FT=A.forwardRef(({className:s,variant:e,...t},n)=>T.jsx(pT,{ref:n,className:Oe(WO({variant:e}),s),...t}));FT.displayName=pT.displayName;const XO=A.forwardRef(({className:s,...e},t)=>T.jsx(xT,{ref:t,className:Oe("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...e}));XO.displayName=xT.displayName;const UT=A.forwardRef(({className:s,...e},t)=>T.jsx(ET,{ref:t,className:Oe("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...e,children:T.jsx(ul,{className:"h-4 w-4"})}));UT.displayName=ET.displayName;const BT=A.forwardRef(({className:s,...e},t)=>T.jsx(yT,{ref:t,className:Oe("text-sm font-semibold",s),...e}));BT.displayName=yT.displayName;const $T=A.forwardRef(({className:s,...e},t)=>T.jsx(vT,{ref:t,className:Oe("text-sm opacity-90",s),...e}));$T.displayName=vT.displayName;function QO(){const{toasts:s}=Kb();return T.jsxs(YO,{children:[s.map(function({id:e,title:t,description:n,action:r,...o}){return T.jsxs(FT,{...o,children:[T.jsxs("div",{className:"grid gap-1",children:[t&&T.jsx(BT,{children:t}),n&&T.jsx($T,{children:n})]}),r,T.jsx(UT,{})]},e)}),T.jsx(PT,{})]})}function ha(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}function Jh(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}function ZO(s){const e=JO(s),t=A.forwardRef((n,r)=>{const{children:o,...l}=n,c=A.Children.toArray(o),f=c.find(tN);if(f){const d=f.props.children,m=c.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}function JO(s){const e=A.forwardRef((t,n)=>{const{children:r,...o}=t;if(A.isValidElement(r)){const l=sN(r),c=nN(o,r.props);return r.type!==A.Fragment&&(c.ref=n?cl(n,l):l),A.cloneElement(r,c)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var eN=Symbol("radix.slottable");function tN(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===eN}function nN(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...c)=>{const f=o(...c);return r(...c),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function sN(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var iN=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Bt=iN.reduce((s,e)=>{const t=ZO(`Primitive.${e}`),n=A.forwardRef((r,o)=>{const{asChild:l,...c}=r,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),T.jsx(f,{...c,ref:o})});return n.displayName=`Primitive.${e}`,{...s,[e]:n}},{});function rN(s,e){s&&ll.flushSync(()=>s.dispatchEvent(e))}var aN="DismissableLayer",Xm="dismissableLayer.update",oN="dismissableLayer.pointerDownOutside",lN="dismissableLayer.focusOutside",bE,jT=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Hg=A.forwardRef((s,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...f}=s,d=A.useContext(jT),[m,g]=A.useState(null),p=m?.ownerDocument??globalThis?.document,[,E]=A.useState({}),v=mt(e,I=>g(I)),S=Array.from(d.layers),[b]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),R=S.indexOf(b),C=m?S.indexOf(m):-1,_=d.layersWithOutsidePointerEventsDisabled.size>0,D=C>=R,N=dN(I=>{const P=I.target,M=[...d.branches].some(U=>U.contains(P));!D||M||(r?.(I),l?.(I),I.defaultPrevented||c?.())},p),B=fN(I=>{const P=I.target;[...d.branches].some(U=>U.contains(P))||(o?.(I),l?.(I),I.defaultPrevented||c?.())},p);return Wb(I=>{C===d.layers.size-1&&(n?.(I),!I.defaultPrevented&&c&&(I.preventDefault(),c()))},p),A.useEffect(()=>{if(m)return t&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(bE=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(m)),d.layers.add(m),TE(),()=>{t&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=bE)}},[m,p,t,d]),A.useEffect(()=>()=>{m&&(d.layers.delete(m),d.layersWithOutsidePointerEventsDisabled.delete(m),TE())},[m,d]),A.useEffect(()=>{const I=()=>E({});return document.addEventListener(Xm,I),()=>document.removeEventListener(Xm,I)},[]),T.jsx(Bt.div,{...f,ref:v,style:{pointerEvents:_?D?"auto":"none":void 0,...s.style},onFocusCapture:Jh(s.onFocusCapture,B.onFocusCapture),onBlurCapture:Jh(s.onBlurCapture,B.onBlurCapture),onPointerDownCapture:Jh(s.onPointerDownCapture,N.onPointerDownCapture)})});Hg.displayName=aN;var cN="DismissableLayerBranch",uN=A.forwardRef((s,e)=>{const t=A.useContext(jT),n=A.useRef(null),r=mt(e,n);return A.useEffect(()=>{const o=n.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),T.jsx(Bt.div,{...s,ref:r})});uN.displayName=cN;function dN(s,e=globalThis?.document){const t=Ct(s),n=A.useRef(!1),r=A.useRef(()=>{});return A.useEffect(()=>{const o=c=>{if(c.target&&!n.current){let f=function(){GT(oN,t,d,{discrete:!0})};const d={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=f,e.addEventListener("click",r.current,{once:!0})):f()}else e.removeEventListener("click",r.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",r.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function fN(s,e=globalThis?.document){const t=Ct(s),n=A.useRef(!1);return A.useEffect(()=>{const r=o=>{o.target&&!n.current&&GT(lN,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function TE(){const s=new CustomEvent(Xm);document.dispatchEvent(s)}function GT(s,e,t,{discrete:n}){const r=t.originalEvent.target,o=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:t});e&&r.addEventListener(s,e,{once:!0}),n?rN(r,o):r.dispatchEvent(o)}var hN=Zu[" useId ".trim().toString()]||(()=>{}),mN=0;function em(s){const[e,t]=A.useState(hN());return kn(()=>{t(n=>n??String(mN++))},[s]),s||(e?`radix-${e}`:"")}const gN=["top","right","bottom","left"],Gi=Math.min,_n=Math.max,Iu=Math.round,Bc=Math.floor,Ts=s=>({x:s,y:s}),pN={left:"right",right:"left",bottom:"top",top:"bottom"},yN={start:"end",end:"start"};function Qm(s,e,t){return _n(s,Gi(e,t))}function si(s,e){return typeof s=="function"?s(e):s}function ii(s){return s.split("-")[0]}function ja(s){return s.split("-")[1]}function zg(s){return s==="x"?"y":"x"}function Vg(s){return s==="y"?"height":"width"}const vN=new Set(["top","bottom"]);function Es(s){return vN.has(ii(s))?"y":"x"}function Kg(s){return zg(Es(s))}function xN(s,e,t){t===void 0&&(t=!1);const n=ja(s),r=Kg(s),o=Vg(r);let l=r==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(l=Ou(l)),[l,Ou(l)]}function EN(s){const e=Ou(s);return[Zm(s),e,Zm(e)]}function Zm(s){return s.replace(/start|end/g,e=>yN[e])}const AE=["left","right"],RE=["right","left"],SN=["top","bottom"],bN=["bottom","top"];function TN(s,e,t){switch(s){case"top":case"bottom":return t?e?RE:AE:e?AE:RE;case"left":case"right":return e?SN:bN;default:return[]}}function AN(s,e,t,n){const r=ja(s);let o=TN(ii(s),t==="start",n);return r&&(o=o.map(l=>l+"-"+r),e&&(o=o.concat(o.map(Zm)))),o}function Ou(s){return s.replace(/left|right|bottom|top/g,e=>pN[e])}function RN(s){return{top:0,right:0,bottom:0,left:0,...s}}function HT(s){return typeof s!="number"?RN(s):{top:s,right:s,bottom:s,left:s}}function Nu(s){const{x:e,y:t,width:n,height:r}=s;return{width:n,height:r,top:t,left:e,right:e+n,bottom:t+r,x:e,y:t}}function wE(s,e,t){let{reference:n,floating:r}=s;const o=Es(e),l=Kg(e),c=Vg(l),f=ii(e),d=o==="y",m=n.x+n.width/2-r.width/2,g=n.y+n.height/2-r.height/2,p=n[c]/2-r[c]/2;let E;switch(f){case"top":E={x:m,y:n.y-r.height};break;case"bottom":E={x:m,y:n.y+n.height};break;case"right":E={x:n.x+n.width,y:g};break;case"left":E={x:n.x-r.width,y:g};break;default:E={x:n.x,y:n.y}}switch(ja(e)){case"start":E[l]-=p*(t&&d?-1:1);break;case"end":E[l]+=p*(t&&d?-1:1);break}return E}const wN=async(s,e,t)=>{const{placement:n="bottom",strategy:r="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(e));let d=await l.getElementRects({reference:s,floating:e,strategy:r}),{x:m,y:g}=wE(d,n,f),p=n,E={},v=0;for(let S=0;S<c.length;S++){const{name:b,fn:R}=c[S],{x:C,y:_,data:D,reset:N}=await R({x:m,y:g,initialPlacement:n,placement:p,strategy:r,middlewareData:E,rects:d,platform:l,elements:{reference:s,floating:e}});m=C??m,g=_??g,E={...E,[b]:{...E[b],...D}},N&&v<=50&&(v++,typeof N=="object"&&(N.placement&&(p=N.placement),N.rects&&(d=N.rects===!0?await l.getElementRects({reference:s,floating:e,strategy:r}):N.rects),{x:m,y:g}=wE(d,p,f)),S=-1)}return{x:m,y:g,placement:p,strategy:r,middlewareData:E}};async function Zo(s,e){var t;e===void 0&&(e={});const{x:n,y:r,platform:o,rects:l,elements:c,strategy:f}=s,{boundary:d="clippingAncestors",rootBoundary:m="viewport",elementContext:g="floating",altBoundary:p=!1,padding:E=0}=si(e,s),v=HT(E),b=c[p?g==="floating"?"reference":"floating":g],R=Nu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(b)))==null||t?b:b.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:d,rootBoundary:m,strategy:f})),C=g==="floating"?{x:n,y:r,width:l.floating.width,height:l.floating.height}:l.reference,_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),D=await(o.isElement==null?void 0:o.isElement(_))?await(o.getScale==null?void 0:o.getScale(_))||{x:1,y:1}:{x:1,y:1},N=Nu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:C,offsetParent:_,strategy:f}):C);return{top:(R.top-N.top+v.top)/D.y,bottom:(N.bottom-R.bottom+v.bottom)/D.y,left:(R.left-N.left+v.left)/D.x,right:(N.right-R.right+v.right)/D.x}}const LN=s=>({name:"arrow",options:s,async fn(e){const{x:t,y:n,placement:r,rects:o,platform:l,elements:c,middlewareData:f}=e,{element:d,padding:m=0}=si(s,e)||{};if(d==null)return{};const g=HT(m),p={x:t,y:n},E=Kg(r),v=Vg(E),S=await l.getDimensions(d),b=E==="y",R=b?"top":"left",C=b?"bottom":"right",_=b?"clientHeight":"clientWidth",D=o.reference[v]+o.reference[E]-p[E]-o.floating[v],N=p[E]-o.reference[E],B=await(l.getOffsetParent==null?void 0:l.getOffsetParent(d));let I=B?B[_]:0;(!I||!await(l.isElement==null?void 0:l.isElement(B)))&&(I=c.floating[_]||o.floating[v]);const P=D/2-N/2,M=I/2-S[v]/2-1,U=Gi(g[R],M),q=Gi(g[C],M),V=U,ee=I-S[v]-q,Z=I/2-S[v]/2+P,re=Qm(V,Z,ee),F=!f.arrow&&ja(r)!=null&&Z!==re&&o.reference[v]/2-(Z<V?U:q)-S[v]/2<0,z=F?Z<V?Z-V:Z-ee:0;return{[E]:p[E]+z,data:{[E]:re,centerOffset:Z-re-z,...F&&{alignmentOffset:z}},reset:F}}}),CN=function(s){return s===void 0&&(s={}),{name:"flip",options:s,async fn(e){var t,n;const{placement:r,middlewareData:o,rects:l,initialPlacement:c,platform:f,elements:d}=e,{mainAxis:m=!0,crossAxis:g=!0,fallbackPlacements:p,fallbackStrategy:E="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:S=!0,...b}=si(s,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const R=ii(r),C=Es(c),_=ii(c)===c,D=await(f.isRTL==null?void 0:f.isRTL(d.floating)),N=p||(_||!S?[Ou(c)]:EN(c)),B=v!=="none";!p&&B&&N.push(...AN(c,S,v,D));const I=[c,...N],P=await Zo(e,b),M=[];let U=((n=o.flip)==null?void 0:n.overflows)||[];if(m&&M.push(P[R]),g){const Z=xN(r,l,D);M.push(P[Z[0]],P[Z[1]])}if(U=[...U,{placement:r,overflows:M}],!M.every(Z=>Z<=0)){var q,V;const Z=(((q=o.flip)==null?void 0:q.index)||0)+1,re=I[Z];if(re&&(!(g==="alignment"?C!==Es(re):!1)||U.every(j=>Es(j.placement)===C?j.overflows[0]>0:!0)))return{data:{index:Z,overflows:U},reset:{placement:re}};let F=(V=U.filter(z=>z.overflows[0]<=0).sort((z,j)=>z.overflows[1]-j.overflows[1])[0])==null?void 0:V.placement;if(!F)switch(E){case"bestFit":{var ee;const z=(ee=U.filter(j=>{if(B){const oe=Es(j.placement);return oe===C||oe==="y"}return!0}).map(j=>[j.placement,j.overflows.filter(oe=>oe>0).reduce((oe,fe)=>oe+fe,0)]).sort((j,oe)=>j[1]-oe[1])[0])==null?void 0:ee[0];z&&(F=z);break}case"initialPlacement":F=c;break}if(r!==F)return{reset:{placement:F}}}return{}}}};function LE(s,e){return{top:s.top-e.height,right:s.right-e.width,bottom:s.bottom-e.height,left:s.left-e.width}}function CE(s){return gN.some(e=>s[e]>=0)}const _N=function(s){return s===void 0&&(s={}),{name:"hide",options:s,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...r}=si(s,e);switch(n){case"referenceHidden":{const o=await Zo(e,{...r,elementContext:"reference"}),l=LE(o,t.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:CE(l)}}}case"escaped":{const o=await Zo(e,{...r,altBoundary:!0}),l=LE(o,t.floating);return{data:{escapedOffsets:l,escaped:CE(l)}}}default:return{}}}}},zT=new Set(["left","top"]);async function DN(s,e){const{placement:t,platform:n,elements:r}=s,o=await(n.isRTL==null?void 0:n.isRTL(r.floating)),l=ii(t),c=ja(t),f=Es(t)==="y",d=zT.has(l)?-1:1,m=o&&f?-1:1,g=si(e,s);let{mainAxis:p,crossAxis:E,alignmentAxis:v}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return c&&typeof v=="number"&&(E=c==="end"?v*-1:v),f?{x:E*m,y:p*d}:{x:p*d,y:E*m}}const IN=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(e){var t,n;const{x:r,y:o,placement:l,middlewareData:c}=e,f=await DN(e,s);return l===((t=c.offset)==null?void 0:t.placement)&&(n=c.arrow)!=null&&n.alignmentOffset?{}:{x:r+f.x,y:o+f.y,data:{...f,placement:l}}}}},ON=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(e){const{x:t,y:n,placement:r}=e,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:b=>{let{x:R,y:C}=b;return{x:R,y:C}}},...f}=si(s,e),d={x:t,y:n},m=await Zo(e,f),g=Es(ii(r)),p=zg(g);let E=d[p],v=d[g];if(o){const b=p==="y"?"top":"left",R=p==="y"?"bottom":"right",C=E+m[b],_=E-m[R];E=Qm(C,E,_)}if(l){const b=g==="y"?"top":"left",R=g==="y"?"bottom":"right",C=v+m[b],_=v-m[R];v=Qm(C,v,_)}const S=c.fn({...e,[p]:E,[g]:v});return{...S,data:{x:S.x-t,y:S.y-n,enabled:{[p]:o,[g]:l}}}}}},NN=function(s){return s===void 0&&(s={}),{options:s,fn(e){const{x:t,y:n,placement:r,rects:o,middlewareData:l}=e,{offset:c=0,mainAxis:f=!0,crossAxis:d=!0}=si(s,e),m={x:t,y:n},g=Es(r),p=zg(g);let E=m[p],v=m[g];const S=si(c,e),b=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(f){const _=p==="y"?"height":"width",D=o.reference[p]-o.floating[_]+b.mainAxis,N=o.reference[p]+o.reference[_]-b.mainAxis;E<D?E=D:E>N&&(E=N)}if(d){var R,C;const _=p==="y"?"width":"height",D=zT.has(ii(r)),N=o.reference[g]-o.floating[_]+(D&&((R=l.offset)==null?void 0:R[g])||0)+(D?0:b.crossAxis),B=o.reference[g]+o.reference[_]+(D?0:((C=l.offset)==null?void 0:C[g])||0)-(D?b.crossAxis:0);v<N?v=N:v>B&&(v=B)}return{[p]:E,[g]:v}}}},kN=function(s){return s===void 0&&(s={}),{name:"size",options:s,async fn(e){var t,n;const{placement:r,rects:o,platform:l,elements:c}=e,{apply:f=()=>{},...d}=si(s,e),m=await Zo(e,d),g=ii(r),p=ja(r),E=Es(r)==="y",{width:v,height:S}=o.floating;let b,R;g==="top"||g==="bottom"?(b=g,R=p===(await(l.isRTL==null?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(R=g,b=p==="end"?"top":"bottom");const C=S-m.top-m.bottom,_=v-m.left-m.right,D=Gi(S-m[b],C),N=Gi(v-m[R],_),B=!e.middlewareData.shift;let I=D,P=N;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(P=_),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(I=C),B&&!p){const U=_n(m.left,0),q=_n(m.right,0),V=_n(m.top,0),ee=_n(m.bottom,0);E?P=v-2*(U!==0||q!==0?U+q:_n(m.left,m.right)):I=S-2*(V!==0||ee!==0?V+ee:_n(m.top,m.bottom))}await f({...e,availableWidth:P,availableHeight:I});const M=await l.getDimensions(c.floating);return v!==M.width||S!==M.height?{reset:{rects:!0}}:{}}}};function ad(){return typeof window<"u"}function Ga(s){return VT(s)?(s.nodeName||"").toLowerCase():"#document"}function On(s){var e;return(s==null||(e=s.ownerDocument)==null?void 0:e.defaultView)||window}function Cs(s){var e;return(e=(VT(s)?s.ownerDocument:s.document)||window.document)==null?void 0:e.documentElement}function VT(s){return ad()?s instanceof Node||s instanceof On(s).Node:!1}function is(s){return ad()?s instanceof Element||s instanceof On(s).Element:!1}function As(s){return ad()?s instanceof HTMLElement||s instanceof On(s).HTMLElement:!1}function _E(s){return!ad()||typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof On(s).ShadowRoot}const MN=new Set(["inline","contents"]);function dl(s){const{overflow:e,overflowX:t,overflowY:n,display:r}=rs(s);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!MN.has(r)}const PN=new Set(["table","td","th"]);function FN(s){return PN.has(Ga(s))}const UN=[":popover-open",":modal"];function od(s){return UN.some(e=>{try{return s.matches(e)}catch{return!1}})}const BN=["transform","translate","scale","rotate","perspective"],$N=["transform","translate","scale","rotate","perspective","filter"],jN=["paint","layout","strict","content"];function qg(s){const e=Yg(),t=is(s)?rs(s):s;return BN.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||$N.some(n=>(t.willChange||"").includes(n))||jN.some(n=>(t.contain||"").includes(n))}function GN(s){let e=Hi(s);for(;As(e)&&!Na(e);){if(qg(e))return e;if(od(e))return null;e=Hi(e)}return null}function Yg(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const HN=new Set(["html","body","#document"]);function Na(s){return HN.has(Ga(s))}function rs(s){return On(s).getComputedStyle(s)}function ld(s){return is(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.scrollX,scrollTop:s.scrollY}}function Hi(s){if(Ga(s)==="html")return s;const e=s.assignedSlot||s.parentNode||_E(s)&&s.host||Cs(s);return _E(e)?e.host:e}function KT(s){const e=Hi(s);return Na(e)?s.ownerDocument?s.ownerDocument.body:s.body:As(e)&&dl(e)?e:KT(e)}function Jo(s,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const r=KT(s),o=r===((n=s.ownerDocument)==null?void 0:n.body),l=On(r);if(o){const c=Jm(l);return e.concat(l,l.visualViewport||[],dl(r)?r:[],c&&t?Jo(c):[])}return e.concat(r,Jo(r,[],t))}function Jm(s){return s.parent&&Object.getPrototypeOf(s.parent)?s.frameElement:null}function qT(s){const e=rs(s);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const r=As(s),o=r?s.offsetWidth:t,l=r?s.offsetHeight:n,c=Iu(t)!==o||Iu(n)!==l;return c&&(t=o,n=l),{width:t,height:n,$:c}}function Wg(s){return is(s)?s:s.contextElement}function wa(s){const e=Wg(s);if(!As(e))return Ts(1);const t=e.getBoundingClientRect(),{width:n,height:r,$:o}=qT(e);let l=(o?Iu(t.width):t.width)/n,c=(o?Iu(t.height):t.height)/r;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const zN=Ts(0);function YT(s){const e=On(s);return!Yg()||!e.visualViewport?zN:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function VN(s,e,t){return e===void 0&&(e=!1),!t||e&&t!==On(s)?!1:e}function Sr(s,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const r=s.getBoundingClientRect(),o=Wg(s);let l=Ts(1);e&&(n?is(n)&&(l=wa(n)):l=wa(s));const c=VN(o,t,n)?YT(o):Ts(0);let f=(r.left+c.x)/l.x,d=(r.top+c.y)/l.y,m=r.width/l.x,g=r.height/l.y;if(o){const p=On(o),E=n&&is(n)?On(n):n;let v=p,S=Jm(v);for(;S&&n&&E!==v;){const b=wa(S),R=S.getBoundingClientRect(),C=rs(S),_=R.left+(S.clientLeft+parseFloat(C.paddingLeft))*b.x,D=R.top+(S.clientTop+parseFloat(C.paddingTop))*b.y;f*=b.x,d*=b.y,m*=b.x,g*=b.y,f+=_,d+=D,v=On(S),S=Jm(v)}}return Nu({width:m,height:g,x:f,y:d})}function cd(s,e){const t=ld(s).scrollLeft;return e?e.left+t:Sr(Cs(s)).left+t}function WT(s,e){const t=s.getBoundingClientRect(),n=t.left+e.scrollLeft-cd(s,t),r=t.top+e.scrollTop;return{x:n,y:r}}function KN(s){let{elements:e,rect:t,offsetParent:n,strategy:r}=s;const o=r==="fixed",l=Cs(n),c=e?od(e.floating):!1;if(n===l||c&&o)return t;let f={scrollLeft:0,scrollTop:0},d=Ts(1);const m=Ts(0),g=As(n);if((g||!g&&!o)&&((Ga(n)!=="body"||dl(l))&&(f=ld(n)),As(n))){const E=Sr(n);d=wa(n),m.x=E.x+n.clientLeft,m.y=E.y+n.clientTop}const p=l&&!g&&!o?WT(l,f):Ts(0);return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-f.scrollLeft*d.x+m.x+p.x,y:t.y*d.y-f.scrollTop*d.y+m.y+p.y}}function qN(s){return Array.from(s.getClientRects())}function YN(s){const e=Cs(s),t=ld(s),n=s.ownerDocument.body,r=_n(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),o=_n(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let l=-t.scrollLeft+cd(s);const c=-t.scrollTop;return rs(n).direction==="rtl"&&(l+=_n(e.clientWidth,n.clientWidth)-r),{width:r,height:o,x:l,y:c}}const DE=25;function WN(s,e){const t=On(s),n=Cs(s),r=t.visualViewport;let o=n.clientWidth,l=n.clientHeight,c=0,f=0;if(r){o=r.width,l=r.height;const m=Yg();(!m||m&&e==="fixed")&&(c=r.offsetLeft,f=r.offsetTop)}const d=cd(n);if(d<=0){const m=n.ownerDocument,g=m.body,p=getComputedStyle(g),E=m.compatMode==="CSS1Compat"&&parseFloat(p.marginLeft)+parseFloat(p.marginRight)||0,v=Math.abs(n.clientWidth-g.clientWidth-E);v<=DE&&(o-=v)}else d<=DE&&(o+=d);return{width:o,height:l,x:c,y:f}}const XN=new Set(["absolute","fixed"]);function QN(s,e){const t=Sr(s,!0,e==="fixed"),n=t.top+s.clientTop,r=t.left+s.clientLeft,o=As(s)?wa(s):Ts(1),l=s.clientWidth*o.x,c=s.clientHeight*o.y,f=r*o.x,d=n*o.y;return{width:l,height:c,x:f,y:d}}function IE(s,e,t){let n;if(e==="viewport")n=WN(s,t);else if(e==="document")n=YN(Cs(s));else if(is(e))n=QN(e,t);else{const r=YT(s);n={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return Nu(n)}function XT(s,e){const t=Hi(s);return t===e||!is(t)||Na(t)?!1:rs(t).position==="fixed"||XT(t,e)}function ZN(s,e){const t=e.get(s);if(t)return t;let n=Jo(s,[],!1).filter(c=>is(c)&&Ga(c)!=="body"),r=null;const o=rs(s).position==="fixed";let l=o?Hi(s):s;for(;is(l)&&!Na(l);){const c=rs(l),f=qg(l);!f&&c.position==="fixed"&&(r=null),(o?!f&&!r:!f&&c.position==="static"&&!!r&&XN.has(r.position)||dl(l)&&!f&&XT(s,l))?n=n.filter(m=>m!==l):r=c,l=Hi(l)}return e.set(s,n),n}function JN(s){let{element:e,boundary:t,rootBoundary:n,strategy:r}=s;const l=[...t==="clippingAncestors"?od(e)?[]:ZN(e,this._c):[].concat(t),n],c=l[0],f=l.reduce((d,m)=>{const g=IE(e,m,r);return d.top=_n(g.top,d.top),d.right=Gi(g.right,d.right),d.bottom=Gi(g.bottom,d.bottom),d.left=_n(g.left,d.left),d},IE(e,c,r));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function ek(s){const{width:e,height:t}=qT(s);return{width:e,height:t}}function tk(s,e,t){const n=As(e),r=Cs(e),o=t==="fixed",l=Sr(s,!0,o,e);let c={scrollLeft:0,scrollTop:0};const f=Ts(0);function d(){f.x=cd(r)}if(n||!n&&!o)if((Ga(e)!=="body"||dl(r))&&(c=ld(e)),n){const E=Sr(e,!0,o,e);f.x=E.x+e.clientLeft,f.y=E.y+e.clientTop}else r&&d();o&&!n&&r&&d();const m=r&&!n&&!o?WT(r,c):Ts(0),g=l.left+c.scrollLeft-f.x-m.x,p=l.top+c.scrollTop-f.y-m.y;return{x:g,y:p,width:l.width,height:l.height}}function tm(s){return rs(s).position==="static"}function OE(s,e){if(!As(s)||rs(s).position==="fixed")return null;if(e)return e(s);let t=s.offsetParent;return Cs(s)===t&&(t=t.ownerDocument.body),t}function QT(s,e){const t=On(s);if(od(s))return t;if(!As(s)){let r=Hi(s);for(;r&&!Na(r);){if(is(r)&&!tm(r))return r;r=Hi(r)}return t}let n=OE(s,e);for(;n&&FN(n)&&tm(n);)n=OE(n,e);return n&&Na(n)&&tm(n)&&!qg(n)?t:n||GN(s)||t}const nk=async function(s){const e=this.getOffsetParent||QT,t=this.getDimensions,n=await t(s.floating);return{reference:tk(s.reference,await e(s.floating),s.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function sk(s){return rs(s).direction==="rtl"}const ik={convertOffsetParentRelativeRectToViewportRelativeRect:KN,getDocumentElement:Cs,getClippingRect:JN,getOffsetParent:QT,getElementRects:nk,getClientRects:qN,getDimensions:ek,getScale:wa,isElement:is,isRTL:sk};function ZT(s,e){return s.x===e.x&&s.y===e.y&&s.width===e.width&&s.height===e.height}function rk(s,e){let t=null,n;const r=Cs(s);function o(){var c;clearTimeout(n),(c=t)==null||c.disconnect(),t=null}function l(c,f){c===void 0&&(c=!1),f===void 0&&(f=1),o();const d=s.getBoundingClientRect(),{left:m,top:g,width:p,height:E}=d;if(c||e(),!p||!E)return;const v=Bc(g),S=Bc(r.clientWidth-(m+p)),b=Bc(r.clientHeight-(g+E)),R=Bc(m),_={rootMargin:-v+"px "+-S+"px "+-b+"px "+-R+"px",threshold:_n(0,Gi(1,f))||1};let D=!0;function N(B){const I=B[0].intersectionRatio;if(I!==f){if(!D)return l();I?l(!1,I):n=setTimeout(()=>{l(!1,1e-7)},1e3)}I===1&&!ZT(d,s.getBoundingClientRect())&&l(),D=!1}try{t=new IntersectionObserver(N,{..._,root:r.ownerDocument})}catch{t=new IntersectionObserver(N,_)}t.observe(s)}return l(!0),o}function ak(s,e,t,n){n===void 0&&(n={});const{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:f=!1}=n,d=Wg(s),m=r||o?[...d?Jo(d):[],...Jo(e)]:[];m.forEach(R=>{r&&R.addEventListener("scroll",t,{passive:!0}),o&&R.addEventListener("resize",t)});const g=d&&c?rk(d,t):null;let p=-1,E=null;l&&(E=new ResizeObserver(R=>{let[C]=R;C&&C.target===d&&E&&(E.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var _;(_=E)==null||_.observe(e)})),t()}),d&&!f&&E.observe(d),E.observe(e));let v,S=f?Sr(s):null;f&&b();function b(){const R=Sr(s);S&&!ZT(S,R)&&t(),S=R,v=requestAnimationFrame(b)}return t(),()=>{var R;m.forEach(C=>{r&&C.removeEventListener("scroll",t),o&&C.removeEventListener("resize",t)}),g?.(),(R=E)==null||R.disconnect(),E=null,f&&cancelAnimationFrame(v)}}const ok=IN,lk=ON,ck=CN,uk=kN,dk=_N,NE=LN,fk=NN,hk=(s,e,t)=>{const n=new Map,r={platform:ik,...t},o={...r.platform,_c:n};return wN(s,e,{...r,platform:o})};var mk=typeof document<"u",gk=function(){},fu=mk?A.useLayoutEffect:gk;function ku(s,e){if(s===e)return!0;if(typeof s!=typeof e)return!1;if(typeof s=="function"&&s.toString()===e.toString())return!0;let t,n,r;if(s&&e&&typeof s=="object"){if(Array.isArray(s)){if(t=s.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!ku(s[n],e[n]))return!1;return!0}if(r=Object.keys(s),t=r.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,r[n]))return!1;for(n=t;n--!==0;){const o=r[n];if(!(o==="_owner"&&s.$$typeof)&&!ku(s[o],e[o]))return!1}return!0}return s!==s&&e!==e}function JT(s){return typeof window>"u"?1:(s.ownerDocument.defaultView||window).devicePixelRatio||1}function kE(s,e){const t=JT(s);return Math.round(e*t)/t}function nm(s){const e=A.useRef(s);return fu(()=>{e.current=s}),e}function pk(s){s===void 0&&(s={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:r,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:f,open:d}=s,[m,g]=A.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[p,E]=A.useState(n);ku(p,n)||E(n);const[v,S]=A.useState(null),[b,R]=A.useState(null),C=A.useCallback(j=>{j!==B.current&&(B.current=j,S(j))},[]),_=A.useCallback(j=>{j!==I.current&&(I.current=j,R(j))},[]),D=o||v,N=l||b,B=A.useRef(null),I=A.useRef(null),P=A.useRef(m),M=f!=null,U=nm(f),q=nm(r),V=nm(d),ee=A.useCallback(()=>{if(!B.current||!I.current)return;const j={placement:e,strategy:t,middleware:p};q.current&&(j.platform=q.current),hk(B.current,I.current,j).then(oe=>{const fe={...oe,isPositioned:V.current!==!1};Z.current&&!ku(P.current,fe)&&(P.current=fe,ll.flushSync(()=>{g(fe)}))})},[p,e,t,q,V]);fu(()=>{d===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,g(j=>({...j,isPositioned:!1})))},[d]);const Z=A.useRef(!1);fu(()=>(Z.current=!0,()=>{Z.current=!1}),[]),fu(()=>{if(D&&(B.current=D),N&&(I.current=N),D&&N){if(U.current)return U.current(D,N,ee);ee()}},[D,N,ee,U,M]);const re=A.useMemo(()=>({reference:B,floating:I,setReference:C,setFloating:_}),[C,_]),F=A.useMemo(()=>({reference:D,floating:N}),[D,N]),z=A.useMemo(()=>{const j={position:t,left:0,top:0};if(!F.floating)return j;const oe=kE(F.floating,m.x),fe=kE(F.floating,m.y);return c?{...j,transform:"translate("+oe+"px, "+fe+"px)",...JT(F.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:oe,top:fe}},[t,c,F.floating,m.x,m.y]);return A.useMemo(()=>({...m,update:ee,refs:re,elements:F,floatingStyles:z}),[m,ee,re,F,z])}const yk=s=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:s,fn(t){const{element:n,padding:r}=typeof s=="function"?s(t):s;return n&&e(n)?n.current!=null?NE({element:n.current,padding:r}).fn(t):{}:n?NE({element:n,padding:r}).fn(t):{}}}},vk=(s,e)=>({...ok(s),options:[s,e]}),xk=(s,e)=>({...lk(s),options:[s,e]}),Ek=(s,e)=>({...fk(s),options:[s,e]}),Sk=(s,e)=>({...ck(s),options:[s,e]}),bk=(s,e)=>({...uk(s),options:[s,e]}),Tk=(s,e)=>({...dk(s),options:[s,e]}),Ak=(s,e)=>({...yk(s),options:[s,e]});var Rk="Arrow",eA=A.forwardRef((s,e)=>{const{children:t,width:n=10,height:r=5,...o}=s;return T.jsx(Bt.svg,{...o,ref:e,width:n,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:s.asChild?t:T.jsx("polygon",{points:"0,0 30,0 15,10"})})});eA.displayName=Rk;var wk=eA;function Lk(s){const[e,t]=A.useState(void 0);return kn(()=>{if(s){t({width:s.offsetWidth,height:s.offsetHeight});const n=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const o=r[0];let l,c;if("borderBoxSize"in o){const f=o.borderBoxSize,d=Array.isArray(f)?f[0]:f;l=d.inlineSize,c=d.blockSize}else l=s.offsetWidth,c=s.offsetHeight;t({width:l,height:c})});return n.observe(s,{box:"border-box"}),()=>n.unobserve(s)}else t(void 0)},[s]),e}var tA="Popper",[nA,sA]=Rr(tA),[Ij,iA]=nA(tA),rA="PopperAnchor",aA=A.forwardRef((s,e)=>{const{__scopePopper:t,virtualRef:n,...r}=s,o=iA(rA,t),l=A.useRef(null),c=mt(e,l),f=A.useRef(null);return A.useEffect(()=>{const d=f.current;f.current=n?.current||l.current,d!==f.current&&o.onAnchorChange(f.current)}),n?null:T.jsx(Bt.div,{...r,ref:c})});aA.displayName=rA;var Xg="PopperContent",[Ck,_k]=nA(Xg),oA=A.forwardRef((s,e)=>{const{__scopePopper:t,side:n="bottom",sideOffset:r=0,align:o="center",alignOffset:l=0,arrowPadding:c=0,avoidCollisions:f=!0,collisionBoundary:d=[],collisionPadding:m=0,sticky:g="partial",hideWhenDetached:p=!1,updatePositionStrategy:E="optimized",onPlaced:v,...S}=s,b=iA(Xg,t),[R,C]=A.useState(null),_=mt(e,ye=>C(ye)),[D,N]=A.useState(null),B=Lk(D),I=B?.width??0,P=B?.height??0,M=n+(o!=="center"?"-"+o:""),U=typeof m=="number"?m:{top:0,right:0,bottom:0,left:0,...m},q=Array.isArray(d)?d:[d],V=q.length>0,ee={padding:U,boundary:q.filter(Ik),altBoundary:V},{refs:Z,floatingStyles:re,placement:F,isPositioned:z,middlewareData:j}=pk({strategy:"fixed",placement:M,whileElementsMounted:(...ye)=>ak(...ye,{animationFrame:E==="always"}),elements:{reference:b.anchor},middleware:[vk({mainAxis:r+P,alignmentAxis:l}),f&&xk({mainAxis:!0,crossAxis:!1,limiter:g==="partial"?Ek():void 0,...ee}),f&&Sk({...ee}),bk({...ee,apply:({elements:ye,rects:Ne,availableWidth:De,availableHeight:dt})=>{const{width:ot,height:we}=Ne.reference,nn=ye.floating.style;nn.setProperty("--radix-popper-available-width",`${De}px`),nn.setProperty("--radix-popper-available-height",`${dt}px`),nn.setProperty("--radix-popper-anchor-width",`${ot}px`),nn.setProperty("--radix-popper-anchor-height",`${we}px`)}}),D&&Ak({element:D,padding:c}),Ok({arrowWidth:I,arrowHeight:P}),p&&Tk({strategy:"referenceHidden",...ee})]}),[oe,fe]=uA(F),k=Ct(v);kn(()=>{z&&k?.()},[z,k]);const G=j.arrow?.x,te=j.arrow?.y,le=j.arrow?.centerOffset!==0,[he,pe]=A.useState();return kn(()=>{R&&pe(window.getComputedStyle(R).zIndex)},[R]),T.jsx("div",{ref:Z.setFloating,"data-radix-popper-content-wrapper":"",style:{...re,transform:z?re.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:he,"--radix-popper-transform-origin":[j.transformOrigin?.x,j.transformOrigin?.y].join(" "),...j.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:s.dir,children:T.jsx(Ck,{scope:t,placedSide:oe,onArrowChange:N,arrowX:G,arrowY:te,shouldHideArrow:le,children:T.jsx(Bt.div,{"data-side":oe,"data-align":fe,...S,ref:_,style:{...S.style,animation:z?void 0:"none"}})})})});oA.displayName=Xg;var lA="PopperArrow",Dk={top:"bottom",right:"left",bottom:"top",left:"right"},cA=A.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,o=_k(lA,n),l=Dk[o.placedSide];return T.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:T.jsx(wk,{...r,ref:t,style:{...r.style,display:"block"}})})});cA.displayName=lA;function Ik(s){return s!==null}var Ok=s=>({name:"transformOrigin",options:s,fn(e){const{placement:t,rects:n,middlewareData:r}=e,l=r.arrow?.centerOffset!==0,c=l?0:s.arrowWidth,f=l?0:s.arrowHeight,[d,m]=uA(t),g={start:"0%",center:"50%",end:"100%"}[m],p=(r.arrow?.x??0)+c/2,E=(r.arrow?.y??0)+f/2;let v="",S="";return d==="bottom"?(v=l?g:`${p}px`,S=`${-f}px`):d==="top"?(v=l?g:`${p}px`,S=`${n.floating.height+f}px`):d==="right"?(v=`${-f}px`,S=l?g:`${E}px`):d==="left"&&(v=`${n.floating.width+f}px`,S=l?g:`${E}px`),{data:{x:v,y:S}}}});function uA(s){const[e,t="center"]=s.split("-");return[e,t]}var Nk=aA,kk=oA,Mk=cA,Pk="Portal",Qg=A.forwardRef((s,e)=>{const{container:t,...n}=s,[r,o]=A.useState(!1);kn(()=>o(!0),[]);const l=t||r&&globalThis?.document?.body;return l?qb.createPortal(T.jsx(Bt.div,{...n,ref:e}),l):null});Qg.displayName=Pk;function Fk(s,e){return A.useReducer((t,n)=>e[t][n]??t,s)}var _s=s=>{const{present:e,children:t}=s,n=Uk(e),r=typeof t=="function"?t({present:n.isPresent}):A.Children.only(t),o=mt(n.ref,Bk(r));return typeof t=="function"||n.isPresent?A.cloneElement(r,{ref:o}):null};_s.displayName="Presence";function Uk(s){const[e,t]=A.useState(),n=A.useRef(null),r=A.useRef(s),o=A.useRef("none"),l=s?"mounted":"unmounted",[c,f]=Fk(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const d=$c(n.current);o.current=c==="mounted"?d:"none"},[c]),kn(()=>{const d=n.current,m=r.current;if(m!==s){const p=o.current,E=$c(d);s?f("MOUNT"):E==="none"||d?.display==="none"?f("UNMOUNT"):f(m&&p!==E?"ANIMATION_OUT":"UNMOUNT"),r.current=s}},[s,f]),kn(()=>{if(e){let d;const m=e.ownerDocument.defaultView??window,g=E=>{const S=$c(n.current).includes(CSS.escape(E.animationName));if(E.target===e&&S&&(f("ANIMATION_END"),!r.current)){const b=e.style.animationFillMode;e.style.animationFillMode="forwards",d=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=b)})}},p=E=>{E.target===e&&(o.current=$c(n.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{m.clearTimeout(d),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else f("ANIMATION_END")},[e,f]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:A.useCallback(d=>{n.current=d?getComputedStyle(d):null,t(d)},[])}}function $c(s){return s?.animationName||"none"}function Bk(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var $k=Symbol("radix.slottable");function jk(s){const e=({children:t})=>T.jsx(T.Fragment,{children:t});return e.displayName=`${s}.Slottable`,e.__radixId=$k,e}var Gk=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Hk="VisuallyHidden",dA=A.forwardRef((s,e)=>T.jsx(Bt.span,{...s,ref:e,style:{...Gk,...s.style}}));dA.displayName=Hk;var zk=dA,[ud]=Rr("Tooltip",[sA]),Zg=sA(),fA="TooltipProvider",Vk=700,ME="tooltip.open",[Kk,hA]=ud(fA),mA=s=>{const{__scopeTooltip:e,delayDuration:t=Vk,skipDelayDuration:n=300,disableHoverableContent:r=!1,children:o}=s,l=A.useRef(!0),c=A.useRef(!1),f=A.useRef(0);return A.useEffect(()=>{const d=f.current;return()=>window.clearTimeout(d)},[]),T.jsx(Kk,{scope:e,isOpenDelayedRef:l,delayDuration:t,onOpen:A.useCallback(()=>{window.clearTimeout(f.current),l.current=!1},[]),onClose:A.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>l.current=!0,n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:A.useCallback(d=>{c.current=d},[]),disableHoverableContent:r,children:o})};mA.displayName=fA;var gA="Tooltip",[Oj,fl]=ud(gA),eg="TooltipTrigger",qk=A.forwardRef((s,e)=>{const{__scopeTooltip:t,...n}=s,r=fl(eg,t),o=hA(eg,t),l=Zg(t),c=A.useRef(null),f=mt(e,c,r.onTriggerChange),d=A.useRef(!1),m=A.useRef(!1),g=A.useCallback(()=>d.current=!1,[]);return A.useEffect(()=>()=>document.removeEventListener("pointerup",g),[g]),T.jsx(Nk,{asChild:!0,...l,children:T.jsx(Bt.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...n,ref:f,onPointerMove:ha(s.onPointerMove,p=>{p.pointerType!=="touch"&&!m.current&&!o.isPointerInTransitRef.current&&(r.onTriggerEnter(),m.current=!0)}),onPointerLeave:ha(s.onPointerLeave,()=>{r.onTriggerLeave(),m.current=!1}),onPointerDown:ha(s.onPointerDown,()=>{r.open&&r.onClose(),d.current=!0,document.addEventListener("pointerup",g,{once:!0})}),onFocus:ha(s.onFocus,()=>{d.current||r.onOpen()}),onBlur:ha(s.onBlur,r.onClose),onClick:ha(s.onClick,r.onClose)})})});qk.displayName=eg;var Jg="TooltipPortal",[Yk,Wk]=ud(Jg,{forceMount:void 0}),pA=s=>{const{__scopeTooltip:e,forceMount:t,children:n,container:r}=s,o=fl(Jg,e);return T.jsx(Yk,{scope:e,forceMount:t,children:T.jsx(_s,{present:t||o.open,children:T.jsx(Qg,{asChild:!0,container:r,children:n})})})};pA.displayName=Jg;var ka="TooltipContent",yA=A.forwardRef((s,e)=>{const t=Wk(ka,s.__scopeTooltip),{forceMount:n=t.forceMount,side:r="top",...o}=s,l=fl(ka,s.__scopeTooltip);return T.jsx(_s,{present:n||l.open,children:l.disableHoverableContent?T.jsx(vA,{side:r,...o,ref:e}):T.jsx(Xk,{side:r,...o,ref:e})})}),Xk=A.forwardRef((s,e)=>{const t=fl(ka,s.__scopeTooltip),n=hA(ka,s.__scopeTooltip),r=A.useRef(null),o=mt(e,r),[l,c]=A.useState(null),{trigger:f,onClose:d}=t,m=r.current,{onPointerInTransitChange:g}=n,p=A.useCallback(()=>{c(null),g(!1)},[g]),E=A.useCallback((v,S)=>{const b=v.currentTarget,R={x:v.clientX,y:v.clientY},C=tM(R,b.getBoundingClientRect()),_=nM(R,C),D=sM(S.getBoundingClientRect()),N=rM([..._,...D]);c(N),g(!0)},[g]);return A.useEffect(()=>()=>p(),[p]),A.useEffect(()=>{if(f&&m){const v=b=>E(b,m),S=b=>E(b,f);return f.addEventListener("pointerleave",v),m.addEventListener("pointerleave",S),()=>{f.removeEventListener("pointerleave",v),m.removeEventListener("pointerleave",S)}}},[f,m,E,p]),A.useEffect(()=>{if(l){const v=S=>{const b=S.target,R={x:S.clientX,y:S.clientY},C=f?.contains(b)||m?.contains(b),_=!iM(R,l);C?p():_&&(p(),d())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[f,m,l,d,p]),T.jsx(vA,{...s,ref:o})}),[Qk,Zk]=ud(gA,{isInside:!1}),Jk=jk("TooltipContent"),vA=A.forwardRef((s,e)=>{const{__scopeTooltip:t,children:n,"aria-label":r,onEscapeKeyDown:o,onPointerDownOutside:l,...c}=s,f=fl(ka,t),d=Zg(t),{onClose:m}=f;return A.useEffect(()=>(document.addEventListener(ME,m),()=>document.removeEventListener(ME,m)),[m]),A.useEffect(()=>{if(f.trigger){const g=p=>{p.target?.contains(f.trigger)&&m()};return window.addEventListener("scroll",g,{capture:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})}},[f.trigger,m]),T.jsx(Hg,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:g=>g.preventDefault(),onDismiss:m,children:T.jsxs(kk,{"data-state":f.stateAttribute,...d,...c,ref:e,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[T.jsx(Jk,{children:n}),T.jsx(Qk,{scope:t,isInside:!0,children:T.jsx(zk,{id:f.contentId,role:"tooltip",children:r||n})})]})})});yA.displayName=ka;var xA="TooltipArrow",eM=A.forwardRef((s,e)=>{const{__scopeTooltip:t,...n}=s,r=Zg(t);return Zk(xA,t).isInside?null:T.jsx(Mk,{...r,...n,ref:e})});eM.displayName=xA;function tM(s,e){const t=Math.abs(e.top-s.y),n=Math.abs(e.bottom-s.y),r=Math.abs(e.right-s.x),o=Math.abs(e.left-s.x);switch(Math.min(t,n,r,o)){case o:return"left";case r:return"right";case t:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function nM(s,e,t=5){const n=[];switch(e){case"top":n.push({x:s.x-t,y:s.y+t},{x:s.x+t,y:s.y+t});break;case"bottom":n.push({x:s.x-t,y:s.y-t},{x:s.x+t,y:s.y-t});break;case"left":n.push({x:s.x+t,y:s.y-t},{x:s.x+t,y:s.y+t});break;case"right":n.push({x:s.x-t,y:s.y-t},{x:s.x-t,y:s.y+t});break}return n}function sM(s){const{top:e,right:t,bottom:n,left:r}=s;return[{x:r,y:e},{x:t,y:e},{x:t,y:n},{x:r,y:n}]}function iM(s,e){const{x:t,y:n}=s;let r=!1;for(let o=0,l=e.length-1;o<e.length;l=o++){const c=e[o],f=e[l],d=c.x,m=c.y,g=f.x,p=f.y;m>n!=p>n&&t<(g-d)*(n-m)/(p-m)+d&&(r=!r)}return r}function rM(s){const e=s.slice();return e.sort((t,n)=>t.x<n.x?-1:t.x>n.x?1:t.y<n.y?-1:t.y>n.y?1:0),aM(e)}function aM(s){if(s.length<=1)return s.slice();const e=[];for(let n=0;n<s.length;n++){const r=s[n];for(;e.length>=2;){const o=e[e.length-1],l=e[e.length-2];if((o.x-l.x)*(r.y-l.y)>=(o.y-l.y)*(r.x-l.x))e.pop();else break}e.push(r)}e.pop();const t=[];for(let n=s.length-1;n>=0;n--){const r=s[n];for(;t.length>=2;){const o=t[t.length-1],l=t[t.length-2];if((o.x-l.x)*(r.y-l.y)>=(o.y-l.y)*(r.x-l.x))t.pop();else break}t.push(r)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var oM=mA,lM=pA,EA=yA;const cM=oM,uM=A.forwardRef(({className:s,sideOffset:e=4,...t},n)=>T.jsx(lM,{children:T.jsx(EA,{ref:n,sideOffset:e,className:Oe("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...t})}));uM.displayName=EA.displayName;function Vo(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}var dM=Zu[" useInsertionEffect ".trim().toString()]||kn;function fM({prop:s,defaultProp:e,onChange:t=()=>{},caller:n}){const[r,o,l]=hM({defaultProp:e,onChange:t}),c=s!==void 0,f=c?s:r;{const m=A.useRef(s!==void 0);A.useEffect(()=>{const g=m.current;g!==c&&console.warn(`${n} is changing from ${g?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=c},[c,n])}const d=A.useCallback(m=>{if(c){const g=mM(m)?m(s):m;g!==s&&l.current?.(g)}else o(m)},[c,s,o,l]);return[f,d]}function hM({defaultProp:s,onChange:e}){const[t,n]=A.useState(s),r=A.useRef(t),o=A.useRef(e);return dM(()=>{o.current=e},[e]),A.useEffect(()=>{r.current!==t&&(o.current?.(t),r.current=t)},[t,r]),[t,n,o]}function mM(s){return typeof s=="function"}var sm="focusScope.autoFocusOnMount",im="focusScope.autoFocusOnUnmount",PE={bubbles:!1,cancelable:!0},gM="FocusScope",SA=A.forwardRef((s,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:r,onUnmountAutoFocus:o,...l}=s,[c,f]=A.useState(null),d=Ct(r),m=Ct(o),g=A.useRef(null),p=mt(e,S=>f(S)),E=A.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;A.useEffect(()=>{if(n){let S=function(_){if(E.paused||!c)return;const D=_.target;c.contains(D)?g.current=D:Fi(g.current,{select:!0})},b=function(_){if(E.paused||!c)return;const D=_.relatedTarget;D!==null&&(c.contains(D)||Fi(g.current,{select:!0}))},R=function(_){if(document.activeElement===document.body)for(const N of _)N.removedNodes.length>0&&Fi(c)};document.addEventListener("focusin",S),document.addEventListener("focusout",b);const C=new MutationObserver(R);return c&&C.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",b),C.disconnect()}}},[n,c,E.paused]),A.useEffect(()=>{if(c){UE.add(E);const S=document.activeElement;if(!c.contains(S)){const R=new CustomEvent(sm,PE);c.addEventListener(sm,d),c.dispatchEvent(R),R.defaultPrevented||(pM(SM(bA(c)),{select:!0}),document.activeElement===S&&Fi(c))}return()=>{c.removeEventListener(sm,d),setTimeout(()=>{const R=new CustomEvent(im,PE);c.addEventListener(im,m),c.dispatchEvent(R),R.defaultPrevented||Fi(S??document.body,{select:!0}),c.removeEventListener(im,m),UE.remove(E)},0)}}},[c,d,m,E]);const v=A.useCallback(S=>{if(!t&&!n||E.paused)return;const b=S.key==="Tab"&&!S.altKey&&!S.ctrlKey&&!S.metaKey,R=document.activeElement;if(b&&R){const C=S.currentTarget,[_,D]=yM(C);_&&D?!S.shiftKey&&R===D?(S.preventDefault(),t&&Fi(_,{select:!0})):S.shiftKey&&R===_&&(S.preventDefault(),t&&Fi(D,{select:!0})):R===C&&S.preventDefault()}},[t,n,E.paused]);return T.jsx(Bt.div,{tabIndex:-1,...l,ref:p,onKeyDown:v})});SA.displayName=gM;function pM(s,{select:e=!1}={}){const t=document.activeElement;for(const n of s)if(Fi(n,{select:e}),document.activeElement!==t)return}function yM(s){const e=bA(s),t=FE(e,s),n=FE(e.reverse(),s);return[t,n]}function bA(s){const e=[],t=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const r=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||r?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function FE(s,e){for(const t of s)if(!vM(t,{upTo:e}))return t}function vM(s,{upTo:e}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(e!==void 0&&s===e)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function xM(s){return s instanceof HTMLInputElement&&"select"in s}function Fi(s,{select:e=!1}={}){if(s&&s.focus){const t=document.activeElement;s.focus({preventScroll:!0}),s!==t&&xM(s)&&e&&s.select()}}var UE=EM();function EM(){let s=[];return{add(e){const t=s[0];e!==t&&t?.pause(),s=BE(s,e),s.unshift(e)},remove(e){s=BE(s,e),s[0]?.resume()}}}function BE(s,e){const t=[...s],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function SM(s){return s.filter(e=>e.tagName!=="A")}var rm=0;function bM(){A.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??$E()),document.body.insertAdjacentElement("beforeend",s[1]??$E()),rm++,()=>{rm===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),rm--}},[])}function $E(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var xs=function(){return xs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},xs.apply(this,arguments)};function TA(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(s);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(s,n[r])&&(t[n[r]]=s[n[r]]);return t}function TM(s,e,t){if(t||arguments.length===2)for(var n=0,r=e.length,o;n<r;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return s.concat(o||Array.prototype.slice.call(e))}var hu="right-scroll-bar-position",mu="width-before-scroll-bar",AM="with-scroll-bars-hidden",RM="--removed-body-scroll-bar-size";function am(s,e){return typeof s=="function"?s(e):s&&(s.current=e),s}function wM(s,e){var t=A.useState(function(){return{value:s,callback:e,facade:{get current(){return t.value},set current(n){var r=t.value;r!==n&&(t.value=n,t.callback(n,r))}}}})[0];return t.callback=e,t.facade}var LM=typeof window<"u"?A.useLayoutEffect:A.useEffect,jE=new WeakMap;function CM(s,e){var t=wM(null,function(n){return s.forEach(function(r){return am(r,n)})});return LM(function(){var n=jE.get(t);if(n){var r=new Set(n),o=new Set(s),l=t.current;r.forEach(function(c){o.has(c)||am(c,null)}),o.forEach(function(c){r.has(c)||am(c,l)})}jE.set(t,s)},[s]),t}function _M(s){return s}function DM(s,e){e===void 0&&(e=_M);var t=[],n=!1,r={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:s},useMedium:function(o){var l=e(o,n);return t.push(l),function(){t=t.filter(function(c){return c!==l})}},assignSyncMedium:function(o){for(n=!0;t.length;){var l=t;t=[],l.forEach(o)}t={push:function(c){return o(c)},filter:function(){return t}}},assignMedium:function(o){n=!0;var l=[];if(t.length){var c=t;t=[],c.forEach(o),l=t}var f=function(){var m=l;l=[],m.forEach(o)},d=function(){return Promise.resolve().then(f)};d(),t={push:function(m){l.push(m),d()},filter:function(m){return l=l.filter(m),t}}}};return r}function IM(s){s===void 0&&(s={});var e=DM(null);return e.options=xs({async:!0,ssr:!1},s),e}var AA=function(s){var e=s.sideCar,t=TA(s,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return A.createElement(n,xs({},t))};AA.isSideCarExport=!0;function OM(s,e){return s.useMedium(e),AA}var RA=IM(),om=function(){},dd=A.forwardRef(function(s,e){var t=A.useRef(null),n=A.useState({onScrollCapture:om,onWheelCapture:om,onTouchMoveCapture:om}),r=n[0],o=n[1],l=s.forwardProps,c=s.children,f=s.className,d=s.removeScrollBar,m=s.enabled,g=s.shards,p=s.sideCar,E=s.noIsolation,v=s.inert,S=s.allowPinchZoom,b=s.as,R=b===void 0?"div":b,C=s.gapMode,_=TA(s,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),D=p,N=CM([t,e]),B=xs(xs({},_),r);return A.createElement(A.Fragment,null,m&&A.createElement(D,{sideCar:RA,removeScrollBar:d,shards:g,noIsolation:E,inert:v,setCallbacks:o,allowPinchZoom:!!S,lockRef:t,gapMode:C}),l?A.cloneElement(A.Children.only(c),xs(xs({},B),{ref:N})):A.createElement(R,xs({},B,{className:f,ref:N}),c))});dd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};dd.classNames={fullWidth:mu,zeroRight:hu};var NM=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function kM(){if(!document)return null;var s=document.createElement("style");s.type="text/css";var e=NM();return e&&s.setAttribute("nonce",e),s}function MM(s,e){s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}function PM(s){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(s)}var FM=function(){var s=0,e=null;return{add:function(t){s==0&&(e=kM())&&(MM(e,t),PM(e)),s++},remove:function(){s--,!s&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},UM=function(){var s=FM();return function(e,t){A.useEffect(function(){return s.add(e),function(){s.remove()}},[e&&t])}},wA=function(){var s=UM(),e=function(t){var n=t.styles,r=t.dynamic;return s(n,r),null};return e},BM={left:0,top:0,right:0,gap:0},lm=function(s){return parseInt(s||"",10)||0},$M=function(s){var e=window.getComputedStyle(document.body),t=e[s==="padding"?"paddingLeft":"marginLeft"],n=e[s==="padding"?"paddingTop":"marginTop"],r=e[s==="padding"?"paddingRight":"marginRight"];return[lm(t),lm(n),lm(r)]},jM=function(s){if(s===void 0&&(s="margin"),typeof window>"u")return BM;var e=$M(s),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},GM=wA(),La="data-scroll-locked",HM=function(s,e,t,n){var r=s.left,o=s.top,l=s.right,c=s.gap;return t===void 0&&(t="margin"),`
  .`.concat(AM,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(c,"px ").concat(n,`;
  }
  body[`).concat(La,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(c,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(hu,` {
    right: `).concat(c,"px ").concat(n,`;
  }
  
  .`).concat(mu,` {
    margin-right: `).concat(c,"px ").concat(n,`;
  }
  
  .`).concat(hu," .").concat(hu,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(mu," .").concat(mu,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(La,`] {
    `).concat(RM,": ").concat(c,`px;
  }
`)},GE=function(){var s=parseInt(document.body.getAttribute(La)||"0",10);return isFinite(s)?s:0},zM=function(){A.useEffect(function(){return document.body.setAttribute(La,(GE()+1).toString()),function(){var s=GE()-1;s<=0?document.body.removeAttribute(La):document.body.setAttribute(La,s.toString())}},[])},VM=function(s){var e=s.noRelative,t=s.noImportant,n=s.gapMode,r=n===void 0?"margin":n;zM();var o=A.useMemo(function(){return jM(r)},[r]);return A.createElement(GM,{styles:HM(o,!e,r,t?"":"!important")})},tg=!1;if(typeof window<"u")try{var jc=Object.defineProperty({},"passive",{get:function(){return tg=!0,!0}});window.addEventListener("test",jc,jc),window.removeEventListener("test",jc,jc)}catch{tg=!1}var ma=tg?{passive:!1}:!1,KM=function(s){return s.tagName==="TEXTAREA"},LA=function(s,e){if(!(s instanceof Element))return!1;var t=window.getComputedStyle(s);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!KM(s)&&t[e]==="visible")},qM=function(s){return LA(s,"overflowY")},YM=function(s){return LA(s,"overflowX")},HE=function(s,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=CA(s,n);if(r){var o=_A(s,n),l=o[1],c=o[2];if(l>c)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},WM=function(s){var e=s.scrollTop,t=s.scrollHeight,n=s.clientHeight;return[e,t,n]},XM=function(s){var e=s.scrollLeft,t=s.scrollWidth,n=s.clientWidth;return[e,t,n]},CA=function(s,e){return s==="v"?qM(e):YM(e)},_A=function(s,e){return s==="v"?WM(e):XM(e)},QM=function(s,e){return s==="h"&&e==="rtl"?-1:1},ZM=function(s,e,t,n,r){var o=QM(s,window.getComputedStyle(e).direction),l=o*n,c=t.target,f=e.contains(c),d=!1,m=l>0,g=0,p=0;do{var E=_A(s,c),v=E[0],S=E[1],b=E[2],R=S-b-o*v;(v||R)&&CA(s,c)&&(g+=R,p+=v),c instanceof ShadowRoot?c=c.host:c=c.parentNode}while(!f&&c!==document.body||f&&(e.contains(c)||e===c));return(m&&Math.abs(g)<1||!m&&Math.abs(p)<1)&&(d=!0),d},Gc=function(s){return"changedTouches"in s?[s.changedTouches[0].clientX,s.changedTouches[0].clientY]:[0,0]},zE=function(s){return[s.deltaX,s.deltaY]},VE=function(s){return s&&"current"in s?s.current:s},JM=function(s,e){return s[0]===e[0]&&s[1]===e[1]},eP=function(s){return`
  .block-interactivity-`.concat(s,` {pointer-events: none;}
  .allow-interactivity-`).concat(s,` {pointer-events: all;}
`)},tP=0,ga=[];function nP(s){var e=A.useRef([]),t=A.useRef([0,0]),n=A.useRef(),r=A.useState(tP++)[0],o=A.useState(wA)[0],l=A.useRef(s);A.useEffect(function(){l.current=s},[s]),A.useEffect(function(){if(s.inert){document.body.classList.add("block-interactivity-".concat(r));var S=TM([s.lockRef.current],(s.shards||[]).map(VE),!0).filter(Boolean);return S.forEach(function(b){return b.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),S.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(r))})}}},[s.inert,s.lockRef.current,s.shards]);var c=A.useCallback(function(S,b){if("touches"in S&&S.touches.length===2||S.type==="wheel"&&S.ctrlKey)return!l.current.allowPinchZoom;var R=Gc(S),C=t.current,_="deltaX"in S?S.deltaX:C[0]-R[0],D="deltaY"in S?S.deltaY:C[1]-R[1],N,B=S.target,I=Math.abs(_)>Math.abs(D)?"h":"v";if("touches"in S&&I==="h"&&B.type==="range")return!1;var P=HE(I,B);if(!P)return!0;if(P?N=I:(N=I==="v"?"h":"v",P=HE(I,B)),!P)return!1;if(!n.current&&"changedTouches"in S&&(_||D)&&(n.current=N),!N)return!0;var M=n.current||N;return ZM(M,b,S,M==="h"?_:D)},[]),f=A.useCallback(function(S){var b=S;if(!(!ga.length||ga[ga.length-1]!==o)){var R="deltaY"in b?zE(b):Gc(b),C=e.current.filter(function(N){return N.name===b.type&&(N.target===b.target||b.target===N.shadowParent)&&JM(N.delta,R)})[0];if(C&&C.should){b.cancelable&&b.preventDefault();return}if(!C){var _=(l.current.shards||[]).map(VE).filter(Boolean).filter(function(N){return N.contains(b.target)}),D=_.length>0?c(b,_[0]):!l.current.noIsolation;D&&b.cancelable&&b.preventDefault()}}},[]),d=A.useCallback(function(S,b,R,C){var _={name:S,delta:b,target:R,should:C,shadowParent:sP(R)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(D){return D!==_})},1)},[]),m=A.useCallback(function(S){t.current=Gc(S),n.current=void 0},[]),g=A.useCallback(function(S){d(S.type,zE(S),S.target,c(S,s.lockRef.current))},[]),p=A.useCallback(function(S){d(S.type,Gc(S),S.target,c(S,s.lockRef.current))},[]);A.useEffect(function(){return ga.push(o),s.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:p}),document.addEventListener("wheel",f,ma),document.addEventListener("touchmove",f,ma),document.addEventListener("touchstart",m,ma),function(){ga=ga.filter(function(S){return S!==o}),document.removeEventListener("wheel",f,ma),document.removeEventListener("touchmove",f,ma),document.removeEventListener("touchstart",m,ma)}},[]);var E=s.removeScrollBar,v=s.inert;return A.createElement(A.Fragment,null,v?A.createElement(o,{styles:eP(r)}):null,E?A.createElement(VM,{gapMode:s.gapMode}):null)}function sP(s){for(var e=null;s!==null;)s instanceof ShadowRoot&&(e=s.host,s=s.host),s=s.parentNode;return e}const iP=OM(RA,nP);var DA=A.forwardRef(function(s,e){return A.createElement(dd,xs({},s,{ref:e,sideCar:iP}))});DA.classNames=dd.classNames;var rP=function(s){if(typeof document>"u")return null;var e=Array.isArray(s)?s[0]:s;return e.ownerDocument.body},pa=new WeakMap,Hc=new WeakMap,zc={},cm=0,IA=function(s){return s&&(s.host||IA(s.parentNode))},aP=function(s,e){return e.map(function(t){if(s.contains(t))return t;var n=IA(t);return n&&s.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",s,". Doing nothing"),null)}).filter(function(t){return!!t})},oP=function(s,e,t,n){var r=aP(e,Array.isArray(s)?s:[s]);zc[t]||(zc[t]=new WeakMap);var o=zc[t],l=[],c=new Set,f=new Set(r),d=function(g){!g||c.has(g)||(c.add(g),d(g.parentNode))};r.forEach(d);var m=function(g){!g||f.has(g)||Array.prototype.forEach.call(g.children,function(p){if(c.has(p))m(p);else try{var E=p.getAttribute(n),v=E!==null&&E!=="false",S=(pa.get(p)||0)+1,b=(o.get(p)||0)+1;pa.set(p,S),o.set(p,b),l.push(p),S===1&&v&&Hc.set(p,!0),b===1&&p.setAttribute(t,"true"),v||p.setAttribute(n,"true")}catch(R){console.error("aria-hidden: cannot operate on ",p,R)}})};return m(e),c.clear(),cm++,function(){l.forEach(function(g){var p=pa.get(g)-1,E=o.get(g)-1;pa.set(g,p),o.set(g,E),p||(Hc.has(g)||g.removeAttribute(n),Hc.delete(g)),E||g.removeAttribute(t)}),cm--,cm||(pa=new WeakMap,pa=new WeakMap,Hc=new WeakMap,zc={})}},lP=function(s,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(s)?s:[s]),r=rP(s);return r?(n.push.apply(n,Array.from(r.querySelectorAll("[aria-live]"))),oP(n,r,t,"aria-hidden")):function(){return null}};function cP(s){const e=uP(s),t=A.forwardRef((n,r)=>{const{children:o,...l}=n,c=A.Children.toArray(o),f=c.find(fP);if(f){const d=f.props.children,m=c.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}function uP(s){const e=A.forwardRef((t,n)=>{const{children:r,...o}=t;if(A.isValidElement(r)){const l=mP(r),c=hP(o,r.props);return r.type!==A.Fragment&&(c.ref=n?cl(n,l):l),A.cloneElement(r,c)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var dP=Symbol("radix.slottable");function fP(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===dP}function hP(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...c)=>{const f=o(...c);return r(...c),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function mP(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var fd="Dialog",[OA,NA]=Rr(fd),[gP,as]=OA(fd),kA=s=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:r,onOpenChange:o,modal:l=!0}=s,c=A.useRef(null),f=A.useRef(null),[d,m]=fM({prop:n,defaultProp:r??!1,onChange:o,caller:fd});return T.jsx(gP,{scope:e,triggerRef:c,contentRef:f,contentId:em(),titleId:em(),descriptionId:em(),open:d,onOpenChange:m,onOpenToggle:A.useCallback(()=>m(g=>!g),[m]),modal:l,children:t})};kA.displayName=fd;var MA="DialogTrigger",PA=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=as(MA,t),o=mt(e,r.triggerRef);return T.jsx(Bt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":np(r.open),...n,ref:o,onClick:Vo(s.onClick,r.onOpenToggle)})});PA.displayName=MA;var ep="DialogPortal",[pP,FA]=OA(ep,{forceMount:void 0}),UA=s=>{const{__scopeDialog:e,forceMount:t,children:n,container:r}=s,o=as(ep,e);return T.jsx(pP,{scope:e,forceMount:t,children:A.Children.map(n,l=>T.jsx(_s,{present:t||o.open,children:T.jsx(Qg,{asChild:!0,container:r,children:l})}))})};UA.displayName=ep;var Mu="DialogOverlay",BA=A.forwardRef((s,e)=>{const t=FA(Mu,s.__scopeDialog),{forceMount:n=t.forceMount,...r}=s,o=as(Mu,s.__scopeDialog);return o.modal?T.jsx(_s,{present:n||o.open,children:T.jsx(vP,{...r,ref:e})}):null});BA.displayName=Mu;var yP=cP("DialogOverlay.RemoveScroll"),vP=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=as(Mu,t);return T.jsx(DA,{as:yP,allowPinchZoom:!0,shards:[r.contentRef],children:T.jsx(Bt.div,{"data-state":np(r.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),br="DialogContent",$A=A.forwardRef((s,e)=>{const t=FA(br,s.__scopeDialog),{forceMount:n=t.forceMount,...r}=s,o=as(br,s.__scopeDialog);return T.jsx(_s,{present:n||o.open,children:o.modal?T.jsx(xP,{...r,ref:e}):T.jsx(EP,{...r,ref:e})})});$A.displayName=br;var xP=A.forwardRef((s,e)=>{const t=as(br,s.__scopeDialog),n=A.useRef(null),r=mt(e,t.contentRef,n);return A.useEffect(()=>{const o=n.current;if(o)return lP(o)},[]),T.jsx(jA,{...s,ref:r,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Vo(s.onCloseAutoFocus,o=>{o.preventDefault(),t.triggerRef.current?.focus()}),onPointerDownOutside:Vo(s.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0;(l.button===2||c)&&o.preventDefault()}),onFocusOutside:Vo(s.onFocusOutside,o=>o.preventDefault())})}),EP=A.forwardRef((s,e)=>{const t=as(br,s.__scopeDialog),n=A.useRef(!1),r=A.useRef(!1);return T.jsx(jA,{...s,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{s.onCloseAutoFocus?.(o),o.defaultPrevented||(n.current||t.triggerRef.current?.focus(),o.preventDefault()),n.current=!1,r.current=!1},onInteractOutside:o=>{s.onInteractOutside?.(o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const l=o.target;t.triggerRef.current?.contains(l)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&r.current&&o.preventDefault()}})}),jA=A.forwardRef((s,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:r,onCloseAutoFocus:o,...l}=s,c=as(br,t),f=A.useRef(null),d=mt(e,f);return bM(),T.jsxs(T.Fragment,{children:[T.jsx(SA,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:r,onUnmountAutoFocus:o,children:T.jsx(Hg,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":np(c.open),...l,ref:d,onDismiss:()=>c.onOpenChange(!1)})}),T.jsxs(T.Fragment,{children:[T.jsx(bP,{titleId:c.titleId}),T.jsx(AP,{contentRef:f,descriptionId:c.descriptionId})]})]})}),tp="DialogTitle",GA=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=as(tp,t);return T.jsx(Bt.h2,{id:r.titleId,...n,ref:e})});GA.displayName=tp;var HA="DialogDescription",zA=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=as(HA,t);return T.jsx(Bt.p,{id:r.descriptionId,...n,ref:e})});zA.displayName=HA;var VA="DialogClose",KA=A.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,r=as(VA,t);return T.jsx(Bt.button,{type:"button",...n,ref:e,onClick:Vo(s.onClick,()=>r.onOpenChange(!1))})});KA.displayName=VA;function np(s){return s?"open":"closed"}var qA="DialogTitleWarning",[SP,YA]=gD(qA,{contentName:br,titleName:tp,docsSlug:"dialog"}),bP=({titleId:s})=>{const e=YA(qA),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return A.useEffect(()=>{s&&(document.getElementById(s)||console.error(t))},[t,s]),null},TP="DialogDescriptionWarning",AP=({contentRef:s,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${YA(TP).contentName}}.`;return A.useEffect(()=>{const r=s.current?.getAttribute("aria-describedby");e&&r&&(document.getElementById(e)||console.warn(n))},[n,s,e]),null},sp=kA,ip=PA,rp=UA,hl=BA,ml=$A,gl=GA,pl=zA,hd=KA;function RP(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}var wP=Symbol("radix.slottable");function LP(s){const e=({children:t})=>T.jsx(T.Fragment,{children:t});return e.displayName=`${s}.Slottable`,e.__radixId=wP,e}var WA="AlertDialog",[CP]=Rr(WA,[NA]),ri=NA(),XA=s=>{const{__scopeAlertDialog:e,...t}=s,n=ri(e);return T.jsx(sp,{...n,...t,modal:!0})};XA.displayName=WA;var _P="AlertDialogTrigger",DP=A.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,r=ri(t);return T.jsx(ip,{...r,...n,ref:e})});DP.displayName=_P;var IP="AlertDialogPortal",QA=s=>{const{__scopeAlertDialog:e,...t}=s,n=ri(e);return T.jsx(rp,{...n,...t})};QA.displayName=IP;var OP="AlertDialogOverlay",ZA=A.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,r=ri(t);return T.jsx(hl,{...r,...n,ref:e})});ZA.displayName=OP;var Ca="AlertDialogContent",[NP,kP]=CP(Ca),MP=LP("AlertDialogContent"),JA=A.forwardRef((s,e)=>{const{__scopeAlertDialog:t,children:n,...r}=s,o=ri(t),l=A.useRef(null),c=mt(e,l),f=A.useRef(null);return T.jsx(SP,{contentName:Ca,titleName:e1,docsSlug:"alert-dialog",children:T.jsx(NP,{scope:t,cancelRef:f,children:T.jsxs(ml,{role:"alertdialog",...o,...r,ref:c,onOpenAutoFocus:RP(r.onOpenAutoFocus,d=>{d.preventDefault(),f.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[T.jsx(MP,{children:n}),T.jsx(FP,{contentRef:l})]})})})});JA.displayName=Ca;var e1="AlertDialogTitle",t1=A.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,r=ri(t);return T.jsx(gl,{...r,...n,ref:e})});t1.displayName=e1;var n1="AlertDialogDescription",s1=A.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,r=ri(t);return T.jsx(pl,{...r,...n,ref:e})});s1.displayName=n1;var PP="AlertDialogAction",i1=A.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,r=ri(t);return T.jsx(hd,{...r,...n,ref:e})});i1.displayName=PP;var r1="AlertDialogCancel",a1=A.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,{cancelRef:r}=kP(r1,t),o=ri(t),l=mt(e,r);return T.jsx(hd,{...o,...n,ref:l})});a1.displayName=r1;var FP=({contentRef:s})=>{const e=`\`${Ca}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ca}\` by passing a \`${n1}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ca}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return A.useEffect(()=>{document.getElementById(s.current?.getAttribute("aria-describedby"))||console.warn(e)},[e,s]),null},UP=XA,BP=QA,o1=ZA,l1=JA,c1=i1,u1=a1,d1=t1,f1=s1,$P=Symbol.for("react.lazy"),Pu=Zu[" use ".trim().toString()];function jP(s){return typeof s=="object"&&s!==null&&"then"in s}function h1(s){return s!=null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===$P&&"_payload"in s&&jP(s._payload)}function GP(s){const e=zP(s),t=A.forwardRef((n,r)=>{let{children:o,...l}=n;h1(o)&&typeof Pu=="function"&&(o=Pu(o._payload));const c=A.Children.toArray(o),f=c.find(KP);if(f){const d=f.props.children,m=c.map(g=>g===f?A.Children.count(d)>1?A.Children.only(null):A.isValidElement(d)?d.props.children:null:g);return T.jsx(e,{...l,ref:r,children:A.isValidElement(d)?A.cloneElement(d,void 0,m):null})}return T.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${s}.Slot`,t}var HP=GP("Slot");function zP(s){const e=A.forwardRef((t,n)=>{let{children:r,...o}=t;if(h1(r)&&typeof Pu=="function"&&(r=Pu(r._payload)),A.isValidElement(r)){const l=YP(r),c=qP(o,r.props);return r.type!==A.Fragment&&(c.ref=n?cl(n,l):l),A.cloneElement(r,c)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var VP=Symbol("radix.slottable");function KP(s){return A.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===VP}function qP(s,e){const t={...e};for(const n in e){const r=s[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...c)=>{const f=o(...c);return r(...c),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...s,...t}}function YP(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}const ap=Ug("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground shadow-sm border-destructive-border",outline:" border [border-color:var(--button-outline)] shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent",link:"text-primary underline-offset-4 hover:underline"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),ht=A.forwardRef(({className:s,variant:e,size:t,asChild:n=!1,...r},o)=>{const l=n?HP:"button";return T.jsx(l,{className:Oe(ap({variant:e,size:t,className:s})),ref:o,...r})});ht.displayName="Button";const WP=UP,XP=BP,m1=A.forwardRef(({className:s,...e},t)=>T.jsx(o1,{className:Oe("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...e,ref:t}));m1.displayName=o1.displayName;const g1=A.forwardRef(({className:s,...e},t)=>T.jsxs(XP,{children:[T.jsx(m1,{}),T.jsx(l1,{ref:t,className:Oe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...e})]}));g1.displayName=l1.displayName;const p1=({className:s,...e})=>T.jsx("div",{className:Oe("flex flex-col space-y-2 text-center sm:text-left",s),...e});p1.displayName="AlertDialogHeader";const y1=({className:s,...e})=>T.jsx("div",{className:Oe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...e});y1.displayName="AlertDialogFooter";const v1=A.forwardRef(({className:s,...e},t)=>T.jsx(d1,{ref:t,className:Oe("text-lg font-semibold",s),...e}));v1.displayName=d1.displayName;const x1=A.forwardRef(({className:s,...e},t)=>T.jsx(f1,{ref:t,className:Oe("text-sm text-muted-foreground",s),...e}));x1.displayName=f1.displayName;const E1=A.forwardRef(({className:s,...e},t)=>T.jsx(c1,{ref:t,className:Oe(ap(),s),...e}));E1.displayName=c1.displayName;const QP=A.forwardRef(({className:s,...e},t)=>T.jsx(u1,{ref:t,className:Oe(ap({variant:"outline"}),"mt-2 sm:mt-0",s),...e}));QP.displayName=u1.displayName;const ng="davex_age_verified",ZP=3600*1e3;function JP(){try{const s=localStorage.getItem(ng);if(s){const e=parseInt(s,10);return Date.now()-e<ZP?{verified:!0,showDialog:!1}:(localStorage.removeItem(ng),{verified:!1,showDialog:!0})}return{verified:!1,showDialog:!0}}catch{return{verified:!1,showDialog:!0}}}function e2({children:s}){const e=JP(),[t,n]=A.useState(e.verified),[r,o]=A.useState(e.showDialog),l=()=>{localStorage.setItem(ng,Date.now().toString()),n(!0),o(!1)},c=()=>{window.location.href="http://www.davexmainweb.zone.id"};return T.jsxs(T.Fragment,{children:[T.jsx(WP,{open:r,onOpenChange:o,children:T.jsxs(g1,{className:"max-w-md bg-gradient-to-br from-card to-background border-primary/20",children:[T.jsxs(p1,{className:"text-center space-y-4",children:[T.jsx("div",{className:"mx-auto w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center",children:T.jsx(ZI,{className:"h-10 w-10 text-primary"})}),T.jsx(v1,{className:"text-2xl font-heading font-bold text-center",children:"Age Verification Required"}),T.jsx(x1,{asChild:!0,children:T.jsxs("div",{className:"text-center space-y-4",children:[T.jsxs("p",{className:"text-base",children:["This website contains adult content intended for viewers ",T.jsx("strong",{children:"18 years of age or older"}),"."]}),T.jsx("p",{className:"text-sm text-muted-foreground",children:'By clicking "I am 18+" below, you confirm that you are of legal age to view adult content in your jurisdiction.'})]})})]}),T.jsxs(y1,{className:"flex flex-col sm:flex-row gap-3 mt-4",children:[T.jsx("button",{onClick:c,className:"flex-1 px-6 py-3 rounded-lg border border-border text-muted-foreground hover:bg-secondary transition-colors font-medium",children:"Leave Site"}),T.jsx(E1,{onClick:l,className:"flex-1 px-6 py-3 rounded-lg bg-primary hover:bg-primary/90 text-white font-bold text-lg shadow-lg shadow-primary/30",children:"I am 18+"})]})]})}),t&&s]})}const S1=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:Oe("rounded-xl border bg-card text-card-foreground shadow",s),...e}));S1.displayName="Card";const t2=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:Oe("flex flex-col space-y-1.5 p-6",s),...e}));t2.displayName="CardHeader";const n2=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:Oe("font-semibold leading-none tracking-tight",s),...e}));n2.displayName="CardTitle";const s2=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:Oe("text-sm text-muted-foreground",s),...e}));s2.displayName="CardDescription";const b1=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:Oe("p-6 pt-0",s),...e}));b1.displayName="CardContent";const i2=A.forwardRef(({className:s,...e},t)=>T.jsx("div",{ref:t,className:Oe("flex items-center p-6 pt-0",s),...e}));i2.displayName="CardFooter";function r2(){return T.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:T.jsx(S1,{className:"w-full max-w-md mx-4",children:T.jsxs(b1,{className:"pt-6",children:[T.jsxs("div",{className:"flex mb-4 gap-2",children:[T.jsx(Vm,{className:"h-8 w-8 text-red-500"}),T.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),T.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const a2=sp,o2=ip,l2=rp,T1=A.forwardRef(({className:s,...e},t)=>T.jsx(hl,{className:Oe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...e,ref:t}));T1.displayName=hl.displayName;const c2=Ug("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),A1=A.forwardRef(({side:s="right",className:e,children:t,...n},r)=>T.jsxs(l2,{children:[T.jsx(T1,{}),T.jsxs(ml,{ref:r,className:Oe(c2({side:s}),e),...n,children:[T.jsxs(hd,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[T.jsx(ul,{className:"h-4 w-4"}),T.jsx("span",{className:"sr-only",children:"Close"})]}),t]})]}));A1.displayName=ml.displayName;const u2=A.forwardRef(({className:s,...e},t)=>T.jsx(gl,{ref:t,className:Oe("text-lg font-semibold text-foreground",s),...e}));u2.displayName=gl.displayName;const d2=A.forwardRef(({className:s,...e},t)=>T.jsx(pl,{ref:t,className:Oe("text-sm text-muted-foreground",s),...e}));d2.displayName=pl.displayName;const sg=A.forwardRef(({className:s,type:e,...t},n)=>T.jsx("input",{type:e,className:Oe("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...t}));sg.displayName="Input";var f2=A.createContext(void 0);function h2(s){const e=A.useContext(f2);return s||e||"ltr"}function m2(s,[e,t]){return Math.min(t,Math.max(e,s))}function vr(s,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(s?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}function g2(s,e){return A.useReducer((t,n)=>e[t][n]??t,s)}var op="ScrollArea",[R1]=Rr(op),[p2,Yn]=R1(op),w1=A.forwardRef((s,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:r,scrollHideDelay:o=600,...l}=s,[c,f]=A.useState(null),[d,m]=A.useState(null),[g,p]=A.useState(null),[E,v]=A.useState(null),[S,b]=A.useState(null),[R,C]=A.useState(0),[_,D]=A.useState(0),[N,B]=A.useState(!1),[I,P]=A.useState(!1),M=mt(e,q=>f(q)),U=h2(r);return T.jsx(p2,{scope:t,type:n,dir:U,scrollHideDelay:o,scrollArea:c,viewport:d,onViewportChange:m,content:g,onContentChange:p,scrollbarX:E,onScrollbarXChange:v,scrollbarXEnabled:N,onScrollbarXEnabledChange:B,scrollbarY:S,onScrollbarYChange:b,scrollbarYEnabled:I,onScrollbarYEnabledChange:P,onCornerWidthChange:C,onCornerHeightChange:D,children:T.jsx(Bt.div,{dir:U,...l,ref:M,style:{position:"relative","--radix-scroll-area-corner-width":R+"px","--radix-scroll-area-corner-height":_+"px",...s.style}})})});w1.displayName=op;var L1="ScrollAreaViewport",C1=A.forwardRef((s,e)=>{const{__scopeScrollArea:t,children:n,nonce:r,...o}=s,l=Yn(L1,t),c=A.useRef(null),f=mt(e,c,l.onViewportChange);return T.jsxs(T.Fragment,{children:[T.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),T.jsx(Bt.div,{"data-radix-scroll-area-viewport":"",...o,ref:f,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...s.style},children:T.jsx("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});C1.displayName=L1;var Ds="ScrollAreaScrollbar",lp=A.forwardRef((s,e)=>{const{forceMount:t,...n}=s,r=Yn(Ds,s.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:l}=r,c=s.orientation==="horizontal";return A.useEffect(()=>(c?o(!0):l(!0),()=>{c?o(!1):l(!1)}),[c,o,l]),r.type==="hover"?T.jsx(y2,{...n,ref:e,forceMount:t}):r.type==="scroll"?T.jsx(v2,{...n,ref:e,forceMount:t}):r.type==="auto"?T.jsx(_1,{...n,ref:e,forceMount:t}):r.type==="always"?T.jsx(cp,{...n,ref:e}):null});lp.displayName=Ds;var y2=A.forwardRef((s,e)=>{const{forceMount:t,...n}=s,r=Yn(Ds,s.__scopeScrollArea),[o,l]=A.useState(!1);return A.useEffect(()=>{const c=r.scrollArea;let f=0;if(c){const d=()=>{window.clearTimeout(f),l(!0)},m=()=>{f=window.setTimeout(()=>l(!1),r.scrollHideDelay)};return c.addEventListener("pointerenter",d),c.addEventListener("pointerleave",m),()=>{window.clearTimeout(f),c.removeEventListener("pointerenter",d),c.removeEventListener("pointerleave",m)}}},[r.scrollArea,r.scrollHideDelay]),T.jsx(_s,{present:t||o,children:T.jsx(_1,{"data-state":o?"visible":"hidden",...n,ref:e})})}),v2=A.forwardRef((s,e)=>{const{forceMount:t,...n}=s,r=Yn(Ds,s.__scopeScrollArea),o=s.orientation==="horizontal",l=gd(()=>f("SCROLL_END"),100),[c,f]=g2("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return A.useEffect(()=>{if(c==="idle"){const d=window.setTimeout(()=>f("HIDE"),r.scrollHideDelay);return()=>window.clearTimeout(d)}},[c,r.scrollHideDelay,f]),A.useEffect(()=>{const d=r.viewport,m=o?"scrollLeft":"scrollTop";if(d){let g=d[m];const p=()=>{const E=d[m];g!==E&&(f("SCROLL"),l()),g=E};return d.addEventListener("scroll",p),()=>d.removeEventListener("scroll",p)}},[r.viewport,o,f,l]),T.jsx(_s,{present:t||c!=="hidden",children:T.jsx(cp,{"data-state":c==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:vr(s.onPointerEnter,()=>f("POINTER_ENTER")),onPointerLeave:vr(s.onPointerLeave,()=>f("POINTER_LEAVE"))})})}),_1=A.forwardRef((s,e)=>{const t=Yn(Ds,s.__scopeScrollArea),{forceMount:n,...r}=s,[o,l]=A.useState(!1),c=s.orientation==="horizontal",f=gd(()=>{if(t.viewport){const d=t.viewport.offsetWidth<t.viewport.scrollWidth,m=t.viewport.offsetHeight<t.viewport.scrollHeight;l(c?d:m)}},10);return Ma(t.viewport,f),Ma(t.content,f),T.jsx(_s,{present:n||o,children:T.jsx(cp,{"data-state":o?"visible":"hidden",...r,ref:e})})}),cp=A.forwardRef((s,e)=>{const{orientation:t="vertical",...n}=s,r=Yn(Ds,s.__scopeScrollArea),o=A.useRef(null),l=A.useRef(0),[c,f]=A.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=k1(c.viewport,c.content),m={...n,sizes:c,onSizesChange:f,hasThumb:d>0&&d<1,onThumbChange:p=>o.current=p,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:p=>l.current=p};function g(p,E){return A2(p,l.current,c,E)}return t==="horizontal"?T.jsx(x2,{...m,ref:e,onThumbPositionChange:()=>{if(r.viewport&&o.current){const p=r.viewport.scrollLeft,E=KE(p,c,r.dir);o.current.style.transform=`translate3d(${E}px, 0, 0)`}},onWheelScroll:p=>{r.viewport&&(r.viewport.scrollLeft=p)},onDragScroll:p=>{r.viewport&&(r.viewport.scrollLeft=g(p,r.dir))}}):t==="vertical"?T.jsx(E2,{...m,ref:e,onThumbPositionChange:()=>{if(r.viewport&&o.current){const p=r.viewport.scrollTop,E=KE(p,c);o.current.style.transform=`translate3d(0, ${E}px, 0)`}},onWheelScroll:p=>{r.viewport&&(r.viewport.scrollTop=p)},onDragScroll:p=>{r.viewport&&(r.viewport.scrollTop=g(p))}}):null}),x2=A.forwardRef((s,e)=>{const{sizes:t,onSizesChange:n,...r}=s,o=Yn(Ds,s.__scopeScrollArea),[l,c]=A.useState(),f=A.useRef(null),d=mt(e,f,o.onScrollbarXChange);return A.useEffect(()=>{f.current&&c(getComputedStyle(f.current))},[f]),T.jsx(I1,{"data-orientation":"horizontal",...r,ref:d,sizes:t,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":md(t)+"px",...s.style},onThumbPointerDown:m=>s.onThumbPointerDown(m.x),onDragScroll:m=>s.onDragScroll(m.x),onWheelScroll:(m,g)=>{if(o.viewport){const p=o.viewport.scrollLeft+m.deltaX;s.onWheelScroll(p),P1(p,g)&&m.preventDefault()}},onResize:()=>{f.current&&o.viewport&&l&&n({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:f.current.clientWidth,paddingStart:Uu(l.paddingLeft),paddingEnd:Uu(l.paddingRight)}})}})}),E2=A.forwardRef((s,e)=>{const{sizes:t,onSizesChange:n,...r}=s,o=Yn(Ds,s.__scopeScrollArea),[l,c]=A.useState(),f=A.useRef(null),d=mt(e,f,o.onScrollbarYChange);return A.useEffect(()=>{f.current&&c(getComputedStyle(f.current))},[f]),T.jsx(I1,{"data-orientation":"vertical",...r,ref:d,sizes:t,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":md(t)+"px",...s.style},onThumbPointerDown:m=>s.onThumbPointerDown(m.y),onDragScroll:m=>s.onDragScroll(m.y),onWheelScroll:(m,g)=>{if(o.viewport){const p=o.viewport.scrollTop+m.deltaY;s.onWheelScroll(p),P1(p,g)&&m.preventDefault()}},onResize:()=>{f.current&&o.viewport&&l&&n({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:f.current.clientHeight,paddingStart:Uu(l.paddingTop),paddingEnd:Uu(l.paddingBottom)}})}})}),[S2,D1]=R1(Ds),I1=A.forwardRef((s,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:r,onThumbChange:o,onThumbPointerUp:l,onThumbPointerDown:c,onThumbPositionChange:f,onDragScroll:d,onWheelScroll:m,onResize:g,...p}=s,E=Yn(Ds,t),[v,S]=A.useState(null),b=mt(e,M=>S(M)),R=A.useRef(null),C=A.useRef(""),_=E.viewport,D=n.content-n.viewport,N=Ct(m),B=Ct(f),I=gd(g,10);function P(M){if(R.current){const U=M.clientX-R.current.left,q=M.clientY-R.current.top;d({x:U,y:q})}}return A.useEffect(()=>{const M=U=>{const q=U.target;v?.contains(q)&&N(U,D)};return document.addEventListener("wheel",M,{passive:!1}),()=>document.removeEventListener("wheel",M,{passive:!1})},[_,v,D,N]),A.useEffect(B,[n,B]),Ma(v,I),Ma(E.content,I),T.jsx(S2,{scope:t,scrollbar:v,hasThumb:r,onThumbChange:Ct(o),onThumbPointerUp:Ct(l),onThumbPositionChange:B,onThumbPointerDown:Ct(c),children:T.jsx(Bt.div,{...p,ref:b,style:{position:"absolute",...p.style},onPointerDown:vr(s.onPointerDown,M=>{M.button===0&&(M.target.setPointerCapture(M.pointerId),R.current=v.getBoundingClientRect(),C.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",E.viewport&&(E.viewport.style.scrollBehavior="auto"),P(M))}),onPointerMove:vr(s.onPointerMove,P),onPointerUp:vr(s.onPointerUp,M=>{const U=M.target;U.hasPointerCapture(M.pointerId)&&U.releasePointerCapture(M.pointerId),document.body.style.webkitUserSelect=C.current,E.viewport&&(E.viewport.style.scrollBehavior=""),R.current=null})})})}),Fu="ScrollAreaThumb",O1=A.forwardRef((s,e)=>{const{forceMount:t,...n}=s,r=D1(Fu,s.__scopeScrollArea);return T.jsx(_s,{present:t||r.hasThumb,children:T.jsx(b2,{ref:e,...n})})}),b2=A.forwardRef((s,e)=>{const{__scopeScrollArea:t,style:n,...r}=s,o=Yn(Fu,t),l=D1(Fu,t),{onThumbPositionChange:c}=l,f=mt(e,g=>l.onThumbChange(g)),d=A.useRef(void 0),m=gd(()=>{d.current&&(d.current(),d.current=void 0)},100);return A.useEffect(()=>{const g=o.viewport;if(g){const p=()=>{if(m(),!d.current){const E=R2(g,c);d.current=E,c()}};return c(),g.addEventListener("scroll",p),()=>g.removeEventListener("scroll",p)}},[o.viewport,m,c]),T.jsx(Bt.div,{"data-state":l.hasThumb?"visible":"hidden",...r,ref:f,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:vr(s.onPointerDownCapture,g=>{const E=g.target.getBoundingClientRect(),v=g.clientX-E.left,S=g.clientY-E.top;l.onThumbPointerDown({x:v,y:S})}),onPointerUp:vr(s.onPointerUp,l.onThumbPointerUp)})});O1.displayName=Fu;var up="ScrollAreaCorner",N1=A.forwardRef((s,e)=>{const t=Yn(up,s.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?T.jsx(T2,{...s,ref:e}):null});N1.displayName=up;var T2=A.forwardRef((s,e)=>{const{__scopeScrollArea:t,...n}=s,r=Yn(up,t),[o,l]=A.useState(0),[c,f]=A.useState(0),d=!!(o&&c);return Ma(r.scrollbarX,()=>{const m=r.scrollbarX?.offsetHeight||0;r.onCornerHeightChange(m),f(m)}),Ma(r.scrollbarY,()=>{const m=r.scrollbarY?.offsetWidth||0;r.onCornerWidthChange(m),l(m)}),d?T.jsx(Bt.div,{...n,ref:e,style:{width:o,height:c,position:"absolute",right:r.dir==="ltr"?0:void 0,left:r.dir==="rtl"?0:void 0,bottom:0,...s.style}}):null});function Uu(s){return s?parseInt(s,10):0}function k1(s,e){const t=s/e;return isNaN(t)?0:t}function md(s){const e=k1(s.viewport,s.content),t=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,n=(s.scrollbar.size-t)*e;return Math.max(n,18)}function A2(s,e,t,n="ltr"){const r=md(t),o=r/2,l=e||o,c=r-l,f=t.scrollbar.paddingStart+l,d=t.scrollbar.size-t.scrollbar.paddingEnd-c,m=t.content-t.viewport,g=n==="ltr"?[0,m]:[m*-1,0];return M1([f,d],g)(s)}function KE(s,e,t="ltr"){const n=md(e),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,o=e.scrollbar.size-r,l=e.content-e.viewport,c=o-n,f=t==="ltr"?[0,l]:[l*-1,0],d=m2(s,f);return M1([0,l],[0,c])(d)}function M1(s,e){return t=>{if(s[0]===s[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(s[1]-s[0]);return e[0]+n*(t-s[0])}}function P1(s,e){return s>0&&s<e}var R2=(s,e=()=>{})=>{let t={left:s.scrollLeft,top:s.scrollTop},n=0;return(function r(){const o={left:s.scrollLeft,top:s.scrollTop},l=t.left!==o.left,c=t.top!==o.top;(l||c)&&e(),t=o,n=window.requestAnimationFrame(r)})(),()=>window.cancelAnimationFrame(n)};function gd(s,e){const t=Ct(s),n=A.useRef(0);return A.useEffect(()=>()=>window.clearTimeout(n.current),[]),A.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function Ma(s,e){const t=Ct(e);kn(()=>{let n=0;if(s){const r=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return r.observe(s),()=>{window.cancelAnimationFrame(n),r.unobserve(s)}}},[s,t])}var F1=w1,w2=C1,L2=N1;const dp=A.forwardRef(({className:s,children:e,...t},n)=>T.jsxs(F1,{ref:n,className:Oe("relative overflow-hidden",s),...t,children:[T.jsx(w2,{className:"h-full w-full rounded-[inherit]",children:e}),T.jsx(U1,{}),T.jsx(L2,{})]}));dp.displayName=F1.displayName;const U1=A.forwardRef(({className:s,orientation:e="vertical",...t},n)=>T.jsx(lp,{ref:n,orientation:e,className:Oe("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...t,children:T.jsx(O1,{className:"relative flex-1 rounded-full bg-border"})}));U1.displayName=lp.displayName;const C2=sp,_2=ip,D2=rp,B1=A.forwardRef(({className:s,...e},t)=>T.jsx(hl,{ref:t,className:Oe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...e}));B1.displayName=hl.displayName;const $1=A.forwardRef(({className:s,children:e,...t},n)=>T.jsxs(D2,{children:[T.jsx(B1,{}),T.jsxs(ml,{ref:n,className:Oe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t,children:[e,T.jsxs(hd,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[T.jsx(ul,{className:"h-4 w-4"}),T.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));$1.displayName=ml.displayName;const j1=({className:s,...e})=>T.jsx("div",{className:Oe("flex flex-col space-y-1.5 text-center sm:text-left",s),...e});j1.displayName="DialogHeader";const G1=A.forwardRef(({className:s,...e},t)=>T.jsx(gl,{ref:t,className:Oe("text-lg font-semibold leading-none tracking-tight",s),...e}));G1.displayName=gl.displayName;const I2=A.forwardRef(({className:s,...e},t)=>T.jsx(pl,{ref:t,className:Oe("text-sm text-muted-foreground",s),...e}));I2.displayName=pl.displayName;const ig=["Family","Hardcore","Black Girls","Doggystyle","African","Milf","18","Missionary","Big Ass","Big dick","Massage","Porno","Lesbian","Nigeria","Orgasm","Workout","Female Ejaculation","Stepmom and stepson","Arab / Arabian","Pussy","Ass","Big black cock","Africa","Sexy Girls","Exotic","Masturbation","Asian","Fucking","Latina","Pussyfucking","Mature Women","Rough","BBW","Hot","Creampie","Spanish brazzers com lisa annd","Black cock","Gangbang","Sex","Virtual Reality","Bi Sexual","Riding","Cumshot","Wife","Big Cock","Cheating","Anal Sex","Big ass stepmom","AI","Big black ass","Cowgirl","Toons","Best Of","India / Indian girls","My commented videos","Photos","Porn Games","Rough sex","Sex Stories","Big Tits","Nigerian","Orgy","Stepdaughter","Fingering","Oiled","Cuckold/Hotwife","Teacher","Femdom","Horny","Amateur","Wet pussy","Fisting / Fist-Fucking","Pussy licking","ASMR","Natural tits","BDSM","Hardsex","Fuck","Interracial","Real","Solo Girls","Brazzers stepmom","Swingers","Black porn","Heels","Housewife","Lingerie","Blonde","Curvy","Cam Videos","Girlfriend","Cheating wife","Shaved Pussy","Deepthroat","Redhead","Feet","Kenyan","Outdoor","Ass Gaping","Chubby","REAL Amateur","South africa","Stockings","Couple","Sex Toys","Bukkake","Moaning","Black Hair","Xxx black nigeria","Naija","Pissing","Facial","Muslim","Ass to Mouth","Virgin","Blowjob","Hard and fast fucking","Gay Porn","Maid","Black on black","Shemale","Skinny","Reverse cowgirl","Ghetto","Perfect ass","Romantic sex","Step daughter","Doctor","Blue film black ebony nigeria nigerian","Compilation","S uploaddate","Wet","Stepmom and son","Romantic","Tight pussy","Black african","Bubble butt","Cum inside","Xvideos","Hard fuck","Xxxx","Stepbrother","Real orgasm","Xxx","Office","Japanese wife","Hijab","African big ass","Cute","Handjob","Cum in pussy","Skank milf","Xxx video videos","Huge ass","New","Uniform","Big black dick","Slut","Closeup","Big","Pov","Hairy pussy","Ebony","Teen","Brunette","College","Petite","Threesome","Squirting","Strip","Shower","Kitchen","Car","Public","Beach","Pool","Hotel","Gym","Yoga","Dance","Twerking","Cosplay","Anime","Hentai","Korean","Chinese","Thai","Filipino","Indonesian","Malaysian","Vietnamese","Brazilian","Colombian","Mexican","Venezuelan","Argentinian","Cuban","Dominican","Russian","Ukrainian","Polish","Czech","Romanian","German","French","Italian","Spanish","British","Irish","Dutch","Swedish","Norwegian","Finnish","Danish","Greek","Turkish","Persian","Pakistani","Bangladeshi","Sri Lankan","Nepali","Ethiopian","Ghanaian","Tanzanian","Ugandan","Cameroon","Senegalese","Congolese","Zimbabwean","Egyptian","Moroccan","Algerian","Step Sister","Step Brother","Step Mom","Step Dad","Babysitter","Neighbor","Boss","Secretary","Nurse","Police","Firefighter","Military","Cheerleader","Model","Actress","Singer","Dancer","Bartender","Waitress","Flight Attendant","Receptionist","Librarian","Tutor","Student","Roommate","Best Friend","Ex Girlfriend","Sugar Daddy","Sugar Mommy","Escort","Gloryhole","Swallow","Gagging","Titfuck","Footjob","Rimming","Pegging","Double Penetration","Triple Penetration","Monster Cock","Small Tits","Saggy Tits","Perky Tits","Fake Tits","Pierced","Tattoo","Goth","Emo","Punk","Hipster","Nerdy","Glasses","Braces","Pigtails","Ponytail","Braids","Short Hair","Long Hair","Natural Hair","Colored Hair"];function O2(){const s=ys.useRef(null),[e,t]=A.useState(!1),n=r=>{if(s.current){const o=r==="left"?-300:300;s.current.scrollBy({left:o,behavior:"smooth"})}};return T.jsx("div",{className:"hidden md:block border-b border-border/50 bg-background/80 backdrop-blur-sm",children:T.jsxs("div",{className:"container relative flex items-center gap-2 py-2",children:[T.jsxs(C2,{open:e,onOpenChange:t,children:[T.jsx(_2,{asChild:!0,children:T.jsxs(ht,{variant:"ghost",size:"sm",className:"shrink-0 bg-primary hover:bg-primary/90 text-white font-medium text-xs gap-1.5 px-3 h-7",children:[T.jsx(LI,{className:"h-3.5 w-3.5"})," All"]})}),T.jsxs($1,{className:"max-w-4xl max-h-[80vh] overflow-hidden",children:[T.jsx(j1,{children:T.jsxs(G1,{className:"text-xl font-bold text-primary flex items-center gap-2",children:[T.jsx(jg,{className:"h-5 w-5 text-primary"})," All Categories"]})}),T.jsx(dp,{className:"max-h-[60vh] pr-4",children:T.jsx("div",{className:"flex flex-wrap gap-2 py-4",children:ig.map((r,o)=>T.jsx("button",{onClick:()=>{t(!1),window.location.href=`/?q=${encodeURIComponent(r)}`},className:"px-4 py-2 text-sm bg-secondary/50 hover:bg-primary hover:text-white rounded-full transition-all hover:scale-105 hover:shadow-lg",children:r},o))})})]})]}),T.jsx(ht,{variant:"ghost",size:"icon",onClick:()=>n("left"),className:"h-7 w-7 rounded-full shrink-0 bg-secondary/50 hover:bg-secondary",children:T.jsx(id,{className:"h-4 w-4"})}),T.jsx("div",{ref:s,className:"flex gap-2 overflow-x-auto scrollbar-hide scroll-smooth flex-1",children:ig.map((r,o)=>T.jsx("button",{onClick:()=>{window.location.href=`/?q=${encodeURIComponent(r)}`},className:"px-3 py-1 text-sm whitespace-nowrap bg-secondary/30 hover:bg-primary hover:text-white rounded-full transition-colors shrink-0",children:r},o))}),T.jsx(ht,{variant:"ghost",size:"icon",onClick:()=>n("right"),className:"h-7 w-7 rounded-full shrink-0 bg-secondary/50 hover:bg-secondary",children:T.jsx(rd,{className:"h-4 w-4"})})]})})}function N2(){const[s,e]=A.useState(!1),[t,n]=A.useState(!1),[r]=Ig(),[o,l]=A.useState(""),f=new URLSearchParams(window.location.search).get("q"),d=r==="/"&&!f;A.useEffect(()=>{f||l("")},[f]);const m=A.useCallback(()=>{window.location.href="/"},[]),g=A.useCallback(()=>{window.history.length>2?window.history.back():m()},[m]),p=E=>{E.preventDefault();const v=o.trim();v&&(window.location.href=`/?q=${encodeURIComponent(v)}`,n(!1))};return T.jsxs("header",{className:"sticky top-0 z-50 w-full border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[T.jsxs("div",{className:"container flex h-16 items-center justify-between px-4",children:[T.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[!d&&T.jsxs(T.Fragment,{children:[T.jsxs(ht,{variant:"ghost",size:"sm",onClick:g,className:"bg-gradient-to-r from-primary/20 to-primary/10 hover:from-primary hover:to-primary/80 text-primary hover:text-white rounded-full gap-2 px-3 py-2 transition-all duration-300 border border-primary/30 hover:border-transparent shadow-sm hover:shadow-lg hover:shadow-primary/30","data-testid":"button-header-back",children:[T.jsx(_u,{className:"h-4 w-4"}),T.jsx("span",{className:"hidden sm:inline font-medium text-sm",children:"Back"})]}),T.jsxs(ht,{variant:"ghost",size:"sm",onClick:m,className:"hidden md:flex bg-gradient-to-r from-primary/20 to-primary/10 hover:from-primary hover:to-primary/80 text-primary hover:text-white rounded-full gap-2 px-3 py-2 transition-all duration-300 border border-primary/30 hover:border-transparent shadow-sm hover:shadow-lg hover:shadow-primary/30","data-testid":"button-header-home",children:[T.jsx(Xh,{className:"h-4 w-4"}),T.jsx("span",{className:"font-medium text-sm",children:"Home"})]})]}),d&&T.jsxs(ht,{variant:"ghost",size:"sm",onClick:m,className:"hidden md:flex bg-gradient-to-r from-primary/20 to-primary/10 hover:from-primary hover:to-primary/80 text-primary hover:text-white rounded-full gap-2 px-3 py-2 transition-all duration-300 border border-primary/30 hover:border-transparent shadow-sm hover:shadow-lg hover:shadow-primary/30","data-testid":"button-header-home-active",children:[T.jsx(Xh,{className:"h-4 w-4"}),T.jsx("span",{className:"font-medium text-sm",children:"Home"})]}),T.jsxs(a2,{open:s,onOpenChange:e,children:[T.jsx(o2,{asChild:!0,children:T.jsx(ht,{variant:"ghost",size:"icon",className:"md:hidden",children:T.jsx(UI,{className:"h-6 w-6"})})}),T.jsxs(A1,{side:"left",className:"w-[300px] bg-background border-r border-border p-0 flex flex-col",children:[T.jsxs("div",{className:"flex flex-col gap-4 p-6 pb-2",children:[T.jsx("button",{onClick:()=>{e(!1),m()},className:"text-xl font-bold font-heading text-primary text-left",children:"DAVEX ADULT ZONE"}),T.jsxs("nav",{className:"flex flex-col gap-3",children:[T.jsxs("button",{onClick:()=>{e(!1),m()},className:"text-lg font-medium hover:text-primary transition-colors flex items-center gap-2 text-left","data-testid":"link-menu-home",children:[T.jsx(Xh,{className:"h-5 w-5"})," Home"]}),!d&&T.jsxs("button",{onClick:()=>{e(!1),g()},className:"text-lg font-medium hover:text-primary transition-colors flex items-center gap-2 text-left","data-testid":"link-menu-back",children:[T.jsx(_u,{className:"h-5 w-5"})," Go Back"]}),T.jsxs("a",{href:"http://www.davexmainweb.zone.id",target:"_blank",rel:"noreferrer",className:"text-lg font-medium hover:text-primary transition-colors flex items-center gap-2","data-testid":"link-menu-external",children:[T.jsx(pE,{className:"h-5 w-5"})," Visit our tech site"]}),T.jsxs("a",{href:"http://www.davexsupport.zone.id/",target:"_blank",rel:"noreferrer",className:"text-lg font-medium hover:text-primary transition-colors flex items-center gap-2",children:[T.jsx(Km,{className:"h-5 w-5"})," Support our project"]}),T.jsxs("a",{href:"https://whatsapp.com/channel/0029VbApvFQ2Jl84lhONkc3k",target:"_blank",rel:"noreferrer",className:"text-lg font-medium hover:text-primary transition-colors flex items-center gap-2",children:[T.jsx(AT,{className:"h-5 w-5"})," Follow our tech WhatsApp channel"]})]})]}),T.jsx("div",{className:"px-6 py-2",children:T.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wider flex items-center gap-2",children:[T.jsx(jg,{className:"h-4 w-4"})," Categories"]})}),T.jsx(dp,{className:"flex-1 px-4",children:T.jsx("div",{className:"flex flex-wrap gap-2 pb-6",children:ig.map((E,v)=>T.jsx("button",{onClick:()=>{e(!1),window.location.href=`/?q=${encodeURIComponent(E)}`},className:"px-3 py-1.5 text-sm bg-secondary/50 hover:bg-primary hover:text-white rounded-full transition-colors",children:E},v))})})]})]}),T.jsx("button",{onClick:m,className:"text-xl md:text-2xl font-bold font-heading tracking-tight text-primary truncate",children:"DAVEX ADULT ZONE"})]}),T.jsx("div",{className:"hidden md:flex flex-1 max-w-md mx-4",children:T.jsxs("form",{onSubmit:p,className:"w-full relative flex gap-2",children:[T.jsxs("div",{className:"relative flex-1",children:[T.jsx(du,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),T.jsx(sg,{placeholder:"Search videos...",className:"pl-9 bg-secondary/50 border-transparent focus:bg-secondary focus:border-primary transition-all",value:o,onChange:E=>l(E.target.value),"data-testid":"input-search-desktop"})]}),T.jsx(ht,{type:"submit",size:"sm",className:"bg-primary text-primary-foreground","data-testid":"button-search-desktop",children:"Search"})]})}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(ht,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>n(!t),children:t?T.jsx(ul,{className:"h-5 w-5"}):T.jsx(du,{className:"h-5 w-5"})}),T.jsx("nav",{className:"hidden md:flex items-center gap-4",children:T.jsx("a",{href:"http://www.davexmainweb.zone.id",target:"_blank",rel:"noreferrer",children:T.jsxs(ht,{size:"sm",className:"gap-2 bg-primary hover:bg-primary/90 text-white font-bold shadow-lg shadow-primary/30 border-0 transition-all hover:scale-105",children:["Visit our tech site ",T.jsx(pE,{className:"h-3 w-3"})]})})})]})]}),t&&T.jsx("div",{className:"md:hidden border-b border-border bg-background p-4 animate-in slide-in-from-top-2",children:T.jsxs("form",{onSubmit:p,className:"flex gap-2",children:[T.jsxs("div",{className:"relative flex-1",children:[T.jsx(du,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),T.jsx(sg,{autoFocus:!0,placeholder:"Search videos...",className:"pl-9",value:o,onChange:E=>l(E.target.value),"data-testid":"input-search-mobile"})]}),T.jsx(ht,{type:"submit",size:"sm","data-testid":"button-search-mobile",children:"Search"})]})}),T.jsx(O2,{})]})}function k2(){return T.jsx("footer",{className:"w-full border-t border-border bg-card mt-auto",children:T.jsxs("div",{className:"container px-4 py-8",children:[T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[T.jsxs("div",{className:"flex flex-col gap-3",children:[T.jsx("h3",{className:"text-lg font-bold text-primary",children:"DAVEX ADULT ZONE"}),T.jsx("p",{className:"text-sm text-muted-foreground",children:"Your premium destination for quality entertainment content."})]}),T.jsxs("div",{className:"flex flex-col gap-3",children:[T.jsx("h4",{className:"text-sm font-semibold text-foreground uppercase tracking-wider",children:"Quick Links"}),T.jsxs("nav",{className:"flex flex-col gap-2",children:[T.jsxs("a",{href:"http://www.davexmainweb.zone.id",target:"_blank",rel:"noreferrer",className:"text-sm text-muted-foreground hover:text-primary transition-colors flex items-center gap-2",children:[T.jsx(RI,{className:"h-4 w-4"})," Visit our tech site"]}),T.jsxs("a",{href:"http://www.davexsupport.zone.id",target:"_blank",rel:"noreferrer",className:"text-sm text-muted-foreground hover:text-primary transition-colors flex items-center gap-2",children:[T.jsx(Km,{className:"h-4 w-4"})," Support our project"]})]})]}),T.jsxs("div",{className:"flex flex-col gap-3",children:[T.jsx("h4",{className:"text-sm font-semibold text-foreground uppercase tracking-wider",children:"Connect With Me"}),T.jsx("nav",{className:"flex flex-col gap-2",children:T.jsxs("a",{href:"https://whatsapp.com/channel/0029VbApvFQ2Jl84lhONkc3k",target:"_blank",rel:"noreferrer",className:"text-sm text-muted-foreground hover:text-primary transition-colors flex items-center gap-2",children:[T.jsx(AT,{className:"h-4 w-4"})," WhatsApp Channel"]})})]})]}),T.jsxs("div",{className:"mt-8 pt-6 border-t border-border/50 flex flex-col md:flex-row items-center justify-between gap-4",children:[T.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:["Made with ",T.jsx(Km,{className:"h-4 w-4 text-primary fill-primary"})," by DAVE TECH"]}),T.jsxs("p",{className:"text-xs text-muted-foreground/60",children:[" ",new Date().getFullYear()," DAVE TECH. All rights reserved."]})]})]})})}function gu({children:s}){return T.jsxs("div",{className:"min-h-screen flex flex-col bg-background text-foreground",children:[T.jsx(N2,{}),T.jsx("main",{className:"flex-1 w-full",children:s}),T.jsx(k2,{})]})}function fp({video:s,variant:e="default",className:t,onImageError:n}){const r=A.useRef(null),o=A.useRef(!0),[l,c]=A.useState(!1),f=(typeof s.views=="number",s.views);if((s.length==="0 min"||s.length==="0 sec")&&(f===0||f==="0")||!s.thumbnail_url||s.thumbnail_url===""||l||s.thumbnail_url.includes("THUMBNUM"))return null;const d=v=>{if(v==null||v==="")return"New";const S=typeof v=="number"?v:parseInt(String(v).replace(/,/g,""));return isNaN(S)?String(v):S===0?"New":S>1e6?(S/1e6).toFixed(1)+"M":S>1e3?(S/1e3).toFixed(1)+"k":S.toString()},m=v=>{const S=v.touches[0];r.current={x:S.clientX,y:S.clientY},o.current=!0},g=v=>{if(!r.current)return;const S=v.touches[0],b=Math.abs(S.clientX-r.current.x),R=Math.abs(S.clientY-r.current.y);(b>10||R>10)&&(o.current=!1)},p=v=>{o.current&&r.current&&(v.preventDefault(),window.location.href=Qo(s.url)),r.current=null,o.current=!0},E=v=>{v.preventDefault(),v.stopPropagation(),window.location.href=Qo(s.url)};return T.jsxs("div",{onClick:E,onTouchStart:m,onTouchMove:g,onTouchEnd:p,role:"button",tabIndex:0,"data-testid":`card-video-${s.url.slice(-10)}`,className:Oe("group relative overflow-hidden rounded-lg bg-card transition-all hover:scale-[1.02] cursor-pointer hover:ring-2 hover:ring-primary/50 touch-manipulation select-none",e==="featured"?"aspect-video md:aspect-[21/9]":"aspect-video",t),children:[T.jsx("img",{src:s.thumbnail_url,alt:s.title,className:"h-full w-full object-cover transition-transform duration-500 group-hover:brightness-75",loading:"eager",decoding:"async",fetchPriority:"high",onError:()=>{c(!0),n?.()}}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent opacity-60 group-hover:opacity-80 transition-opacity"}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:T.jsx("div",{className:"rounded-full bg-primary/90 p-3 shadow-lg backdrop-blur-sm transform scale-75 group-hover:scale-100 transition-transform",children:T.jsx(ni,{className:"h-6 w-6 text-white fill-white"})})}),T.jsxs("div",{className:"absolute bottom-0 left-0 w-full p-3 flex flex-col gap-1",children:[T.jsx("h3",{className:Oe("font-medium text-white line-clamp-2 text-shadow",e==="featured"?"text-xl md:text-2xl":"text-sm md:text-base"),children:s.title}),T.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-300 font-medium",children:[T.jsxs("span",{className:"flex items-center gap-1 bg-black/50 px-1.5 py-0.5 rounded backdrop-blur-sm",children:[T.jsx(Bg,{className:"h-3 w-3"})," ",s.length]}),T.jsxs("span",{className:"flex items-center gap-1 bg-black/50 px-1.5 py-0.5 rounded backdrop-blur-sm",children:[T.jsx(Du,{className:"h-3 w-3"})," ",d(s.views)]})]})]})]})}function M2({video:s}){const[e,t]=A.useState(!1);return e?null:T.jsx("div",{className:"min-w-[280px] md:min-w-[320px] snap-start",children:T.jsx(fp,{video:s,onImageError:()=>t(!0)})})}function qE({video:s,className:e}){const[t,n]=A.useState(!1);return t?null:T.jsx(fp,{video:s,className:e,onImageError:()=>n(!0)})}function P2({video:s}){const[e,t]=A.useState(!1);return e?null:T.jsx(fp,{video:s,variant:"featured",onImageError:()=>t(!0)})}function $o({title:s,videos:e,type:t,icon:n}){const r=A.useRef(null),o=c=>{if(r.current){const{current:f}=r,d=c==="left"?-f.offsetWidth:f.offsetWidth;f.scrollBy({left:d,behavior:"smooth"})}};if(!e.length)return null;const l=e.filter(c=>{if(!c.thumbnail_url||c.thumbnail_url===""||!c.thumbnail_url.startsWith("http"))return!1;const f=(typeof c.views=="number",c.views);return!((c.length==="0 min"||c.length==="0 sec")&&(f===0||f==="0"))});return l.length?T.jsxs("section",{className:"py-6 space-y-4",children:[T.jsxs("div",{className:"flex items-center justify-between px-4 md:px-8",children:[T.jsxs("h2",{className:"text-xl md:text-2xl font-bold font-heading text-foreground border-l-4 border-primary pl-3 flex items-center gap-2",children:[n,s]}),t==="horizontal"&&T.jsxs("div",{className:"hidden md:flex gap-2",children:[T.jsx(ht,{variant:"outline",size:"icon",onClick:()=>o("left"),className:"h-8 w-8 rounded-full",children:T.jsx(id,{className:"h-4 w-4"})}),T.jsx(ht,{variant:"outline",size:"icon",onClick:()=>o("right"),className:"h-8 w-8 rounded-full",children:T.jsx(rd,{className:"h-4 w-4"})})]})]}),t==="horizontal"&&T.jsx("div",{className:"relative group",children:T.jsx("div",{ref:r,className:"flex gap-4 overflow-x-auto pb-4 px-4 md:px-8 scrollbar-hide snap-x snap-mandatory",children:l.map((c,f)=>T.jsx(M2,{video:c},f))})}),t==="boxed"&&T.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-6 px-4 md:px-8",children:l.map((c,f)=>T.jsx(qE,{video:c,className:"aspect-[4/3] md:aspect-video"},f))}),t==="mixed"&&T.jsxs("div",{className:"px-4 md:px-8 space-y-6",children:[T.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:l.slice(0,2).map((c,f)=>T.jsx(P2,{video:c},f))}),T.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:l.slice(2).map((c,f)=>T.jsx(qE,{video:c},f+2))})]})]}):null}const F2="VideoWatchHistoryDB",U2=1,Kn="watchHistory";class B2{constructor(){this.db=null,this.dbReady=this.initDB()}initDB(){return new Promise((e,t)=>{const n=indexedDB.open(F2,U2);n.onerror=()=>{console.error("Failed to open IndexedDB:",n.error),t(n.error)},n.onsuccess=()=>{this.db=n.result,e(n.result)},n.onupgradeneeded=r=>{const o=r.target.result;if(!o.objectStoreNames.contains(Kn)){const l=o.createObjectStore(Kn,{keyPath:"id"});l.createIndex("videoUrl","videoUrl",{unique:!0}),l.createIndex("lastWatchedAt","lastWatchedAt",{unique:!1})}}})}async getDB(){return this.db?this.db:this.dbReady}async addOrUpdate(e){const t=await this.getDB();return new Promise((n,r)=>{const l=t.transaction(Kn,"readwrite").objectStore(Kn),f=l.index("videoUrl").get(e.videoUrl);f.onsuccess=()=>{const d=f.result,m={id:d?.id||`video_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...e,createdAt:d?.createdAt||Date.now()},g=l.put(m);g.onsuccess=()=>n(),g.onerror=()=>r(g.error)},f.onerror=()=>r(f.error)})}async getByVideoUrl(e){const t=await this.getDB();return new Promise((n,r)=>{const f=t.transaction(Kn,"readonly").objectStore(Kn).index("videoUrl").get(e);f.onsuccess=()=>n(f.result||null),f.onerror=()=>r(f.error)})}async getAllSortedByRecent(){const e=await this.getDB();return new Promise((t,n)=>{const l=e.transaction(Kn,"readonly").objectStore(Kn).getAll();l.onsuccess=()=>{const c=l.result;c.sort((f,d)=>d.lastWatchedAt-f.lastWatchedAt),t(c)},l.onerror=()=>n(l.error)})}async delete(e){const t=await this.getDB();return new Promise((n,r)=>{const l=t.transaction(Kn,"readwrite").objectStore(Kn),f=l.index("videoUrl").get(e);f.onsuccess=()=>{const d=f.result;if(d){const m=l.delete(d.id);m.onsuccess=()=>n(),m.onerror=()=>r(m.error)}else n()},f.onerror=()=>r(f.error)})}async clear(){const e=await this.getDB();return new Promise((t,n)=>{const l=e.transaction(Kn,"readwrite").objectStore(Kn).clear();l.onsuccess=()=>t(),l.onerror=()=>n(l.error)})}}const pu=new B2;function $2(s){const t=Date.now()-s,n=Math.floor(t/6e4),r=Math.floor(t/36e5),o=Math.floor(t/864e5);return n<1?"Just now":n<60?`${n}m ago`:r<24?`${r}h ago`:o===1?"Yesterday":`${o}d ago`}function j2(s){if(isNaN(s)||!isFinite(s))return"0:00";const e=Math.floor(s/60),t=Math.floor(s%60);return`${e}:${t.toString().padStart(2,"0")}`}function YE({item:s,onRemove:e}){const[t,n]=A.useState(!1),r=f=>{f.preventDefault();const d=s.completed?0:Math.floor(s.currentTime),m=Qo(s.videoUrl);window.location.href=`${m}&t=${d}`},o=f=>{f.preventDefault(),f.stopPropagation(),e(s.videoUrl)},l=Math.min(s.progress,100),c=Math.max(0,s.totalDuration-s.currentTime);return T.jsxs("div",{onClick:r,className:"group relative flex-shrink-0 w-[280px] md:w-[320px] cursor-pointer touch-manipulation select-none","data-testid":`card-continue-watching-${s.id}`,children:[T.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden bg-card shadow-lg transition-all duration-300 hover:scale-[1.02] hover:ring-2 hover:ring-primary/50",children:[t||!s.thumbnailUrl?T.jsx("div",{className:"w-full h-full bg-gradient-to-br from-primary/30 to-primary/10 flex items-center justify-center",children:T.jsx(ni,{className:"h-12 w-12 text-primary/60"})}):T.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"w-full h-full object-cover",loading:"eager",decoding:"async",onError:()=>n(!0)}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent"}),T.jsx("button",{onClick:o,className:"absolute top-2 right-2 p-1.5 rounded-full bg-black/60 hover:bg-red-600 opacity-0 group-hover:opacity-100 transition-all duration-200 z-10",title:"Remove from history",children:T.jsx(ul,{className:"h-4 w-4 text-white"})}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:T.jsx("div",{className:"rounded-full bg-primary/90 p-4 shadow-lg backdrop-blur-sm transform scale-75 group-hover:scale-100 transition-transform",children:s.completed?T.jsx(RT,{className:"h-8 w-8 text-white"}):T.jsx(ni,{className:"h-8 w-8 text-white fill-white"})})}),T.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3",children:[T.jsx("h3",{className:"text-white font-medium text-sm line-clamp-2 mb-2 text-shadow",children:s.title}),T.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-300 mb-2",children:[T.jsxs("span",{className:"flex items-center gap-1",children:[T.jsx(Bg,{className:"h-3 w-3"}),s.completed?"Completed":`${j2(c)} left`]}),T.jsx("span",{className:"text-gray-400",children:$2(s.lastWatchedAt)})]}),T.jsx("div",{className:"relative h-1.5 bg-white/30 rounded-full overflow-hidden",children:T.jsx("div",{className:Oe("absolute h-full rounded-full transition-all",s.completed?"bg-green-500":"bg-primary"),style:{width:`${l}%`}})})]})]}),T.jsx("p",{className:"text-xs text-muted-foreground mt-2 truncate px-1",children:s.author})]})}function G2({className:s}){const[e,t]=A.useState([]),[n,r]=A.useState(!0),[o,l]=A.useState(!1),[c,f]=A.useState(!1),[d,m]=A.useState(!1),g=A.useRef(null),p=A.useCallback(async()=>{try{const C=await pu.getAllSortedByRecent();t(C)}catch(C){console.error("Failed to load watch history:",C)}finally{r(!1)}},[]),E=A.useCallback(()=>{if(g.current){const{scrollLeft:C,scrollWidth:_,clientWidth:D}=g.current;f(C>10),m(C<_-D-10)}},[]);A.useEffect(()=>{p();const C=()=>{p()};window.addEventListener("watchHistoryUpdated",C);const _=setInterval(p,5e3);return()=>{window.removeEventListener("watchHistoryUpdated",C),clearInterval(_)}},[p]),A.useEffect(()=>{E();const C=g.current;if(C)return C.addEventListener("scroll",E),window.addEventListener("resize",E),()=>{C.removeEventListener("scroll",E),window.removeEventListener("resize",E)}},[E,e]);const v=async C=>{try{await pu.delete(C),t(_=>_.filter(D=>D.videoUrl!==C))}catch(_){console.error("Failed to remove from history:",_)}},S=async()=>{if(confirm("Are you sure you want to clear all watch history?"))try{await pu.clear(),t([])}catch(C){console.error("Failed to clear history:",C)}},b=C=>{if(g.current){const _=C==="left"?-350:350;g.current.scrollBy({left:_,behavior:"smooth"})}};if(n||e.length===0)return null;const R=o?e:e.slice(0,10);return T.jsx("div",{className:Oe("py-6",s),children:T.jsxs("div",{className:"container px-4",children:[T.jsxs("div",{className:"flex items-center justify-between mb-4",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:T.jsx(DI,{className:"h-5 w-5 text-primary"})}),T.jsx("h2",{className:"text-xl md:text-2xl font-heading font-bold",children:"Continue Watching"}),T.jsx("span",{className:"text-sm text-muted-foreground bg-secondary/50 px-2 py-0.5 rounded-full",children:e.length})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[!o&&e.length>3&&T.jsxs("div",{className:"hidden md:flex items-center gap-1",children:[T.jsx(ht,{variant:"ghost",size:"icon",onClick:()=>b("left"),className:Oe("h-8 w-8 rounded-full bg-secondary hover:bg-primary text-foreground hover:text-white transition-all duration-300",!c&&"opacity-50 pointer-events-none"),children:T.jsx(id,{className:"h-5 w-5"})}),T.jsx(ht,{variant:"ghost",size:"icon",onClick:()=>b("right"),className:Oe("h-8 w-8 rounded-full bg-secondary hover:bg-primary text-foreground hover:text-white transition-all duration-300",!d&&"opacity-50 pointer-events-none"),children:T.jsx(rd,{className:"h-5 w-5"})})]}),e.length>3&&T.jsxs(ht,{variant:"ghost",size:"sm",onClick:()=>l(!o),className:"text-primary hover:text-primary hover:bg-primary/10 gap-1",children:[o?"Show Less":"See All",T.jsx(fI,{className:Oe("h-4 w-4 transition-transform",o&&"rotate-180")})]}),T.jsxs(ht,{variant:"ghost",size:"sm",onClick:S,className:"text-red-500 hover:text-red-600 hover:bg-red-500/10 gap-1",children:[T.jsx(rO,{className:"h-4 w-4"}),T.jsx("span",{className:"hidden sm:inline",children:"Clear All"})]})]})]}),o?T.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:R.map(C=>T.jsx("div",{className:"w-full",children:T.jsx(YE,{item:C,onRemove:v})},C.id))}):T.jsxs("div",{className:"relative",children:[T.jsx("div",{ref:g,className:"flex gap-4 overflow-x-auto pb-4 scrollbar-hide scroll-smooth snap-x snap-mandatory md:snap-none",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:R.map(C=>T.jsx("div",{className:"snap-start",children:T.jsx(YE,{item:C,onRemove:v})},C.id))}),T.jsx("div",{className:"absolute right-0 top-0 bottom-4 w-16 bg-gradient-to-l from-background to-transparent pointer-events-none"})]})]})})}function H1(s,e){return function(){return s.apply(e,arguments)}}const{toString:H2}=Object.prototype,{getPrototypeOf:hp}=Object,{iterator:pd,toStringTag:z1}=Symbol,yd=(s=>e=>{const t=H2.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),os=s=>(s=s.toLowerCase(),e=>yd(e)===s),vd=s=>e=>typeof e===s,{isArray:Ha}=Array,Pa=vd("undefined");function yl(s){return s!==null&&!Pa(s)&&s.constructor!==null&&!Pa(s.constructor)&&pn(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const V1=os("ArrayBuffer");function z2(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&V1(s.buffer),e}const V2=vd("string"),pn=vd("function"),K1=vd("number"),vl=s=>s!==null&&typeof s=="object",K2=s=>s===!0||s===!1,yu=s=>{if(yd(s)!=="object")return!1;const e=hp(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(z1 in s)&&!(pd in s)},q2=s=>{if(!vl(s)||yl(s))return!1;try{return Object.keys(s).length===0&&Object.getPrototypeOf(s)===Object.prototype}catch{return!1}},Y2=os("Date"),W2=os("File"),X2=os("Blob"),Q2=os("FileList"),Z2=s=>vl(s)&&pn(s.pipe),J2=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||pn(s.append)&&((e=yd(s))==="formdata"||e==="object"&&pn(s.toString)&&s.toString()==="[object FormData]"))},eF=os("URLSearchParams"),[tF,nF,sF,iF]=["ReadableStream","Request","Response","Headers"].map(os),rF=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xl(s,e,{allOwnKeys:t=!1}={}){if(s===null||typeof s>"u")return;let n,r;if(typeof s!="object"&&(s=[s]),Ha(s))for(n=0,r=s.length;n<r;n++)e.call(null,s[n],n,s);else{if(yl(s))return;const o=t?Object.getOwnPropertyNames(s):Object.keys(s),l=o.length;let c;for(n=0;n<l;n++)c=o[n],e.call(null,s[c],c,s)}}function q1(s,e){if(yl(s))return null;e=e.toLowerCase();const t=Object.keys(s);let n=t.length,r;for(;n-- >0;)if(r=t[n],e===r.toLowerCase())return r;return null}const yr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Y1=s=>!Pa(s)&&s!==yr;function rg(){const{caseless:s,skipUndefined:e}=Y1(this)&&this||{},t={},n=(r,o)=>{const l=s&&q1(t,o)||o;yu(t[l])&&yu(r)?t[l]=rg(t[l],r):yu(r)?t[l]=rg({},r):Ha(r)?t[l]=r.slice():(!e||!Pa(r))&&(t[l]=r)};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&xl(arguments[r],n);return t}const aF=(s,e,t,{allOwnKeys:n}={})=>(xl(e,(r,o)=>{t&&pn(r)?s[o]=H1(r,t):s[o]=r},{allOwnKeys:n}),s),oF=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),lF=(s,e,t,n)=>{s.prototype=Object.create(e.prototype,n),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),t&&Object.assign(s.prototype,t)},cF=(s,e,t,n)=>{let r,o,l;const c={};if(e=e||{},s==null)return e;do{for(r=Object.getOwnPropertyNames(s),o=r.length;o-- >0;)l=r[o],(!n||n(l,s,e))&&!c[l]&&(e[l]=s[l],c[l]=!0);s=t!==!1&&hp(s)}while(s&&(!t||t(s,e))&&s!==Object.prototype);return e},uF=(s,e,t)=>{s=String(s),(t===void 0||t>s.length)&&(t=s.length),t-=e.length;const n=s.indexOf(e,t);return n!==-1&&n===t},dF=s=>{if(!s)return null;if(Ha(s))return s;let e=s.length;if(!K1(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=s[e];return t},fF=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&hp(Uint8Array)),hF=(s,e)=>{const n=(s&&s[pd]).call(s);let r;for(;(r=n.next())&&!r.done;){const o=r.value;e.call(s,o[0],o[1])}},mF=(s,e)=>{let t;const n=[];for(;(t=s.exec(e))!==null;)n.push(t);return n},gF=os("HTMLFormElement"),pF=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,r){return n.toUpperCase()+r}),WE=(({hasOwnProperty:s})=>(e,t)=>s.call(e,t))(Object.prototype),yF=os("RegExp"),W1=(s,e)=>{const t=Object.getOwnPropertyDescriptors(s),n={};xl(t,(r,o)=>{let l;(l=e(r,o,s))!==!1&&(n[o]=l||r)}),Object.defineProperties(s,n)},vF=s=>{W1(s,(e,t)=>{if(pn(s)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=s[t];if(pn(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},xF=(s,e)=>{const t={},n=r=>{r.forEach(o=>{t[o]=!0})};return Ha(s)?n(s):n(String(s).split(e)),t},EF=()=>{},SF=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e;function bF(s){return!!(s&&pn(s.append)&&s[z1]==="FormData"&&s[pd])}const TF=s=>{const e=new Array(10),t=(n,r)=>{if(vl(n)){if(e.indexOf(n)>=0)return;if(yl(n))return n;if(!("toJSON"in n)){e[r]=n;const o=Ha(n)?[]:{};return xl(n,(l,c)=>{const f=t(l,r+1);!Pa(f)&&(o[c]=f)}),e[r]=void 0,o}}return n};return t(s,0)},AF=os("AsyncFunction"),RF=s=>s&&(vl(s)||pn(s))&&pn(s.then)&&pn(s.catch),X1=((s,e)=>s?setImmediate:e?((t,n)=>(yr.addEventListener("message",({source:r,data:o})=>{r===yr&&o===t&&n.length&&n.shift()()},!1),r=>{n.push(r),yr.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",pn(yr.postMessage)),wF=typeof queueMicrotask<"u"?queueMicrotask.bind(yr):typeof process<"u"&&process.nextTick||X1,LF=s=>s!=null&&pn(s[pd]),ne={isArray:Ha,isArrayBuffer:V1,isBuffer:yl,isFormData:J2,isArrayBufferView:z2,isString:V2,isNumber:K1,isBoolean:K2,isObject:vl,isPlainObject:yu,isEmptyObject:q2,isReadableStream:tF,isRequest:nF,isResponse:sF,isHeaders:iF,isUndefined:Pa,isDate:Y2,isFile:W2,isBlob:X2,isRegExp:yF,isFunction:pn,isStream:Z2,isURLSearchParams:eF,isTypedArray:fF,isFileList:Q2,forEach:xl,merge:rg,extend:aF,trim:rF,stripBOM:oF,inherits:lF,toFlatObject:cF,kindOf:yd,kindOfTest:os,endsWith:uF,toArray:dF,forEachEntry:hF,matchAll:mF,isHTMLForm:gF,hasOwnProperty:WE,hasOwnProp:WE,reduceDescriptors:W1,freezeMethods:vF,toObjectSet:xF,toCamelCase:pF,noop:EF,toFiniteNumber:SF,findKey:q1,global:yr,isContextDefined:Y1,isSpecCompliantForm:bF,toJSONObject:TF,isAsyncFn:AF,isThenable:RF,setImmediate:X1,asap:wF,isIterable:LF};function Pe(s,e,t,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}ne.inherits(Pe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ne.toJSONObject(this.config),code:this.code,status:this.status}}});const Q1=Pe.prototype,Z1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{Z1[s]={value:s}});Object.defineProperties(Pe,Z1);Object.defineProperty(Q1,"isAxiosError",{value:!0});Pe.from=(s,e,t,n,r,o)=>{const l=Object.create(Q1);ne.toFlatObject(s,l,function(m){return m!==Error.prototype},d=>d!=="isAxiosError");const c=s&&s.message?s.message:"Error",f=e==null&&s?s.code:e;return Pe.call(l,c,f,t,n,r),s&&l.cause==null&&Object.defineProperty(l,"cause",{value:s,configurable:!0}),l.name=s&&s.name||"Error",o&&Object.assign(l,o),l};const CF=null;function ag(s){return ne.isPlainObject(s)||ne.isArray(s)}function J1(s){return ne.endsWith(s,"[]")?s.slice(0,-2):s}function XE(s,e,t){return s?s.concat(e).map(function(r,o){return r=J1(r),!t&&o?"["+r+"]":r}).join(t?".":""):e}function _F(s){return ne.isArray(s)&&!s.some(ag)}const DF=ne.toFlatObject(ne,{},null,function(e){return/^is[A-Z]/.test(e)});function xd(s,e,t){if(!ne.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,t=ne.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,b){return!ne.isUndefined(b[S])});const n=t.metaTokens,r=t.visitor||m,o=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&ne.isSpecCompliantForm(e);if(!ne.isFunction(r))throw new TypeError("visitor must be a function");function d(v){if(v===null)return"";if(ne.isDate(v))return v.toISOString();if(ne.isBoolean(v))return v.toString();if(!f&&ne.isBlob(v))throw new Pe("Blob is not supported. Use a Buffer instead.");return ne.isArrayBuffer(v)||ne.isTypedArray(v)?f&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function m(v,S,b){let R=v;if(v&&!b&&typeof v=="object"){if(ne.endsWith(S,"{}"))S=n?S:S.slice(0,-2),v=JSON.stringify(v);else if(ne.isArray(v)&&_F(v)||(ne.isFileList(v)||ne.endsWith(S,"[]"))&&(R=ne.toArray(v)))return S=J1(S),R.forEach(function(_,D){!(ne.isUndefined(_)||_===null)&&e.append(l===!0?XE([S],D,o):l===null?S:S+"[]",d(_))}),!1}return ag(v)?!0:(e.append(XE(b,S,o),d(v)),!1)}const g=[],p=Object.assign(DF,{defaultVisitor:m,convertValue:d,isVisitable:ag});function E(v,S){if(!ne.isUndefined(v)){if(g.indexOf(v)!==-1)throw Error("Circular reference detected in "+S.join("."));g.push(v),ne.forEach(v,function(R,C){(!(ne.isUndefined(R)||R===null)&&r.call(e,R,ne.isString(C)?C.trim():C,S,p))===!0&&E(R,S?S.concat(C):[C])}),g.pop()}}if(!ne.isObject(s))throw new TypeError("data must be an object");return E(s),e}function QE(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function mp(s,e){this._pairs=[],s&&xd(s,this,e)}const eR=mp.prototype;eR.append=function(e,t){this._pairs.push([e,t])};eR.toString=function(e){const t=e?function(n){return e.call(this,n,QE)}:QE;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function IF(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function tR(s,e,t){if(!e)return s;const n=t&&t.encode||IF;ne.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let o;if(r?o=r(e,t):o=ne.isURLSearchParams(e)?e.toString():new mp(e,t).toString(n),o){const l=s.indexOf("#");l!==-1&&(s=s.slice(0,l)),s+=(s.indexOf("?")===-1?"?":"&")+o}return s}class ZE{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ne.forEach(this.handlers,function(n){n!==null&&e(n)})}}const nR={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},OF=typeof URLSearchParams<"u"?URLSearchParams:mp,NF=typeof FormData<"u"?FormData:null,kF=typeof Blob<"u"?Blob:null,MF={isBrowser:!0,classes:{URLSearchParams:OF,FormData:NF,Blob:kF},protocols:["http","https","file","blob","url","data"]},gp=typeof window<"u"&&typeof document<"u",og=typeof navigator=="object"&&navigator||void 0,PF=gp&&(!og||["ReactNative","NativeScript","NS"].indexOf(og.product)<0),FF=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",UF=gp&&window.location.href||"http://localhost",BF=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:gp,hasStandardBrowserEnv:PF,hasStandardBrowserWebWorkerEnv:FF,navigator:og,origin:UF},Symbol.toStringTag,{value:"Module"})),tn={...BF,...MF};function $F(s,e){return xd(s,new tn.classes.URLSearchParams,{visitor:function(t,n,r,o){return tn.isNode&&ne.isBuffer(t)?(this.append(n,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...e})}function jF(s){return ne.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function GF(s){const e={},t=Object.keys(s);let n;const r=t.length;let o;for(n=0;n<r;n++)o=t[n],e[o]=s[o];return e}function sR(s){function e(t,n,r,o){let l=t[o++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),f=o>=t.length;return l=!l&&ne.isArray(r)?r.length:l,f?(ne.hasOwnProp(r,l)?r[l]=[r[l],n]:r[l]=n,!c):((!r[l]||!ne.isObject(r[l]))&&(r[l]=[]),e(t,n,r[l],o)&&ne.isArray(r[l])&&(r[l]=GF(r[l])),!c)}if(ne.isFormData(s)&&ne.isFunction(s.entries)){const t={};return ne.forEachEntry(s,(n,r)=>{e(jF(n),r,t,0)}),t}return null}function HF(s,e,t){if(ne.isString(s))try{return(e||JSON.parse)(s),ne.trim(s)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(s)}const El={transitional:nR,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,o=ne.isObject(e);if(o&&ne.isHTMLForm(e)&&(e=new FormData(e)),ne.isFormData(e))return r?JSON.stringify(sR(e)):e;if(ne.isArrayBuffer(e)||ne.isBuffer(e)||ne.isStream(e)||ne.isFile(e)||ne.isBlob(e)||ne.isReadableStream(e))return e;if(ne.isArrayBufferView(e))return e.buffer;if(ne.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let c;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return $F(e,this.formSerializer).toString();if((c=ne.isFileList(e))||n.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return xd(c?{"files[]":e}:e,f&&new f,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),HF(e)):e}],transformResponse:[function(e){const t=this.transitional||El.transitional,n=t&&t.forcedJSONParsing,r=this.responseType==="json";if(ne.isResponse(e)||ne.isReadableStream(e))return e;if(e&&ne.isString(e)&&(n&&!this.responseType||r)){const l=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(c){if(l)throw c.name==="SyntaxError"?Pe.from(c,Pe.ERR_BAD_RESPONSE,this,null,this.response):c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tn.classes.FormData,Blob:tn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ne.forEach(["delete","get","head","post","put","patch"],s=>{El.headers[s]={}});const zF=ne.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),VF=s=>{const e={};let t,n,r;return s&&s.split(`
`).forEach(function(l){r=l.indexOf(":"),t=l.substring(0,r).trim().toLowerCase(),n=l.substring(r+1).trim(),!(!t||e[t]&&zF[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e},JE=Symbol("internals");function jo(s){return s&&String(s).trim().toLowerCase()}function vu(s){return s===!1||s==null?s:ne.isArray(s)?s.map(vu):String(s)}function KF(s){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(s);)e[n[1]]=n[2];return e}const qF=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function um(s,e,t,n,r){if(ne.isFunction(n))return n.call(this,e,t);if(r&&(e=t),!!ne.isString(e)){if(ne.isString(n))return e.indexOf(n)!==-1;if(ne.isRegExp(n))return n.test(e)}}function YF(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function WF(s,e){const t=ne.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(s,n+t,{value:function(r,o,l){return this[n].call(this,e,r,o,l)},configurable:!0})})}let yn=class{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function o(c,f,d){const m=jo(f);if(!m)throw new Error("header name must be a non-empty string");const g=ne.findKey(r,m);(!g||r[g]===void 0||d===!0||d===void 0&&r[g]!==!1)&&(r[g||f]=vu(c))}const l=(c,f)=>ne.forEach(c,(d,m)=>o(d,m,f));if(ne.isPlainObject(e)||e instanceof this.constructor)l(e,t);else if(ne.isString(e)&&(e=e.trim())&&!qF(e))l(VF(e),t);else if(ne.isObject(e)&&ne.isIterable(e)){let c={},f,d;for(const m of e){if(!ne.isArray(m))throw TypeError("Object iterator must return a key-value pair");c[d=m[0]]=(f=c[d])?ne.isArray(f)?[...f,m[1]]:[f,m[1]]:m[1]}l(c,t)}else e!=null&&o(t,e,n);return this}get(e,t){if(e=jo(e),e){const n=ne.findKey(this,e);if(n){const r=this[n];if(!t)return r;if(t===!0)return KF(r);if(ne.isFunction(t))return t.call(this,r,n);if(ne.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=jo(e),e){const n=ne.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||um(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let r=!1;function o(l){if(l=jo(l),l){const c=ne.findKey(n,l);c&&(!t||um(n,n[c],c,t))&&(delete n[c],r=!0)}}return ne.isArray(e)?e.forEach(o):o(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const o=t[n];(!e||um(this,this[o],o,e,!0))&&(delete this[o],r=!0)}return r}normalize(e){const t=this,n={};return ne.forEach(this,(r,o)=>{const l=ne.findKey(n,o);if(l){t[l]=vu(r),delete t[o];return}const c=e?YF(o):String(o).trim();c!==o&&delete t[o],t[c]=vu(r),n[c]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ne.forEach(this,(n,r)=>{n!=null&&n!==!1&&(t[r]=e&&ne.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(r=>n.set(r)),n}static accessor(e){const n=(this[JE]=this[JE]={accessors:{}}).accessors,r=this.prototype;function o(l){const c=jo(l);n[c]||(WF(r,l),n[c]=!0)}return ne.isArray(e)?e.forEach(o):o(e),this}};yn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ne.reduceDescriptors(yn.prototype,({value:s},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(n){this[t]=n}}});ne.freezeMethods(yn);function dm(s,e){const t=this||El,n=e||t,r=yn.from(n.headers);let o=n.data;return ne.forEach(s,function(c){o=c.call(t,o,r.normalize(),e?e.status:void 0)}),r.normalize(),o}function iR(s){return!!(s&&s.__CANCEL__)}function za(s,e,t){Pe.call(this,s??"canceled",Pe.ERR_CANCELED,e,t),this.name="CanceledError"}ne.inherits(za,Pe,{__CANCEL__:!0});function rR(s,e,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?s(t):e(new Pe("Request failed with status code "+t.status,[Pe.ERR_BAD_REQUEST,Pe.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function XF(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function QF(s,e){s=s||10;const t=new Array(s),n=new Array(s);let r=0,o=0,l;return e=e!==void 0?e:1e3,function(f){const d=Date.now(),m=n[o];l||(l=d),t[r]=f,n[r]=d;let g=o,p=0;for(;g!==r;)p+=t[g++],g=g%s;if(r=(r+1)%s,r===o&&(o=(o+1)%s),d-l<e)return;const E=m&&d-m;return E?Math.round(p*1e3/E):void 0}}function ZF(s,e){let t=0,n=1e3/e,r,o;const l=(d,m=Date.now())=>{t=m,r=null,o&&(clearTimeout(o),o=null),s(...d)};return[(...d)=>{const m=Date.now(),g=m-t;g>=n?l(d,m):(r=d,o||(o=setTimeout(()=>{o=null,l(r)},n-g)))},()=>r&&l(r)]}const Bu=(s,e,t=3)=>{let n=0;const r=QF(50,250);return ZF(o=>{const l=o.loaded,c=o.lengthComputable?o.total:void 0,f=l-n,d=r(f),m=l<=c;n=l;const g={loaded:l,total:c,progress:c?l/c:void 0,bytes:f,rate:d||void 0,estimated:d&&c&&m?(c-l)/d:void 0,event:o,lengthComputable:c!=null,[e?"download":"upload"]:!0};s(g)},t)},eS=(s,e)=>{const t=s!=null;return[n=>e[0]({lengthComputable:t,total:s,loaded:n}),e[1]]},tS=s=>(...e)=>ne.asap(()=>s(...e)),JF=tn.hasStandardBrowserEnv?((s,e)=>t=>(t=new URL(t,tn.origin),s.protocol===t.protocol&&s.host===t.host&&(e||s.port===t.port)))(new URL(tn.origin),tn.navigator&&/(msie|trident)/i.test(tn.navigator.userAgent)):()=>!0,eU=tn.hasStandardBrowserEnv?{write(s,e,t,n,r,o,l){if(typeof document>"u")return;const c=[`${s}=${encodeURIComponent(e)}`];ne.isNumber(t)&&c.push(`expires=${new Date(t).toUTCString()}`),ne.isString(n)&&c.push(`path=${n}`),ne.isString(r)&&c.push(`domain=${r}`),o===!0&&c.push("secure"),ne.isString(l)&&c.push(`SameSite=${l}`),document.cookie=c.join("; ")},read(s){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+s+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(s){this.write(s,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function tU(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function nU(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function aR(s,e,t){let n=!tU(e);return s&&(n||t==!1)?nU(s,e):e}const nS=s=>s instanceof yn?{...s}:s;function Tr(s,e){e=e||{};const t={};function n(d,m,g,p){return ne.isPlainObject(d)&&ne.isPlainObject(m)?ne.merge.call({caseless:p},d,m):ne.isPlainObject(m)?ne.merge({},m):ne.isArray(m)?m.slice():m}function r(d,m,g,p){if(ne.isUndefined(m)){if(!ne.isUndefined(d))return n(void 0,d,g,p)}else return n(d,m,g,p)}function o(d,m){if(!ne.isUndefined(m))return n(void 0,m)}function l(d,m){if(ne.isUndefined(m)){if(!ne.isUndefined(d))return n(void 0,d)}else return n(void 0,m)}function c(d,m,g){if(g in e)return n(d,m);if(g in s)return n(void 0,d)}const f={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(d,m,g)=>r(nS(d),nS(m),g,!0)};return ne.forEach(Object.keys({...s,...e}),function(m){const g=f[m]||r,p=g(s[m],e[m],m);ne.isUndefined(p)&&g!==c||(t[m]=p)}),t}const oR=s=>{const e=Tr({},s);let{data:t,withXSRFToken:n,xsrfHeaderName:r,xsrfCookieName:o,headers:l,auth:c}=e;if(e.headers=l=yn.from(l),e.url=tR(aR(e.baseURL,e.url,e.allowAbsoluteUrls),s.params,s.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),ne.isFormData(t)){if(tn.hasStandardBrowserEnv||tn.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(ne.isFunction(t.getHeaders)){const f=t.getHeaders(),d=["content-type","content-length"];Object.entries(f).forEach(([m,g])=>{d.includes(m.toLowerCase())&&l.set(m,g)})}}if(tn.hasStandardBrowserEnv&&(n&&ne.isFunction(n)&&(n=n(e)),n||n!==!1&&JF(e.url))){const f=r&&o&&eU.read(o);f&&l.set(r,f)}return e},sU=typeof XMLHttpRequest<"u",iU=sU&&function(s){return new Promise(function(t,n){const r=oR(s);let o=r.data;const l=yn.from(r.headers).normalize();let{responseType:c,onUploadProgress:f,onDownloadProgress:d}=r,m,g,p,E,v;function S(){E&&E(),v&&v(),r.cancelToken&&r.cancelToken.unsubscribe(m),r.signal&&r.signal.removeEventListener("abort",m)}let b=new XMLHttpRequest;b.open(r.method.toUpperCase(),r.url,!0),b.timeout=r.timeout;function R(){if(!b)return;const _=yn.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),N={data:!c||c==="text"||c==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:_,config:s,request:b};rR(function(I){t(I),S()},function(I){n(I),S()},N),b=null}"onloadend"in b?b.onloadend=R:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(R)},b.onabort=function(){b&&(n(new Pe("Request aborted",Pe.ECONNABORTED,s,b)),b=null)},b.onerror=function(D){const N=D&&D.message?D.message:"Network Error",B=new Pe(N,Pe.ERR_NETWORK,s,b);B.event=D||null,n(B),b=null},b.ontimeout=function(){let D=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const N=r.transitional||nR;r.timeoutErrorMessage&&(D=r.timeoutErrorMessage),n(new Pe(D,N.clarifyTimeoutError?Pe.ETIMEDOUT:Pe.ECONNABORTED,s,b)),b=null},o===void 0&&l.setContentType(null),"setRequestHeader"in b&&ne.forEach(l.toJSON(),function(D,N){b.setRequestHeader(N,D)}),ne.isUndefined(r.withCredentials)||(b.withCredentials=!!r.withCredentials),c&&c!=="json"&&(b.responseType=r.responseType),d&&([p,v]=Bu(d,!0),b.addEventListener("progress",p)),f&&b.upload&&([g,E]=Bu(f),b.upload.addEventListener("progress",g),b.upload.addEventListener("loadend",E)),(r.cancelToken||r.signal)&&(m=_=>{b&&(n(!_||_.type?new za(null,s,b):_),b.abort(),b=null)},r.cancelToken&&r.cancelToken.subscribe(m),r.signal&&(r.signal.aborted?m():r.signal.addEventListener("abort",m)));const C=XF(r.url);if(C&&tn.protocols.indexOf(C)===-1){n(new Pe("Unsupported protocol "+C+":",Pe.ERR_BAD_REQUEST,s));return}b.send(o||null)})},rU=(s,e)=>{const{length:t}=s=s?s.filter(Boolean):[];if(e||t){let n=new AbortController,r;const o=function(d){if(!r){r=!0,c();const m=d instanceof Error?d:this.reason;n.abort(m instanceof Pe?m:new za(m instanceof Error?m.message:m))}};let l=e&&setTimeout(()=>{l=null,o(new Pe(`timeout ${e} of ms exceeded`,Pe.ETIMEDOUT))},e);const c=()=>{s&&(l&&clearTimeout(l),l=null,s.forEach(d=>{d.unsubscribe?d.unsubscribe(o):d.removeEventListener("abort",o)}),s=null)};s.forEach(d=>d.addEventListener("abort",o));const{signal:f}=n;return f.unsubscribe=()=>ne.asap(c),f}},aU=function*(s,e){let t=s.byteLength;if(t<e){yield s;return}let n=0,r;for(;n<t;)r=n+e,yield s.slice(n,r),n=r},oU=async function*(s,e){for await(const t of lU(s))yield*aU(t,e)},lU=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}},sS=(s,e,t,n)=>{const r=oU(s,e);let o=0,l,c=f=>{l||(l=!0,n&&n(f))};return new ReadableStream({async pull(f){try{const{done:d,value:m}=await r.next();if(d){c(),f.close();return}let g=m.byteLength;if(t){let p=o+=g;t(p)}f.enqueue(new Uint8Array(m))}catch(d){throw c(d),d}},cancel(f){return c(f),r.return()}},{highWaterMark:2})},iS=64*1024,{isFunction:Vc}=ne,cU=(({Request:s,Response:e})=>({Request:s,Response:e}))(ne.global),{ReadableStream:rS,TextEncoder:aS}=ne.global,oS=(s,...e)=>{try{return!!s(...e)}catch{return!1}},uU=s=>{s=ne.merge.call({skipUndefined:!0},cU,s);const{fetch:e,Request:t,Response:n}=s,r=e?Vc(e):typeof fetch=="function",o=Vc(t),l=Vc(n);if(!r)return!1;const c=r&&Vc(rS),f=r&&(typeof aS=="function"?(v=>S=>v.encode(S))(new aS):async v=>new Uint8Array(await new t(v).arrayBuffer())),d=o&&c&&oS(()=>{let v=!1;const S=new t(tn.origin,{body:new rS,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!S}),m=l&&c&&oS(()=>ne.isReadableStream(new n("").body)),g={stream:m&&(v=>v.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!g[v]&&(g[v]=(S,b)=>{let R=S&&S[v];if(R)return R.call(S);throw new Pe(`Response type '${v}' is not supported`,Pe.ERR_NOT_SUPPORT,b)})});const p=async v=>{if(v==null)return 0;if(ne.isBlob(v))return v.size;if(ne.isSpecCompliantForm(v))return(await new t(tn.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(ne.isArrayBufferView(v)||ne.isArrayBuffer(v))return v.byteLength;if(ne.isURLSearchParams(v)&&(v=v+""),ne.isString(v))return(await f(v)).byteLength},E=async(v,S)=>{const b=ne.toFiniteNumber(v.getContentLength());return b??p(S)};return async v=>{let{url:S,method:b,data:R,signal:C,cancelToken:_,timeout:D,onDownloadProgress:N,onUploadProgress:B,responseType:I,headers:P,withCredentials:M="same-origin",fetchOptions:U}=oR(v),q=e||fetch;I=I?(I+"").toLowerCase():"text";let V=rU([C,_&&_.toAbortSignal()],D),ee=null;const Z=V&&V.unsubscribe&&(()=>{V.unsubscribe()});let re;try{if(B&&d&&b!=="get"&&b!=="head"&&(re=await E(P,R))!==0){let k=new t(S,{method:"POST",body:R,duplex:"half"}),G;if(ne.isFormData(R)&&(G=k.headers.get("content-type"))&&P.setContentType(G),k.body){const[te,le]=eS(re,Bu(tS(B)));R=sS(k.body,iS,te,le)}}ne.isString(M)||(M=M?"include":"omit");const F=o&&"credentials"in t.prototype,z={...U,signal:V,method:b.toUpperCase(),headers:P.normalize().toJSON(),body:R,duplex:"half",credentials:F?M:void 0};ee=o&&new t(S,z);let j=await(o?q(ee,U):q(S,z));const oe=m&&(I==="stream"||I==="response");if(m&&(N||oe&&Z)){const k={};["status","statusText","headers"].forEach(he=>{k[he]=j[he]});const G=ne.toFiniteNumber(j.headers.get("content-length")),[te,le]=N&&eS(G,Bu(tS(N),!0))||[];j=new n(sS(j.body,iS,te,()=>{le&&le(),Z&&Z()}),k)}I=I||"text";let fe=await g[ne.findKey(g,I)||"text"](j,v);return!oe&&Z&&Z(),await new Promise((k,G)=>{rR(k,G,{data:fe,headers:yn.from(j.headers),status:j.status,statusText:j.statusText,config:v,request:ee})})}catch(F){throw Z&&Z(),F&&F.name==="TypeError"&&/Load failed|fetch/i.test(F.message)?Object.assign(new Pe("Network Error",Pe.ERR_NETWORK,v,ee),{cause:F.cause||F}):Pe.from(F,F&&F.code,v,ee)}}},dU=new Map,lR=s=>{let e=s&&s.env||{};const{fetch:t,Request:n,Response:r}=e,o=[n,r,t];let l=o.length,c=l,f,d,m=dU;for(;c--;)f=o[c],d=m.get(f),d===void 0&&m.set(f,d=c?new Map:uU(e)),m=d;return d};lR();const pp={http:CF,xhr:iU,fetch:{get:lR}};ne.forEach(pp,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const lS=s=>`- ${s}`,fU=s=>ne.isFunction(s)||s===null||s===!1;function hU(s,e){s=ne.isArray(s)?s:[s];const{length:t}=s;let n,r;const o={};for(let l=0;l<t;l++){n=s[l];let c;if(r=n,!fU(n)&&(r=pp[(c=String(n)).toLowerCase()],r===void 0))throw new Pe(`Unknown adapter '${c}'`);if(r&&(ne.isFunction(r)||(r=r.get(e))))break;o[c||"#"+l]=r}if(!r){const l=Object.entries(o).map(([f,d])=>`adapter ${f} `+(d===!1?"is not supported by the environment":"is not available in the build"));let c=t?l.length>1?`since :
`+l.map(lS).join(`
`):" "+lS(l[0]):"as no adapter specified";throw new Pe("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return r}const cR={getAdapter:hU,adapters:pp};function fm(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new za(null,s)}function cS(s){return fm(s),s.headers=yn.from(s.headers),s.data=dm.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),cR.getAdapter(s.adapter||El.adapter,s)(s).then(function(n){return fm(s),n.data=dm.call(s,s.transformResponse,n),n.headers=yn.from(n.headers),n},function(n){return iR(n)||(fm(s),n&&n.response&&(n.response.data=dm.call(s,s.transformResponse,n.response),n.response.headers=yn.from(n.response.headers))),Promise.reject(n)})}const uR="1.13.2",Ed={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{Ed[s]=function(n){return typeof n===s||"a"+(e<1?"n ":" ")+s}});const uS={};Ed.transitional=function(e,t,n){function r(o,l){return"[Axios v"+uR+"] Transitional option '"+o+"'"+l+(n?". "+n:"")}return(o,l,c)=>{if(e===!1)throw new Pe(r(l," has been removed"+(t?" in "+t:"")),Pe.ERR_DEPRECATED);return t&&!uS[l]&&(uS[l]=!0,console.warn(r(l," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,l,c):!0}};Ed.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function mU(s,e,t){if(typeof s!="object")throw new Pe("options must be an object",Pe.ERR_BAD_OPTION_VALUE);const n=Object.keys(s);let r=n.length;for(;r-- >0;){const o=n[r],l=e[o];if(l){const c=s[o],f=c===void 0||l(c,o,s);if(f!==!0)throw new Pe("option "+o+" must be "+f,Pe.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Pe("Unknown option "+o,Pe.ERR_BAD_OPTION)}}const xu={assertOptions:mU,validators:Ed},hs=xu.validators;let xr=class{constructor(e){this.defaults=e||{},this.interceptors={request:new ZE,response:new ZE}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const o=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Tr(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:o}=t;n!==void 0&&xu.assertOptions(n,{silentJSONParsing:hs.transitional(hs.boolean),forcedJSONParsing:hs.transitional(hs.boolean),clarifyTimeoutError:hs.transitional(hs.boolean)},!1),r!=null&&(ne.isFunction(r)?t.paramsSerializer={serialize:r}:xu.assertOptions(r,{encode:hs.function,serialize:hs.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),xu.assertOptions(t,{baseUrl:hs.spelling("baseURL"),withXsrfToken:hs.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&ne.merge(o.common,o[t.method]);o&&ne.forEach(["delete","get","head","post","put","patch","common"],v=>{delete o[v]}),t.headers=yn.concat(l,o);const c=[];let f=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(t)===!1||(f=f&&S.synchronous,c.unshift(S.fulfilled,S.rejected))});const d=[];this.interceptors.response.forEach(function(S){d.push(S.fulfilled,S.rejected)});let m,g=0,p;if(!f){const v=[cS.bind(this),void 0];for(v.unshift(...c),v.push(...d),p=v.length,m=Promise.resolve(t);g<p;)m=m.then(v[g++],v[g++]);return m}p=c.length;let E=t;for(;g<p;){const v=c[g++],S=c[g++];try{E=v(E)}catch(b){S.call(this,b);break}}try{m=cS.call(this,E)}catch(v){return Promise.reject(v)}for(g=0,p=d.length;g<p;)m=m.then(d[g++],d[g++]);return m}getUri(e){e=Tr(this.defaults,e);const t=aR(e.baseURL,e.url,e.allowAbsoluteUrls);return tR(t,e.params,e.paramsSerializer)}};ne.forEach(["delete","get","head","options"],function(e){xr.prototype[e]=function(t,n){return this.request(Tr(n||{},{method:e,url:t,data:(n||{}).data}))}});ne.forEach(["post","put","patch"],function(e){function t(n){return function(o,l,c){return this.request(Tr(c||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}xr.prototype[e]=t(),xr.prototype[e+"Form"]=t(!0)});let gU=class dR{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const n=this;this.promise.then(r=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](r);n._listeners=null}),this.promise.then=r=>{let o;const l=new Promise(c=>{n.subscribe(c),o=c}).then(r);return l.cancel=function(){n.unsubscribe(o)},l},e(function(o,l,c){n.reason||(n.reason=new za(o,l,c),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=n=>{e.abort(n)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new dR(function(r){e=r}),cancel:e}}};function pU(s){return function(t){return s.apply(null,t)}}function yU(s){return ne.isObject(s)&&s.isAxiosError===!0}const lg={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(lg).forEach(([s,e])=>{lg[e]=s});function fR(s){const e=new xr(s),t=H1(xr.prototype.request,e);return ne.extend(t,xr.prototype,e,{allOwnKeys:!0}),ne.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return fR(Tr(s,r))},t}const Tt=fR(El);Tt.Axios=xr;Tt.CanceledError=za;Tt.CancelToken=gU;Tt.isCancel=iR;Tt.VERSION=uR;Tt.toFormData=xd;Tt.AxiosError=Pe;Tt.Cancel=Tt.CanceledError;Tt.all=function(e){return Promise.all(e)};Tt.spread=pU;Tt.isAxiosError=yU;Tt.mergeConfig=Tr;Tt.AxiosHeaders=yn;Tt.formToJSON=s=>sR(ne.isHTMLForm(s)?new FormData(s):s);Tt.getAdapter=cR.getAdapter;Tt.HttpStatusCode=lg;Tt.default=Tt;const{Axios:Mj,AxiosError:Pj,CanceledError:Fj,isCancel:Uj,CancelToken:Bj,VERSION:$j,all:jj,Cancel:Gj,isAxiosError:Hj,spread:zj,toFormData:Vj,AxiosHeaders:Kj,HttpStatusCode:qj,formToJSON:Yj,getAdapter:Wj,mergeConfig:Xj}=Tt,ya="/api",va=Tt.create({timeout:15e3});async function hR(s,e=2,t=500){try{return await s()}catch(n){if(e>0)return await new Promise(r=>setTimeout(r,t)),hR(s,e-1,t*2);throw n}}const $i={getTrending:async(s=1)=>{try{console.log("Fetching trending...");const e=await va.get(`${ya}/trending`,{params:{pages:s}});return console.log("Trending response:",e.data),Array.isArray(e.data)?e.data:e.data&&Array.isArray(e.data.videos)?e.data.videos:e.data&&Array.isArray(e.data.results)?e.data.results:[]}catch(e){return console.error("Error fetching trending:",e),Tt.isAxiosError(e)&&console.error("Axios error details:",e.response?.data,e.response?.status),[]}},search:async(s,e=1,t="all",n="allduration",r="all")=>{try{console.log(`Searching for ${s}...`);const o=await hR(()=>va.get(`${ya}/search`,{params:{q:s,pages:e,sort_date:t,sort_time:n,sort_quality:r}}));return console.log(`Search response for ${s}:`,o.data),Array.isArray(o.data)?o.data:o.data&&Array.isArray(o.data.videos)?o.data.videos:o.data&&Array.isArray(o.data.results)?o.data.results:[]}catch(o){return console.error(`Error searching ${s}:`,o),[]}},getVideoDetails:async s=>{try{console.log(`Fetching details for ${s}...`);const e=await va.get(`${ya}/video`,{params:{url:s}});return console.log("Video details response:",e.data),e.data}catch(e){throw console.error("Error fetching video details:",e),e}},getUserLocation:async()=>{try{return(await va.get(`${ya}/user-location`)).data}catch(s){return console.error("Error getting user location:",s),{country:"United States",country_code:"US",region:"California",city:"Los Angeles"}}},getSimilarVideos:async s=>{try{return console.log(`Fetching similar videos for: ${s}`),(await $i.search(s)).slice(0,10)}catch(e){return console.error("Error fetching similar videos:",e),[]}},searchWithBackgroundFetch:(s,e,t=1)=>{let n=!1;const r=new Set,o=async()=>{try{console.log(`[Fast API] Searching for ${s}...`);const c=await va.get(`${ya}/search`,{params:{q:s,pages:t},timeout:1e4});let f=[];return Array.isArray(c.data)?f=c.data:c.data?.videos?f=c.data.videos:c.data?.results&&(f=c.data.results),f.forEach(d=>r.add(d.url)),!n&&f.length>0&&(console.log(`[Fast API] Got ${f.length} results for ${s}`),e(f,!1)),f}catch(c){return console.error("[Fast API] Error:",c),[]}},l=async()=>{try{if(await new Promise(m=>setTimeout(m,1e3)),n)return;console.log(`[Slow API] Background search for ${s}...`);const c=await va.get(`${ya}/search`,{params:{q:s,pages:t+1,sort_date:"all",sort_time:"allduration",sort_quality:"all"},timeout:6e4});let f=[];Array.isArray(c.data)?f=c.data:c.data?.videos?f=c.data.videos:c.data?.results&&(f=c.data.results);const d=f.filter(m=>!r.has(m.url));!n&&d.length>0&&(console.log(`[Slow API] Got ${d.length} additional results for ${s}`),e(d,!0))}catch(c){console.error("[Slow API] Background error:",c)}};return o().then(()=>{n||l()}),()=>{n=!0}}},Kc=[{title:"Trending Now",type:"mixed",isSearch:!1},{title:"Fresh Picks",type:"horizontal",isSearch:!1},{title:"Top Rated",type:"boxed",isSearch:!1},{title:"Recommended",type:"horizontal",isSearch:!1}],vU=[{title:"Amateur",query:"amateur",type:"horizontal"},{title:"Popular",query:"popular",type:"boxed"},{title:"HD Videos",query:"hd",type:"horizontal"},{title:"New Releases",query:"new",type:"mixed"},{title:"MILF",query:"milf",type:"horizontal"},{title:"Teen",query:"teen",type:"boxed"},{title:"Lesbian",query:"lesbian",type:"horizontal"},{title:"Blonde",query:"blonde",type:"mixed"},{title:"Brunette",query:"brunette",type:"horizontal"},{title:"Asian",query:"asian",type:"boxed"},{title:"Ebony",query:"ebony",type:"horizontal"},{title:"Latina",query:"latina",type:"mixed"}];function cg(s){const e=[...s];for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function xU({videos:s,hdVideos:e}){const[t,n]=A.useState(0),r=ys.useMemo(()=>{let d=[];e&&e.length>=5?d=e:d=s;const m=d.filter(p=>p.thumbnail_url&&p.thumbnail_url!==""&&p.thumbnail_url.startsWith("http")&&p.title&&p.title.length>0);return cg(m).slice(0,5)},[s,e]),o=A.useCallback(()=>{n(d=>(d+1)%r.length)},[r.length]),l=()=>{n(d=>(d-1+r.length)%r.length)};if(A.useEffect(()=>{const d=setInterval(o,6e3);return()=>clearInterval(d)},[o]),r.length===0)return null;const c=r[t],f=d=>{if(d==null)return"New";const m=typeof d=="number"?d:parseInt(String(d).replace(/,/g,""));return isNaN(m)?String(d):m===0?"New":m>1e6?(m/1e6).toFixed(1)+"M":m>1e3?(m/1e3).toFixed(1)+"k":m.toString()};return T.jsxs("div",{className:"group relative w-full h-[50vh] md:h-[70vh] lg:h-[80vh] overflow-hidden","data-testid":"hero-carousel",children:[r.map((d,m)=>T.jsxs("div",{className:Oe("absolute inset-0 transition-all duration-700 ease-out",m===t?"opacity-100 scale-100":"opacity-0 scale-105"),children:[T.jsx("img",{src:d.thumbnail_url,className:"w-full h-full object-cover",alt:d.title,loading:"eager",decoding:"async",fetchPriority:"high"}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/90 via-black/50 to-transparent"}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background via-transparent to-transparent"})]},m)),T.jsx("div",{className:"absolute inset-0 flex items-center",children:T.jsx("div",{className:"container px-6 md:px-12 lg:px-16 max-w-4xl",children:T.jsxs("div",{className:"animate-in fade-in slide-in-from-left-4 duration-500",children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[T.jsxs("span",{className:"bg-primary text-white px-4 py-1.5 rounded-full text-sm font-bold uppercase tracking-wider flex items-center gap-2 shadow-lg",children:[T.jsx(TI,{className:"h-4 w-4"})," Featured"]}),T.jsxs("span",{className:"bg-white/10 backdrop-blur-sm text-white px-3 py-1 rounded-full text-sm font-medium",children:["#",t+1," Trending"]})]}),T.jsx("h1",{className:"text-3xl md:text-5xl lg:text-6xl font-heading font-extrabold text-white mb-4 leading-tight drop-shadow-lg line-clamp-2 break-words overflow-hidden",children:c.title}),T.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 text-white/80",children:[T.jsxs("span",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-3 py-1.5 rounded-lg",children:[T.jsx(Du,{className:"h-4 w-4"})," ",f(c.views)," views"]}),T.jsxs("span",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-3 py-1.5 rounded-lg",children:[T.jsx(Bg,{className:"h-4 w-4"})," ",c.length]}),T.jsxs("span",{className:"text-white/60",children:["by ",c.author]})]}),T.jsx("div",{className:"flex flex-wrap gap-3",children:T.jsxs(ht,{size:"lg",className:"bg-primary hover:bg-primary/90 text-white gap-2 shadow-lg shadow-primary/30 text-lg px-8",onClick:()=>window.location.href=Qo(c.url),"data-testid":"button-watch-now",children:[T.jsx(ni,{className:"h-5 w-5 fill-current"})," Watch Now"]})})]},t)})}),T.jsx(ht,{variant:"ghost",size:"icon",className:"absolute left-4 top-1/2 -translate-y-1/2 bg-black/30 hover:bg-black/50 text-white rounded-full h-12 w-12 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300",onClick:l,"data-testid":"button-carousel-prev",children:T.jsx(id,{className:"h-6 w-6"})}),T.jsx(ht,{variant:"ghost",size:"icon",className:"absolute right-4 top-1/2 -translate-y-1/2 bg-black/30 hover:bg-black/50 text-white rounded-full h-12 w-12 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300",onClick:o,"data-testid":"button-carousel-next",children:T.jsx(rd,{className:"h-6 w-6"})}),T.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:r.map((d,m)=>T.jsx("button",{onClick:()=>n(m),className:Oe("transition-all duration-300 rounded-full",m===t?"w-8 h-2 bg-primary":"w-2 h-2 bg-white/40 hover:bg-white/60"),"data-testid":`button-carousel-dot-${m}`},m))}),T.jsx("div",{className:"absolute bottom-20 right-6 hidden lg:flex gap-2",children:r.map((d,m)=>T.jsx("div",{onClick:()=>n(m),className:Oe("relative w-24 h-14 rounded-lg overflow-hidden cursor-pointer transition-all duration-300",m===t?"ring-2 ring-primary scale-105":"opacity-60 hover:opacity-100"),children:T.jsx("img",{src:d.thumbnail_url,className:"w-full h-full object-cover",alt:"",loading:"eager",decoding:"async",fetchPriority:"high"})},m))})]})}function EU(){return T.jsxs("div",{className:"relative w-full h-[50vh] md:h-[70vh] lg:h-[80vh] bg-background overflow-hidden",children:[T.jsx("div",{className:"absolute inset-0 flex items-center",children:T.jsxs("div",{className:"container px-6 md:px-12 lg:px-16 max-w-4xl space-y-4",children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[T.jsx("div",{className:"h-8 w-24 rounded-full bg-primary/30 animate-pulse"}),T.jsx("div",{className:"h-8 w-32 rounded-full bg-primary/20 animate-pulse",style:{animationDelay:"0.1s"}})]}),T.jsx("div",{className:"h-12 w-3/4 md:h-16 rounded bg-primary/20 animate-pulse"}),T.jsx("div",{className:"h-8 w-1/2 md:h-12 rounded bg-primary/15 animate-pulse",style:{animationDelay:"0.15s"}}),T.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[T.jsx("div",{className:"h-10 w-24 rounded-lg bg-primary/25 animate-pulse"}),T.jsx("div",{className:"h-10 w-24 rounded-lg bg-primary/20 animate-pulse",style:{animationDelay:"0.1s"}}),T.jsx("div",{className:"h-6 w-32 rounded bg-primary/15 animate-pulse",style:{animationDelay:"0.2s"}})]}),T.jsx("div",{className:"h-12 w-40 rounded-md mt-4 bg-primary/40 animate-pulse"})]})}),T.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2 flex gap-2",children:[0,1,2,3,4].map(s=>T.jsx("div",{className:"w-3 h-3 rounded-full bg-primary animate-bounce",style:{animationDelay:`${s*.1}s`,opacity:1-s*.15}},s))})]})}function hm(){return T.jsxs("div",{className:"container px-4 py-8 space-y-4",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"h-8 w-8 rounded bg-primary/30 animate-pulse"}),T.jsx("div",{className:"h-8 w-48 rounded bg-primary/20 animate-pulse"})]}),T.jsx("div",{className:"flex gap-4 overflow-hidden",children:[1,2,3,4,5].map(s=>T.jsxs("div",{className:"flex-shrink-0 space-y-2",children:[T.jsx("div",{className:"h-40 w-64 rounded-xl bg-primary/20 animate-pulse",style:{animationDelay:`${s*.1}s`}}),T.jsx("div",{className:"h-4 w-48 rounded bg-primary/20 animate-pulse",style:{animationDelay:`${s*.1}s`}}),T.jsx("div",{className:"h-3 w-32 rounded bg-primary/15 animate-pulse",style:{animationDelay:`${s*.1}s`}})]},s))})]})}function SU(){return T.jsxs("div",{className:"space-y-6",children:[T.jsxs("div",{className:"flex items-center justify-center gap-4 py-8",children:[T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-primary/20"}),T.jsx("div",{className:"absolute inset-0 w-16 h-16 rounded-full border-4 border-transparent border-t-primary animate-spin"}),T.jsx("div",{className:"absolute inset-1 w-14 h-14 rounded-full border-4 border-transparent border-r-primary/70 animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}}),T.jsx("div",{className:"absolute inset-2 w-12 h-12 rounded-full border-4 border-transparent border-b-primary/50 animate-spin",style:{animationDuration:"1.2s"}})]}),T.jsxs("div",{className:"text-center",children:[T.jsx("p",{className:"text-lg font-medium text-primary animate-pulse",children:"Searching..."}),T.jsx("div",{className:"flex justify-center gap-1.5 pt-2",children:[0,1,2,3,4].map(s=>T.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-bounce",style:{animationDelay:`${s*.1}s`,opacity:1-s*.15}},s))})]})]}),T.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[1,2,3,4,5,6,7,8].map(s=>T.jsxs("div",{className:"space-y-2",children:[T.jsx("div",{className:"aspect-video rounded-xl bg-primary/15 animate-pulse",style:{animationDelay:`${s*.05}s`}}),T.jsx("div",{className:"h-4 w-3/4 rounded bg-primary/20 animate-pulse",style:{animationDelay:`${s*.05}s`}}),T.jsx("div",{className:"h-3 w-1/2 rounded bg-primary/15 animate-pulse",style:{animationDelay:`${s*.05}s`}})]},s))})]})}function bU(){Ig();const e=new URLSearchParams(window.location.search).get("q"),[t,n]=A.useState([]),[r,o]=A.useState({}),[l,c]=A.useState({}),[f,d]=A.useState(null),[m,g]=A.useState(!0),[p]=A.useState(()=>cg([...vU]).slice(0,6)),[E,v]=A.useState([]),[S,b]=A.useState(1),[R,C]=A.useState(!0),[_,D]=A.useState(!1),[N,B]=A.useState(!1),I=A.useRef(null);A.useEffect(()=>{b(1),C(!0),v([])},[e]),A.useEffect(()=>{let M=!0,U=null;return(async()=>{if(e)B(!0),U=$i.searchWithBackgroundFetch(e,(V,ee)=>{M&&(ee?v(Z=>{const re=new Set(Z.map(z=>z.url)),F=V.filter(z=>!re.has(z.url));return F.length>=10&&C(!0),b(2),[...Z,...F]}):(v(V),C(V.length>=20),B(!1)))},1);else{g(!0);try{const V=await $i.getTrending();if(M&&V.length>0){n(V);const ee=cg([...V]),Z=Math.ceil(ee.length/Kc.length),re={};Kc.forEach((F,z)=>{const j=z*Z,oe=j+Z;re[F.title]=ee.slice(j,oe)}),o(re)}M&&g(!1),$i.search("Africa").then(ee=>{M&&ee.length>0&&d({title:"Trending in Africa",videos:ee.slice(0,12)})}).catch(console.error);for(const ee of p)$i.search(ee.query).then(Z=>{M&&Z.length>0&&c(re=>({...re,[ee.title]:Z.slice(0,12)}))}).catch(console.error)}catch(V){console.error("Error fetching trending:",V),M&&g(!1)}}})(),()=>{M=!1,U&&U()}},[e,p]);const P=A.useCallback(async()=>{if(!(_||!R||!e)){D(!0);try{const M=S+1,U=await $i.search(e,M);U.length>0?(v(q=>[...q,...U]),b(M),C(U.length>=20)):C(!1)}catch(M){console.error("Error loading more results:",M)}finally{D(!1)}}},[e,S,R,_]);return A.useEffect(()=>{if(!e||!R)return;const M=new IntersectionObserver(q=>{q[0].isIntersecting&&!_&&P()},{threshold:.1,rootMargin:"100px"}),U=I.current;return U&&M.observe(U),()=>{U&&M.unobserve(U)}},[e,R,_,P]),T.jsx(gu,{children:T.jsxs("div",{className:"pb-12",children:[!e&&(m?T.jsx(EU,{}):t.length>0?T.jsx(xU,{videos:t,hdVideos:l["HD Videos"]}):null),T.jsxs("div",{className:"space-y-2 mt-4",children:[!e&&T.jsx(G2,{}),e?T.jsxs("div",{className:"container px-4 pt-6",children:[T.jsxs("h2",{className:"text-2xl font-heading font-bold mb-6",children:['Results for "',e,'"']}),N?T.jsx(SU,{}):T.jsxs(T.Fragment,{children:[T.jsx($o,{title:"",videos:E,type:"boxed"}),R&&T.jsx("div",{ref:I,className:"py-8 flex justify-center",children:_?T.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[T.jsx($g,{className:"h-6 w-6 animate-spin text-primary"}),T.jsx("span",{children:"Loading more videos..."})]}):T.jsx(ht,{variant:"outline",onClick:P,className:"px-8","data-testid":"button-load-more",children:"Load More"})}),!R&&E.length>0&&T.jsx("p",{className:"text-center text-muted-foreground py-8",children:"You've reached the end of the results"})]})]}):T.jsxs(T.Fragment,{children:[Kc.slice(0,2).map((M,U)=>T.jsx("div",{className:"min-h-[200px]",children:r[M.title]&&r[M.title].length>0?T.jsx($o,{title:M.title,videos:r[M.title],type:M.type}):m?T.jsx(hm,{}):null},U)),f&&f.videos.length>0&&T.jsx("div",{className:"min-h-[200px]",children:T.jsx($o,{title:f.title,videos:f.videos,type:"horizontal",icon:T.jsx(kI,{className:"h-5 w-5 text-primary"})})}),Kc.slice(2).map((M,U)=>T.jsx("div",{className:"min-h-[200px]",children:r[M.title]&&r[M.title].length>0?T.jsx($o,{title:M.title,videos:r[M.title],type:M.type}):m?T.jsx(hm,{}):null},`trending-${U}`)),p.map((M,U)=>T.jsx("div",{className:"min-h-[200px]",children:l[M.title]&&l[M.title].length>0?T.jsx($o,{title:M.title,videos:l[M.title],type:M.type}):T.jsx(hm,{})},`search-${U}`))]})]})]})})}const ve=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},TU=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=AU},AU=Number.MAX_SAFE_INTEGER||9007199254740991;let Ae=(function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s})({}),W=(function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",s.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",s.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.ASSET_LIST_LOAD_ERROR="assetListLoadError",s.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",s.ASSET_LIST_PARSING_ERROR="assetListParsingError",s.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.ATTACH_MEDIA_ERROR="attachMediaError",s.UNKNOWN="unknown",s})({}),L=(function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.MEDIA_ENDED="hlsMediaEnded",s.STALL_RESOLVED="hlsStallResolved",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFERED_TO_END="hlsBufferedToEnd",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s.ASSET_LIST_LOADING="hlsAssetListLoading",s.ASSET_LIST_LOADED="hlsAssetListLoaded",s.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",s.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",s.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",s.INTERSTITIAL_STARTED="hlsInterstitialStarted",s.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",s.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",s.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",s.INTERSTITIAL_ENDED="hlsInterstitialEnded",s.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",s.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",s.EVENT_CUE_ENTER="hlsEventCueEnter",s})({});var je={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},xe={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class xa{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class RU{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new xa(e),this.fast_=new xa(t),this.defaultTTFB_=r,this.ttfb_=new xa(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:o}=this;n.halfLife!==e&&(this.slow_=new xa(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new xa(t,r.getEstimate(),r.getTotalWeight())),o.halfLife!==e&&(this.ttfb_=new xa(e,o.getEstimate(),o.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,r=e/1e3,o=n/r;this.fast_.sample(r,o),this.slow_.sample(r,o)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function wU(s,e,t){return(e=CU(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function at(){return at=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},at.apply(null,arguments)}function dS(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,n)}return t}function tt(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?dS(Object(t),!0).forEach(function(n){wU(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):dS(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function LU(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function CU(s){var e=LU(s,"string");return typeof e=="symbol"?e:e+""}class Wn{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=Ui,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const Ui=function(){},_U={trace:Ui,debug:Ui,log:Ui,warn:Ui,info:Ui,error:Ui};function ug(){return at({},_U)}function DU(s,e){const t=self.console[s];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${s}] >`):Ui}function fS(s,e,t){return e[s]?e[s].bind(e):DU(s,t)}const dg=ug();function IU(s,e,t){const n=ug();if(typeof console=="object"&&s===!0||typeof s=="object"){const r=["debug","log","info","warn","error"];r.forEach(o=>{n[o]=fS(o,s,t)});try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return ug()}r.forEach(o=>{dg[o]=fS(o,s)})}else at(dg,n);return n}const nt=dg;function zi(s=!0){return typeof self>"u"?void 0:(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function OU(s){return typeof self<"u"&&s===self.ManagedMediaSource}function mR(s,e){const t=Object.keys(s),n=Object.keys(e),r=t.length,o=n.length;return!r||!o||r===o&&!t.some(l=>n.indexOf(l)===-1)}function Nn(s,e=!1){if(typeof TextDecoder<"u"){const d=new TextDecoder("utf-8").decode(s);if(e){const m=d.indexOf("\0");return m!==-1?d.substring(0,m):d}return d.replace(/\0/g,"")}const t=s.length;let n,r,o,l="",c=0;for(;c<t;){if(n=s[c++],n===0&&e)return l;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(n);break;case 12:case 13:r=s[c++],l+=String.fromCharCode((n&31)<<6|r&63);break;case 14:r=s[c++],o=s[c++],l+=String.fromCharCode((n&15)<<12|(r&63)<<6|(o&63)<<0);break}}return l}function Qt(s){let e="";for(let t=0;t<s.length;t++){let n=s[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}function gR(s){return Uint8Array.from(s.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function NU(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var mm={exports:{}},hS;function kU(){return hS||(hS=1,(function(s,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,o=/(?:\/|^)\.(?=\/)/g,l=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(f,d,m){if(m=m||{},f=f.trim(),d=d.trim(),!d){if(!m.alwaysNormalize)return f;var g=c.parseURL(f);if(!g)throw new Error("Error trying to parse base URL.");return g.path=c.normalizePath(g.path),c.buildURLFromParts(g)}var p=c.parseURL(d);if(!p)throw new Error("Error trying to parse relative URL.");if(p.scheme)return m.alwaysNormalize?(p.path=c.normalizePath(p.path),c.buildURLFromParts(p)):d;var E=c.parseURL(f);if(!E)throw new Error("Error trying to parse base URL.");if(!E.netLoc&&E.path&&E.path[0]!=="/"){var v=r.exec(E.path);E.netLoc=v[1],E.path=v[2]}E.netLoc&&!E.path&&(E.path="/");var S={scheme:E.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(S.netLoc=E.netLoc,p.path[0]!=="/"))if(!p.path)S.path=E.path,p.params||(S.params=E.params,p.query||(S.query=E.query));else{var b=E.path,R=b.substring(0,b.lastIndexOf("/")+1)+p.path;S.path=c.normalizePath(R)}return S.path===null&&(S.path=m.alwaysNormalize?c.normalizePath(p.path):p.path),c.buildURLFromParts(S)},parseURL:function(f){var d=n.exec(f);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(f){for(f=f.split("").reverse().join("").replace(o,"");f.length!==(f=f.replace(l,"")).length;);return f.split("").reverse().join("")},buildURLFromParts:function(f){return f.scheme+f.netLoc+f.path+f.params+f.query+f.fragment}};s.exports=c})()})(mm)),mm.exports}var yp=kU();class vp{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ct={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class pR{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,PU(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let r;n.length===1?r=t?.byteRangeEndOffset||0:r=parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[ct.AUDIO]:null,[ct.VIDEO]:null,[ct.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new vp),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=yp.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[ct.AUDIO]=null,e[ct.VIDEO]=null,e[ct.AUDIOVIDEO]=null}}function Lt(s){return s.sn!=="initSegment"}class gm extends pR{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(ve(e)&&ve(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const n=Object.keys(t);if(n.length===1){const r=this._decryptdata=t[n[0]]||null;r&&(this._decryptdata=r.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=ve(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const n=Object.keys(this.levelkeys),r=n.length;if(r>1||r===1&&(t=this.levelkeys[n[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!ve(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Lt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var n;const r=t[e];r&&!((n=this._decryptdata)!=null&&n.keyId)&&(this._decryptdata=r.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,r,o,l=!1){const{elementaryStreams:c}=this,f=c[e];if(!f){c[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:o,partial:l};return}f.startPTS=Math.min(f.startPTS,t),f.endPTS=Math.max(f.endPTS,n),f.startDTS=Math.min(f.startDTS,r),f.endDTS=Math.max(f.endDTS,o)}}class MU extends pR{constructor(e,t,n,r,o){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const l=e.enumeratedString("BYTERANGE");l&&this.setByteRange(l,o),o&&(this.fragOffset=o.fragOffset+o.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function yR(s,e){const t=Object.getPrototypeOf(s);if(t){const n=Object.getOwnPropertyDescriptor(t,e);return n||yR(t,e)}}function PU(s,e){const t=yR(s,e);t&&(t.enumerable=!0,Object.defineProperty(s,e,t))}const mS=Math.pow(2,32)-1,FU=[].push,vR={video:1,audio:2,id3:3,text:4};function Ft(s){return String.fromCharCode.apply(null,s)}function xR(s,e){const t=s[e]<<8|s[e+1];return t<0?65536+t:t}function _e(s,e){const t=ER(s,e);return t<0?4294967296+t:t}function gS(s,e){let t=_e(s,e);return t*=Math.pow(2,32),t+=_e(s,e+4),t}function ER(s,e){return s[e]<<24|s[e+1]<<16|s[e+2]<<8|s[e+3]}function UU(s){const e=s.byteLength;for(let t=0;t<e;){const n=_e(s,t);if(n>8&&s[t+4]===109&&s[t+5]===111&&s[t+6]===111&&s[t+7]===102)return!0;t=n>1?t+n:e}return!1}function $e(s,e){const t=[];if(!e.length)return t;const n=s.byteLength;for(let r=0;r<n;){const o=_e(s,r),l=Ft(s.subarray(r+4,r+8)),c=o>1?r+o:n;if(l===e[0])if(e.length===1)t.push(s.subarray(r+8,c));else{const f=$e(s.subarray(r+8,c),e.slice(1));f.length&&FU.apply(t,f)}r=c}return t}function BU(s){const e=[],t=s[0];let n=8;const r=_e(s,n);n+=4;let o=0,l=0;t===0?(o=_e(s,n),l=_e(s,n+4),n+=8):(o=gS(s,n),l=gS(s,n+8),n+=16),n+=2;let c=s.length+l;const f=xR(s,n);n+=2;for(let d=0;d<f;d++){let m=n;const g=_e(s,m);m+=4;const p=g&2147483647;if((g&2147483648)>>>31===1)return nt.warn("SIDX has hierarchical references (not supported)"),null;const v=_e(s,m);m+=4,e.push({referenceSize:p,subsegmentDuration:v,info:{duration:v/r,start:c,end:c+p-1}}),c+=p,m+=4,n=m}return{earliestPresentationTime:o,timescale:r,version:t,referencesCount:f,references:e}}function SR(s){const e=[],t=$e(s,["moov","trak"]);for(let r=0;r<t.length;r++){const o=t[r],l=$e(o,["tkhd"])[0];if(l){let c=l[0];const f=_e(l,c===0?12:20),d=$e(o,["mdia","mdhd"])[0];if(d){c=d[0];const m=_e(d,c===0?12:20),g=$e(o,["mdia","hdlr"])[0];if(g){const p=Ft(g.subarray(8,12)),E={soun:ct.AUDIO,vide:ct.VIDEO}[p],v=$e(o,["mdia","minf","stbl","stsd"])[0],S=$U(v);E?(e[f]={timescale:m,type:E,stsd:S},e[E]=tt({timescale:m,id:f},S)):e[f]={timescale:m,type:p,stsd:S}}}}}return $e(s,["moov","mvex","trex"]).forEach(r=>{const o=_e(r,4),l=e[o];l&&(l.default={duration:_e(r,12),flags:_e(r,20)})}),e}function $U(s){const e=s.subarray(8),t=e.subarray(86),n=Ft(e.subarray(4,8));let r=n,o;const l=n==="enca"||n==="encv";if(l){const d=$e(e,[n])[0].subarray(n==="enca"?28:78);$e(d,["sinf"]).forEach(g=>{const p=$e(g,["schm"])[0];if(p){const E=Ft(p.subarray(4,8));if(E==="cbcs"||E==="cenc"){const v=$e(g,["frma"])[0];v&&(r=Ft(v))}}})}const c=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const f=$e(t,["avcC"])[0];f&&f.length>3&&(r+="."+Yc(f[1])+Yc(f[2])+Yc(f[3]),o=qc(c==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const f=$e(e,[n])[0],d=$e(f.subarray(28),["esds"])[0];if(d&&d.length>7){let m=4;if(d[m++]!==3)break;m=pm(d,m),m+=2;const g=d[m++];if(g&128&&(m+=2),g&64&&(m+=d[m++]),d[m++]!==4)break;m=pm(d,m);const p=d[m++];if(p===64)r+="."+Yc(p);else break;if(m+=12,d[m++]!==5)break;m=pm(d,m);const E=d[m++];let v=(E&248)>>3;v===31&&(v+=1+((E&7)<<3)+((d[m]&224)>>5)),r+="."+v}break}case"hvc1":case"hev1":{const f=$e(t,["hvcC"])[0];if(f&&f.length>12){const d=f[1],m=["","A","B","C"][d>>6],g=d&31,p=_e(f,2),E=(d&32)>>5?"H":"L",v=f[12],S=f.subarray(6,12);r+="."+m+g,r+="."+jU(p).toString(16).toUpperCase(),r+="."+E+v;let b="";for(let R=S.length;R--;){const C=S[R];(C||b)&&(b="."+C.toString(16).toUpperCase()+b)}r+=b}o=qc(c=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{r=qc(r,t)||r;break}case"vp09":{const f=$e(t,["vpcC"])[0];if(f&&f.length>6){const d=f[4],m=f[5],g=f[6]>>4&15;r+="."+ps(d)+"."+ps(m)+"."+ps(g)}break}case"av01":{const f=$e(t,["av1C"])[0];if(f&&f.length>2){const d=f[1]>>>5,m=f[1]&31,g=f[2]>>>7?"H":"M",p=(f[2]&64)>>6,E=(f[2]&32)>>5,v=d===2&&p?E?12:10:p?10:8,S=(f[2]&16)>>4,b=(f[2]&8)>>3,R=(f[2]&4)>>2,C=f[2]&3;r+="."+d+"."+ps(m)+g+"."+ps(v)+"."+S+"."+b+R+C+"."+ps(1)+"."+ps(1)+"."+ps(1)+"."+0,o=qc("dav1",t)}break}}return{codec:r,encrypted:l,supplemental:o}}function qc(s,e){const t=$e(e,["dvvC"]),n=t.length?t[0]:$e(e,["dvcC"])[0];if(n){const r=n[2]>>1&127,o=n[2]<<5&32|n[3]>>3&31;return s+"."+ps(r)+"."+ps(o)}}function jU(s){let e=0;for(let t=0;t<32;t++)e|=(s>>t&1)<<31-t;return e>>>0}function pm(s,e){const t=e+5;for(;s[e++]&128&&e<t;);return e}function Yc(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function ps(s){return(s<10?"0":"")+s}function GU(s,e){if(!s||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&bR(s,(n,r)=>{const o=n.subarray(8,24);o.some(l=>l!==0)||(nt.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${Qt(o)} -> ${Qt(t)}`),n.set(t,8))})}function HU(s){const e=[];return bR(s,t=>e.push(t.subarray(8,24))),e}function bR(s,e){$e(s,["moov","trak"]).forEach(n=>{const r=$e(n,["mdia","minf","stbl","stsd"])[0];if(!r)return;const o=r.subarray(8);let l=$e(o,["enca"]);const c=l.length>0;c||(l=$e(o,["encv"])),l.forEach(f=>{const d=c?f.subarray(28):f.subarray(78);$e(d,["sinf"]).forEach(g=>{const p=TR(g);p&&e(p,c)})})})}function TR(s){const e=$e(s,["schm"])[0];if(e){const t=Ft(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const n=$e(s,["schi","tenc"])[0];if(n)return n}}}function zU(s,e,t){const n={},r=$e(s,["moof","traf"]);for(let o=0;o<r.length;o++){const l=r[o],c=$e(l,["tfhd"])[0],f=_e(c,4),d=e[f];if(!d)continue;n[f]||(n[f]={start:NaN,duration:0,sampleCount:0,timescale:d.timescale,type:d.type});const m=n[f],g=$e(l,["tfdt"])[0];if(g){const _=g[0];let D=_e(g,4);_===1&&(D===mS?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(D*=mS+1,D+=_e(g,8))),ve(D)&&(!ve(m.start)||D<m.start)&&(m.start=D)}const p=d.default,E=_e(c,0)|p?.flags;let v=p?.duration||0;E&8&&(E&2?v=_e(c,12):v=_e(c,8));const S=$e(l,["trun"]);let b=m.start||0,R=0,C=v;for(let _=0;_<S.length;_++){const D=S[_],N=_e(D,4),B=m.sampleCount;m.sampleCount+=N;const I=D[3]&1,P=D[3]&4,M=D[2]&1,U=D[2]&2,q=D[2]&4,V=D[2]&8;let ee=8,Z=N;for(I&&(ee+=4),P&&N&&(!(D[ee+1]&1)&&m.keyFrameIndex===void 0&&(m.keyFrameIndex=B),ee+=4,M?(C=_e(D,ee),ee+=4):C=v,U&&(ee+=4),V&&(ee+=4),b+=C,R+=C,Z--);Z--;)M?(C=_e(D,ee),ee+=4):C=v,U&&(ee+=4),q&&(D[ee+1]&1||m.keyFrameIndex===void 0&&(m.keyFrameIndex=m.sampleCount-(Z+1),m.keyFrameStart=b),ee+=4),V&&(ee+=4),b+=C,R+=C;!R&&v&&(R+=v*N)}m.duration+=R}if(!Object.keys(n).some(o=>n[o].duration)){let o=1/0,l=0;const c=$e(s,["sidx"]);for(let f=0;f<c.length;f++){const d=BU(c[f]);if(d!=null&&d.references){o=Math.min(o,d.earliestPresentationTime/d.timescale);const m=d.references.reduce((g,p)=>g+p.info.duration||0,0);l=Math.max(l,m+d.earliestPresentationTime/d.timescale)}}l&&ve(l)&&Object.keys(n).forEach(f=>{n[f].duration||(n[f].duration=l*n[f].timescale-n[f].start)})}return n}function VU(s){const e={valid:null,remainder:null},t=$e(s,["moof"]);if(t.length<2)return e.remainder=s,e;const n=t[t.length-1];return e.valid=s.slice(0,n.byteOffset-8),e.remainder=s.slice(n.byteOffset-8),e}function qn(s,e){const t=new Uint8Array(s.length+e.length);return t.set(s),t.set(e,s.length),t}function pS(s,e){const t=[],n=e.samples,r=e.timescale,o=e.id;let l=!1;return $e(n,["moof"]).map(f=>{const d=f.byteOffset-8;$e(f,["traf"]).map(g=>{const p=$e(g,["tfdt"]).map(E=>{const v=E[0];let S=_e(E,4);return v===1&&(S*=Math.pow(2,32),S+=_e(E,8)),S/r})[0];return p!==void 0&&(s=p),$e(g,["tfhd"]).map(E=>{const v=_e(E,4),S=_e(E,0)&16777215,b=(S&1)!==0,R=(S&2)!==0,C=(S&8)!==0;let _=0;const D=(S&16)!==0;let N=0;const B=(S&32)!==0;let I=8;v===o&&(b&&(I+=8),R&&(I+=4),C&&(_=_e(E,I),I+=4),D&&(N=_e(E,I),I+=4),B&&(I+=4),e.type==="video"&&(l=Sd(e.codec)),$e(g,["trun"]).map(P=>{const M=P[0],U=_e(P,0)&16777215,q=(U&1)!==0;let V=0;const ee=(U&4)!==0,Z=(U&256)!==0;let re=0;const F=(U&512)!==0;let z=0;const j=(U&1024)!==0,oe=(U&2048)!==0;let fe=0;const k=_e(P,4);let G=8;q&&(V=_e(P,G),G+=4),ee&&(G+=4);let te=V+d;for(let le=0;le<k;le++){if(Z?(re=_e(P,G),G+=4):re=_,F?(z=_e(P,G),G+=4):z=N,j&&(G+=4),oe&&(M===0?fe=_e(P,G):fe=ER(P,G),G+=4),e.type===ct.VIDEO){let he=0;for(;he<z;){const pe=_e(n,te);if(te+=4,KU(l,n[te])){const ye=n.subarray(te,te+pe);xp(ye,l?2:1,s+fe/r,t)}te+=pe,he+=pe+4}}s+=re/r}}))})})}),t}function Sd(s){if(!s)return!1;const e=s.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function KU(s,e){if(s){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function xp(s,e,t,n){const r=AR(s);let o=0;o+=e;let l=0,c=0,f=0;for(;o<r.length;){l=0;do{if(o>=r.length)break;f=r[o++],l+=f}while(f===255);c=0;do{if(o>=r.length)break;f=r[o++],c+=f}while(f===255);const d=r.length-o;let m=o;if(c<d)o+=c;else if(c>d){nt.error(`Malformed SEI payload. ${c} is too small, only ${d} bytes left to parse.`);break}if(l===4){if(r[m++]===181){const p=xR(r,m);if(m+=2,p===49){const E=_e(r,m);if(m+=4,E===1195456820){const v=r[m++];if(v===3){const S=r[m++],b=31&S,R=64&S,C=R?2+b*3:0,_=new Uint8Array(C);if(R){_[0]=S;for(let D=1;D<C;D++)_[D]=r[m++]}n.push({type:v,payloadType:l,pts:t,bytes:_})}}}}}else if(l===5&&c>16){const g=[];for(let v=0;v<16;v++){const S=r[m++].toString(16);g.push(S.length==1?"0"+S:S),(v===3||v===5||v===7||v===9)&&g.push("-")}const p=c-16,E=new Uint8Array(p);for(let v=0;v<p;v++)E[v]=r[m++];n.push({payloadType:l,pts:t,uuid:g.join(""),userData:Nn(E),userDataBytes:E})}}}function AR(s){const e=s.byteLength,t=[];let n=1;for(;n<e-2;)s[n]===0&&s[n+1]===0&&s[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return s;const r=e-t.length,o=new Uint8Array(r);let l=0;for(n=0;n<r;l++,n++)l===t[0]&&(l++,t.shift()),o[n]=s[l];return o}function qU(s){const e=s[0];let t="",n="",r=0,o=0,l=0,c=0,f=0,d=0;if(e===0){for(;Ft(s.subarray(d,d+1))!=="\0";)t+=Ft(s.subarray(d,d+1)),d+=1;for(t+=Ft(s.subarray(d,d+1)),d+=1;Ft(s.subarray(d,d+1))!=="\0";)n+=Ft(s.subarray(d,d+1)),d+=1;n+=Ft(s.subarray(d,d+1)),d+=1,r=_e(s,12),o=_e(s,16),c=_e(s,20),f=_e(s,24),d=28}else if(e===1){d+=4,r=_e(s,d),d+=4;const g=_e(s,d);d+=4;const p=_e(s,d);for(d+=4,l=2**32*g+p,TU(l)||(l=Number.MAX_SAFE_INTEGER,nt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=_e(s,d),d+=4,f=_e(s,d),d+=4;Ft(s.subarray(d,d+1))!=="\0";)t+=Ft(s.subarray(d,d+1)),d+=1;for(t+=Ft(s.subarray(d,d+1)),d+=1;Ft(s.subarray(d,d+1))!=="\0";)n+=Ft(s.subarray(d,d+1)),d+=1;n+=Ft(s.subarray(d,d+1)),d+=1}const m=s.subarray(d,s.byteLength);return{schemeIdUri:t,value:n,timeScale:r,presentationTime:l,presentationTimeDelta:o,eventDuration:c,id:f,payload:m}}function YU(s,...e){const t=e.length;let n=8,r=t;for(;r--;)n+=e[r].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(s,4),r=0,n=8;r<t;r++)o.set(e[r],n),n+=e[r].byteLength;return o}function WU(s,e,t){if(s.byteLength!==16)throw new RangeError("Invalid system id");let n,r;n=0,r=new Uint8Array;let o;n>0?(o=new Uint8Array(4),e.length>0&&new DataView(o.buffer).setUint32(0,e.length,!1)):o=new Uint8Array;const l=new Uint8Array(4);return t.byteLength>0&&new DataView(l.buffer).setUint32(0,t.byteLength,!1),YU([112,115,115,104],new Uint8Array([n,0,0,0]),s,o,r,l,t)}function XU(s){const e=[];if(s instanceof ArrayBuffer){const t=s.byteLength;let n=0;for(;n+32<t;){const r=new DataView(s,n),o=QU(r);e.push(o),n+=o.size}}return e}function QU(s){const e=s.getUint32(0),t=s.byteOffset,n=s.byteLength;if(n<e)return{offset:t,size:n};if(s.getUint32(4)!==1886614376)return{offset:t,size:e};const o=s.getUint32(8)>>>24;if(o!==0&&o!==1)return{offset:t,size:e};const l=s.buffer,c=Qt(new Uint8Array(l,t+12,16));let f=null,d=null,m=0;if(o===0)m=28;else{const p=s.getUint32(28);if(!p||n<32+p*16)return{offset:t,size:e};f=[];for(let E=0;E<p;E++)f.push(new Uint8Array(l,t+32+E*16,16));m=32+p*16}if(!m)return{offset:t,size:e};const g=s.getUint32(m);return e-32<g?{offset:t,size:e}:(d=new Uint8Array(l,t+m+4,g),{version:o,systemId:c,kids:f,data:d,offset:t,size:e})}const RR=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Fa={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Ep(s,e){const t=Fa[e];return!!t&&!!t[s.slice(0,4)]}function el(s,e,t=!0){return!s.split(",").some(n=>!Sp(n,e,t))}function Sp(s,e,t=!0){var n;const r=zi(t);return(n=r?.isTypeSupported(tl(s,e)))!=null?n:!1}function tl(s,e){return`${e}/mp4;codecs=${s}`}function yS(s){if(s){const e=s.substring(0,4);return Fa.video[e]}return 2}function $u(s){const e=RR();return s.split(",").reduce((t,n)=>{const o=e&&Sd(n)?9:Fa.video[n];return o?(o*2+t)/(t?3:2):(Fa.audio[n]+t)/(t?2:1)},0)}const ym={};function ZU(s,e=!0){if(ym[s])return ym[s];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[s];for(let r=0;r<t.length;r++){var n;if(Sp(t[r],"audio",e))return ym[s]=t[r],t[r];if(t[r]==="mp3"&&(n=zi(e))!=null&&n.isTypeSupported("audio/mpeg"))return""}return s}const JU=/flac|opus|mp4a\.40\.34/i;function ju(s,e=!0){return s.replace(JU,t=>ZU(t.toLowerCase(),e))}function eB(s,e){const t=[];if(s){const n=s.split(",");for(let r=0;r<n.length;r++)Ep(n[r],"video")||t.push(n[r])}return e&&t.push(e),t.join(",")}function Eu(s,e){if(s&&(s.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(s)!==-1)&&(vS(s,"audio")||vS(s,"video")))return s;if(e){const t=e.split(",");if(t.length>1){if(s){for(let n=t.length;n--;)if(t[n].substring(0,4)===s.substring(0,4))return t[n]}return t[0]}}return e||s}function vS(s,e){return Ep(s,e)&&Sp(s,e)}function tB(s){const e=s.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");n.length>2&&n[0]==="avc1"&&(e[t]=`avc1.${parseInt(n[1]).toString(16)}${("000"+parseInt(n[2]).toString(16)).slice(-4)}`)}return e.join(",")}function nB(s){if(s.startsWith("av01.")){const e=s.split("."),t=["0","111","01","01","01","0"];for(let n=e.length;n>4&&n<10;n++)e[n]=t[n-4];return e.join(".")}return s}function xS(s){const e=zi(s)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function fg(s){return s.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const sB={supported:!0,powerEfficient:!0,smooth:!0},iB={supported:!1,smooth:!1,powerEfficient:!1},wR={supported:!0,configurations:[],decodingInfoResults:[sB]};function LR(s,e){return{supported:!1,configurations:e,decodingInfoResults:[iB],error:s}}function rB(s,e,t,n,r,o){const l=s.videoCodec,c=s.audioCodec?s.audioGroups:null,f=o?.audioCodec,d=o?.channels,m=d?parseInt(d):f?1/0:2;let g=null;if(c!=null&&c.length)try{c.length===1&&c[0]?g=e.groups[c[0]].channels:g=c.reduce((p,E)=>{if(E){const v=e.groups[E];if(!v)throw new Error(`Audio track group ${E} not found`);Object.keys(v.channels).forEach(S=>{p[S]=(p[S]||0)+v.channels[S]})}return p},{2:0})}catch{return!0}return l!==void 0&&(l.split(",").some(p=>Sd(p))||s.width>1920&&s.height>1088||s.height>1920&&s.width>1088||s.frameRate>Math.max(n,30)||s.videoRange!=="SDR"&&s.videoRange!==t||s.bitrate>Math.max(r,8e6))||!!g&&ve(m)&&Object.keys(g).some(p=>parseInt(p)>m)}function CR(s,e,t,n={}){const r=s.videoCodec;if(!r&&!s.audioCodec||!t)return Promise.resolve(wR);const o=[],l=aB(s),c=l.length,f=oB(s,e,c>0),d=f.length;for(let m=c||1*d||1;m--;){const g={type:"media-source"};if(c&&(g.video=l[m%c]),d){g.audio=f[m%d];const p=g.audio.bitrate;g.video&&p&&(g.video.bitrate-=p)}o.push(g)}if(r){const m=navigator.userAgent;if(r.split(",").some(g=>Sd(g))&&RR())return Promise.resolve(LR(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${m})`),o))}return Promise.all(o.map(m=>{const g=cB(m);return n[g]||(n[g]=t.decodingInfo(m))})).then(m=>({supported:!m.some(g=>!g.supported),configurations:o,decodingInfoResults:m})).catch(m=>({supported:!1,configurations:o,decodingInfoResults:[],error:m}))}function aB(s){var e;const t=(e=s.videoCodec)==null?void 0:e.split(","),n=_R(s),r=s.width||640,o=s.height||480,l=s.frameRate||30,c=s.videoRange.toLowerCase();return t?t.map(f=>{const d={contentType:tl(nB(f),"video"),width:r,height:o,bitrate:n,framerate:l};return c!=="sdr"&&(d.transferFunction=c),d}):[]}function oB(s,e,t){var n;const r=(n=s.audioCodec)==null?void 0:n.split(","),o=_R(s);return r&&s.audioGroups?s.audioGroups.reduce((l,c)=>{var f;const d=c?(f=e.groups[c])==null?void 0:f.tracks:null;return d?d.reduce((m,g)=>{if(g.groupId===c){const p=parseFloat(g.channels||"");r.forEach(E=>{const v={contentType:tl(E,"audio"),bitrate:t?lB(E,o):o};p&&(v.channels=""+p),m.push(v)})}return m},l):l},[]):[]}function lB(s,e){if(e<=1)return 1;let t=128e3;return s==="ec-3"?t=768e3:s==="ac-3"&&(t=64e4),Math.min(e/2,t)}function _R(s){return Math.ceil(Math.max(s.bitrate*.9,s.averageBitrate)/1e3)*1e3||1}function cB(s){let e="";const{audio:t,video:n}=s;if(n){const r=fg(n.contentType);e+=`${r}_r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${Math.ceil(n.bitrate/1e5)}`}if(t){const r=fg(t.contentType);e+=`${n?"_":""}${r}_c${t.channels}`}return e}const hg=["NONE","TYPE-0","TYPE-1",null];function uB(s){return hg.indexOf(s)>-1}const Gu=["SDR","PQ","HLG"];function dB(s){return!!s&&Gu.indexOf(s)>-1}var Su={No:"",Yes:"YES",v2:"v2"};function ES(s){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=s,r=n<e/2;return e&&r?t?Su.v2:Su.Yes:Su.No}class SS{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class nl{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=(t=e.supplemental)==null?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return bS(this._audioGroups,e)}hasSubtitleGroup(e){return bS(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function bS(s,e){return!e||!s?!1:s.indexOf(e)!==-1}function fB(){if(typeof matchMedia=="function"){const s=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(s.media!==e.media)return s.matches===!0}return!1}function hB(s,e){let t=!1,n=[];if(s&&(t=s!=="SDR",n=[s]),e){n=e.allowedVideoRanges||Gu.slice(0);const r=n.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:r&&fB(),t||(n=["SDR"])}return{preferHDR:t,allowedVideoRanges:n}}const mB=s=>{const e=new WeakSet;return(t,n)=>{if(s&&(n=s(t,n)),typeof n=="object"&&n!==null){if(e.has(n))return;e.add(n)}return n}},ut=(s,e)=>JSON.stringify(s,mB(e));function gB(s,e,t,n,r){const o=Object.keys(s),l=n?.channels,c=n?.audioCodec,f=r?.videoCodec,d=l&&parseInt(l)===2;let m=!1,g=!1,p=1/0,E=1/0,v=1/0,S=1/0,b=0,R=[];const{preferHDR:C,allowedVideoRanges:_}=hB(e,r);for(let P=o.length;P--;){const M=s[o[P]];m||(m=M.channels[2]>0),p=Math.min(p,M.minHeight),E=Math.min(E,M.minFramerate),v=Math.min(v,M.minBitrate),_.filter(q=>M.videoRanges[q]>0).length>0&&(g=!0)}p=ve(p)?p:0,E=ve(E)?E:0;const D=Math.max(1080,p),N=Math.max(30,E);v=ve(v)?v:t,t=Math.max(v,t),g||(e=void 0);const B=o.length>1;return{codecSet:o.reduce((P,M)=>{const U=s[M];if(M===P)return P;if(R=g?_.filter(q=>U.videoRanges[q]>0):[],B){if(U.minBitrate>t)return ms(M,`min bitrate of ${U.minBitrate} > current estimate of ${t}`),P;if(!U.hasDefaultAudio)return ms(M,"no renditions with default or auto-select sound found"),P;if(c&&M.indexOf(c.substring(0,4))%5!==0)return ms(M,`audio codec preference "${c}" not found`),P;if(l&&!d){if(!U.channels[l])return ms(M,`no renditions with ${l} channel sound found (channels options: ${Object.keys(U.channels)})`),P}else if((!c||d)&&m&&U.channels[2]===0)return ms(M,"no renditions with stereo sound found"),P;if(U.minHeight>D)return ms(M,`min resolution of ${U.minHeight} > maximum of ${D}`),P;if(U.minFramerate>N)return ms(M,`min framerate of ${U.minFramerate} > maximum of ${N}`),P;if(!R.some(q=>U.videoRanges[q]>0))return ms(M,`no variants with VIDEO-RANGE of ${ut(R)} found`),P;if(f&&M.indexOf(f.substring(0,4))%5!==0)return ms(M,`video codec preference "${f}" not found`),P;if(U.maxScore<b)return ms(M,`max score of ${U.maxScore} < selected max of ${b}`),P}return P&&($u(M)>=$u(P)||U.fragmentError>s[P].fragmentError)?P:(S=U.minIndex,b=U.maxScore,M)},void 0),videoRanges:R,preferHDR:C,minFramerate:E,minBitrate:v,minIndex:S}}function ms(s,e){nt.log(`[abr] start candidates with "${s}" ignored because ${e}`)}function DR(s){return s.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const r=t.channels||"2";return n.channels[r]=(n.channels[r]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function pB(s,e,t,n){return s.slice(t,n+1).reduce((r,o,l)=>{if(!o.codecSet)return r;const c=o.audioGroups;let f=r[o.codecSet];f||(r[o.codecSet]=f={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:l,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!c,fragmentError:0}),f.minBitrate=Math.min(f.minBitrate,o.bitrate);const d=Math.min(o.height,o.width);return f.minHeight=Math.min(f.minHeight,d),f.minFramerate=Math.min(f.minFramerate,o.frameRate),f.minIndex=Math.min(f.minIndex,l),f.maxScore=Math.max(f.maxScore,o.score),f.fragmentError+=o.fragmentError,f.videoRanges[o.videoRange]=(f.videoRanges[o.videoRange]||0)+1,c&&c.forEach(m=>{if(!m)return;const g=e.groups[m];g&&(f.hasDefaultAudio=f.hasDefaultAudio||e.hasDefaultAudio?g.hasDefault:g.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(g.channels).forEach(p=>{f.channels[p]=(f.channels[p]||0)+g.channels[p]}))}),r},{})}function TS(s){if(!s)return s;const{lang:e,assocLang:t,characteristics:n,channels:r,audioCodec:o}=s;return{lang:e,assocLang:t,characteristics:n,channels:r,audioCodec:o}}function Ss(s,e,t){if("attrs"in s){const n=e.indexOf(s);if(n!==-1)return n}for(let n=0;n<e.length;n++){const r=e[n];if(Er(s,r,t))return n}return-1}function Er(s,e,t){const{groupId:n,name:r,lang:o,assocLang:l,default:c}=s,f=s.forced;return(n===void 0||e.groupId===n)&&(r===void 0||e.name===r)&&(o===void 0||yB(o,e.lang))&&(o===void 0||e.assocLang===l)&&(c===void 0||e.default===c)&&(f===void 0||e.forced===f)&&(!("characteristics"in s)||vB(s.characteristics||"",e.characteristics))&&(t===void 0||t(s,e))}function yB(s,e="--"){return s.length===e.length?s===e:s.startsWith(e)||e.startsWith(s)}function vB(s,e=""){const t=s.split(","),n=e.split(",");return t.length===n.length&&!t.some(r=>n.indexOf(r)===-1)}function pr(s,e){const{audioCodec:t,channels:n}=s;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function xB(s,e,t,n,r){const o=e[n],c=e.reduce((p,E,v)=>{const S=E.uri;return(p[S]||(p[S]=[])).push(v),p},{})[o.uri];c.length>1&&(n=Math.max.apply(Math,c));const f=o.videoRange,d=o.frameRate,m=o.codecSet.substring(0,4),g=AS(e,n,p=>{if(p.videoRange!==f||p.frameRate!==d||p.codecSet.substring(0,4)!==m)return!1;const E=p.audioGroups,v=t.filter(S=>!E||E.indexOf(S.groupId)!==-1);return Ss(s,v,r)>-1});return g>-1?g:AS(e,n,p=>{const E=p.audioGroups,v=t.filter(S=>!E||E.indexOf(S.groupId)!==-1);return Ss(s,v,r)>-1})}function AS(s,e,t){for(let n=e;n>-1;n--)if(t(s[n]))return n;for(let n=e+1;n<s.length;n++)if(t(s[n]))return n;return-1}function Hu(s,e){var t;return!!s&&s!==((t=e.loadLevelObj)==null?void 0:t.uri)}class EB extends Wn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var n;const{fragCurrent:r,partCurrent:o,hls:l}=this,{autoLevelEnabled:c,media:f}=l;if(!r||!f)return;const d=performance.now(),m=o?o.stats:r.stats,g=o?o.duration:r.duration,p=d-m.loading.start,E=l.minAutoLevel,v=r.level,S=this._nextAutoLevel;if(m.aborted||m.loaded&&m.loaded===m.total||v<=E){this.clearTimer(),this._nextAutoLevel=-1;return}if(!c)return;const b=S>-1&&S!==v,R=!!t||b;if(!R&&(f.paused||!f.playbackRate||!f.readyState))return;const C=l.mainForwardBufferInfo;if(!R&&C===null)return;const _=this.bwEstimator.getEstimateTTFB(),D=Math.abs(f.playbackRate);if(p<=Math.max(_,1e3*(g/(D*2))))return;const N=C?C.len/D:0,B=m.loading.first?m.loading.first-m.loading.start:-1,I=m.loaded&&B>-1,P=this.getBwEstimate(),M=l.levels,U=M[v],q=Math.max(m.loaded,Math.round(g*(r.bitrate||U.averageBitrate)/8));let V=I?p-B:p;V<1&&I&&(V=Math.min(p,m.loaded*8/P));const ee=I?m.loaded*1e3/V:0,Z=_/1e3,re=ee?(q-m.loaded)/ee:q*8/P+Z;if(re<=N)return;const F=ee?ee*8:P,z=((n=t?.details||this.hls.latestLevelDetails)==null?void 0:n.live)===!0,j=this.hls.config.abrBandWidthUpFactor;let oe=Number.POSITIVE_INFINITY,fe;for(fe=v-1;fe>E;fe--){const le=M[fe].maxBitrate,he=!M[fe].details||z;if(oe=this.getTimeToLoadFrag(Z,F,g*le,he),oe<Math.min(N,g+Z))break}if(oe>=re||oe>g*10)return;I?this.bwEstimator.sample(p-Math.min(_,B),m.loaded):this.bwEstimator.sampleTTFB(p);const k=M[fe].maxBitrate;this.getBwEstimate()*j>k&&this.resetEstimator(k);const G=this.findBestLevel(k,E,fe,0,N,1,1);G>-1&&(fe=G),this.warn(`Fragment ${r.sn}${o?" part "+o.index:""} of level ${v} is loading too slowly;
      Fragment duration: ${r.duration.toFixed(3)}
      Time to underbuffer: ${N.toFixed(3)} s
      Estimated load time for current fragment: ${re.toFixed(3)} s
      Estimated load time for down switch fragment: ${oe.toFixed(3)} s
      TTFB estimate: ${B|0} ms
      Current BW estimate: ${ve(P)?P|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${fe} @ ${k|0} bps`),l.nextLoadLevel=l.nextAutoLevel=fe,this.clearTimer();const te=()=>{if(this.clearTimer(),this.fragCurrent===r&&this.hls.loadLevel===fe&&fe>0){const le=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${fe>0?"and switching down":""}
      Fragment duration: ${r.duration.toFixed(3)} s
      Time to underbuffer: ${le.toFixed(3)} s`),r.abortRequests(),this.fragCurrent=this.partCurrent=null,fe>E){let he=this.findBestLevel(this.hls.levels[E].bitrate,E,fe,0,le,1,1);he===-1&&(he=E),this.hls.nextLoadLevel=this.hls.nextAutoLevel=he,this.resetEstimator(this.hls.levels[he].bitrate)}}};b||re>oe*2?te():this.timer=self.setInterval(te,oe*1e3),l.trigger(L.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:o,stats:m})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new RU(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(L.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var r;this.fragCurrent=n,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case W.BUFFER_ADD_CODEC_ERROR:case W.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case W.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:r,partCurrent:o}=this;if(n&&r&&n.sn===r.sn&&n.level===r.level){const l=performance.now(),c=o?o.stats:n.stats,f=l-c.loading.start,d=c.loading.first?c.loading.first-c.loading.start:-1;if(c.loaded&&d>-1){const g=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(f-Math.min(g,d),c.loaded)}else this.bwEstimator.sampleTTFB(f)}break}}}getTimeToLoadFrag(e,t,n,r){const o=e+n/t,l=r?e+this.lastLevelLoadSec:0;return o+l}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,o=r.end-r.first;ve(o)&&(this.lastLevelLoadSec=o/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===xe.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const o=n?n.duration:t.duration,l=this.hls.levels[t.level],c=(l.loaded?l.loaded.bytes:0)+r.loaded,f=(l.loaded?l.loaded.duration:0)+o;l.loaded={bytes:c,duration:f},l.realBitrate=Math.round(8*c/f)}if(t.bitrateTest){const o={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(L.FRAG_BUFFERED,o),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:r}=t,o=r!=null&&r.stats.loaded?r.stats:n.stats;if(o.aborted||this.ignoreFragment(n))return;const l=o.parsing.end-o.loading.start-Math.min(o.loading.first-o.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(l,o.loaded),o.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==xe.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,o=this.findBestLevel(n,t,e,0,r,1,1);if(o>-1)return o;const l=this.hls.firstLevel,c=Math.min(Math.max(l,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${l} clamped to ${c}`),c}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const o=n&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const l=this.hls.levels;if(l.length>Math.max(e,o)&&l[e].loadError<=l[o].loadError)return e}return this._nextAutoLevel=o,this.nextAutoLevelKey=this.getAutoLevelKey(),o}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:r,config:o,minAutoLevel:l}=n,c=t?t.duration:e?e.duration:0,f=this.getBwEstimate(),d=this.getStarvationDelay();let m=o.abrBandWidthFactor,g=o.abrBandWidthUpFactor;if(d){const b=this.findBestLevel(f,l,r,d,0,m,g);if(b>=0)return this.rebufferNotice=-1,b}let p=c?Math.min(c,o.maxStarvationDelay):o.maxStarvationDelay;if(!d){const b=this.bitrateTestDelay;b&&(p=(c?Math.min(c,o.maxLoadingDelay):o.maxLoadingDelay)-b,this.info(`bitrate test took ${Math.round(1e3*b)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),m=g=1)}const E=this.findBestLevel(f,l,r,d,p,m,g);if(this.rebufferNotice!==E&&(this.rebufferNotice=E,this.info(`${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${E}`)),E>-1)return E;const v=n.levels[l],S=n.loadLevelObj;return S&&v?.bitrate<S.bitrate?l:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,o,l,c){var f;const d=r+o,m=this.lastLoadedFragLevel,g=m===-1?this.hls.firstLevel:m,{fragCurrent:p,partCurrent:E}=this,{levels:v,allAudioTracks:S,loadLevel:b,config:R}=this.hls;if(v.length===1)return 0;const C=v[g],_=!!((f=this.hls.latestLevelDetails)!=null&&f.live),D=b===-1||m===-1;let N,B="SDR",I=C?.frameRate||0;const{audioPreference:P,videoPreference:M}=R,U=this.audioTracksByGroup||(this.audioTracksByGroup=DR(S));let q=-1;if(D){if(this.firstSelection!==-1)return this.firstSelection;const F=this.codecTiers||(this.codecTiers=pB(v,U,t,n)),z=gB(F,B,e,P,M),{codecSet:j,videoRanges:oe,minFramerate:fe,minBitrate:k,minIndex:G,preferHDR:te}=z;q=G,N=j,B=te?oe[oe.length-1]:oe[0],I=fe,e=Math.max(e,k),this.log(`picked start tier ${ut(z)}`)}else N=C?.codecSet,B=C?.videoRange;const V=E?E.duration:p?p.duration:0,ee=this.bwEstimator.getEstimateTTFB()/1e3,Z=[];for(let F=n;F>=t;F--){var re;const z=v[F],j=F>g;if(!z)continue;if(R.useMediaCapabilities&&!z.supportedResult&&!z.supportedPromise){const he=navigator.mediaCapabilities;typeof he?.decodingInfo=="function"&&rB(z,U,B,I,e,P)?(z.supportedPromise=CR(z,U,he,this.supportedCache),z.supportedPromise.then(pe=>{if(!this.hls)return;z.supportedResult=pe;const ye=this.hls.levels,Ne=ye.indexOf(z);pe.error?this.warn(`MediaCapabilities decodingInfo error: "${pe.error}" for level ${Ne} ${ut(pe)}`):pe.supported?pe.decodingInfoResults.some(De=>De.smooth===!1||De.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Ne} not smooth or powerEfficient: ${ut(pe)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Ne} ${ut(pe)}`),Ne>-1&&ye.length>1&&(this.log(`Removing unsupported level ${Ne}`),this.hls.removeLevel(Ne),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(pe=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${pe}`)})):z.supportedResult=wR}if((N&&z.codecSet!==N||B&&z.videoRange!==B||j&&I>z.frameRate||!j&&I>0&&I<z.frameRate||(re=z.supportedResult)!=null&&(re=re.decodingInfoResults)!=null&&re.some(he=>he.smooth===!1))&&(!D||F!==q)){Z.push(F);continue}const oe=z.details,fe=(E?oe?.partTarget:oe?.averagetargetduration)||V;let k;j?k=c*e:k=l*e;const G=V&&r>=V*2&&o===0?z.averageBitrate:z.maxBitrate,te=this.getTimeToLoadFrag(ee,k,G*fe,oe===void 0);if(k>=G&&(F===m||z.loadError===0&&z.fragmentError===0)&&(te<=ee||!ve(te)||_&&!this.bitrateTestDelay||te<d)){const he=this.forcedAutoLevel;return F!==b&&(he===-1||he!==b)&&(Z.length&&this.trace(`Skipped level(s) ${Z.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${v[Z[0]].codecs}" ${v[Z[0]].videoRange}; not compatible with "${N}" ${B}`),this.info(`switch candidate:${g}->${F} adjustedbw(${Math.round(k)})-bitrate=${Math.round(k-G)} ttfb:${ee.toFixed(1)} avgDuration:${fe.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${te.toFixed(1)} firstSelection:${D} codecSet:${z.codecSet} videoRange:${z.videoRange} hls.loadLevel:${b}`)),D&&(this.firstSelection=F),F}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const IR={search:function(s,e){let t=0,n=s.length-1,r=null,o=null;for(;t<=n;){r=(t+n)/2|0,o=s[r];const l=e(o);if(l>0)t=r+1;else if(l<0)n=r-1;else return o}return null}};function SB(s,e,t){if(e===null||!Array.isArray(s)||!s.length||!ve(e))return null;const n=s[0].programDateTime;if(e<(n||0))return null;const r=s[s.length-1].endProgramDateTime;if(e>=(r||0))return null;for(let o=0;o<s.length;++o){const l=s[o];if(TB(e,t,l))return l}return null}function Ar(s,e,t=0,n=0,r=.005){let o=null;if(s){o=e[1+s.sn-e[0].sn]||null;const c=s.endDTS-t;c>0&&c<15e-7&&(t+=15e-7),o&&s.level!==o.level&&o.end<=s.end&&(o=e[2+s.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(o=e[0]);if(o&&((!s||s.level===o.level)&&RS(t,n,o)===0||bB(o,s,Math.min(r,n))))return o;const l=IR.search(e,RS.bind(null,t,n));return l&&(l!==s||!o)?l:o}function bB(s,e,t){if(e&&e.start===0&&e.level<s.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((r,o)=>(o[0]==="INF"&&(r+=parseFloat(o[1])),r),t);return s.start<=n}return!1}function RS(s=0,e=0,t){if(t.start<=s&&t.start+t.duration>s)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=s?1:t.start-n>s&&t.start?-1:0}function TB(s,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>s}function OR(s,e,t){if(s&&s.startCC<=e&&s.endCC>=e){let n=s.fragments;const{fragmentHint:r}=s;r&&(n=n.concat(r));let o;return IR.search(n,l=>l.cc<e?1:l.cc>e?-1:(o=l,l.end<=t?1:l.start>t?-1:0)),o||null}return null}function zu(s){switch(s.details){case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_TIMEOUT:case W.LEVEL_LOAD_TIMEOUT:case W.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function NR(s){return s.details.startsWith("key")}function kR(s){return NR(s)&&!!s.frag&&!s.frag.decryptdata}function wS(s,e){const t=zu(e);return s.default[`${t?"timeout":"error"}Retry`]}function bp(s,e){const t=s.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*s.retryDelayMs,s.maxRetryDelayMs)}function LS(s){return tt(tt({},s),{errorRetry:null,timeoutRetry:null})}function Vu(s,e,t,n){if(!s)return!1;const r=n?.code,o=e<s.maxNumRetry&&(AB(r)||!!t);return s.shouldRetry?s.shouldRetry(s,e,t,n,o):o}function AB(s){return mg(s)||!!s&&(s<400||s>499)}function mg(s){return s===0&&navigator.onLine===!1}var Xt={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Ln={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class RB extends Wn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(L.ERROR,this.onError,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(L.ERROR,this.onError,this),e.off(L.ERROR,this.onErrorOut,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===xe.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,n=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||n===-1?t.loadLevel:n}variantHasKey(e,t){if(e){var n;if((n=e.details)!=null&&n.hasKey(t))return!0;const r=e.audioGroups;if(r)return this.hls.allAudioTracks.filter(l=>r.indexOf(l.groupId)>=0).some(l=>{var c;return(c=l.details)==null?void 0:c.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const r=this.hls,o=t.context;switch(t.details){case W.FRAG_LOAD_ERROR:case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_ERROR:case W.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case W.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction=_a();return}case W.FRAG_GAP:case W.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Xt.SendAlternateToPenaltyBox;return}case W.LEVEL_EMPTY_ERROR:case W.LEVEL_PARSING_ERROR:{var l;const f=t.parent===xe.MAIN?t.level:r.loadLevel;t.details===W.LEVEL_EMPTY_ERROR&&((l=t.context)!=null&&(l=l.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,f):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,f))}return;case W.LEVEL_LOAD_ERROR:case W.LEVEL_LOAD_TIMEOUT:typeof o?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case W.AUDIO_TRACK_LOAD_ERROR:case W.AUDIO_TRACK_LOAD_TIMEOUT:case W.SUBTITLE_LOAD_ERROR:case W.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const f=r.loadLevelObj;if(f&&(o.type===je.AUDIO_TRACK&&f.hasAudioGroup(o.groupId)||o.type===je.SUBTITLE_TRACK&&f.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=Xt.SendAlternateToPenaltyBox,t.errorAction.flags=Ln.MoveAllAlternatesMatchingHost;return}}return;case W.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:Xt.SendAlternateToPenaltyBox,flags:Ln.MoveAllAlternatesMatchingHDCP};return;case W.KEY_SYSTEM_SESSION_UPDATE_FAILED:case W.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case W.KEY_SYSTEM_NO_SESSION:t.errorAction={action:Xt.SendAlternateToPenaltyBox,flags:Ln.MoveAllAlternatesMatchingKey};return;case W.BUFFER_ADD_CODEC_ERROR:case W.REMUX_ALLOC_ERROR:case W.BUFFER_APPEND_ERROR:if(!t.errorAction){var c;t.errorAction=this.getLevelSwitchAction(t,(c=t.level)!=null?c:r.loadLevel)}return;case W.INTERNAL_EXCEPTION:case W.BUFFER_APPENDING_ERROR:case W.BUFFER_FULL_ERROR:case W.LEVEL_SWITCH_ERROR:case W.BUFFER_STALLED_ERROR:case W.BUFFER_SEEK_OVER_HOLE:case W.BUFFER_NUDGE_ON_STALL:t.errorAction=_a();return}t.type===Ae.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=_a())}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,r=wS(n.config.playlistLoadPolicy,e),o=this.playlistError++;if(Vu(r,o,zu(e),e.response))return{action:Xt.RetryRequest,flags:Ln.None,retryConfig:r,retryCount:o};const c=this.getLevelSwitchAction(e,t);return r&&(c.retryConfig=r,c.retryCount=o),c}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:o,keyLoadPolicy:l}=t.config,c=wS(NR(e)?l:o,e),f=t.levels.reduce((m,g)=>m+g.fragmentError,0);if(r&&(e.details!==W.FRAG_GAP&&r.fragmentError++,!kR(e)&&Vu(c,f,zu(e),e.response)))return{action:Xt.RetryRequest,flags:Ln.None,retryConfig:c,retryCount:f};const d=this.getLevelSwitchAction(e,n);return c&&(d.retryConfig=c,d.retryCount=f),d}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const r=this.hls.levels[t];if(r){var o,l;const d=e.details;r.loadError++,d===W.BUFFER_APPEND_ERROR&&r.fragmentError++;let m=-1;const{levels:g,loadLevel:p,minAutoLevel:E,maxAutoLevel:v}=n;!n.autoLevelEnabled&&!n.config.preserveManualLevelOnError&&(n.loadLevel=-1);const S=(o=e.frag)==null?void 0:o.type,R=(S===xe.AUDIO&&d===W.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(d===W.BUFFER_ADD_CODEC_ERROR||d===W.BUFFER_APPEND_ERROR))&&g.some(({audioCodec:B})=>r.audioCodec!==B),_=e.sourceBufferName==="video"&&(d===W.BUFFER_ADD_CODEC_ERROR||d===W.BUFFER_APPEND_ERROR)&&g.some(({codecSet:B,audioCodec:I})=>r.codecSet!==B&&r.audioCodec===I),{type:D,groupId:N}=(l=e.context)!=null?l:{};for(let B=g.length;B--;){const I=(B+p)%g.length;if(I!==p&&I>=E&&I<=v&&g[I].loadError===0){var c,f;const P=g[I];if(d===W.FRAG_GAP&&S===xe.MAIN&&e.frag){const M=g[I].details;if(M){const U=Ar(e.frag,M.fragments,e.frag.start);if(U!=null&&U.gap)continue}}else{if(D===je.AUDIO_TRACK&&P.hasAudioGroup(N)||D===je.SUBTITLE_TRACK&&P.hasSubtitleGroup(N))continue;if(S===xe.AUDIO&&(c=r.audioGroups)!=null&&c.some(M=>P.hasAudioGroup(M))||S===xe.SUBTITLE&&(f=r.subtitleGroups)!=null&&f.some(M=>P.hasSubtitleGroup(M))||R&&r.audioCodec===P.audioCodec||_&&r.codecSet===P.codecSet||!R&&r.codecSet!==P.codecSet)continue}m=I;break}}if(m>-1&&n.loadLevel!==m)return e.levelRetry=!0,this.playlistError=0,{action:Xt.SendAlternateToPenaltyBox,flags:Ln.None,nextAutoLevel:m}}return{action:Xt.SendAlternateToPenaltyBox,flags:Ln.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case Xt.DoNothing:break;case Xt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==W.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r}=n,o=n.nextAutoLevel;switch(r){case Ln.None:this.switchLevel(e,o);break;case Ln.MoveAllAlternatesMatchingHDCP:{const f=this.getVariantLevelIndex(e.frag),d=t.levels[f],m=d?.attrs["HDCP-LEVEL"];if(n.hdcpLevel=m,m==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(m){t.maxHdcpLevel=hg[hg.indexOf(m)-1],n.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case Ln.MoveAllAlternatesMatchingKey:{const f=e.decryptdata;if(f){const d=this.hls.levels,m=d.length;for(let p=m;p--;)if(this.variantHasKey(d[p],f)){var l,c;this.log(`Banned key found in level ${p} (${d[p].bitrate}bps) or audio group "${(l=d[p].audioGroups)==null?void 0:l.join(",")}" (${(c=e.frag)==null?void 0:c.type} fragment) ${Qt(f.keyId||[])}`),d[p].fragmentError++,d[p].loadError++,this.log(`Removing level ${p} with key error (${e.error})`),this.hls.removeLevel(p)}const g=e.frag;if(this.hls.levels.length<m)n.resolved=!0;else if(g&&g.type!==xe.MAIN){const p=g.decryptdata;p&&!f.matches(p)&&(n.resolved=!0)}}break}}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===W.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const n=fg(e.mimeType),r=this.hls.levels;for(let o=r.length;o--;)r[o][`${e.sourceBufferName}Codec`]===n&&(this.log(`Removing level ${o} for ${e.details} ("${n}" not supported)`),this.hls.removeLevel(o))}}}function _a(s){const e={action:Xt.DoNothing,flags:Ln.None};return s&&(e.resolved=!0),e}var Ut={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class wB{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.BUFFER_APPENDED,this.onBufferAppended,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.BUFFER_APPENDED,this.onBufferAppended,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let r=n.length;r--;){const o=n[r];if(!o)break;if(o.start<=e&&e<=o.end&&o.loaded)return o}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:r}=this,o=Object.keys(r);for(let l=o.length;l--;){const c=r[o[l]];if(c?.body.type===t&&(!n||c.buffered)){const f=c.body;if(f.start<=e&&e<=f.end)return f}}return null}detectEvictedFragments(e,t,n,r,o){this.timeRanges&&(this.timeRanges[e]=t);const l=r?.fragment.sn||-1;Object.keys(this.fragments).forEach(c=>{const f=this.fragments[c];if(!f||l>=f.body.sn)return;if(!f.buffered&&(!f.loaded||o)){f.body.type===n&&this.removeFragment(f.body);return}const d=f.range[e];if(d){if(d.time.length===0){this.removeFragment(f.body);return}d.time.some(m=>{const g=!this.isTimeBuffered(m.startPTS,m.endPTS,t);return g&&this.removeFragment(f.body),g})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const n=e.frag,r=Ea(n),o=this.fragments[r];if(!o||o.buffered&&n.gap)return;const l=!n.relurl;Object.keys(t).forEach(c=>{const f=n.elementaryStreams[c];if(!f)return;const d=t[c],m=l||f.partial===!0;o.range[c]=this.getBufferedTimes(n,e.part,m,d)}),o.loaded=null,Object.keys(o.range).length?(this.bufferedEnd(o,n),Wc(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}bufferedEnd(e,t){e.buffered=!0,(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=CS(n,r=>r.fragment.sn>=e))}fragBuffered(e,t){const n=Ea(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,this.bufferedEnd(r,e))}getBufferedTimes(e,t,n,r){const o={time:[],partial:n},l=e.start,c=e.end,f=e.minEndPTS||c,d=e.maxStartPTS||l;for(let m=0;m<r.length;m++){const g=r.start(m)-this.bufferPadding,p=r.end(m)+this.bufferPadding;if(d>=g&&f<=p){o.time.push({startPTS:Math.max(l,r.start(m)),endPTS:Math.min(c,r.end(m))});break}else if(l<p&&c>g){const E=Math.max(l,r.start(m)),v=Math.min(c,r.end(m));v>E&&(o.partial=!0,o.time.push({startPTS:E,endPTS:v}))}else if(c<=g)break}return o}getPartialFragment(e){let t=null,n,r,o,l=0;const{bufferPadding:c,fragments:f}=this;return Object.keys(f).forEach(d=>{const m=f[d];m&&Wc(m)&&(r=m.body.start-c,o=m.body.end+c,e>=r&&e<=o&&(n=Math.min(e-r,o-e),l<=n&&(t=m.body,l=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Wc(t))}getState(e){const t=Ea(e),n=this.fragments[t];return n?n.buffered?Wc(n)?Ut.PARTIAL:Ut.OK:Ut.APPENDING:Ut.NOT_LOADED}isTimeBuffered(e,t,n){let r,o;for(let l=0;l<n.length;l++){if(r=n.start(l)-this.bufferPadding,o=n.end(l)+this.bufferPadding,e>=r&&t<=o)return!0;if(t<=r)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const n=t.frag,r=t.part?null:t,o=Ea(n);this.fragments[o]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:o,type:l}=t;if(n.sn==="initSegment")return;const c=n.type;if(r){let d=this.activePartLists[c];d||(this.activePartLists[c]=d=[]),d.push(r)}this.timeRanges=o;const f=o[l];this.detectEvictedFragments(l,f,c,r)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Ea(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let r=n.length;r--;){const o=t[n[r]];if(o?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,r,o){r&&!this.hasGaps||Object.keys(this.fragments).forEach(l=>{const c=this.fragments[l];if(!c)return;const f=c.body;f.type!==n||r&&!f.gap||f.start<t&&f.end>e&&(c.buffered||o)&&this.removeFragment(f)})}removeFragment(e){const t=Ea(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const r=e.sn;this.activePartLists[e.type]=CS(n,o=>o.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(n=>n.clearElementaryStreamInfo())}}function Wc(s){var e,t,n;return s.buffered&&!!(s.body.gap||(e=s.range.video)!=null&&e.partial||(t=s.range.audio)!=null&&t.partial||(n=s.range.audiovideo)!=null&&n.partial)}function Ea(s){return`${s.type}_${s.level}_${s.sn}`}function CS(s,e){return s.filter(t=>{const n=e(t);return n||t.clearElementaryStreamInfo(),n})}var Vi={cbc:0,ctr:1};class LB{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case Vi.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Vi.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function CB(s){const e=s.byteLength,t=e&&new DataView(s.buffer).getUint8(e-1);return t?s.slice(0,e-t):s}class _B{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(r*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],o=n[1],l=n[2],c=n[3],f=this.invSubMix,d=f[0],m=f[1],g=f[2],p=f[3],E=new Uint32Array(256);let v=0,S=0,b=0;for(b=0;b<256;b++)b<128?E[b]=b<<1:E[b]=b<<1^283;for(b=0;b<256;b++){let R=S^S<<1^S<<2^S<<3^S<<4;R=R>>>8^R&255^99,e[v]=R,t[R]=v;const C=E[v],_=E[C],D=E[_];let N=E[R]*257^R*16843008;r[v]=N<<24|N>>>8,o[v]=N<<16|N>>>16,l[v]=N<<8|N>>>24,c[v]=N,N=D*16843009^_*65537^C*257^v*16843008,d[R]=N<<24|N>>>8,m[R]=N<<16|N>>>16,g[R]=N<<8|N>>>24,p[R]=N,v?(v=C^E[E[E[D^C]]],S^=E[E[S]]):v=S=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const o=this.keySize=t.length;if(o!==4&&o!==6&&o!==8)throw new Error("Invalid aes key size="+o);const l=this.ksRows=(o+6+1)*4;let c,f;const d=this.keySchedule=new Uint32Array(l),m=this.invKeySchedule=new Uint32Array(l),g=this.sBox,p=this.rcon,E=this.invSubMix,v=E[0],S=E[1],b=E[2],R=E[3];let C,_;for(c=0;c<l;c++){if(c<o){C=d[c]=t[c];continue}_=C,c%o===0?(_=_<<8|_>>>24,_=g[_>>>24]<<24|g[_>>>16&255]<<16|g[_>>>8&255]<<8|g[_&255],_^=p[c/o|0]<<24):o>6&&c%o===4&&(_=g[_>>>24]<<24|g[_>>>16&255]<<16|g[_>>>8&255]<<8|g[_&255]),d[c]=C=(d[c-o]^_)>>>0}for(f=0;f<l;f++)c=l-f,f&3?_=d[c]:_=d[c-4],f<4||c<=4?m[f]=_:m[f]=v[g[_>>>24]]^S[g[_>>>16&255]]^b[g[_>>>8&255]]^R[g[_&255]],m[f]=m[f]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,o=this.invKeySchedule,l=this.invSBox,c=this.invSubMix,f=c[0],d=c[1],m=c[2],g=c[3],p=this.uint8ArrayToUint32Array_(n);let E=p[0],v=p[1],S=p[2],b=p[3];const R=new Int32Array(e),C=new Int32Array(R.length);let _,D,N,B,I,P,M,U,q,V,ee,Z,re,F;const z=this.networkToHostOrderSwap;for(;t<R.length;){for(q=z(R[t]),V=z(R[t+1]),ee=z(R[t+2]),Z=z(R[t+3]),I=q^o[0],P=Z^o[1],M=ee^o[2],U=V^o[3],re=4,F=1;F<r;F++)_=f[I>>>24]^d[P>>16&255]^m[M>>8&255]^g[U&255]^o[re],D=f[P>>>24]^d[M>>16&255]^m[U>>8&255]^g[I&255]^o[re+1],N=f[M>>>24]^d[U>>16&255]^m[I>>8&255]^g[P&255]^o[re+2],B=f[U>>>24]^d[I>>16&255]^m[P>>8&255]^g[M&255]^o[re+3],I=_,P=D,M=N,U=B,re=re+4;_=l[I>>>24]<<24^l[P>>16&255]<<16^l[M>>8&255]<<8^l[U&255]^o[re],D=l[P>>>24]<<24^l[M>>16&255]<<16^l[U>>8&255]<<8^l[I&255]^o[re+1],N=l[M>>>24]<<24^l[U>>16&255]<<16^l[I>>8&255]<<8^l[P&255]^o[re+2],B=l[U>>>24]<<24^l[I>>16&255]<<16^l[P>>8&255]<<8^l[M&255]^o[re+3],C[t]=z(_^E),C[t+1]=z(B^v),C[t+2]=z(N^S),C[t+3]=z(D^b),E=q,v=V,S=ee,b=Z,t=t+4}return C.buffer}}class DB{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=IB(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function IB(s){switch(s){case Vi.cbc:return"AES-CBC";case Vi.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${s}`)}}const OB=16;class Tp{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?CB(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,r){return this.useSoftware?new Promise((o,l)=>{const c=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(c,t,n,r);const f=this.flush();f?o(f.buffer):l(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,r)}softwareDecrypt(e,t,n,r){const{currentIV:o,currentResult:l,remainderData:c}=this;if(r!==Vi.cbc||t.byteLength!==16)return nt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),c&&(e=qn(c,e),this.remainderData=null);const f=this.getValidChunk(e);if(!f.length)return null;o&&(n=o);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new _B),d.expandKey(t);const m=l;return this.currentResult=d.decrypt(f.buffer,0,n),this.currentIV=f.slice(-16).buffer,m||null}webCryptoDecrypt(e,t,n,r){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,r));this.key=t,this.fastAesKey=new DB(this.subtle,t,r)}return this.fastAesKey.expandKey().then(o=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new LB(this.subtle,new Uint8Array(n),r).decrypt(e.buffer,o)):Promise.reject(new Error("web crypto not initialized"))).catch(o=>(nt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${o.name}: ${o.message}`),this.onWebCryptoError(e,t,n,r)))}onWebCryptoError(e,t,n,r){const o=this.enableSoftwareAES;if(o){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,r);const l=this.flush();if(l)return l.buffer}throw new Error("WebCrypto"+(o?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%OB;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(nt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const _S=Math.pow(2,17);class NB{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new ei({type:Ae.NETWORK_ERROR,details:W.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,o=r.fLoader,l=r.loader;return new Promise((c,f)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(v=>v[0]==="GAP")){f(IS(e));return}else e.gap=!1;const d=this.loader=o?new o(r):new l(r),m=DS(e);e.loader=d;const g=LS(r.fragLoadPolicy.default),p={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:_S};e.stats=d.stats;const E={onSuccess:(v,S,b,R)=>{this.resetLoader(e,d);let C=v.data;b.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(C.slice(0,16)),C=C.slice(16)),c({frag:e,part:null,payload:C,networkDetails:R})},onError:(v,S,b,R)=>{this.resetLoader(e,d),f(new ei({type:Ae.NETWORK_ERROR,details:W.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:tt({url:n,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:b,stats:R}))},onAbort:(v,S,b)=>{this.resetLoader(e,d),f(new ei({type:Ae.NETWORK_ERROR,details:W.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:b,stats:v}))},onTimeout:(v,S,b)=>{this.resetLoader(e,d),f(new ei({type:Ae.NETWORK_ERROR,details:W.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:b,stats:v}))}};t&&(E.onProgress=(v,S,b,R)=>t({frag:e,part:null,payload:b,networkDetails:R})),d.load(m,p,E)})}loadPart(e,t,n){this.abort();const r=this.config,o=r.fLoader,l=r.loader;return new Promise((c,f)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){f(IS(e,t));return}const d=this.loader=o?new o(r):new l(r),m=DS(e,t);e.loader=d;const g=LS(r.fragLoadPolicy.default),p={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:_S};t.stats=d.stats,d.load(m,p,{onSuccess:(E,v,S,b)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const R={frag:e,part:t,payload:E.data,networkDetails:b};n(R),c(R)},onError:(E,v,S,b)=>{this.resetLoader(e,d),f(new ei({type:Ae.NETWORK_ERROR,details:W.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:tt({url:m.url,data:void 0},E),error:new Error(`HTTP Error ${E.code} ${E.text}`),networkDetails:S,stats:b}))},onAbort:(E,v,S)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),f(new ei({type:Ae.NETWORK_ERROR,details:W.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:S,stats:E}))},onTimeout:(E,v,S)=>{this.resetLoader(e,d),f(new ei({type:Ae.NETWORK_ERROR,details:W.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:S,stats:E}))}})})}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,o=r.total;if(n.loaded+=r.loaded,o){const f=Math.round(e.duration/t.duration),d=Math.min(Math.round(n.loaded/o),f),g=(f-d)*Math.round(n.loaded/d);n.total=n.loaded+g}else n.total=Math.max(n.loaded,n.total);const l=n.loading,c=r.loading;l.start?l.first+=c.first-c.start:(l.start=c.start,l.first=c.first),l.end=c.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function DS(s,e=null){const t=e||s,n={frag:s,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,o=t.byteRangeEndOffset;if(ve(r)&&ve(o)){var l;let c=r,f=o;if(s.sn==="initSegment"&&kB((l=s.decryptdata)==null?void 0:l.method)){const d=o-r;d%16&&(f=o+(16-d%16)),r!==0&&(n.resetIV=!0,c=r-16)}n.rangeStart=c,n.rangeEnd=f}return n}function IS(s,e){const t=new Error(`GAP ${s.gap?"tag":"attribute"} found`),n={type:Ae.MEDIA_ERROR,details:W.FRAG_GAP,fatal:!1,frag:s,error:t,networkDetails:null};return e&&(n.part=e),(e||s).stats.aborted=!0,new ei(n)}function kB(s){return s==="AES-128"||s==="AES-256"}class ei extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class MR extends Wn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Ap{constructor(e,t,n,r=0,o=-1,l=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Xc(),this.buffering={audio:Xc(),video:Xc(),audiovideo:Xc()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=o,this.partial=l}}function Xc(){return{start:0,executeStart:0,executeEnd:0,end:0}}const OS={length:0,start:()=>0,end:()=>0};class Ie{static isBuffered(e,t){if(e){const n=Ie.getBuffered(e);for(let r=n.length;r--;)if(t>=n.start(r)&&t<=n.end(r))return!0}return!1}static bufferedRanges(e){if(e){const t=Ie.getBuffered(e);return Ie.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const r=Ie.bufferedRanges(e);if(r.length)return Ie.bufferedInfo(r,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((m,g)=>m.start-g.start||g.end-m.end);let r=-1,o=[];if(n)for(let m=0;m<e.length;m++){t>=e[m].start&&t<=e[m].end&&(r=m);const g=o.length;if(g){const p=o[g-1].end;e[m].start-p<n?e[m].end>p&&(o[g-1].end=e[m].end):o.push(e[m])}else o.push(e[m])}else o=e;let l=0,c,f=t,d=t;for(let m=0;m<o.length;m++){const g=o[m].start,p=o[m].end;if(r===-1&&t>=g&&t<=p&&(r=m),t+n>=g&&t<p)f=g,d=p,l=d-t;else if(t+n<g){c=g;break}}return{len:l,start:f||0,end:d||0,nextStart:c,buffered:e,bufferedIndex:r}}static getBuffered(e){try{return e.buffered||OS}catch(t){return nt.log("failed to get media.buffered",t),OS}}}const PR=/\{\$([a-zA-Z0-9-_]+)\}/g;function NS(s){return PR.test(s)}function gg(s,e){if(s.variableList!==null||s.hasVariableRefs){const t=s.variableList;return e.replace(PR,n=>{const r=n.substring(2,n.length-1),o=t?.[r];return o===void 0?(s.playlistParsingError||(s.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),n):o})}return e}function kS(s,e,t){let n=s.variableList;n||(s.variableList=n={});let r,o;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const l=new self.URL(t).searchParams;if(l.has(r))o=l.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(l){s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${l.message}`))}}else r=e.NAME,o=e.VALUE;r in n?s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):n[r]=o||""}function MB(s,e,t){const n=e.IMPORT;if(t&&n in t){let r=s.variableList;r||(s.variableList=r={}),r[n]=t[n]}else s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const PB=/^(\d+)x(\d+)$/,MS=/(.+?)=(".*?"|.*?)(?:,|$)/g;class vt{constructor(e,t){typeof e=="string"&&(e=vt.parseAttrList(e,t)),at(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(r*2,r*2+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((r,o)=>(r[o.toLowerCase()]=!0,r),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=PB.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const r={};for(MS.lastIndex=0;(n=MS.exec(e))!==null;){const l=n[1].trim();let c=n[2];const f=c.indexOf('"')===0&&c.lastIndexOf('"')===c.length-1;let d=!1;if(f)c=c.slice(1,-1);else switch(l){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":d=!0}if(t&&(f||d))c=gg(t,c);else if(!d&&!f)switch(l){case"CLOSED-CAPTIONS":if(c==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":nt.warn(`${e}: attribute ${l} is missing quotes`)}r[l]=c}return r}}const FB="com.apple.hls.interstitial";function UB(s){return s!=="ID"&&s!=="CLASS"&&s!=="CUE"&&s!=="START-DATE"&&s!=="DURATION"&&s!=="END-DATE"&&s!=="END-ON-NEXT"}function BB(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"||s==="SCTE35-CMD"}class FR{constructor(e,t,n=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(r=t?.tagOrder)!=null?r:n,t){const o=t.attr;for(const l in o)if(Object.prototype.hasOwnProperty.call(e,l)&&e[l]!==o[l]){nt.warn(`DATERANGE tag attribute: "${l}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=l;break}e=at(new vt({}),o,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const o=t?.endDate||new Date(this.attr["END-DATE"]);ve(o.getTime())&&(this._endDate=o)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(nt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(ve(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===FB}get isValid(){return!!this.id&&!this._badValueForSameId&&ve(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const $B=10;class jB{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let n=t.decryptdata;return n||(t.setKeyFormat(e.keyFormat),n=t.decryptdata),!!n&&e.matches(n)})}get hasProgramDateTime(){return this.fragments.length?ve(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||$B}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Ku(s,e){return s.length===e.length?!s.some((t,n)=>t!==e[n]):!1}function PS(s,e){return!s&&!e?!0:!s||!e?!1:Ku(s,e)}function Da(s){return s==="AES-128"||s==="AES-256"||s==="AES-256-CTR"}function Rp(s){switch(s){case"AES-128":case"AES-256":return Vi.cbc;case"AES-256-CTR":return Vi.ctr;default:throw new Error(`invalid full segment method ${s}`)}}function wp(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0))}function pg(s){return Uint8Array.from(unescape(encodeURIComponent(s)),e=>e.charCodeAt(0))}function GB(s){const e=pg(s).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function UR(s){const e=function(n,r,o){const l=n[r];n[r]=n[o],n[o]=l};e(s,0,3),e(s,1,2),e(s,4,5),e(s,6,7)}function BR(s){const e=s.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),r=n[n.length-1].split(",");if(r.length===2){const o=r[0]==="base64",l=r[1];o?(n.splice(-1,1),t=wp(l)):t=GB(l)}}return t}const qu=typeof self<"u"?self:void 0;var xt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Zt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function bu(s){switch(s){case Zt.FAIRPLAY:return xt.FAIRPLAY;case Zt.PLAYREADY:return xt.PLAYREADY;case Zt.WIDEVINE:return xt.WIDEVINE;case Zt.CLEARKEY:return xt.CLEARKEY}}function vm(s){switch(s){case xt.FAIRPLAY:return Zt.FAIRPLAY;case xt.PLAYREADY:return Zt.PLAYREADY;case xt.WIDEVINE:return Zt.WIDEVINE;case xt.CLEARKEY:return Zt.CLEARKEY}}function Ho(s){const{drmSystems:e,widevineLicenseUrl:t}=s,n=e?[xt.FAIRPLAY,xt.WIDEVINE,xt.PLAYREADY,xt.CLEARKEY].filter(r=>!!e[r]):[];return!n[xt.WIDEVINE]&&t&&n.push(xt.WIDEVINE),n}const $R=(function(s){return qu!=null&&(s=qu.navigator)!=null&&s.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function HB(s,e,t,n){let r;switch(s){case xt.FAIRPLAY:r=["cenc","sinf"];break;case xt.WIDEVINE:case xt.PLAYREADY:r=["cenc"];break;case xt.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${s}`)}return zB(r,e,t,n)}function zB(s,e,t,n){return[{initDataTypes:s,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(o=>({contentType:`audio/mp4; codecs=${o}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(o=>({contentType:`video/mp4; codecs=${o}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function VB(s){var e;return!!s&&(s.sessionType==="persistent-license"||!!((e=s.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function jR(s){const e=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),l=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(l){const c=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(c){const f=wp(c).subarray(0,16);return UR(f),f}}return null}let Sa={};class ji{static clearKeyUriToKeyIdMap(){Sa={}}static setKeyIdForUri(e,t){Sa[e]=t}static addKeyIdForUri(e){const t=Object.keys(Sa).length%Number.MAX_SAFE_INTEGER,n=new Uint8Array(16);return new DataView(n.buffer,12,4).setUint32(0,t),Sa[e]=n,n}constructor(e,t,n,r=[1],o=null,l){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=o,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Da(e),l!=null&&l.startsWith("0x")&&(this.keyId=new Uint8Array(gR(l)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Ku(e.keyFormatVersions,this.keyFormatVersions)&&PS(e.iv,this.iv)&&PS(e.keyId,this.keyId)}isSupported(){if(this.method){if(Da(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Zt.FAIRPLAY:case Zt.WIDEVINE:case Zt.PLAYREADY:case Zt.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(Da(this.method)){let o=this.iv;return o||(typeof e!="number"&&(nt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),o=qB(e)),new ji(this.method,this.uri,"identity",this.keyFormatVersions,o)}if(this.keyId){const o=Sa[this.uri];if(o&&!Ku(this.keyId,o)&&ji.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const n=BR(this.uri);if(n)switch(this.keyFormat){case Zt.WIDEVINE:if(this.pssh=n,!this.keyId){const o=XU(n.buffer);if(o.length){var r;const l=o[0];this.keyId=(r=l.kids)!=null&&r.length?l.kids[0]:null}}this.keyId||(this.keyId=FS(t));break;case Zt.PLAYREADY:{const o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=WU(o,null,n),this.keyId=jR(n);break}default:{let o=n.subarray(0,16);if(o.length!==16){const l=new Uint8Array(16);l.set(o,16-o.length),o=l}this.keyId=o;break}}if(!this.keyId||this.keyId.byteLength!==16){let o;o=KB(t),o||(o=FS(t),o||(o=Sa[this.uri])),o&&(this.keyId=o,ji.setKeyIdForUri(this.uri,o))}return this}}function KB(s){const e=s?.[Zt.WIDEVINE];return e?e.keyId:null}function FS(s){const e=s?.[Zt.PLAYREADY];if(e){const t=BR(e.uri);if(t)return jR(t)}return null}function qB(s){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=s>>8*(15-t)&255;return e}const US=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,BS=/#EXT-X-MEDIA:(.*)/g,YB=/^#EXT(?:INF|-X-TARGETDURATION):/m,xm=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),WB=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class bs{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static resolve(e,t){return yp.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return YB.test(e)}static parseMasterPlaylist(e,t){const n=NS(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},o=[];if(US.lastIndex=0,!e.startsWith("#EXTM3U"))return r.playlistParsingError=new Error("no EXTM3U delimiter"),r;let l;for(;(l=US.exec(e))!=null;)if(l[1]){var c;const d=new vt(l[1],r),m=gg(r,l[2]),g={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:bs.resolve(m,t)},p=d.decimalResolution("RESOLUTION");p&&(g.width=p.width,g.height=p.height),GS(d.CODECS,g);const E=d["SUPPLEMENTAL-CODECS"];E&&(g.supplemental={},GS(E,g.supplemental)),(c=g.unknownCodecs)!=null&&c.length||o.push(g),r.levels.push(g)}else if(l[3]){const d=l[3],m=l[4];switch(d){case"SESSION-DATA":{const g=new vt(m,r),p=g["DATA-ID"];p&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[p]=g);break}case"SESSION-KEY":{const g=$S(m,t,r);g.encrypted&&g.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(g)):nt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${m}"`);break}case"DEFINE":{{const g=new vt(m,r);kS(r,g,t)}break}case"CONTENT-STEERING":{const g=new vt(m,r);r.contentSteering={uri:bs.resolve(g["SERVER-URI"],t),pathwayId:g["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=jS(m);break}}}const f=o.length>0&&o.length<r.levels.length;return r.levels=f?o:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r;const o={},l=n.levels,c={AUDIO:l.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:l.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let f=0;for(BS.lastIndex=0;(r=BS.exec(e))!==null;){const d=new vt(r[1],n),m=d.TYPE;if(m){const g=c[m],p=o[m]||[];o[m]=p;const E=d.LANGUAGE,v=d["ASSOC-LANGUAGE"],S=d.CHANNELS,b=d.CHARACTERISTICS,R=d["INSTREAM-ID"],C={attrs:d,bitrate:0,id:f++,groupId:d["GROUP-ID"]||"",name:d.NAME||E||"",type:m,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:E,url:d.URI?bs.resolve(d.URI,t):""};if(v&&(C.assocLang=v),S&&(C.channels=S),b&&(C.characteristics=b),R&&(C.instreamId=R),g!=null&&g.length){const _=bs.findGroup(g,C.groupId)||g[0];HS(C,_,"audioCodec"),HS(C,_,"textCodec")}p.push(C)}}return o}static parseLevelPlaylist(e,t,n,r,o,l){var c;const f={url:t},d=new jB(t),m=d.fragments,g=[];let p=null,E=0,v=0,S=0,b=0,R=0,C=null,_=new gm(r,f),D,N,B,I=-1,P=!1,M=null,U;if(xm.lastIndex=0,d.m3u8=e,d.hasVariableRefs=NS(e),((c=xm.exec(e))==null?void 0:c[0])!=="#EXTM3U")return d.playlistParsingError=new Error("Missing format identifier #EXTM3U"),d;for(;(D=xm.exec(e))!==null;){P&&(P=!1,_=new gm(r,f),_.playlistOffset=S,_.setStart(S),_.sn=E,_.cc=b,R&&(_.bitrate=R),_.level=n,p&&(_.initSegment=p,p.rawProgramDateTime&&(_.rawProgramDateTime=p.rawProgramDateTime,p.rawProgramDateTime=null),M&&(_.setByteRange(M),M=null)));const Z=D[1];if(Z){_.duration=parseFloat(Z);const re=(" "+D[2]).slice(1);_.title=re||null,_.tagList.push(re?["INF",Z,re]:["INF",Z])}else if(D[3]){if(ve(_.duration)){_.playlistOffset=S,_.setStart(S),B&&VS(_,B,d),_.sn=E,_.level=n,_.cc=b,m.push(_);const re=(" "+D[3]).slice(1);_.relurl=gg(d,re),yg(_,C,g),C=_,S+=_.duration,E++,v=0,P=!0}}else{if(D=D[0].match(WB),!D){nt.warn("No matches on slow regex match for level playlist!");continue}for(N=1;N<D.length&&D[N]===void 0;N++);const re=(" "+D[N]).slice(1),F=(" "+D[N+1]).slice(1),z=D[N+2]?(" "+D[N+2]).slice(1):null;switch(re){case"BYTERANGE":C?_.setByteRange(F,C):_.setByteRange(F);break;case"PROGRAM-DATE-TIME":_.rawProgramDateTime=F,_.tagList.push(["PROGRAM-DATE-TIME",F]),I===-1&&(I=m.length);break;case"PLAYLIST-TYPE":d.type&&Zs(d,re,D),d.type=F.toUpperCase();break;case"MEDIA-SEQUENCE":d.startSN!==0?Zs(d,re,D):m.length>0&&KS(d,re,D),E=d.startSN=parseInt(F);break;case"SKIP":{d.skippedSegments&&Zs(d,re,D);const j=new vt(F,d),oe=j.decimalInteger("SKIPPED-SEGMENTS");if(ve(oe)){d.skippedSegments+=oe;for(let k=oe;k--;)m.push(null);E+=oe}const fe=j.enumeratedString("RECENTLY-REMOVED-DATERANGES");fe&&(d.recentlyRemovedDateranges=(d.recentlyRemovedDateranges||[]).concat(fe.split("	")));break}case"TARGETDURATION":d.targetduration!==0&&Zs(d,re,D),d.targetduration=Math.max(parseInt(F),1);break;case"VERSION":d.version!==null&&Zs(d,re,D),d.version=parseInt(F);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":d.live||Zs(d,re,D),d.live=!1;break;case"#":(F||z)&&_.tagList.push(z?[F,z]:[F]);break;case"DISCONTINUITY":b++,_.tagList.push(["DIS"]);break;case"GAP":_.gap=!0,_.tagList.push([re]);break;case"BITRATE":_.tagList.push([re,F]),R=parseInt(F)*1e3,ve(R)?_.bitrate=R:R=0;break;case"DATERANGE":{const j=new vt(F,d),oe=new FR(j,d.dateRanges[j.ID],d.dateRangeTagCount);d.dateRangeTagCount++,oe.isValid||d.skippedSegments?d.dateRanges[oe.id]=oe:nt.warn(`Ignoring invalid DATERANGE tag: "${F}"`),_.tagList.push(["EXT-X-DATERANGE",F]);break}case"DEFINE":{{const j=new vt(F,d);"IMPORT"in j?MB(d,j,l):kS(d,j,t)}break}case"DISCONTINUITY-SEQUENCE":d.startCC!==0?Zs(d,re,D):m.length>0&&KS(d,re,D),d.startCC=b=parseInt(F);break;case"KEY":{const j=$S(F,t,d);if(j.isSupported()){if(j.method==="NONE"){B=void 0;break}B||(B={});const oe=B[j.keyFormat];oe!=null&&oe.matches(j)||(oe&&(B=at({},B)),B[j.keyFormat]=j)}else nt.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${F}"`);break}case"START":d.startTimeOffset=jS(F);break;case"MAP":{const j=new vt(F,d);if(_.duration){const oe=new gm(r,f);zS(oe,j,n,B),p=oe,_.initSegment=p,p.rawProgramDateTime&&!_.rawProgramDateTime&&(_.rawProgramDateTime=p.rawProgramDateTime)}else{const oe=_.byteRangeEndOffset;if(oe){const fe=_.byteRangeStartOffset;M=`${oe-fe}@${fe}`}else M=null;zS(_,j,n,B),p=_,P=!0}p.cc=b;break}case"SERVER-CONTROL":{U&&Zs(d,re,D),U=new vt(F),d.canBlockReload=U.bool("CAN-BLOCK-RELOAD"),d.canSkipUntil=U.optionalFloat("CAN-SKIP-UNTIL",0),d.canSkipDateRanges=d.canSkipUntil>0&&U.bool("CAN-SKIP-DATERANGES"),d.partHoldBack=U.optionalFloat("PART-HOLD-BACK",0),d.holdBack=U.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{d.partTarget&&Zs(d,re,D);const j=new vt(F);d.partTarget=j.decimalFloatingPoint("PART-TARGET");break}case"PART":{let j=d.partList;j||(j=d.partList=[]);const oe=v>0?j[j.length-1]:void 0,fe=v++,k=new vt(F,d),G=new MU(k,_,f,fe,oe);j.push(G),_.duration+=G.duration;break}case"PRELOAD-HINT":{const j=new vt(F,d);d.preloadHint=j;break}case"RENDITION-REPORT":{const j=new vt(F,d);d.renditionReports=d.renditionReports||[],d.renditionReports.push(j);break}default:nt.warn(`line parsed but not handled: ${D}`);break}}}C&&!C.relurl?(m.pop(),S-=C.duration,d.partList&&(d.fragmentHint=C)):d.partList&&(yg(_,C,g),_.cc=b,d.fragmentHint=_,B&&VS(_,B,d)),d.targetduration||(d.playlistParsingError=new Error("Missing Target Duration"));const q=m.length,V=m[0],ee=m[q-1];if(S+=d.skippedSegments*d.targetduration,S>0&&q&&ee){d.averagetargetduration=S/q;const Z=ee.sn;d.endSN=Z!=="initSegment"?Z:0,d.live||(ee.endList=!0),I>0&&(QB(m,I),V&&g.unshift(V))}return d.fragmentHint&&(S+=d.fragmentHint.duration),d.totalduration=S,g.length&&d.dateRangeTagCount&&V&&GR(g,d),d.endCC=b,d}}function GR(s,e){let t=s.length;if(!t)if(e.hasProgramDateTime){const c=e.fragments[e.fragments.length-1];s.push(c),t++}else return;const n=s[t-1],r=e.live?1/0:e.totalduration,o=Object.keys(e.dateRanges);for(let c=o.length;c--;){const f=e.dateRanges[o[c]],d=f.startDate.getTime();f.tagAnchor=n.ref;for(let m=t;m--;){var l;if(((l=s[m])==null?void 0:l.sn)<e.startSN)break;const g=XB(e,d,s,m,r);if(g!==-1){f.tagAnchor=e.fragments[g].ref;break}}}}function XB(s,e,t,n,r){const o=t[n];if(o){const c=o.programDateTime;if(e>=c||n===0){var l;const f=(((l=t[n+1])==null?void 0:l.start)||r)-o.start;if(e<=c+f*1e3){const d=t[n].sn-s.startSN;if(d<0)return-1;const m=s.fragments;if(m.length>t.length){const p=(t[n+1]||m[m.length-1]).sn-s.startSN;for(let E=p;E>d;E--){const v=m[E].programDateTime;if(e>=v&&e<v+m[E].duration*1e3)return E}}return d}}}return-1}function $S(s,e,t){var n,r;const o=new vt(s,t),l=(n=o.METHOD)!=null?n:"",c=o.URI,f=o.hexadecimalInteger("IV"),d=o.KEYFORMATVERSIONS,m=(r=o.KEYFORMAT)!=null?r:"identity";c&&o.IV&&!f&&nt.error(`Invalid IV: ${o.IV}`);const g=c?bs.resolve(c,e):"",p=(d||"1").split("/").map(Number).filter(Number.isFinite);return new ji(l,g,m,p,f,o.KEYID)}function jS(s){const t=new vt(s).decimalFloatingPoint("TIME-OFFSET");return ve(t)?t:null}function GS(s,e){let t=(s||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const r=t.filter(o=>Ep(o,n));r.length&&(e[`${n}Codec`]=r.map(o=>o.split("/")[0]).join(","),t=t.filter(o=>r.indexOf(o)===-1))}),e.unknownCodecs=t}function HS(s,e,t){const n=e[t];n&&(s[t]=n)}function QB(s,e){let t=s[e];for(let n=e;n--;){const r=s[n];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function yg(s,e,t){s.rawProgramDateTime?t.push(s):e!=null&&e.programDateTime&&(s.programDateTime=e.endProgramDateTime)}function zS(s,e,t,n){s.relurl=e.URI,e.BYTERANGE&&s.setByteRange(e.BYTERANGE),s.level=t,s.sn="initSegment",n&&(s.levelkeys=n),s.initSegment=null}function VS(s,e,t){s.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&n.push(s)}function Zs(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function KS(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Em(s,e){const t=e.startPTS;if(ve(t)){let n=0,r;e.sn>s.sn?(n=t-s.start,r=s):(n=s.start-t,r=e),r.duration!==n&&r.setDuration(n)}else e.sn>s.sn?s.cc===e.cc&&s.minEndPTS?e.setStart(s.start+(s.minEndPTS-s.start)):e.setStart(s.start+s.duration):e.setStart(Math.max(s.start-e.duration,0))}function HR(s,e,t,n,r,o,l){n-t<=0&&(l.warn("Fragment should have a positive duration",e),n=t+e.duration,o=r+e.duration);let f=t,d=n;const m=e.startPTS,g=e.endPTS;if(ve(m)){const R=Math.abs(m-t);s&&R>s.totalduration?l.warn(`media timestamps and playlist times differ by ${R}s for level ${e.level} ${s.url}`):ve(e.deltaPTS)?e.deltaPTS=Math.max(R,e.deltaPTS):e.deltaPTS=R,f=Math.max(t,m),t=Math.min(t,m),r=e.startDTS!==void 0?Math.min(r,e.startDTS):r,d=Math.min(n,g),n=Math.max(n,g),o=e.endDTS!==void 0?Math.max(o,e.endDTS):o}const p=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(n-e.start),e.startPTS=t,e.maxStartPTS=f,e.startDTS=r,e.endPTS=n,e.minEndPTS=d,e.endDTS=o;const E=e.sn;if(!s||E<s.startSN||E>s.endSN)return 0;let v;const S=E-s.startSN,b=s.fragments;for(b[S]=e,v=S;v>0;v--)Em(b[v],b[v-1]);for(v=S;v<b.length-1;v++)Em(b[v],b[v+1]);return s.fragmentHint&&Em(b[b.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,p}function ZB(s,e,t){if(s===e)return;let n=null;const r=s.fragments;for(let m=r.length-1;m>=0;m--){const g=r[m].initSegment;if(g){n=g;break}}s.fragmentHint&&delete s.fragmentHint.endPTS;let o;t3(s,e,(m,g,p,E)=>{if((!e.startCC||e.skippedSegments)&&g.cc!==m.cc){const v=m.cc-g.cc;for(let S=p;S<E.length;S++)E[S].cc+=v;e.endCC=E[E.length-1].cc}ve(m.startPTS)&&ve(m.endPTS)&&(g.setStart(g.startPTS=m.startPTS),g.startDTS=m.startDTS,g.maxStartPTS=m.maxStartPTS,g.endPTS=m.endPTS,g.endDTS=m.endDTS,g.minEndPTS=m.minEndPTS,g.setDuration(m.endPTS-m.startPTS),g.duration&&(o=g),e.PTSKnown=e.alignedSliding=!0),m.hasStreams&&(g.elementaryStreams=m.elementaryStreams),g.loader=m.loader,m.hasStats&&(g.stats=m.stats),m.initSegment&&(g.initSegment=m.initSegment,n=m.initSegment)});const l=e.fragments,c=e.fragmentHint?l.concat(e.fragmentHint):l;if(n&&c.forEach(m=>{var g;m&&(!m.initSegment||m.initSegment.relurl===((g=n)==null?void 0:g.relurl))&&(m.initSegment=n)}),e.skippedSegments){if(e.deltaUpdateFailed=l.some(m=>!m),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let m=e.skippedSegments;m--;)l.shift();e.startSN=l[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=JB(s.dateRanges,e,t));const m=s.fragments.filter(g=>g.rawProgramDateTime);if(s.hasProgramDateTime&&!e.hasProgramDateTime)for(let g=1;g<c.length;g++)c[g].programDateTime===null&&yg(c[g],c[g-1],m);GR(m,e)}e.endCC=l[l.length-1].cc}if(!e.startCC){var f;const m=KR(s,e.startSN-1);e.startCC=(f=m?.cc)!=null?f:l[0].cc}e3(s.partList,e.partList,(m,g)=>{g.elementaryStreams=m.elementaryStreams,g.stats=m.stats}),o?HR(e,o,o.startPTS,o.endPTS,o.startDTS,o.endDTS,t):zR(s,e),l.length&&(e.totalduration=e.edge-l[0].start),e.driftStartTime=s.driftStartTime,e.driftStart=s.driftStart;const d=e.advancedDateTime;if(e.advanced&&d){const m=e.edge;e.driftStart||(e.driftStartTime=d,e.driftStart=m),e.driftEndTime=d,e.driftEnd=m}else e.driftEndTime=s.driftEndTime,e.driftEnd=s.driftEnd,e.advancedDateTime=s.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=s.requestScheduled)}function JB(s,e,t){const{dateRanges:n,recentlyRemovedDateranges:r}=e,o=at({},s);r&&r.forEach(f=>{delete o[f]});const c=Object.keys(o).length;return c?(Object.keys(n).forEach(f=>{const d=o[f],m=new FR(n[f].attr,d);m.isValid?(o[f]=m,d||(m.tagOrder+=c)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${ut(n[f].attr)}"`)}),o):n}function e3(s,e,t){if(s&&e){let n=0;for(let r=0,o=s.length;r<=o;r++){const l=s[r],c=e[r+n];l&&c&&l.index===c.index&&l.fragment.sn===c.fragment.sn?t(l,c):n--}}}function t3(s,e,t){const n=e.skippedSegments,r=Math.max(s.startSN,e.startSN)-e.startSN,o=(s.fragmentHint?1:0)+(n?e.endSN:Math.min(s.endSN,e.endSN))-e.startSN,l=e.startSN-s.startSN,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,f=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;for(let d=r;d<=o;d++){const m=f[l+d];let g=c[d];if(n&&!g&&m&&(g=e.fragments[d]=m),m&&g){t(m,g,d,c);const p=m.relurl,E=g.relurl;if(p&&n3(p,E)){e.playlistParsingError=qS(`media sequence mismatch ${g.sn}:`,s,e,m,g);return}else if(m.cc!==g.cc){e.playlistParsingError=qS(`discontinuity sequence mismatch (${m.cc}!=${g.cc})`,s,e,m,g);return}}}}function qS(s,e,t,n,r){return new Error(`${s} ${r.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function zR(s,e,t=!0){const n=e.startSN+e.skippedSegments-s.startSN,r=s.fragments,o=n>=0;let l=0;if(o&&n<r.length)l=r[n].start;else if(o&&e.startSN===s.endSN+1)l=s.fragmentEnd;else if(o&&t)l=s.fragmentStart+n*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)l=s.fragmentStart;else return;vg(e,l)}function vg(s,e){if(e){const t=s.fragments;for(let n=s.skippedSegments;n<t.length;n++)t[n].addStart(e);s.fragmentHint&&s.fragmentHint.addStart(e)}}function VR(s,e=1/0){let t=1e3*s.targetduration;if(s.updated){const n=s.fragments;if(n.length&&t*4>e){const o=n[n.length-1].duration*1e3;o<t&&(t=o)}}else t/=2;return Math.round(t)}function KR(s,e,t){if(!s)return null;let n=s.fragments[e-s.startSN];return n||(n=s.fragmentHint,n&&n.sn===e)?n:e<s.startSN&&t&&t.sn===e?t:null}function YS(s,e,t){return s?qR(s.partList,e,t):null}function qR(s,e,t){if(s)for(let n=s.length;n--;){const r=s[n];if(r.index===t&&r.fragment.sn===e)return r}return null}function YR(s){s.forEach((e,t)=>{var n;(n=e.details)==null||n.fragments.forEach(r=>{r.level=t,r.initSegment&&(r.initSegment.level=t)})})}function n3(s,e){return s!==e&&e?WS(s)!==WS(e):!1}function WS(s){return s.replace(/\?[^?]*$/,"")}function Ko(s,e){for(let n=0,r=s.length;n<r;n++){var t;if(((t=s[n])==null?void 0:t.cc)===e)return s[n]}return null}function s3(s,e){return!!(s&&e.startCC<s.endCC&&e.endCC>s.startCC)}function XS(s,e){const t=s.start+e;s.startPTS=t,s.setStart(t),s.endPTS=t+s.duration}function WR(s,e){const t=e.fragments;for(let n=0,r=t.length;n<r;n++)XS(t[n],s);e.fragmentHint&&XS(e.fragmentHint,s),e.alignedSliding=!0}function i3(s,e){s&&(XR(e,s),e.alignedSliding||Yu(e,s),!e.alignedSliding&&!e.skippedSegments&&zR(s,e,!1))}function XR(s,e){if(!s3(e,s))return;const t=Math.min(e.endCC,s.endCC),n=Ko(e.fragments,t),r=Ko(s.fragments,t);if(!n||!r)return;nt.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const o=n.start-r.start;WR(o,s)}function Yu(s,e){if(!s.hasProgramDateTime||!e.hasProgramDateTime)return;const t=s.fragments,n=e.fragments;if(!t.length||!n.length)return;let r,o;const l=Math.min(e.endCC,s.endCC);e.startCC<l&&s.startCC<l&&(r=Ko(n,l),o=Ko(t,l)),(!r||!o)&&(r=n[Math.floor(n.length/2)],o=Ko(t,r.cc)||t[Math.floor(t.length/2)]);const c=r.programDateTime,f=o.programDateTime;if(!c||!f)return;const d=(f-c)/1e3-(o.start-r.start);WR(d,s)}function an(s,e,t){gn(s,e,t),s.addEventListener(e,t)}function gn(s,e,t){s.removeEventListener(e,t)}const r3={toString:function(s){let e="";const t=s.length;for(let n=0;n<t;n++)e+=`[${s.start(n).toFixed(3)}-${s.end(n).toFixed(3)}]`;return e}},ce={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Lp extends MR{constructor(e,t,n,r,o){super(r,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ce.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:l,fragCurrent:c,media:f,mediaBuffer:d,state:m}=this,g=f?f.currentTime:0,p=Ie.bufferInfo(d||f,g,l.maxBufferHole),E=!p.len;if(this.log(`Media seeking to ${ve(g)?g.toFixed(3):g}, state: ${m}, ${E?"out of":"in"} buffer`),this.state===ce.ENDED)this.resetLoadingState();else if(c){const v=l.maxFragLookUpTolerance,S=c.start-v,b=c.start+c.duration+v;if(E||b<p.start||S>p.end){const R=g>b;(g<S||R)&&(R&&c.loader&&(this.log(`Cancelling fragment load for seek (sn: ${c.sn})`),c.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(f){this.fragmentTracker.removeFragmentsInRange(g,1/0,this.playlistType,!0);const v=this.lastCurrentTime;if(g>v&&(this.lastCurrentTime=g),!this.loadingParts){const S=Math.max(p.end,g),b=this.shouldLoadParts(this.getLevelDetails(),S);b&&(this.log(`LL-Part loading ON after seeking to ${g.toFixed(2)} with buffer @${S.toFixed(2)}`),this.loadingParts=b)}}this.hls.hasEnoughToStart||(this.log(`Setting ${E?"startPosition":"nextLoadPosition"} to ${g} for seek without enough to start`),this.nextLoadPosition=g,E&&(this.startPosition=g)),E&&this.state===ce.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=o,this.hls=e,this.fragmentLoader=new NB(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Tp(e.config)}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===ce.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ce.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,r=this.config.timelineOffset||0;if(n<=r)return!1;const o=e.buffered;this.config.maxBufferHole&&o&&o.length>1&&(e=Ie.bufferedInfo(o,e.start,0));const l=e.nextStart;if(l&&l>r&&l<t.edge||this.media.currentTime<e.start)return!1;const f=t.partList;if(f!=null&&f.length){const m=f[f.length-1];return Ie.isBuffered(this.media,m.start+m.duration/2)}const d=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(d)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;an(n,"seeking",this.onMediaSeeking),an(n,"ended",this.onMediaEnded);const r=this.config;this.levels&&r.autoStartLoad&&this.state===ce.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,r=this.media;if(r!==null){if(r.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),gn(r,"seeking",this.onMediaSeeking),gn(r,"ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=ce.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const r=o=>{const l=o.frag;if(this.fragContextChanged(l)){this.warn(`${l.type} sn: ${l.sn}${o.part?" part: "+o.part.index:""} of ${this.fragInfo(l,!1,o.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(l);return}l.stats.chunkCount++,this._handleFragmentLoadProgress(o)};this._doFragLoad(e,t,n,r).then(o=>{if(!o)return;const l=this.state,c=o.frag;if(this.fragContextChanged(c)){(l===ce.FRAG_LOADING||!this.fragCurrent&&l===ce.PARSING)&&(this.fragmentTracker.removeFragment(c),this.state=ce.IDLE);return}"payload"in o&&(this.log(`Loaded ${c.type} sn: ${c.sn} of ${this.playlistLabel()} ${c.level}`),this.hls.trigger(L.FRAG_LOADED,o)),this._handleFragmentLoadComplete(o)}).catch(o=>{this.state===ce.STOPPED||this.state===ce.ERROR||(this.warn(`Frag error: ${o?.message||o}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Ut.APPENDING){const o=e.type,l=this.getFwdBufferInfo(this.mediaBuffer,o),c=Math.max(e.duration,l?l.len:this.config.maxBufferLength),f=this.backtrackFragment;((f?e.sn-f.sn:0)===1||this.reduceMaxBufferLength(c,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Ut.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:n};this.hls.trigger(L.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{const r=n?.frag;if(!r||this.fragContextChanged(r)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:r}=this,{frag:o,payload:l}=n,c=o.decryptdata;if(l&&l.byteLength>0&&c!=null&&c.key&&c.iv&&Da(c.method)){const f=self.performance.now();return this.decrypter.decrypt(new Uint8Array(l),c.key.buffer,c.iv.buffer,Rp(c.method)).catch(d=>{throw r.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:o}),d}).then(d=>{const m=self.performance.now();return r.trigger(L.FRAG_DECRYPTED,{frag:o,payload:d,stats:{tstart:f,tdecrypt:m}}),n.payload=d,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===ce.STOPPED||this.state===ce.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==ce.STOPPED&&(this.state=ce.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var n,r;const o=e.tracks;if(o&&!t.encrypted&&((n=o.audio)!=null&&n.encrypted||(r=o.video)!=null&&r.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const l=this.media,c=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${l?"attached mediaKeys: "+l.mediaKeys:"detached"})`);return this.warn(c.message),!l||l.mediaKeys?!1:(this.hls.trigger(L.ERROR,{type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_KEYS,fatal:!1,error:c,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?r3.toString(Ie.getBuffered(n)):"(detached)"})`),Lt(e)){var r;if(e.type!==xe.SUBTITLE){const l=e.elementaryStreams;if(!Object.keys(l).some(c=>!!l[c])){this.state=ce.IDLE;return}}const o=(r=this.levels)==null?void 0:r[e.level];o!=null&&o.fragmentError&&(this.log(`Resetting level fragment error count of ${o.fragmentError} on frag buffered`),o.fragmentError=0)}this.state=ce.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:o}=e,l=!o||o.length===0||o.some(f=>!f),c=new Ap(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!l);t.flush(c)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var o;this.fragCurrent=e;const l=t.details;if(!this.levels||!l)throw new Error(`frag load aborted, missing level${l?"":" detail"}s`);let c=null;if(e.encrypted&&!((o=e.decryptdata)!=null&&o.key)){if(this.log(`Loading key for ${e.sn} of [${l.startSN}-${l.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=ce.KEY_LOADING,this.fragCurrent=e,c=this.keyLoader.load(e).then(p=>{if(!this.fragContextChanged(p.frag))return this.hls.trigger(L.KEY_LOADED,p),this.state===ce.KEY_LOADING&&(this.state=ce.IDLE),p}),this.hls.trigger(L.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(c=this.keyLoader.loadClear(e,l.encryptedFragments,this.startFragRequested),c&&this.log("[eme] blocking frag load until media-keys acquired"));const f=this.fragPrevious;if(Lt(e)&&(!f||e.sn!==f.sn)){const p=this.shouldLoadParts(t.details,e.end);p!==this.loadingParts&&(this.log(`LL-Part loading ${p?"ON":"OFF"} loading sn ${f?.sn}->${e.sn}`),this.loadingParts=p)}if(n=Math.max(e.start,n||0),this.loadingParts&&Lt(e)){const p=l.partList;if(p&&r){n>l.fragmentEnd&&l.fragmentHint&&(e=l.fragmentHint);const E=this.getNextPart(p,e,n);if(E>-1){const v=p[E];e=this.fragCurrent=v.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${v.index} (${E}/${p.length-1}) of ${this.fragInfo(e,!1,v)}) cc: ${e.cc} [${l.startSN}-${l.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=v.start+v.duration,this.state=ce.FRAG_LOADING;let S;return c?S=c.then(b=>!b||this.fragContextChanged(b.frag)?null:this.doFragPartsLoad(e,v,t,r)).catch(b=>this.handleFragLoadError(b)):S=this.doFragPartsLoad(e,v,t,r).catch(b=>this.handleFragLoadError(b)),this.hls.trigger(L.FRAG_LOADING,{frag:e,part:v,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):S}else if(!e.url||this.loadedEndOfParts(p,n))return Promise.resolve(null)}}if(Lt(e)&&this.loadingParts){var d;this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(d=l.partList)==null?void 0:d.filter(p=>p.loaded).map(p=>`[${p.start}-${p.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+l.startSN+"-"+l.endSN+"]"}, target: ${parseFloat(n.toFixed(3))}`),ve(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ce.FRAG_LOADING;const m=this.config.progressive&&e.type!==xe.SUBTITLE;let g;return m&&c?g=c.then(p=>!p||this.fragContextChanged(p.frag)?null:this.fragmentLoader.load(e,r)).catch(p=>this.handleFragLoadError(p)):g=Promise.all([this.fragmentLoader.load(e,m?r:void 0),c]).then(([p])=>(!m&&r&&r(p),p)).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(L.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):g}doFragPartsLoad(e,t,n,r){return new Promise((o,l)=>{var c;const f=[],d=(c=n.details)==null?void 0:c.partList,m=g=>{this.fragmentLoader.loadPart(e,g,r).then(p=>{f[g.index]=p;const E=p.part;this.hls.trigger(L.FRAG_LOADED,p);const v=YS(n.details,e.sn,g.index+1)||qR(d,e.sn,g.index+1);if(v)m(v);else return o({frag:e,part:E,partsLoaded:f})}).catch(l)};m(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===W.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Ae.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(L.ERROR,t)}else this.hls.trigger(L.ERROR,{type:Ae.OTHER_ERROR,details:W.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==ce.PARSING){!this.fragCurrent&&this.state!==ce.STOPPED&&this.state!==ce.ERROR&&(this.state=ce.IDLE);return}const{frag:n,part:r,level:o}=t,l=self.performance.now();n.stats.parsing.end=l,r&&(r.stats.parsing.end=l);const c=this.getLevelDetails(),d=c&&n.sn>c.endSN||this.shouldLoadParts(c,n.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=d),this.updateLevelTiming(n,r,o,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var n;const o=e.partList[0];if(o.fragment.type===xe.SUBTITLE)return!1;const l=o.end+(((n=e.fragmentHint)==null?void 0:n.duration)||0);if(t>=l){var r;if((this.hls.hasEnoughToStart?((r=this.media)==null?void 0:r.currentTime)||this.lastCurrentTime:this.getLoadPosition())>o.start-o.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:o,part:l}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${o} of ${this.playlistLabel()} ${r}. The current chunk will not be buffered.`),null;const c=t[r],f=c.details,d=l>-1?YS(f,o,l):null,m=d?d.fragment:KR(f,o,n);return m?(n&&n!==m&&(m.stats=n.stats),{frag:m,part:d,level:c}):null}bufferFragmentData(e,t,n,r,o){if(this.state!==ce.PARSING)return;const{data1:l,data2:c}=e;let f=l;if(c&&(f=qn(l,c)),!f.length)return;const d=this.initPTS[t.cc],m=d?-d.baseTime/d.timescale:void 0,g={type:e.type,frag:t,part:n,chunkMeta:r,offset:m,parent:t.type,data:f};if(this.hls.trigger(L.BUFFER_APPENDING,g),e.dropped&&e.independent&&!n){if(o)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Ie.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,r=Ie.bufferInfo(t,n,0),o=e.duration,l=Math.min(this.config.maxFragLookUpTolerance*2,o*.25),c=Math.max(Math.min(e.start-l,r.end-l),n+l);e.start-c>l&&this.flushMainBuffer(c,e.start)}getFwdBufferInfo(e,t){var n;const r=this.getLoadPosition();if(!ve(r))return null;const l=this.lastCurrentTime>r||(n=this.media)!=null&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,r,t,l)}getFwdBufferInfoAtPos(e,t,n,r){const o=Ie.bufferInfo(e,t,r);if(o.len===0&&o.nextStart!==void 0){const l=this.fragmentTracker.getBufferedFrag(t,n);if(l&&(o.nextStart<=l.end||l.gap)){const c=Math.max(Math.min(o.nextStart,l.end)-t,r);return Ie.bufferInfo(e,t,c)}}return o}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,r=Math.max(Math.min(e-t,n.maxBufferLength),t),o=Math.max(e-t*3,n.maxMaxBufferLength/2,r);return o>=r?(n.maxMaxBufferLength=o,this.warn(`Reduce max buffer length to ${o}s`),!0):!1}getAppendedFrag(e,t=xe.MAIN){const n=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:o}=this,l=n[0].start,c=o.lowLatencyMode&&!!t.partList;let f=null;if(t.live){const g=o.initialLiveManifestSize;if(r<g)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${g})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<l){var d;c&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),f=this.getInitialLiveFragment(t);const p=this.hls.startPosition,E=this.hls.liveSyncPosition,v=f?(p!==-1&&p>=l?p:E)||f.start:e;this.log(`Setting startPosition to ${v} to match start frag at live edge. mainStart: ${p} liveSyncPosition: ${E} frag.start: ${(d=f)==null?void 0:d.start}`),this.startPosition=this.nextLoadPosition=v}}else e<=l&&(f=n[0]);if(!f){const g=this.loadingParts?t.partEnd:t.fragmentEnd;f=this.getFragmentAtPosition(e,g,t)}let m=this.filterReplacedPrimary(f,t);if(!m&&f){const g=f.sn-t.startSN;m=this.filterReplacedPrimary(n[g+1]||null,t)}return this.mapToInitFragWhenRequired(m)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Ut.OK||n===Ut.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,o){let l=null;if(e.gap&&(l=this.getNextFragment(this.nextLoadPosition,t),l&&!l.gap&&n.nextStart)){const c=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r,0);if(c!==null&&n.len+c.len>=o){const f=l.sn;return this.loopSn!==f&&(this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${f}`),this.loopSn=f),null}}return this.loopSn=void 0,l}get primaryPrefetch(){if(QS(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(QS(this.config)&&e.type!==xe.SUBTITLE){const n=this.hls.interstitialsManager,r=n?.bufferingItem;if(r){const l=r.event;if(l){if(l.appendInPlace||Math.abs(e.start-r.start)>1||r.start===0)return null}else if(e.end<=r.start&&t?.live===!1||e.start>r.end&&r.nextEvent&&(r.nextEvent.appendInPlace||e.start-r.end>1))return null}const o=n?.playerQueue;if(o)for(let l=o.length;l--;){const c=o[l].interstitial;if(c.appendInPlace&&e.start>=c.startTime&&e.end<=c.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let r=-1,o=!1,l=!0;for(let c=0,f=e.length;c<f;c++){const d=e[c];if(l=l&&!d.independent,r>-1&&n<d.start)break;const m=d.loaded;m?r=-1:(o||(d.independent||l)&&d.fragment===t)&&(d.fragment!==t&&this.warn(`Need buffer at ${n} but next unloaded part starts at ${d.start}`),r=c),o=m}return r}loadedEndOfParts(e,t){let n;for(let r=e.length;r--;){if(n=e[r],!n.loaded)return!1;if(t>n.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=SB(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const o=n.sn+1;if(o>=e.startSN&&o<=e.endSN){const l=t[o-e.startSN];n.cc===l.cc&&(r=l,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=OR(e,n.cc,n.end),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const o=this.hls.liveSyncPosition;o!==null&&(r=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:o}=this,{fragments:l,endSN:c}=n;const{fragmentHint:f}=n,{maxFragLookUpTolerance:d}=r,m=n.partList,g=!!(this.loadingParts&&m!=null&&m.length&&f);g&&!this.bitrateTest&&m[m.length-1].fragment.sn===f.sn&&(l=l.concat(f),c=f.sn);let p;if(e<t){var E;const S=e<this.lastCurrentTime||e>t-d||(E=this.media)!=null&&E.paused||!this.startFragRequested?0:d;p=Ar(o,l,e,S)}else p=l[l.length-1];if(p){const v=p.sn-n.startSN,S=this.fragmentTracker.getState(p);if((S===Ut.OK||S===Ut.PARTIAL&&p.gap)&&(o=p),o&&p.sn===o.sn&&(!g||m[0].fragment.sn>p.sn||!n.live)&&p.level===o.level){const R=l[v+1];p.sn<c&&this.fragmentTracker.getState(R)!==Ut.OK?p=R:p=null}}return p}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const o=e.fragmentStart,l=!t,c=e.alignedSliding&&ve(o);if(l||!c&&!o){i3(n,e);const f=e.fragmentStart;return this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${r}`),f}return o}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const r=this.timelineOffset;if(n===-1){const o=this.startTimeOffset!==null,l=o?this.startTimeOffset:e.startTimeOffset;l!==null&&ve(l)?(n=t+l,l<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${l} found in ${o?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+r}this.nextLoadPosition=n+r}getLoadPosition(){var e;const{media:t}=this;let n=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&Lt(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ce.FRAG_LOADING_WAITING_RETRY)&&(this.state=ce.IDLE)}onFragmentOrKeyLoadError(e,t){var n;if(t.chunkMeta&&!t.frag){const R=this.getCurrentContext(t.chunkMeta);R&&(t.frag=R.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var o;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(o=this.fragCurrent)==null?void 0:o.url}`);return}const l=t.details===W.FRAG_GAP;l&&this.fragmentTracker.fragBuffered(r,!0);const c=t.errorAction;if(!c){this.state=ce.ERROR;return}const{action:f,flags:d,retryCount:m=0,retryConfig:g}=c,p=!!g,E=p&&f===Xt.RetryRequest,v=p&&!c.resolved&&d===Ln.MoveAllAlternatesMatchingHost,S=(n=this.hls.latestLevelDetails)==null?void 0:n.live;if(!E&&v&&Lt(r)&&!r.endList&&S&&!kR(t))this.resetFragmentErrors(e),this.treatAsGap(r),c.resolved=!0;else if((E||v)&&m<g.maxNumRetry){var b;const R=mg((b=t.response)==null?void 0:b.code),C=bp(g,m);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+C,this.state=ce.FRAG_LOADING_WAITING_RETRY,c.resolved=!0,R){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${m+1}/${g.maxNumRetry} in ${C}ms`)}else if(g)if(this.resetFragmentErrors(e),m<g.maxNumRetry)!l&&f!==Xt.RemoveAlternatePermanently&&(c.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${m})`);return}else f===Xt.SendAlternateToPenaltyBox?this.state=ce.WAITING_LEVEL:this.state=ce.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,n=t===1/0;(!t||e>=t||n&&!mg(0))&&(n&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=ce.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===ce.PARSING||this.state===ce.PARSED){const t=e.frag,n=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,n),o=r&&r.len>.5;o&&this.reduceMaxBufferLength(r.len,t?.duration||10);const l=!o;return l&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),l}return!1}resetFragmentErrors(e){e===xe.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==ce.STOPPED&&(this.state=ce.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const r=Ie.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===ce.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==ce.STOPPED&&(this.state=ce.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){const o=n.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((f,d)=>{const m=e.elementaryStreams[d];if(m){const g=m.endPTS-m.startPTS;if(g<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${g})`),f||!1;const p=r?0:HR(o,e,m.startPTS,m.endPTS,m.startDTS,m.endDTS,this);return this.hls.trigger(L.LEVEL_PTS_UPDATED,{details:o,level:n,drift:p,type:d,frag:e,start:m.startPTS,end:m.endPTS}),!0}return f},!1)){var c;const f=((c=this.transmuxer)==null?void 0:c.error)===null;if((n.fragmentError===0||f&&(n.fragmentError<2||e.endList))&&this.treatAsGap(e,n),f){const d=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=ce.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(L.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===xe.MAIN?"level":"track"}fragInfo(e,t=!0,n){var r,o;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${((r=t&&!n?e.startPTS:(n||e).start)!=null?r:NaN).toFixed(3)}-${((o=t&&!n?e.endPTS:(n||e).end)!=null?o:NaN).toFixed(3)}]${n&&e.type==="main"?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function QS(s){return!!s.interstitialsController&&s.enableInterstitialPlayback!==!1}class QR{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=a3(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function a3(s,e){const t=new Uint8Array(e);let n=0;for(let r=0;r<s.length;r++){const o=s[r];t.set(o,n),n+=o.length}return t}var Sm={exports:{}},ZS;function o3(){return ZS||(ZS=1,(function(s){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(f,d,m){this.fn=f,this.context=d,this.once=m||!1}function o(f,d,m,g,p){if(typeof m!="function")throw new TypeError("The listener must be a function");var E=new r(m,g||f,p),v=t?t+d:d;return f._events[v]?f._events[v].fn?f._events[v]=[f._events[v],E]:f._events[v].push(E):(f._events[v]=E,f._eventsCount++),f}function l(f,d){--f._eventsCount===0?f._events=new n:delete f._events[d]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],m,g;if(this._eventsCount===0)return d;for(g in m=this._events)e.call(m,g)&&d.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(m)):d},c.prototype.listeners=function(d){var m=t?t+d:d,g=this._events[m];if(!g)return[];if(g.fn)return[g.fn];for(var p=0,E=g.length,v=new Array(E);p<E;p++)v[p]=g[p].fn;return v},c.prototype.listenerCount=function(d){var m=t?t+d:d,g=this._events[m];return g?g.fn?1:g.length:0},c.prototype.emit=function(d,m,g,p,E,v){var S=t?t+d:d;if(!this._events[S])return!1;var b=this._events[S],R=arguments.length,C,_;if(b.fn){switch(b.once&&this.removeListener(d,b.fn,void 0,!0),R){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,m),!0;case 3:return b.fn.call(b.context,m,g),!0;case 4:return b.fn.call(b.context,m,g,p),!0;case 5:return b.fn.call(b.context,m,g,p,E),!0;case 6:return b.fn.call(b.context,m,g,p,E,v),!0}for(_=1,C=new Array(R-1);_<R;_++)C[_-1]=arguments[_];b.fn.apply(b.context,C)}else{var D=b.length,N;for(_=0;_<D;_++)switch(b[_].once&&this.removeListener(d,b[_].fn,void 0,!0),R){case 1:b[_].fn.call(b[_].context);break;case 2:b[_].fn.call(b[_].context,m);break;case 3:b[_].fn.call(b[_].context,m,g);break;case 4:b[_].fn.call(b[_].context,m,g,p);break;default:if(!C)for(N=1,C=new Array(R-1);N<R;N++)C[N-1]=arguments[N];b[_].fn.apply(b[_].context,C)}}return!0},c.prototype.on=function(d,m,g){return o(this,d,m,g,!1)},c.prototype.once=function(d,m,g){return o(this,d,m,g,!0)},c.prototype.removeListener=function(d,m,g,p){var E=t?t+d:d;if(!this._events[E])return this;if(!m)return l(this,E),this;var v=this._events[E];if(v.fn)v.fn===m&&(!p||v.once)&&(!g||v.context===g)&&l(this,E);else{for(var S=0,b=[],R=v.length;S<R;S++)(v[S].fn!==m||p&&!v[S].once||g&&v[S].context!==g)&&b.push(v[S]);b.length?this._events[E]=b.length===1?b[0]:b:l(this,E)}return this},c.prototype.removeAllListeners=function(d){var m;return d?(m=t?t+d:d,this._events[m]&&l(this,m)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,s.exports=c})(Sm)),Sm.exports}var l3=o3(),Cp=NU(l3);const sl="1.6.15",Ua={};function c3(){return typeof __HLS_WORKER_BUNDLE__=="function"}function u3(){const s=Ua[sl];if(s)return s.clientCount++,s;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),r={worker:new self.Worker(t),objectURL:t,clientCount:1};return Ua[sl]=r,r}function d3(s){const e=Ua[s];if(e)return e.clientCount++,e;const t=new self.URL(s,self.location.href).href,r={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Ua[s]=r,r}function f3(s){const e=Ua[s||sl];if(e&&e.clientCount--===1){const{worker:n,objectURL:r}=e;delete Ua[s||sl],r&&self.URL.revokeObjectURL(r),n.terminate()}}function ZR(s,e){return e+10<=s.length&&s[e]===51&&s[e+1]===68&&s[e+2]===73&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function _p(s,e){return e+10<=s.length&&s[e]===73&&s[e+1]===68&&s[e+2]===51&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function bd(s,e){let t=0;return t=(s[e]&127)<<21,t|=(s[e+1]&127)<<14,t|=(s[e+2]&127)<<7,t|=s[e+3]&127,t}function il(s,e){const t=e;let n=0;for(;_p(s,e);){n+=10;const r=bd(s,e+6);n+=r,ZR(s,e+10)&&(n+=10),e+=n}if(n>0)return s.subarray(t,t+n)}function h3(s,e,t,n){const r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],o=e[t+2],l=o>>2&15;if(l>12){const E=new Error(`invalid ADTS sampling index:${l}`);s.emit(L.ERROR,L.ERROR,{type:Ae.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!0,error:E,reason:E.message});return}const c=(o>>6&3)+1,f=e[t+3]>>6&3|(o&1)<<2,d="mp4a.40."+c,m=r[l];let g=l;(c===5||c===29)&&(g-=3);const p=[c<<3|(g&14)>>1,(g&1)<<7|f<<3];return nt.log(`manifest codec:${n}, parsed codec:${d}, channels:${f}, rate:${m} (ADTS object type:${c} sampling index:${l})`),{config:p,samplerate:m,channelCount:f,codec:d,parsedCodec:d,manifestCodec:n}}function JR(s,e){return s[e]===255&&(s[e+1]&246)===240}function ew(s,e){return s[e+1]&1?7:9}function Dp(s,e){return(s[e+3]&3)<<11|s[e+4]<<3|(s[e+5]&224)>>>5}function m3(s,e){return e+5<s.length}function Wu(s,e){return e+1<s.length&&JR(s,e)}function g3(s,e){return m3(s,e)&&JR(s,e)&&Dp(s,e)<=s.length-e}function p3(s,e){if(Wu(s,e)){const t=ew(s,e);if(e+t>=s.length)return!1;const n=Dp(s,e);if(n<=t)return!1;const r=e+n;return r===s.length||Wu(s,r)}return!1}function tw(s,e,t,n,r){if(!s.samplerate){const o=h3(e,t,n,r);if(!o)return;at(s,o)}}function nw(s){return 1024*9e4/s}function y3(s,e){const t=ew(s,e);if(e+t<=s.length){const n=Dp(s,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function sw(s,e,t,n,r){const o=nw(s.samplerate),l=n+r*o,c=y3(e,t);let f;if(c){const{frameLength:g,headerLength:p}=c,E=p+g,v=Math.max(0,t+E-e.length);v?(f=new Uint8Array(E-p),f.set(e.subarray(t+p,e.length),0)):f=e.subarray(t+p,t+E);const S={unit:f,pts:l};return v||s.samples.push(S),{sample:S,length:E,missing:v}}const d=e.length-t;return f=new Uint8Array(d),f.set(e.subarray(t,e.length),0),{sample:{unit:f,pts:l},length:d,missing:-1}}function v3(s,e){return _p(s,e)&&bd(s,e+6)+10<=s.length-e}function x3(s){return s instanceof ArrayBuffer?s:s.byteOffset==0&&s.byteLength==s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer}function bm(s,e=0,t=1/0){return E3(s,e,t,Uint8Array)}function E3(s,e,t,n){const r=S3(s);let o=1;"BYTES_PER_ELEMENT"in n&&(o=n.BYTES_PER_ELEMENT);const l=b3(s)?s.byteOffset:0,c=(l+s.byteLength)/o,f=(l+e)/o,d=Math.floor(Math.max(0,Math.min(f,c))),m=Math.floor(Math.min(d+Math.max(t,0),c));return new n(r,d,m-d)}function S3(s){return s instanceof ArrayBuffer?s:s.buffer}function b3(s){return s&&s.buffer instanceof ArrayBuffer&&s.byteLength!==void 0&&s.byteOffset!==void 0}function T3(s){const e={key:s.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(s.size<2)return;if(s.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const n=s.data.subarray(1).indexOf(0);if(n===-1)return;const r=Nn(bm(s.data,1,n)),o=s.data[2+n],l=s.data.subarray(3+n).indexOf(0);if(l===-1)return;const c=Nn(bm(s.data,3+n,l));let f;return r==="-->"?f=Nn(bm(s.data,4+n+l)):f=x3(s.data.subarray(4+n+l)),e.mimeType=r,e.pictureType=o,e.description=c,e.data=f,e}function A3(s){if(s.size<2)return;const e=Nn(s.data,!0),t=new Uint8Array(s.data.subarray(e.length+1));return{key:s.type,info:e,data:t.buffer}}function R3(s){if(s.size<2)return;if(s.type==="TXXX"){let t=1;const n=Nn(s.data.subarray(t),!0);t+=n.length+1;const r=Nn(s.data.subarray(t));return{key:s.type,info:n,data:r}}const e=Nn(s.data.subarray(1));return{key:s.type,info:"",data:e}}function w3(s){if(s.type==="WXXX"){if(s.size<2)return;let t=1;const n=Nn(s.data.subarray(t),!0);t+=n.length+1;const r=Nn(s.data.subarray(t));return{key:s.type,info:n,data:r}}const e=Nn(s.data);return{key:s.type,info:"",data:e}}function L3(s){return s.type==="PRIV"?A3(s):s.type[0]==="W"?w3(s):s.type==="APIC"?T3(s):R3(s)}function C3(s){const e=String.fromCharCode(s[0],s[1],s[2],s[3]),t=bd(s,4),n=10;return{type:e,size:t,data:s.subarray(n,n+t)}}const Qc=10,_3=10;function iw(s){let e=0;const t=[];for(;_p(s,e);){const n=bd(s,e+6);s[e+5]>>6&1&&(e+=Qc),e+=Qc;const r=e+n;for(;e+_3<r;){const o=C3(s.subarray(e)),l=L3(o);l&&t.push(l),e+=o.size+Qc}ZR(s,e)&&(e+=Qc)}return t}function rw(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"}function D3(s){if(s.data.byteLength===8){const e=new Uint8Array(s.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}}function Ip(s){const e=iw(s);for(let t=0;t<e.length;t++){const n=e[t];if(rw(n))return D3(n)}}let Dn=(function(s){return s.audioId3="org.id3",s.dateRange="com.apple.quicktime.HLS",s.emsg="https://aomedia.org/emsg/ID3",s.misbklv="urn:misb:KLV:bin:1910.1",s})({});function vs(s="",e=9e4){return{type:s,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Op{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=qn(this.cachedData,e),this.cachedData=null);let n=il(e,0),r=n?n.length:0,o;const l=this._audioTrack,c=this._id3Track,f=n?Ip(n):void 0,d=e.length;for((this.basePTS===null||this.frameIndex===0&&ve(f))&&(this.basePTS=I3(f,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Dn.audioId3,duration:Number.POSITIVE_INFINITY});r<d;){if(this.canParse(e,r)){const m=this.appendFrame(l,e,r);m?(this.frameIndex++,this.lastPTS=m.sample.pts,r+=m.length,o=r):r=d}else v3(e,r)?(n=il(e,r),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Dn.audioId3,duration:Number.POSITIVE_INFINITY}),r+=n.length,o=r):r++;if(r===d&&o!==d){const m=e.slice(o);this.cachedData?this.cachedData=qn(this.cachedData,m):this.cachedData=m}}return{audioTrack:l,videoTrack:vs(),id3Track:c,textTrack:vs()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:vs(),id3Track:this._id3Track,textTrack:vs()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const I3=(s,e,t)=>{if(ve(s))return s*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};let Zc=null;const O3=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],N3=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],k3=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],M3=[0,1,1,4];function aw(s,e,t,n,r){if(t+24>e.length)return;const o=ow(e,t);if(o&&t+o.frameLength<=e.length){const l=o.samplesPerFrame*9e4/o.sampleRate,c=n+r*l,f={unit:e.subarray(t,t+o.frameLength),pts:c,dts:c};return s.config=[],s.channelCount=o.channelCount,s.samplerate=o.sampleRate,s.samples.push(f),{sample:f,length:o.frameLength,missing:0}}}function ow(s,e){const t=s[e+1]>>3&3,n=s[e+1]>>1&3,r=s[e+2]>>4&15,o=s[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&o!==3){const l=s[e+2]>>1&1,c=s[e+3]>>6,f=t===3?3-n:n===3?3:4,d=O3[f*14+r-1]*1e3,g=N3[(t===3?0:t===2?1:2)*3+o],p=c===3?1:2,E=k3[t][n],v=M3[n],S=E*8*v,b=Math.floor(E*d/g+l)*v;if(Zc===null){const _=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Zc=_?parseInt(_[1]):0}return!!Zc&&Zc<=87&&n===2&&d>=224e3&&c===0&&(s[e+3]=s[e+3]|128),{sampleRate:g,channelCount:p,frameLength:b,samplesPerFrame:S}}}function Np(s,e){return s[e]===255&&(s[e+1]&224)===224&&(s[e+1]&6)!==0}function lw(s,e){return e+1<s.length&&Np(s,e)}function P3(s,e){return Np(s,e)&&4<=s.length-e}function cw(s,e){if(e+1<s.length&&Np(s,e)){const n=ow(s,e);let r=4;n!=null&&n.frameLength&&(r=n.frameLength);const o=e+r;return o===s.length||lw(s,o)}return!1}class F3 extends Op{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=il(e,0);let r=n?.length||0;if(cw(e,r))return!1;for(let o=e.length;r<o;r++)if(p3(e,r))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return g3(e,t)}appendFrame(e,t,n){tw(e,this.observer,t,n,e.manifestCodec);const r=sw(e,t,n,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const uw=(s,e)=>{let t=0,n=5;e+=n;const r=new Uint32Array(1),o=new Uint32Array(1),l=new Uint8Array(1);for(;n>0;){l[0]=s[e];const c=Math.min(n,8),f=8-c;o[0]=4278190080>>>24+f<<f,r[0]=(l[0]&o[0])>>f,t=t?t<<c|r[0]:r[0],e+=1,n-=c}return t};class U3 extends Op{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const r=dw(e,t,n,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=il(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&Ip(t)!==void 0&&uw(e,n)<16}}function dw(s,e,t,n,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const o=e[t+4]>>6;if(o>=3)return-1;const c=[48e3,44100,32e3][o],f=e[t+4]&63,m=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][f*3+o]*2;if(t+m>e.length)return-1;const g=e[t+6]>>5;let p=0;g===2?p+=2:(g&1&&g!==1&&(p+=2),g&4&&(p+=2));const E=(e[t+6]<<8|e[t+7])>>12-p&1,S=[2,1,2,3,3,4,4,5][g]+E,b=e[t+5]>>3,R=e[t+5]&7,C=new Uint8Array([o<<6|b<<1|R>>2,(R&3)<<6|g<<3|E<<2|f>>4,f<<4&224]),_=1536/c*9e4,D=n+r*_,N=e.subarray(t,t+m);return s.config=C,s.channelCount=S,s.samplerate=c,s.samples.push({unit:N,pts:D}),m}class B3 extends Op{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=il(e,0);let n=t?.length||0;if(t&&e[n]===11&&e[n+1]===119&&Ip(t)!==void 0&&uw(e,n)<=16)return!1;for(let r=e.length;n<r;n++)if(cw(e,n))return nt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return P3(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return aw(e,t,n,this.basePTS,this.frameIndex)}}const $3=/\/emsg[-/]ID3/i;class j3{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const o=this.videoTrack=vs("video",1),l=this.audioTrack=vs("audio",1),c=this.txtTrack=vs("text",1);if(this.id3Track=vs("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const f=SR(e);if(f.video){const{id:d,timescale:m,codec:g,supplemental:p}=f.video;o.id=d,o.timescale=c.timescale=m,o.codec=g,o.supplemental=p}if(f.audio){const{id:d,timescale:m,codec:g}=f.audio;l.id=d,l.timescale=m,l.codec=g}c.id=vR.text,o.sampleDuration=0,o.duration=l.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return UU(e)}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,o=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=qn(this.remainderData,e));const c=VU(n);this.remainderData=c.remainder,r.samples=c.valid||new Uint8Array}else r.samples=n;const l=this.extractID3Track(r,t);return o.samples=pS(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:l,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=pS(e,t),{videoTrack:t,audioTrack:vs(),id3Track:r,textTrack:vs()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=$e(e.samples,["emsg"]);r&&r.forEach(o=>{const l=qU(o);if($3.test(l.schemeIdUri)){const c=JS(l,t);let f=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;f<=.001&&(f=Number.POSITIVE_INFINITY);const d=l.payload;n.samples.push({data:d,len:d.byteLength,dts:c,pts:c,type:Dn.emsg,duration:f})}else if(this.config.enableEmsgKLVMetadata&&l.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const c=JS(l,t);n.samples.push({data:l.payload,len:l.payload.byteLength,dts:c,pts:c,type:Dn.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function JS(s,e){return ve(s.presentationTime)?s.presentationTime/s.timeScale:e+s.presentationTimeDelta/s.timeScale}class G3{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Tp(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Vi.cbc)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const o=r.subarray(16,r.length-r.length%16),l=o.buffer.slice(o.byteOffset,o.byteOffset+o.length);this.decryptBuffer(l).then(c=>{const f=new Uint8Array(c);r.set(f,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}).catch(n)}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let r=0;for(let o=32;o<e.length-16;o+=160,r+=16)n.set(e.subarray(o,o+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let o=32;o<e.length-16;o+=160,r+=16)e.set(n.subarray(r,r+16),o);return e}decryptAvcSample(e,t,n,r,o){const l=AR(o.data),c=this.getAvcEncryptedData(l);this.decryptBuffer(c.buffer).then(f=>{o.data=this.getAvcDecryptedUnit(l,f),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)}).catch(r)}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){r();return}const o=e[t].units;for(;!(n>=o.length);n++){const l=o[n];if(!(l.data.length<=48||l.type!==1&&l.type!==5)&&(this.decryptAvcSample(e,t,n,r,l),!this.decrypter.isSync()))return}}}}class fw{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,r;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const o=n.units;r=o[o.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,r=n.length;if(r){const o=n[r-1];e.pts=o.pts,e.dts=o.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,n){const r=t.byteLength;let o=e.naluState||0;const l=o,c=[];let f=0,d,m,g,p=-1,E=0;for(o===-1&&(p=0,E=this.getNALuType(t,0),o=0,f=1);f<r;){if(d=t[f++],!o){o=d?0:1;continue}if(o===1){o=d?0:2;continue}if(!d)o=3;else if(d===1){if(m=f-o-1,p>=0){const v={data:t.subarray(p,m),type:E};c.push(v)}else{const v=this.getLastNalUnit(e.samples);v&&(l&&f<=4-l&&v.state&&(v.data=v.data.subarray(0,v.data.byteLength-l)),m>0&&(v.data=qn(v.data,t.subarray(0,m)),v.state=0))}f<r?(g=this.getNALuType(t,f),p=f,E=g,o=0):o=-1}else o=0}if(p>=0&&o>=0){const v={data:t.subarray(p,r),type:E,state:o};c.push(v)}if(c.length===0){const v=this.getLastNalUnit(e.samples);v&&(v.data=qn(v.data,t))}return e.naluState=o,c}}class qo{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),o=Math.min(4,t);if(o===0)throw new Error("no bytes available");r.set(e.subarray(n,n+o)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=o*8,this.bytesAvailable-=o}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&nt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class H3 extends fw{parsePES(e,t,n,r){const o=this.parseNALu(e,n.data,r);let l=this.VideoSample,c,f=!1;n.data=null,l&&o.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),o.forEach(d=>{var m,g;switch(d.type){case 1:{let S=!1;c=!0;const b=d.data;if(f&&b.length>4){const R=this.readSliceType(b);(R===2||R===4||R===7||R===9)&&(S=!0)}if(S){var p;(p=l)!=null&&p.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.frame=!0,l.key=S;break}case 5:c=!0,(m=l)!=null&&m.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 6:{c=!0,xp(d.data,1,n.pts,t.samples);break}case 7:{var E,v;c=!0,f=!0;const S=d.data,b=this.readSPS(S);if(!e.sps||e.width!==b.width||e.height!==b.height||((E=e.pixelRatio)==null?void 0:E[0])!==b.pixelRatio[0]||((v=e.pixelRatio)==null?void 0:v[1])!==b.pixelRatio[1]){e.width=b.width,e.height=b.height,e.pixelRatio=b.pixelRatio,e.sps=[S];const R=S.subarray(1,4);let C="avc1.";for(let _=0;_<3;_++){let D=R[_].toString(16);D.length<2&&(D="0"+D),C+=D}e.codec=C}break}case 8:c=!0,e.pps=[d.data];break;case 9:c=!0,e.audFound=!0,(g=l)!=null&&g.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:c=!0;break;default:c=!1;break}l&&c&&l.units.push(d)}),r&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new qo(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n=8,r=8,o;for(let l=0;l<e;l++)r!==0&&(o=t.readEG(),r=(n+o+256)%256),n=r===0?n:r}readSPS(e){const t=new qo(e);let n=0,r=0,o=0,l=0,c,f,d;const m=t.readUByte.bind(t),g=t.readBits.bind(t),p=t.readUEG.bind(t),E=t.readBoolean.bind(t),v=t.skipBits.bind(t),S=t.skipEG.bind(t),b=t.skipUEG.bind(t),R=this.skipScalingList.bind(this);m();const C=m();if(g(5),v(3),m(),b(),C===100||C===110||C===122||C===244||C===44||C===83||C===86||C===118||C===128){const P=p();if(P===3&&v(1),b(),b(),v(1),E())for(f=P!==3?8:12,d=0;d<f;d++)E()&&(d<6?R(16,t):R(64,t))}b();const _=p();if(_===0)p();else if(_===1)for(v(1),S(),S(),c=p(),d=0;d<c;d++)S();b(),v(1);const D=p(),N=p(),B=g(1);B===0&&v(1),v(1),E()&&(n=p(),r=p(),o=p(),l=p());let I=[1,1];if(E()&&E())switch(m()){case 1:I=[1,1];break;case 2:I=[12,11];break;case 3:I=[10,11];break;case 4:I=[16,11];break;case 5:I=[40,33];break;case 6:I=[24,11];break;case 7:I=[20,11];break;case 8:I=[32,11];break;case 9:I=[80,33];break;case 10:I=[18,11];break;case 11:I=[15,11];break;case 12:I=[64,33];break;case 13:I=[160,99];break;case 14:I=[4,3];break;case 15:I=[3,2];break;case 16:I=[2,1];break;case 255:{I=[m()<<8|m(),m()<<8|m()];break}}return{width:Math.ceil((D+1)*16-n*2-r*2),height:(2-B)*(N+1)*16-(B?2:4)*(o+l),pixelRatio:I}}}class z3 extends fw{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,r){const o=this.parseNALu(e,n.data,r);let l=this.VideoSample,c,f=!1;n.data=null,l&&o.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),o.forEach(d=>{var m,g;switch(d.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),l.frame=!0,c=!0;break;case 16:case 17:case 18:case 21:if(c=!0,f){var p;(p=l)!=null&&p.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 19:case 20:c=!0,(m=l)!=null&&m.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 39:c=!0,xp(d.data,2,n.pts,t.samples);break;case 32:c=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=at(e.params,this.readVPS(d.data)),this.initVPS=d.data),e.vps=[d.data];break;case 33:if(c=!0,f=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],d.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const E=this.readSPS(d.data);e.width=E.width,e.height=E.height,e.pixelRatio=E.pixelRatio,e.codec=E.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const v in E.params)e.params[v]=E.params[v]}this.pushParameterSet(e.sps,d.data,e.vps),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0;break;case 34:if(c=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const E=this.readPPS(d.data);for(const v in E)e.params[v]=E[v]}this.pushParameterSet(e.pps,d.data,e.vps)}break;case 35:c=!0,e.audFound=!0,(g=l)!=null&&g.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:c=!1;break}l&&c&&l.units.push(d)}),r&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let r=0;r<e.byteLength;r++)r>=2&&e[r]===3&&e[r-1]===0&&e[r-2]===0||(t[n]=e[r],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new qo(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),r=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:r}}readSPS(e){const t=new qo(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const r=t.readBits(2),o=t.readBoolean(),l=t.readBits(5),c=t.readUByte(),f=t.readUByte(),d=t.readUByte(),m=t.readUByte(),g=t.readUByte(),p=t.readUByte(),E=t.readUByte(),v=t.readUByte(),S=t.readUByte(),b=t.readUByte(),R=t.readUByte(),C=[],_=[];for(let Ue=0;Ue<n;Ue++)C.push(t.readBoolean()),_.push(t.readBoolean());if(n>0)for(let Ue=n;Ue<8;Ue++)t.readBits(2);for(let Ue=0;Ue<n;Ue++)C[Ue]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),_[Ue]&&t.readUByte();t.readUEG();const D=t.readUEG();D==3&&t.skipBits(1);const N=t.readUEG(),B=t.readUEG(),I=t.readBoolean();let P=0,M=0,U=0,q=0;I&&(P+=t.readUEG(),M+=t.readUEG(),U+=t.readUEG(),q+=t.readUEG());const V=t.readUEG(),ee=t.readUEG(),Z=t.readUEG(),re=t.readBoolean();for(let Ue=re?0:n;Ue<=n;Ue++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let At=0;At<4;At++)for(let _t=0;_t<(At===3?2:6);_t++)if(!t.readBoolean())t.readUEG();else{const Ht=Math.min(64,1<<4+(At<<1));At>1&&t.readEG();for(let Mn=0;Mn<Ht;Mn++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const j=t.readUEG();let oe=0;for(let Ue=0;Ue<j;Ue++){let At=!1;if(Ue!==0&&(At=t.readBoolean()),At){Ue===j&&t.readUEG(),t.readBoolean(),t.readUEG();let _t=0;for(let Jt=0;Jt<=oe;Jt++){const Ht=t.readBoolean();let Mn=!1;Ht||(Mn=t.readBoolean()),(Ht||Mn)&&_t++}oe=_t}else{const _t=t.readUEG(),Jt=t.readUEG();oe=_t+Jt;for(let Ht=0;Ht<_t;Ht++)t.readUEG(),t.readBoolean();for(let Ht=0;Ht<Jt;Ht++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Ue=t.readUEG();for(let At=0;At<Ue;At++){for(let _t=0;_t<Z+4;_t++)t.readBits(1);t.readBits(1)}}let k=0,G=1,te=1,le=!0,he=1,pe=0;t.readBoolean(),t.readBoolean();let ye=!1;if(t.readBoolean()){if(t.readBoolean()){const Xn=t.readUByte(),wr=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Dt=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Xn>0&&Xn<16?(G=wr[Xn-1],te=Dt[Xn-1]):Xn===255&&(G=t.readBits(16),te=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),ye=t.readBoolean(),ye&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(he=t.readBits(32),pe=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const Dt=t.readBoolean(),Lr=t.readBoolean();let ls=!1;(Dt||Lr)&&(ls=t.readBoolean(),ls&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),ls&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let ai=0;ai<=n;ai++){le=t.readBoolean();const Is=le||t.readBoolean();let oi=!1;Is?t.readEG():oi=t.readBoolean();const li=oi?1:t.readUEG()+1;if(Dt)for(let Os=0;Os<li;Os++)t.readUEG(),t.readUEG(),ls&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Lr)for(let Os=0;Os<li;Os++)t.readUEG(),t.readUEG(),ls&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),k=t.readUEG())}let De=N,dt=B;if(I){let Ue=1,At=1;D===1?Ue=At=2:D==2&&(Ue=2),De=N-Ue*M-Ue*P,dt=B-At*q-At*U}const ot=r?["A","B","C"][r]:"",we=c<<24|f<<16|d<<8|m;let nn=0;for(let Ue=0;Ue<32;Ue++)nn=(nn|(we>>Ue&1)<<31-Ue)>>>0;let vn=nn.toString(16);return l===1&&vn==="2"&&(vn="6"),{codecString:`hvc1.${ot}${l}.${vn}.${o?"H":"L"}${R}.B0`,params:{general_tier_flag:o,general_profile_idc:l,general_profile_space:r,general_profile_compatibility_flags:[c,f,d,m],general_constraint_indicator_flags:[g,p,E,v,S,b],general_level_idc:R,bit_depth:V+8,bit_depth_luma_minus8:V,bit_depth_chroma_minus8:ee,min_spatial_segmentation_idc:k,chroma_format_idc:D,frame_rate:{fixed:le,fps:pe/he}},width:De,height:dt,pixelRatio:[G,te]}}readPPS(e){const t=new qo(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const r=t.readBoolean(),o=t.readBoolean();let l=1;return o&&r?l=0:o?l=3:r&&(l=2),{parallelismType:l}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Gt=188;class Bi{constructor(e,t,n,r){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=r,this.videoParser=null}static probe(e,t){const n=Bi.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){const t=e.length;let n=Math.min(Gt*5,t-Gt)+1,r=0;for(;r<n;){let o=!1,l=-1,c=0;for(let f=r;f<t;f+=Gt)if(e[f]===71&&(t-f===Gt||e[f+Gt]===71)){if(c++,l===-1&&(l=f,l!==0&&(n=Math.min(l+Gt*99,e.length-Gt)+1)),o||(o=xg(e,f)===0),o&&c>1&&(l===0&&c>2||f+Gt>n))return l}else{if(c)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:vR[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Bi.createTrack("video"),this._videoTrack.duration=r,this._audioTrack=Bi.createTrack("audio",r),this._id3Track=Bi.createTrack("id3"),this._txtTrack=Bi.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,r=!1){n||(this.sampleAes=null);let o;const l=this._videoTrack,c=this._audioTrack,f=this._id3Track,d=this._txtTrack;let m=l.pid,g=l.pesData,p=c.pid,E=f.pid,v=c.pesData,S=f.pesData,b=null,R=this.pmtParsed,C=this._pmtId,_=e.length;if(this.remainderData&&(e=qn(this.remainderData,e),_=e.length,this.remainderData=null),_<Gt&&!r)return this.remainderData=e,{audioTrack:c,videoTrack:l,id3Track:f,textTrack:d};const D=Math.max(0,Bi.syncOffset(e));_-=(_-D)%Gt,_<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,_,e.buffer.byteLength-_));let N=0;for(let I=D;I<_;I+=Gt)if(e[I]===71){const P=!!(e[I+1]&64),M=xg(e,I),U=(e[I+3]&48)>>4;let q;if(U>1){if(q=I+5+e[I+4],q===I+Gt)continue}else q=I+4;switch(M){case m:P&&(g&&(o=ba(g,this.logger))&&(this.readyVideoParser(l.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(l,d,o,!1)),g={data:[],size:0}),g&&(g.data.push(e.subarray(q,I+Gt)),g.size+=I+Gt-q);break;case p:if(P){if(v&&(o=ba(v,this.logger)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,o);break;case"mp3":this.parseMPEGPES(c,o);break;case"ac3":this.parseAC3PES(c,o);break}v={data:[],size:0}}v&&(v.data.push(e.subarray(q,I+Gt)),v.size+=I+Gt-q);break;case E:P&&(S&&(o=ba(S,this.logger))&&this.parseID3PES(f,o),S={data:[],size:0}),S&&(S.data.push(e.subarray(q,I+Gt)),S.size+=I+Gt-q);break;case 0:P&&(q+=e[q]+1),C=this._pmtId=V3(e,q);break;case C:{P&&(q+=e[q]+1);const V=K3(e,q,this.typeSupported,n,this.observer,this.logger);m=V.videoPid,m>0&&(l.pid=m,l.segmentCodec=V.segmentVideoCodec),p=V.audioPid,p>0&&(c.pid=p,c.segmentCodec=V.segmentAudioCodec),E=V.id3Pid,E>0&&(f.pid=E),b!==null&&!R&&(this.logger.warn(`MPEG-TS PMT found at ${I} after unknown PID '${b}'. Backtracking to sync byte @${D} to parse all TS packets.`),b=null,I=D-188),R=this.pmtParsed=!0;break}case 17:case 8191:break;default:b=M;break}}else N++;N>0&&Eg(this.observer,new Error(`Found ${N} TS packet/s that do not start with 0x47`),void 0,this.logger),l.pesData=g,c.pesData=v,f.pesData=S;const B={audioTrack:c,videoTrack:l,id3Track:f,textTrack:d};return r&&this.extractRemainingSamples(B),B}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:o}=e,l=n.pesData,c=t.pesData,f=r.pesData;let d;if(l&&(d=ba(l,this.logger))?(this.readyVideoParser(n.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(n,o,d,!0),n.pesData=null)):n.pesData=l,c&&(d=ba(c,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d);break}t.pesData=null}else c!=null&&c.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=c;f&&(d=ba(f,this.logger))?(this.parseID3PES(r,d),r.pesData=null):r.pesData=f}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),o=this.sampleAes=new G3(this.observer,this.config,t);return this.decrypt(r,o)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new H3:e==="hevc"&&(this.videoParser=new z3))}decrypt(e,t){return new Promise(n=>{const{audioTrack:r,videoTrack:o}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{o.samples?t.decryptAvcSamples(o.samples,0,0,()=>{n(e)}):n(e)}):o.samples&&t.decryptAvcSamples(o.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let o=t.data;if(r){this.aacOverFlow=null;const g=r.missing,p=r.sample.unit.byteLength;if(g===-1)o=qn(r.sample.unit,o);else{const E=p-g;r.sample.unit.set(o.subarray(0,g),E),e.samples.push(r.sample),n=r.missing}}let l,c;for(l=n,c=o.length;l<c-1&&!Wu(o,l);l++);if(l!==n){let g;const p=l<c-1;if(p?g=`AAC PES did not start with ADTS header,offset:${l}`:g="No ADTS header found in AAC PES",Eg(this.observer,new Error(g),p,this.logger),!p)return}tw(e,this.observer,o,l,this.audioCodec);let f;if(t.pts!==void 0)f=t.pts;else if(r){const g=nw(e.samplerate);f=r.sample.pts+g}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,m;for(;l<c;)if(m=sw(e,o,l,f,d),l+=m.length,m.missing){this.aacOverFlow=m;break}else for(d++;l<c-1&&!Wu(o,l);l++);}parseMPEGPES(e,t){const n=t.data,r=n.length;let o=0,l=0;const c=t.pts;if(c===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;l<r;)if(lw(n,l)){const f=aw(e,n,l,c,o);if(f)l+=f.length,o++;else break}else l++}parseAC3PES(e,t){{const n=t.data,r=t.pts;if(r===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const o=n.length;let l=0,c=0,f;for(;c<o&&(f=dw(e,n,c,r,l++))>0;)c+=f}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=at({},t,{type:this._videoTrack?Dn.emsg:Dn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function xg(s,e){return((s[e+1]&31)<<8)+s[e+2]}function V3(s,e){return(s[e+10]&31)<<8|s[e+11]}function K3(s,e,t,n,r,o){const l={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},c=(s[e+1]&15)<<8|s[e+2],f=e+3+c-4,d=(s[e+10]&15)<<8|s[e+11];for(e+=12+d;e<f;){const m=xg(s,e),g=(s[e+3]&15)<<8|s[e+4];switch(s[e]){case 207:if(!n){Tm("ADTS AAC",o);break}case 15:l.audioPid===-1&&(l.audioPid=m);break;case 21:l.id3Pid===-1&&(l.id3Pid=m);break;case 219:if(!n){Tm("H.264",o);break}case 27:l.videoPid===-1&&(l.videoPid=m);break;case 3:case 4:!t.mpeg&&!t.mp3?o.log("MPEG audio found, not supported in this browser"):l.audioPid===-1&&(l.audioPid=m,l.segmentAudioCodec="mp3");break;case 193:if(!n){Tm("AC-3",o);break}case 129:t.ac3?l.audioPid===-1&&(l.audioPid=m,l.segmentAudioCodec="ac3"):o.log("AC-3 audio found, not supported in this browser");break;case 6:if(l.audioPid===-1&&g>0){let p=e+5,E=g;for(;E>2;){switch(s[p]){case 106:t.ac3!==!0?o.log("AC-3 audio found, not supported in this browser for now"):(l.audioPid=m,l.segmentAudioCodec="ac3");break}const S=s[p+1]+2;p+=S,E-=S}}break;case 194:case 135:return Eg(r,new Error("Unsupported EC-3 in M2TS found"),void 0,o),l;case 36:l.videoPid===-1&&(l.videoPid=m,l.segmentVideoCodec="hevc",o.log("HEVC in M2TS found"));break}e+=g+5}return l}function Eg(s,e,t,n){n.warn(`parsing error: ${e.message}`),s.emit(L.ERROR,L.ERROR,{type:Ae.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Tm(s,e){e.log(`${s} with AES-128-CBC encryption found in unencrypted stream`)}function ba(s,e){let t=0,n,r,o,l,c;const f=s.data;if(!s||s.size===0)return null;for(;f[0].length<19&&f.length>1;)f[0]=qn(f[0],f[1]),f.splice(1,1);if(n=f[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(r=(n[4]<<8)+n[5],r&&r>s.size-6)return null;const m=n[7];m&192&&(l=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,m&64?(c=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,l-c>60*9e4&&(e.warn(`${Math.round((l-c)/9e4)}s delta between PTS and DTS, align them`),l=c)):c=l),o=n[8];let g=o+9;if(s.size<=g)return null;s.size-=g;const p=new Uint8Array(s.size);for(let E=0,v=f.length;E<v;E++){n=f[E];let S=n.byteLength;if(g)if(g>S){g-=S;continue}else n=n.subarray(g),S-=g,g=0;p.set(n,t),t+=S}return r&&(r-=o+3),{data:p,pts:l,dts:c,len:r}}return null}class q3{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Mi=Math.pow(2,32)-1;class Y{static init(){Y.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Y.types)Y.types.hasOwnProperty(e)&&(Y.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Y.HDLR_TYPES={video:t,audio:n};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);Y.STTS=Y.STSC=Y.STCO=o,Y.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Y.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Y.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Y.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const l=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),f=new Uint8Array([0,0,0,1]);Y.FTYP=Y.box(Y.types.ftyp,l,f,l,c),Y.DINF=Y.box(Y.types.dinf,Y.box(Y.types.dref,r))}static box(e,...t){let n=8,r=t.length;const o=r;for(;r--;)n+=t[r].byteLength;const l=new Uint8Array(n);for(l[0]=n>>24&255,l[1]=n>>16&255,l[2]=n>>8&255,l[3]=n&255,l.set(e,4),r=0,n=8;r<o;r++)l.set(t[r],n),n+=t[r].byteLength;return l}static hdlr(e){return Y.box(Y.types.hdlr,Y.HDLR_TYPES[e])}static mdat(e){return Y.box(Y.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Mi+1)),r=Math.floor(t%(Mi+1));return Y.box(Y.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return Y.box(Y.types.mdia,Y.mdhd(e.timescale||0,e.duration||0),Y.hdlr(e.type),Y.minf(e))}static mfhd(e){return Y.box(Y.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Y.box(Y.types.minf,Y.box(Y.types.smhd,Y.SMHD),Y.DINF,Y.stbl(e)):Y.box(Y.types.minf,Y.box(Y.types.vmhd,Y.VMHD),Y.DINF,Y.stbl(e))}static moof(e,t,n){return Y.box(Y.types.moof,Y.mfhd(e),Y.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=Y.trak(e[t]);return Y.box.apply(null,[Y.types.moov,Y.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(Y.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=Y.trex(e[t]);return Y.box.apply(null,[Y.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Mi+1)),r=Math.floor(t%(Mi+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Y.box(Y.types.mvhd,o)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let r,o;for(r=0;r<t.length;r++)o=t[r].flags,n[r+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return Y.box(Y.types.sdtp,n)}static stbl(e){return Y.box(Y.types.stbl,Y.stsd(e),Y.box(Y.types.stts,Y.STTS),Y.box(Y.types.stsc,Y.STSC),Y.box(Y.types.stsz,Y.STSZ),Y.box(Y.types.stco,Y.STCO))}static avc1(e){let t=[],n=[],r,o,l;for(r=0;r<e.sps.length;r++)o=e.sps[r],l=o.byteLength,t.push(l>>>8&255),t.push(l&255),t=t.concat(Array.prototype.slice.call(o));for(r=0;r<e.pps.length;r++)o=e.pps[r],l=o.byteLength,n.push(l>>>8&255),n.push(l&255),n=n.concat(Array.prototype.slice.call(o));const c=Y.box(Y.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),f=e.width,d=e.height,m=e.pixelRatio[0],g=e.pixelRatio[1];return Y.box(Y.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,Y.box(Y.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Y.box(Y.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,g>>24,g>>16&255,g>>8&255,g&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Y.box(Y.types.mp4a,Y.audioStsd(e),Y.box(Y.types.esds,Y.esds(e)))}static mp3(e){return Y.box(Y.types[".mp3"],Y.audioStsd(e))}static ac3(e){return Y.box(Y.types["ac-3"],Y.audioStsd(e),Y.box(Y.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return Y.box(Y.types.stsd,Y.STSD,Y.mp4a(e));if(t==="ac3"&&e.config)return Y.box(Y.types.stsd,Y.STSD,Y.ac3(e));if(t==="mp3"&&e.codec==="mp3")return Y.box(Y.types.stsd,Y.STSD,Y.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return Y.box(Y.types.stsd,Y.STSD,Y.avc1(e));if(t==="hevc"&&e.vps)return Y.box(Y.types.stsd,Y.STSD,Y.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),r=e.width||0,o=e.height||0,l=Math.floor(n/(Mi+1)),c=Math.floor(n%(Mi+1));return Y.box(Y.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,o>>8&255,o&255,0,0]))}static traf(e,t){const n=Y.sdtp(e),r=e.id,o=Math.floor(t/(Mi+1)),l=Math.floor(t%(Mi+1));return Y.box(Y.types.traf,Y.box(Y.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),Y.box(Y.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255])),Y.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,Y.box(Y.types.trak,Y.tkhd(e),Y.mdia(e))}static trex(e){const t=e.id;return Y.box(Y.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],r=n.length,o=12+16*r,l=new Uint8Array(o);let c,f,d,m,g,p;for(t+=8+o,l.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),c=0;c<r;c++)f=n[c],d=f.duration,m=f.size,g=f.flags,p=f.cts,l.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,g.isLeading<<2|g.dependsOn,g.isDependedOn<<6|g.hasRedundancy<<4|g.paddingValue<<1|g.isNonSync,g.degradPrio&61440,g.degradPrio&15,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*c);return Y.box(Y.types.trun,l)}static initSegment(e){Y.types||Y.init();const t=Y.moov(e);return qn(Y.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],r=4,o=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),r-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let l=o.length;for(let v=0;v<n.length;v+=1){l+=3;for(let S=0;S<n[v].length;S+=1)l+=2+n[v][S].length}const c=new Uint8Array(l);c.set(o,0),l=o.length;const f=n.length-1;for(let v=0;v<n.length;v+=1){c.set(new Uint8Array([32+v|(v===f?128:0),0,n[v].length]),l),l+=3;for(let S=0;S<n[v].length;S+=1)c.set(new Uint8Array([n[v][S].length>>8,n[v][S].length&255]),l),l+=2,c.set(n[v][S],l),l+=n[v][S].length}const d=Y.box(Y.types.hvcC,c),m=e.width,g=e.height,p=e.pixelRatio[0],E=e.pixelRatio[1];return Y.box(Y.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,m&255,g>>8&255,g&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,Y.box(Y.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Y.box(Y.types.pasp,new Uint8Array([p>>24,p>>16&255,p>>8&255,p&255,E>>24,E>>16&255,E>>8&255,E&255])))}}Y.types=void 0;Y.HDLR_TYPES=void 0;Y.STTS=void 0;Y.STSC=void 0;Y.STCO=void 0;Y.STSZ=void 0;Y.VMHD=void 0;Y.SMHD=void 0;Y.STSD=void 0;Y.FTYP=void 0;Y.DINF=void 0;const hw=9e4;function kp(s,e,t=1,n=!1){const r=s*e*t;return n?Math.round(r):r}function Y3(s,e,t=1,n=!1){return kp(s,e,1/t,n)}function Go(s,e=!1){return kp(s,1e3,1/hw,e)}function W3(s,e=1){return kp(s,hw,1/e)}function eb(s){const{baseTime:e,timescale:t,trackId:n}=s;return`${e/t} (${e}/${t}) trackId: ${n}`}const X3=10*1e3,Q3=1024,Z3=1152,J3=1536;let Ta=null,Am=null;function tb(s,e,t,n){return{duration:e,size:t,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:s?2:1,isNonSync:s?0:1}}}class Tu extends Wn{constructor(e,t,n,r){if(super("mp4-remuxer",r),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,Ta===null){const l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ta=l?parseInt(l[1]):0}if(Am===null){const o=navigator.userAgent.match(/Safari\/(\d+)/i);Am=o?parseInt(o[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&eb(t)} > ${e&&eb(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,r=e.reduce((o,l)=>{let c=l.pts,f=c-o;return f<-4294967296&&(t=!0,c=Cn(c,n),f=c-o),f>0?o:c},n);return t&&this.debug("PTS rollover detected"),r}remux(e,t,n,r,o,l,c,f){let d,m,g,p,E,v,S=o,b=o;const R=e.pid>-1,C=t.pid>-1,_=t.samples.length,D=e.samples.length>0,N=c&&_>0||_>1;if((!R||D)&&(!C||N)||this.ISGenerated||c){if(this.ISGenerated){var I,P,M,U;const Z=this.videoTrackConfig;(Z&&(t.width!==Z.width||t.height!==Z.height||((I=t.pixelRatio)==null?void 0:I[0])!==((P=Z.pixelRatio)==null?void 0:P[0])||((M=t.pixelRatio)==null?void 0:M[1])!==((U=Z.pixelRatio)==null?void 0:U[1]))||!Z&&N||this.nextAudioTs===null&&D)&&this.resetInitSegment()}this.ISGenerated||(g=this.generateIS(e,t,o,l));const q=this.isVideoContiguous;let V=-1,ee;if(N&&(V=e$(t.samples),!q&&this.config.forceKeyFrameOnDiscontinuity))if(v=!0,V>0){this.warn(`Dropped ${V} out of ${_} video samples due to a missing keyframe`);const Z=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(V),t.dropped+=V,b+=(t.samples[0].pts-Z)/t.inputTimeScale,ee=b}else V===-1&&(this.warn(`No keyframe found out of ${_} video samples`),v=!1);if(this.ISGenerated){if(D&&N){const Z=this.getVideoStartPts(t.samples),F=(Cn(e.samples[0].pts,Z)-Z)/t.inputTimeScale;S+=Math.max(0,F),b+=Math.max(0,-F)}if(D){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),g=this.generateIS(e,t,o,l)),m=this.remuxAudio(e,S,this.isAudioContiguous,l,C||N||f===xe.AUDIO?b:void 0),N){const Z=m?m.endPTS-m.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),g=this.generateIS(e,t,o,l)),d=this.remuxVideo(t,b,q,Z)}}else N&&(d=this.remuxVideo(t,b,q,0));d&&(d.firstKeyFrame=V,d.independent=V!==-1,d.firstKeyFramePTS=ee)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(E=mw(n,o,this._initPTS,this._initDTS)),r.samples.length&&(p=gw(r,o,this._initPTS))),{audio:m,video:d,initSegment:g,independent:v,text:p,id3:E}}computeInitPts(e,t,n,r){const o=Math.round(n*t);let l=Cn(e,o);if(l<o+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(o-l)/t} ${r}`);l<o+t;)l+=8589934592;return l-o}generateIS(e,t,n,r){const o=e.samples,l=t.samples,c=this.typeSupported,f={},d=this._initPTS;let m=!d||r,g="audio/mp4",p,E,v,S=-1;if(m&&(p=E=1/0),e.config&&o.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":c.mpeg?(g="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}f.audio={id:"audio",container:g,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&c.mpeg?new Uint8Array(0):Y.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(S=e.id,v=e.inputTimeScale,!d||v!==d.timescale?p=E=this.computeInitPts(o[0].pts,v,n,"audio"):m=!1)}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,f.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Y.initSegment([t]),metadata:{width:t.width,height:t.height}},m)if(S=t.id,v=t.inputTimeScale,!d||v!==d.timescale){const b=this.getVideoStartPts(l),R=Cn(l[0].dts,b),C=this.computeInitPts(R,v,n,"video"),_=this.computeInitPts(b,v,n,"video");E=Math.min(E,C),p=Math.min(p,_)}else m=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(f).length)return this.ISGenerated=!0,m?(d&&this.warn(`Timestamps at playlist time: ${r?"":"~"}${n} ${p/v} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${n} offset: ${p/v} (${p}/${v}) trackId: ${S}`),this._initPTS={baseTime:p,timescale:v,trackId:S},this._initDTS={baseTime:E,timescale:v,trackId:S}):p=v=void 0,{tracks:f,initPTS:p,timescale:v,trackId:S}}remuxVideo(e,t,n,r){const o=e.inputTimeScale,l=e.samples,c=[],f=l.length,d=this._initPTS,m=d.baseTime*o/d.timescale;let g=this.nextVideoTs,p=8,E=this.videoSampleDuration,v,S,b=Number.POSITIVE_INFINITY,R=Number.NEGATIVE_INFINITY,C=!1;if(!n||g===null){const k=m+t*o,G=l[0].pts-Cn(l[0].dts,l[0].pts);Ta&&g!==null&&Math.abs(k-G-(g+m))<15e3?n=!0:g=k-G-m}const _=g+m;for(let k=0;k<f;k++){const G=l[k];G.pts=Cn(G.pts,_),G.dts=Cn(G.dts,_),G.dts<l[k>0?k-1:k].dts&&(C=!0)}C&&l.sort(function(k,G){const te=k.dts-G.dts,le=k.pts-G.pts;return te||le}),v=l[0].dts,S=l[l.length-1].dts;const D=S-v,N=D?Math.round(D/(f-1)):E||e.inputTimeScale/30;if(n){const k=v-_,G=k>N,te=k<-1;if((G||te)&&(G?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Go(k,!0)} ms (${k}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Go(-k,!0)} ms (${k}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!te||_>=l[0].pts||Ta)){v=_;const le=l[0].pts-k;if(G)l[0].dts=v,l[0].pts=le;else{let he=!0;for(let pe=0;pe<l.length&&!(l[pe].dts>le&&he);pe++){const ye=l[pe].pts;if(l[pe].dts-=k,l[pe].pts-=k,pe<l.length-1){const Ne=l[pe+1].pts,De=l[pe].pts,dt=Ne<=De,ot=Ne<=ye;he=dt==ot}}}this.log(`Video: Initial PTS/DTS adjusted: ${Go(le,!0)}/${Go(v,!0)}, delta: ${Go(k,!0)} ms`)}}v=Math.max(0,v);let B=0,I=0,P=v;for(let k=0;k<f;k++){const G=l[k],te=G.units,le=te.length;let he=0;for(let pe=0;pe<le;pe++)he+=te[pe].data.length;I+=he,B+=le,G.length=he,G.dts<P?(G.dts=P,P+=N/4|0||1):P=G.dts,b=Math.min(G.pts,b),R=Math.max(G.pts,R)}S=l[f-1].dts;const M=I+4*B+8;let U;try{U=new Uint8Array(M)}catch(k){this.observer.emit(L.ERROR,L.ERROR,{type:Ae.MUX_ERROR,details:W.REMUX_ALLOC_ERROR,fatal:!1,error:k,bytes:M,reason:`fail allocating video mdat ${M}`});return}const q=new DataView(U.buffer);q.setUint32(0,M),U.set(Y.types.mdat,4);let V=!1,ee=Number.POSITIVE_INFINITY,Z=Number.POSITIVE_INFINITY,re=Number.NEGATIVE_INFINITY,F=Number.NEGATIVE_INFINITY;for(let k=0;k<f;k++){const G=l[k],te=G.units;let le=0;for(let ye=0,Ne=te.length;ye<Ne;ye++){const De=te[ye],dt=De.data,ot=De.data.byteLength;q.setUint32(p,ot),p+=4,U.set(dt,p),p+=ot,le+=4+ot}let he;if(k<f-1)E=l[k+1].dts-G.dts,he=l[k+1].pts-G.pts;else{const ye=this.config,Ne=k>0?G.dts-l[k-1].dts:N;if(he=k>0?G.pts-l[k-1].pts:N,ye.stretchShortVideoTrack&&this.nextAudioTs!==null){const De=Math.floor(ye.maxBufferHole*o),dt=(r?b+r*o:this.nextAudioTs+m)-G.pts;dt>De?(E=dt-Ne,E<0?E=Ne:V=!0,this.log(`It is approximately ${dt/90} ms to the next segment; using duration ${E/90} ms for the last video frame.`)):E=Ne}else E=Ne}const pe=Math.round(G.pts-G.dts);ee=Math.min(ee,E),re=Math.max(re,E),Z=Math.min(Z,he),F=Math.max(F,he),c.push(tb(G.key,E,le,pe))}if(c.length){if(Ta){if(Ta<70){const k=c[0].flags;k.dependsOn=2,k.isNonSync=0}}else if(Am&&F-Z<re-ee&&N/re<.025&&c[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let k=v;for(let G=0,te=c.length;G<te;G++){const le=k+c[G].duration,he=k+c[G].cts;if(G<te-1){const pe=le+c[G+1].cts;c[G].duration=pe-he}else c[G].duration=G?c[G-1].duration:N;c[G].cts=0,k=le}}}E=V||!E?N:E;const z=S+E;this.nextVideoTs=g=z-m,this.videoSampleDuration=E,this.isVideoContiguous=!0;const fe={data1:Y.moof(e.sequenceNumber++,v,at(e,{samples:c})),data2:U,startPTS:(b-m)/o,endPTS:(R+E-m)/o,startDTS:(v-m)/o,endDTS:g/o,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:e.dropped};return e.samples=[],e.dropped=0,fe}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return Z3;case"ac3":return J3;default:return Q3}}remuxAudio(e,t,n,r,o){const l=e.inputTimeScale,c=e.samplerate?e.samplerate:l,f=l/c,d=this.getSamplesPerFrame(e),m=d*f,g=this._initPTS,p=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,E=[],v=o!==void 0;let S=e.samples,b=p?0:8,R=this.nextAudioTs||-1;const C=g.baseTime*l/g.timescale,_=C+t*l;if(this.isAudioContiguous=n=n||S.length&&R>0&&(r&&Math.abs(_-(R+C))<9e3||Math.abs(Cn(S[0].pts,_)-(R+C))<20*m),S.forEach(function(F){F.pts=Cn(F.pts,_)}),!n||R<0){const F=S.length;if(S=S.filter(z=>z.pts>=0),F!==S.length&&this.warn(`Removed ${S.length-F} of ${F} samples (initPTS ${C} / ${l})`),!S.length)return;o===0?R=0:r&&!v?R=Math.max(0,_-C):R=S[0].pts-C}if(e.segmentCodec==="aac"){const F=this.config.maxAudioFramesDrift;for(let z=0,j=R+C;z<S.length;z++){const oe=S[z],fe=oe.pts,k=fe-j,G=Math.abs(1e3*k/l);if(k<=-F*m&&v)z===0&&(this.warn(`Audio frame @ ${(fe/l).toFixed(3)}s overlaps marker by ${Math.round(1e3*k/l)} ms.`),this.nextAudioTs=R=fe-C,j=fe);else if(k>=F*m&&G<X3&&v){let te=Math.round(k/m);for(j=fe-te*m;j<0&&te&&m;)te--,j+=m;z===0&&(this.nextAudioTs=R=j-C),this.warn(`Injecting ${te} audio frames @ ${((j-C)/l).toFixed(3)}s due to ${Math.round(1e3*k/l)} ms gap.`);for(let le=0;le<te;le++){let he=q3.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);he||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),he=oe.unit.subarray()),S.splice(z,0,{unit:he,pts:j}),j+=m,z++}}oe.pts=j,j+=m}}let D=null,N=null,B,I=0,P=S.length;for(;P--;)I+=S[P].unit.byteLength;for(let F=0,z=S.length;F<z;F++){const j=S[F],oe=j.unit;let fe=j.pts;if(N!==null){const G=E[F-1];G.duration=Math.round((fe-N)/f)}else if(n&&e.segmentCodec==="aac"&&(fe=R+C),D=fe,I>0){I+=b;try{B=new Uint8Array(I)}catch(G){this.observer.emit(L.ERROR,L.ERROR,{type:Ae.MUX_ERROR,details:W.REMUX_ALLOC_ERROR,fatal:!1,error:G,bytes:I,reason:`fail allocating audio mdat ${I}`});return}p||(new DataView(B.buffer).setUint32(0,I),B.set(Y.types.mdat,4))}else return;B.set(oe,b);const k=oe.byteLength;b+=k,E.push(tb(!0,d,k,0)),N=fe}const M=E.length;if(!M)return;const U=E[E.length-1];R=N-C,this.nextAudioTs=R+f*U.duration;const q=p?new Uint8Array(0):Y.moof(e.sequenceNumber++,D/f,at({},e,{samples:E}));e.samples=[];const V=(D-C)/l,ee=this.nextAudioTs/l,re={data1:q,data2:B,startPTS:V,endPTS:ee,startDTS:V,endDTS:ee,type:"audio",hasAudio:!0,hasVideo:!1,nb:M};return this.isAudioContiguous=!0,re}}function Cn(s,e){let t;if(e===null)return s;for(e<s?t=-8589934592:t=8589934592;Math.abs(s-e)>4294967296;)s+=t;return s}function e$(s){for(let e=0;e<s.length;e++)if(s[e].key)return e;return-1}function mw(s,e,t,n){const r=s.samples.length;if(!r)return;const o=s.inputTimeScale;for(let c=0;c<r;c++){const f=s.samples[c];f.pts=Cn(f.pts-t.baseTime*o/t.timescale,e*o)/o,f.dts=Cn(f.dts-n.baseTime*o/n.timescale,e*o)/o}const l=s.samples;return s.samples=[],{samples:l}}function gw(s,e,t){const n=s.samples.length;if(!n)return;const r=s.inputTimeScale;for(let l=0;l<n;l++){const c=s.samples[l];c.pts=Cn(c.pts-t.baseTime*r/t.timescale,e*r)/r}s.samples.sort((l,c)=>l.pts-c.pts);const o=s.samples;return s.samples=[],{samples:o}}class t$ extends Wn{constructor(e,t,n,r){super("passthrough-remuxer",r),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(e,r),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:n,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:o,video:l}=this.initData=SR(e);if(t)GU(e,t);else{const f=o||l;f!=null&&f.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${f.codec}")!`)}o&&(n=nb(o,ct.AUDIO,this)),l&&(r=nb(l,ct.VIDEO,this));const c={};o&&l?c.audiovideo={container:"video/mp4",codec:n+","+r,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:e,id:"main"}:o?c.audio={container:"audio/mp4",codec:n,encrypted:o.encrypted,initSegment:e,id:"audio"}:l?c.video={container:"video/mp4",codec:r,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=c}remux(e,t,n,r,o,l){var c,f;let{initPTS:d,lastEndTime:m}=this;const g={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};ve(m)||(m=this.lastEndTime=o||0);const p=t.samples;if(!p.length)return g;const E={initPTS:void 0,timescale:void 0,trackId:void 0};let v=this.initData;if((c=v)!=null&&c.length||(this.generateInitSegment(p),v=this.initData),!((f=v)!=null&&f.length))return this.warn("Failed to generate initSegment."),g;this.emitInitSegment&&(E.tracks=this.initTracks,this.emitInitSegment=!1);const S=zU(p,v,this),b=v.audio?S[v.audio.id]:null,R=v.video?S[v.video.id]:null,C=Jc(R,1/0),_=Jc(b,1/0),D=Jc(R,0,!0),N=Jc(b,0,!0);let B=o,I=0;const P=b&&(!R||!d&&_<C||d&&d.trackId===v.audio.id),M=P?b:R;if(M){const j=M.timescale,oe=M.start-o*j,fe=P?v.audio.id:v.video.id;B=M.start/j,I=P?N-_:D-C,(l||!d)&&(n$(d,B,o,I)||j!==d.timescale)&&(d&&this.warn(`Timestamps at playlist time: ${l?"":"~"}${o} ${oe/j} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${o} offset: ${B-o} (${oe}/${j}) trackId: ${fe}`),d=null,E.initPTS=oe,E.timescale=j,E.trackId=fe)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${o}`);d?(E.initPTS=d.baseTime,E.timescale=d.timescale,E.trackId=d.trackId):((!E.timescale||E.trackId===void 0||E.initPTS===void 0)&&(this.warn("Could not set initPTS"),E.initPTS=B,E.timescale=1,E.trackId=-1),this.initPTS=d={baseTime:E.initPTS,timescale:E.timescale,trackId:E.trackId});const U=B-d.baseTime/d.timescale,q=U+I;I>0?this.lastEndTime=q:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const V=!!v.audio,ee=!!v.video;let Z="";V&&(Z+="audio"),ee&&(Z+="video");const re=(v.audio?v.audio.encrypted:!1)||(v.video?v.video.encrypted:!1),F={data1:p,startPTS:U,startDTS:U,endPTS:q,endDTS:q,type:Z,hasAudio:V,hasVideo:ee,nb:1,dropped:0,encrypted:re};g.audio=V&&!ee?F:void 0,g.video=ee?F:void 0;const z=R?.sampleCount;if(z){const j=R.keyFrameIndex,oe=j!==-1;F.nb=z,F.dropped=j===0||this.isVideoContiguous?0:oe?j:z,F.independent=oe,F.firstKeyFrame=j,oe&&R.keyFrameStart&&(F.firstKeyFramePTS=(R.keyFrameStart-d.baseTime)/d.timescale),this.isVideoContiguous||(g.independent=oe),this.isVideoContiguous||(this.isVideoContiguous=oe),F.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${j}/${z} dropped: ${F.dropped} start: ${F.firstKeyFramePTS||"NA"}`)}return g.initSegment=E,g.id3=mw(n,o,d,d),r.samples.length&&(g.text=gw(r,o,d)),g}}function Jc(s,e,t=!1){return s?.start!==void 0?(s.start+(t?s.duration:0))/s.timescale:e}function n$(s,e,t,n){if(s===null)return!0;const r=Math.max(n,1),o=e-s.baseTime/s.timescale;return Math.abs(o-t)>r}function nb(s,e,t){const n=s.codec;return n&&n.length>4?n:e===ct.AUDIO?n==="ec-3"||n==="ac-3"||n==="alac"?n:n==="fLaC"||n==="Opus"?ju(n,!1):(t.warn(`Unhandled audio codec "${n}" in mp4 MAP`),n||"mp4a"):(t.warn(`Unhandled video codec "${n}" in mp4 MAP`),n||"avc1")}let ti;try{ti=self.performance.now.bind(self.performance)}catch{ti=Date.now}const Au=[{demux:j3,remux:t$},{demux:Bi,remux:Tu},{demux:F3,remux:Tu},{demux:B3,remux:Tu}];Au.splice(2,0,{demux:U3,remux:Tu});class sb{constructor(e,t,n,r,o,l){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=o,this.logger=l}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const o=n.transmuxing;o.executeStart=ti();let l=new Uint8Array(e);const{currentTransmuxState:c,transmuxConfig:f}=this;r&&(this.currentTransmuxState=r);const{contiguous:d,discontinuity:m,trackSwitch:g,accurateTimeOffset:p,timeOffset:E,initSegmentChange:v}=r||c,{audioCodec:S,videoCodec:b,defaultInitPts:R,duration:C,initSegmentData:_}=f,D=s$(l,t);if(D&&Da(D.method)){const P=this.getDecrypter(),M=Rp(D.method);if(P.isSync()){let U=P.softwareDecrypt(l,D.key.buffer,D.iv.buffer,M);if(n.part>-1){const V=P.flush();U=V&&V.buffer}if(!U)return o.executeEnd=ti(),Rm(n);l=new Uint8Array(U)}else return this.asyncResult=!0,this.decryptionPromise=P.webCryptoDecrypt(l,D.key.buffer,D.iv.buffer,M).then(U=>{const q=this.push(U,null,n);return this.decryptionPromise=null,q}),this.decryptionPromise}const N=this.needsProbing(m,g);if(N){const P=this.configureTransmuxer(l);if(P)return this.logger.warn(`[transmuxer] ${P.message}`),this.observer.emit(L.ERROR,L.ERROR,{type:Ae.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,fatal:!1,error:P,reason:P.message}),o.executeEnd=ti(),Rm(n)}(m||g||v||N)&&this.resetInitSegment(_,S,b,C,t),(m||v||N)&&this.resetInitialTimestamp(R),d||this.resetContiguity();const B=this.transmux(l,D,E,p,n);this.asyncResult=rl(B);const I=this.currentTransmuxState;return I.contiguous=!0,I.discontinuity=!1,I.trackSwitch=!1,o.executeEnd=ti(),B}flush(e){const t=e.transmuxing;t.executeStart=ti();const{decrypter:n,currentTransmuxState:r,decryptionPromise:o}=this;if(o)return this.asyncResult=!0,o.then(()=>this.flush(e));const l=[],{timeOffset:c}=r;if(n){const g=n.flush();g&&l.push(this.push(g.buffer,null,e))}const{demuxer:f,remuxer:d}=this;if(!f||!d){t.executeEnd=ti();const g=[Rm(e)];return this.asyncResult?Promise.resolve(g):g}const m=f.flush(c);return rl(m)?(this.asyncResult=!0,m.then(g=>(this.flushRemux(l,g,e),l))):(this.flushRemux(l,m,e),this.asyncResult?Promise.resolve(l):l)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:o,id3Track:l,textTrack:c}=t,{accurateTimeOffset:f,timeOffset:d}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===xe.MAIN?"level":"track"} ${n.level}`);const m=this.remuxer.remux(r,o,l,c,d,f,!0,this.id);e.push({remuxResult:m,chunkMeta:n}),n.transmuxing.executeEnd=ti()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,o){const{demuxer:l,remuxer:c}=this;!l||!c||(l.resetInitSegment(e,t,n,r),c.resetInitSegment(e,t,n,o))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,o){let l;return t&&t.method==="SAMPLE-AES"?l=this.transmuxSampleAes(e,t,n,r,o):l=this.transmuxUnencrypted(e,n,r,o),l}transmuxUnencrypted(e,t,n,r){const{audioTrack:o,videoTrack:l,id3Track:c,textTrack:f}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(o,l,c,f,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,o){return this.demuxer.demuxSampleAes(e,t,n).then(l=>({remuxResult:this.remuxer.remux(l.audioTrack,l.videoTrack,l.id3Track,l.textTrack,n,r,!1,this.id),chunkMeta:o}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r}=this;let o;for(let g=0,p=Au.length;g<p;g++){var l;if((l=Au[g].demux)!=null&&l.probe(e,this.logger)){o=Au[g];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const c=this.demuxer,f=this.remuxer,d=o.remux,m=o.demux;(!f||!(f instanceof d))&&(this.remuxer=new d(n,t,r,this.logger)),(!c||!(c instanceof m))&&(this.demuxer=new m(n,t,r,this.logger),this.probe=m.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Tp(this.config)),e}}function s$(s,e){let t=null;return s.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Rm=s=>({remuxResult:{},chunkMeta:s});function rl(s){return"then"in s&&s.then instanceof Function}class i${constructor(e,t,n,r,o){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=o||null}}class r${constructor(e,t,n,r,o,l){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=o,this.initSegmentChange=l}}let ib=0;class pw{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=ib++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=f=>{const d=f.data,m=this.hls;if(!(!m||!(d!=null&&d.event)||d.instanceNo!==this.instanceNo))switch(d.event){case"init":{var g;const p=(g=this.workerContext)==null?void 0:g.objectURL;p&&self.URL.revokeObjectURL(p);break}case"transmuxComplete":{this.handleTransmuxComplete(d.data);break}case"flush":{this.onFlush(d.data);break}case"workerLog":{m.logger[d.data.logType]&&m.logger[d.data.logType](d.data.message);break}default:{d.data=d.data||{},d.data.frag=this.frag,d.data.part=this.part,d.data.id=this.id,m.trigger(d.event,d.data);break}}},this.onWorkerError=f=>{if(!this.hls)return;const d=new Error(`${f.message}  (${f.filename}:${f.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(L.ERROR,{type:Ae.OTHER_ERROR,details:W.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:d})};const o=e.config;this.hls=e,this.id=t,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const l=(f,d)=>{d=d||{},d.frag=this.frag||void 0,f===L.ERROR&&(d=d,d.parent=this.id,d.part=this.part,this.error=d.error),this.hls.trigger(f,d)};this.observer=new Cp,this.observer.on(L.FRAG_DECRYPTED,l),this.observer.on(L.ERROR,l);const c=xS(o.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const f=this.hls.logger;if(o.workerPath||c3()){try{o.workerPath?(f.log(`loading Web Worker ${o.workerPath} for "${t}"`),this.workerContext=d3(o.workerPath)):(f.log(`injecting Web Worker for "${t}"`),this.workerContext=u3());const{worker:m}=this.workerContext;m.addEventListener("message",this.onWorkerMessage),m.addEventListener("error",this.onWorkerError),m.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:c,id:t,config:ut(o)})}catch(m){f.warn(`Error setting up "${t}" Web Worker, fallback to inline`,m),this.terminateWorker(),this.error=null,this.transmuxer=new sb(this.observer,c,o,"",t,e.logger)}return}}this.transmuxer=new sb(this.observer,c,o,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=ib++;const t=this.hls.config,n=xS(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:ut(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),f3(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,r,o,l,c,f,d,m){var g,p;d.transmuxing.start=self.performance.now();const{instanceNo:E,transmuxer:v}=this,S=l?l.start:o.start,b=o.decryptdata,R=this.frag,C=!(R&&o.cc===R.cc),_=!(R&&d.level===R.level),D=R?d.sn-R.sn:-1,N=this.part?d.part-this.part.index:-1,B=D===0&&d.id>1&&d.id===R?.stats.chunkCount,I=!_&&(D===1||D===0&&(N===1||B&&N<=0)),P=self.performance.now();(_||D||o.stats.parsing.start===0)&&(o.stats.parsing.start=P),l&&(N||!I)&&(l.stats.parsing.start=P);const M=!(R&&((g=o.initSegment)==null?void 0:g.url)===((p=R.initSegment)==null?void 0:p.url)),U=new r$(C,I,f,_,S,M);if(!I||C||M){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${o.type} sn: ${d.sn}${d.part>-1?" part: "+d.part:""} ${this.id===xe.MAIN?"level":"track"}: ${d.level} id: ${d.id}
        discontinuity: ${C}
        trackSwitch: ${_}
        contiguous: ${I}
        accurateTimeOffset: ${f}
        timeOffset: ${S}
        initSegmentChange: ${M}`);const q=new i$(n,r,t,c,m);this.configureTransmuxer(q)}if(this.frag=o,this.part=l,this.workerContext)this.workerContext.worker.postMessage({instanceNo:E,cmd:"demux",data:e,decryptdata:b,chunkMeta:d,state:U},e instanceof ArrayBuffer?[e]:[]);else if(v){const q=v.push(e,b,d,U);rl(q)?q.then(V=>{this.handleTransmuxComplete(V)}).catch(V=>{this.transmuxerError(V,d,"transmuxer-interface push error")}):this.handleTransmuxComplete(q)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const r=n.flush(e);rl(r)?r.then(o=>{this.handleFlushResult(o,e)}).catch(o=>{this.transmuxerError(o,e,"transmuxer-interface flush error")}):this.handleFlushResult(r,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const rb=100;class a$ extends Lp{constructor(e,t,n){super(e,t,n,"audio-stream-controller",xe.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(L.BUFFER_RESET,this.onBufferReset,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(L.BUFFER_RESET,this.onBufferReset,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:o,trackId:l}){if(n===xe.MAIN){const c=t.cc,f=this.fragCurrent;if(this.initPTS[c]={baseTime:r,timescale:o,trackId:l},this.log(`InitPTS for cc: ${c} found from main: ${r/o} (${r}/${o}) trackId: ${l}`),this.mainAnchor=t,this.state===ce.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==c)&&this.syncWithAnchor(t,d?.frag)}else!this.hls.hasEnoughToStart&&f&&f.cc!==c?(f.abortRequests(),this.syncWithAnchor(t,f)):this.state===ce.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var n;const r=((n=this.mainFragLoading)==null?void 0:n.frag)||null;if(t&&r?.cc===t.cc)return;const o=(r||e).cc,l=this.getLevelDetails(),c=this.getLoadPosition(),f=OR(l,o,c);f&&(this.log(`Syncing with main frag at ${f.start} cc ${f.cc}`),this.startFragRequested=!1,this.nextLoadPosition=f.start,this.resetLoadingState(),this.state===ce.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=ce.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(rb),n>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=ce.IDLE):this.state=ce.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case ce.IDLE:this.doTickIdle();break;case ce.WAITING_TRACK:{const{levels:e,trackId:t}=this,n=e?.[t],r=n?.details;if(r&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(r))break;this.state=ce.WAITING_INIT_PTS}break}case ce.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case ce.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:r,complete:o}=e,l=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=ce.FRAG_LOADING;const c=r.flush().buffer,f={frag:t,part:n,payload:c,networkDetails:null};this._handleFragmentLoadProgress(f),o&&super._handleFragmentLoadComplete(f)}else l&&l.cc!==e.frag.cc&&this.syncWithAnchor(l,e.frag)}else this.state=ce.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:r,trackId:o}=this,l=t.config;if(!this.buffering||!r&&!this.primaryPrefetch&&(this.startFragRequested||!l.startFragPrefetch)||!(n!=null&&n[o]))return;const c=n[o],f=c.details;if(!f||this.waitForLive(c)||this.waitForCdnTuneIn(f)){this.state=ce.WAITING_TRACK,this.startFragRequested=!1;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,ct.AUDIO,xe.AUDIO));const m=this.getFwdBufferInfo(d,xe.AUDIO);if(m===null)return;if(!this.switchingTrack&&this._streamEnded(m,f)){t.trigger(L.BUFFER_EOS,{type:"audio"}),this.state=ce.ENDED;return}const g=m.len,p=t.maxBufferLength,E=f.fragments,v=E[0].start,S=this.getLoadPosition(),b=this.flushing?S:m.end;if(this.switchingTrack&&r){const _=S;f.PTSKnown&&_<v&&(m.end>v||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=v+.05)}if(g>=p&&!this.switchingTrack&&b<E[E.length-1].start)return;let R=this.getNextFragment(b,f);if(R&&this.isLoopLoading(R,b)&&(R=this.getNextFragmentLoopLoading(R,f,m,xe.MAIN,p)),!R){this.bufferFlushed=!0;return}let C=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&C&&Lt(R)&&!R.endList&&(!f.live||!this.loadingParts&&b<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(C)===Ut.OK&&(this.mainFragLoading=C=null),C&&Lt(C))){if(R.start>C.end){const D=this.fragmentTracker.getFragAtPos(b,xe.MAIN);D&&D.end>C.end&&(C=D,this.mainFragLoading={frag:D,targetBufferTime:null})}if(R.start>C.end)return}this.loadFragment(R,c,b)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new nl(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==ce.STOPPED&&(this.setInterval(rb),this.state=ce.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(L.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:r}=this,{details:o,id:l,groupId:c,track:f}=t;if(!r){this.warn(`Audio tracks reset while loading track ${l} "${f.name}" of "${c}"`);return}const d=this.mainDetails;if(!d||o.endCC>d.endCC||d.expired){this.cachedTrackLoadedData=t,this.state!==ce.STOPPED&&(this.state=ce.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${l} "${f.name}" of "${c}" loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`);const m=r[l];let g=0;if(o.live||(n=m.details)!=null&&n.live){if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;if(m.details){var p;g=this.alignPlaylists(o,m.details,(p=this.levelLastLoaded)==null?void 0:p.details)}o.alignedSliding||(XR(o,d),o.alignedSliding||Yu(o,d),g=o.fragmentStart)}m.details=o,this.levelLastLoaded=m,this.startFragRequested||this.setStartPosition(d,g),this.hls.trigger(L.AUDIO_TRACK_UPDATED,{details:o,id:l,groupId:t.groupId}),this.state===ce.WAITING_TRACK&&!this.waitForCdnTuneIn(o)&&(this.state=ce.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:r,payload:o}=e,{config:l,trackId:c,levels:f}=this;if(!f){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const d=f[c];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const m=d.details;if(!m){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const g=l.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let p=this.transmuxer;p||(p=this.transmuxer=new pw(this.hls,xe.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const E=this.initPTS[n.cc],v=(t=n.initSegment)==null?void 0:t.data;if(E!==void 0){const b=r?r.index:-1,R=b!==-1,C=new Ap(n.level,n.sn,n.stats.chunkCount,o.byteLength,b,R);p.push(o,v,g,"",n,r,m.totalduration,!1,C,E)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${m.startSN} ,${m.endSN}],track ${c}`);const{cache:S}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new QR,complete:!1};S.push(new Uint8Array(o)),this.state!==ce.STOPPED&&(this.state=ce.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===xe.MAIN&&Lt(t.frag)&&(this.mainFragLoading=t,this.state===ce.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type!==xe.AUDIO){!this.audioOnly&&n.type===xe.MAIN&&!n.elementaryStreams.video&&!n.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Lt(n)){this.fragPrevious=n;const o=this.switchingTrack;o&&(this.bufferedTrack=o,this.switchingTrack=null,this.hls.trigger(L.AUDIO_TRACK_SWITCHED,tt({},o)))}this.fragBufferedComplete(n,r),this.media&&this.tick()}onError(e,t){var n;if(t.fatal){this.state=ce.ERROR;return}switch(t.details){case W.FRAG_GAP:case W.FRAG_PARSING_ERROR:case W.FRAG_DECRYPT_ERROR:case W.FRAG_LOAD_ERROR:case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_ERROR:case W.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(xe.AUDIO,t);break;case W.AUDIO_TRACK_LOAD_ERROR:case W.AUDIO_TRACK_LOAD_TIMEOUT:case W.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ce.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===je.AUDIO_TRACK&&(this.state=ce.IDLE);break;case W.BUFFER_ADD_CODEC_ERROR:case W.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case W.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case W.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==ct.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==ct.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ce.ENDED&&(this.state=ce.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,xe.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:o,chunkMeta:l}=e,c=this.getCurrentContext(l);if(!c){this.resetWhenMissingContext(l);return}const{frag:f,part:d,level:m}=c,{details:g}=m,{audio:p,text:E,id3:v,initSegment:S}=o;if(this.fragContextChanged(f)||!g){this.fragmentTracker.removeFragment(f);return}if(this.state=ce.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),S!=null&&S.tracks){const b=f.initSegment||f;if(this.unhandledEncryptionError(S,f))return;this._bufferInitSegment(m,S.tracks,b,l),r.trigger(L.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:n,tracks:S.tracks})}if(p){const{startPTS:b,endPTS:R,startDTS:C,endDTS:_}=p;d&&(d.elementaryStreams[ct.AUDIO]={startPTS:b,endPTS:R,startDTS:C,endDTS:_}),f.setElementaryStreamInfo(ct.AUDIO,b,R,C,_),this.bufferFragmentData(p,f,d,l)}if(v!=null&&(t=v.samples)!=null&&t.length){const b=at({id:n,frag:f,details:g},v);r.trigger(L.FRAG_PARSING_METADATA,b)}if(E){const b=at({id:n,frag:f,details:g},E);r.trigger(L.FRAG_PARSING_USERDATA,b)}}_bufferInitSegment(e,t,n,r){if(this.state!==ce.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const o=t.audio;o.id=xe.AUDIO;const l=e.audioCodec;this.log(`Init audio buffer, container:${o.container}, codecs[level/parsed]=[${l}/${o.codec}]`),l&&l.split(",").length===1&&(o.levelCodec=l),this.hls.trigger(L.BUFFER_CODECS,t);const c=o.initSegment;if(c!=null&&c.byteLength){const f={type:"audio",frag:n,part:null,chunkMeta:r,parent:n.type,data:c};this.hls.trigger(L.BUFFER_APPENDING,f)}this.tickImmediate()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);if(this.switchingTrack||r===Ut.NOT_LOADED||r===Ut.PARTIAL){var o;if(!Lt(e))this._loadInitSegment(e,t);else if((o=t.details)!=null&&o.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ce.WAITING_INIT_PTS;const l=this.mainDetails;l&&l.fragmentStart!==t.details.fragmentStart&&Yu(t.details,l)}else super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:r,characteristics:o,audioCodec:l,channels:c}=this.bufferedTrack;Er({name:t,lang:n,assocLang:r,characteristics:o,audioCodec:l,channels:c},e,pr)||(Hu(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(L.AUDIO_TRACK_SWITCHED,tt({},e))}}class Mp extends Wn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const r=t?.renditionReports;if(r){let o=-1;for(let l=0;l<r.length;l++){const c=r[l];let f;try{f=new self.URL(c.URI,t.url).href}catch(d){this.warn(`Could not construct new URL for Rendition Report: ${d}`),f=c.URI||""}if(f===e){o=l;break}else f===e.substring(0,f.length)&&(o=l)}if(o!==-1){const l=r[o],c=parseInt(l["LAST-MSN"])||t.lastPartSn;let f=parseInt(l["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const m=Math.min(t.age-t.partTarget,t.targetduration);f>=0&&m>t.partTarget&&(f+=1)}const d=n&&ES(n);return new SS(c,f>=0?f:void 0,d)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:r,stats:o}=t,l=self.performance.now(),c=o.loading.first?Math.max(0,l-o.loading.first):0;r.advancedDateTime=Date.now()-c;const f=this.hls.config.timelineOffset;if(f!==r.appliedTimelineOffset){const m=Math.max(f||0,0);r.appliedTimelineOffset=m,r.fragments.forEach(g=>{g.setStart(g.playlistOffset+m)})}if(r.live||n!=null&&n.live){const m="levelInfo"in t?t.levelInfo:t.track;if(r.reloaded(n),n&&r.fragments.length>0){ZB(n,r,this);const C=r.playlistParsingError;if(C){this.warn(C);const _=this.hls;if(!_.config.ignorePlaylistParsingErrors){var d;const{networkDetails:D}=t;_.trigger(L.ERROR,{type:Ae.NETWORK_ERROR,details:W.LEVEL_PARSING_ERROR,fatal:!1,url:r.url,error:C,reason:C.message,level:t.level||void 0,parent:(d=r.fragments[0])==null?void 0:d.type,networkDetails:D,stats:o});return}r.playlistParsingError=null}}r.requestScheduled===-1&&(r.requestScheduled=o.loading.start);const g=this.hls.mainForwardBufferInfo,p=g?g.end-g.len:0,E=(r.edge-p)*1e3,v=VR(r,E);if(r.requestScheduled+v<l?r.requestScheduled=l:r.requestScheduled+=v,this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),!this.canLoad||!r.live)return;let S,b,R;if(r.canBlockReload&&r.endSN&&r.advanced){const C=this.hls.config.lowLatencyMode,_=r.lastPartSn,D=r.endSN,N=r.lastPartIndex,B=N!==-1,I=_===D;B?I?(b=D+1,R=C?0:N):(b=_,R=C?N+1:r.maxPartIndex):b=D+1;const P=r.age,M=P+r.ageHeader;let U=Math.min(M-r.partTarget,r.targetduration*1.5);if(U>0){if(M>r.targetduration*3)this.log(`Playlist last advanced ${P.toFixed(2)}s ago. Omitting segment and part directives.`),b=void 0,R=void 0;else if(n!=null&&n.tuneInGoal&&M-r.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${U} with playlist age: ${r.age}`),U=0;else{const q=Math.floor(U/r.targetduration);if(b+=q,R!==void 0){const V=Math.round(U%r.targetduration/r.partTarget);R+=V}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${P.toFixed(2)}s goal: ${U} skip sn ${q} to part ${R}`)}r.tuneInGoal=U}if(S=this.getDeliveryDirectives(r,t.deliveryDirectives,b,R),C||!I){r.requestScheduled=l,this.loadingPlaylist(m,S);return}}else(r.canBlockReload||r.canSkipUntil)&&(S=this.getDeliveryDirectives(r,t.deliveryDirectives,b,R));S&&b!==void 0&&r.canBlockReload&&(r.requestScheduled=o.loading.first+Math.max(v-c*2,v/2)),this.scheduleLoading(m,S,r)}else this.clearTimer()}scheduleLoading(e,t,n){const r=n||e.details;if(!r){this.loadingPlaylist(e,t);return}const o=self.performance.now(),l=r.requestScheduled;if(o>=l){this.loadingPlaylist(e,t);return}const c=l-o;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(c)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),c)}getDeliveryDirectives(e,t,n,r){let o=ES(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,o=Su.No),new SS(n,r,o)}checkRetry(e){const t=e.details,n=zu(e),r=e.errorAction,{action:o,retryCount:l=0,retryConfig:c}=r||{},f=!!r&&!!c&&(o===Xt.RetryRequest||!r.resolved&&o===Xt.SendAlternateToPenaltyBox);if(f){var d;if(l>=c.maxNumRetry)return!1;if(n&&(d=e.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${l+1}/${c.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const m=bp(c,l);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),m),this.warn(`Retrying playlist loading ${l+1}/${c.maxNumRetry} after "${t}" in ${m}ms`)}e.levelRetry=!0,r.resolved=!0}return f}}function yw(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!al(s[t].attrs,e[t].attrs))return!1;return!0}function al(s,e,t){const n=s["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>s[r]!==e[r])}function Sg(s,e){return e.label.toLowerCase()===s.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(s.lang||"").toLowerCase())}class o$ extends Mp{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(L.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:o}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==r){this.warn(`Audio track with id:${n} and group:${r} not found in active group ${l?.groupId}`);return}const c=l.details;l.details=t.details,this.log(`Audio track ${n} "${l.name}" lang:${l.lang} group:${r} loaded [${o.startSN}-${o.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,r=this.groupIds;let o=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(c=>r?.indexOf(c)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(p=>!n||n.indexOf(p.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(p=>p.default)&&(this.selectDefaultTrack=!1),c.forEach((p,E)=>{p.id=E});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const f=this.hls.config.audioPreference;if(!o&&f){const p=Ss(f,c,pr);if(p>-1)o=c[p];else{const E=Ss(f,this.tracks);o=this.tracks[E]}}let d=this.findTrackId(o);d===-1&&o&&(d=this.findTrackId(null));const m={audioTracks:c};this.log(`Updating audio tracks, ${c.length} track(s) found in group(s): ${n?.join(",")}`),this.hls.trigger(L.AUDIO_TRACKS_UPDATED,m);const g=this.trackId;if(d!==-1&&g===-1)this.setAudioTrack(d);else if(c.length&&g===-1){var l;const p=new Error(`No audio track selected for current audio group-ID(s): ${(l=this.groupIds)==null?void 0:l.join(",")} track count: ${c.length}`);this.warn(p.message),this.hls.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:p})}}}onError(e,t){t.fatal||!t.context||t.context.type===je.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const r=this.currentTrack;if(r&&Er(e,r,pr))return r;const o=Ss(e,this.tracksInGroup,pr);if(o>-1){const l=this.tracksInGroup[o];return this.setAudioTrack(o),l}else if(r){let l=t.loadLevel;l===-1&&(l=t.firstAutoLevel);const c=xB(e,t.levels,n,l,pr);if(c===-1)return null;t.nextLoadLevel=c}if(e.channels||e.audioCodec){const l=Ss(e,n);if(l>-1)return n[l]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e],o=r.details&&!r.details.live;if(e===this.trackId&&r===n&&o||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(L.AUDIO_TRACK_SWITCHING,tt({},r)),o))return;const l=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(l)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(!(this.selectDefaultTrack&&!r.default)&&(!e||Er(e,r,pr)))return n}if(e){const{name:n,lang:r,assocLang:o,characteristics:l,audioCodec:c,channels:f}=e;for(let d=0;d<t.length;d++){const m=t[d];if(Er({name:n,lang:r,assocLang:o,characteristics:l,audioCodec:c,channels:f},m,pr))return d}for(let d=0;d<t.length;d++){const m=t[d];if(al(e.attrs,m.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<t.length;d++){const m=t[d];if(al(e.attrs,m.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Hu(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,r=e.groupId,o=this.getUrlWithDirectives(e.url,t),l=e.details,c=l?.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${c&&l.live?" age "+c.toFixed(1)+(l.type&&" "+l.type||""):""} ${o}`),this.hls.trigger(L.AUDIO_TRACK_LOADING,{url:o,id:n,groupId:r,deliveryDirectives:t||null,track:e})}}class l${constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(this.queues===null||this.tracks===null)return;const r=this.queues[t];r.push(e),r.length===1&&!n&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=(t=e[0])==null?void 0:t.label;(n==="async-blocker"||n==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(o){var n;if(r.onError(o),this.queues===null||this.tracks===null)return;const l=(n=this.tracks[e])==null?void 0:n.buffer;l!=null&&l.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,n;return(t=this.queues)!=null&&t[e]||(n=this.tracks)!=null&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=(t=this.tracks)==null?void 0:t[e],r=n?.buffer;return r?`SourceBuffer${r.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(n=>n.label).join(", "))||""}}const ab=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,vw="HlsJsTrackRemovedError";class c$ extends Error{constructor(e){super(e),this.name=vw}}class u$ extends Wn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=n=>{var r;this.hls&&((r=this.mediaSource)==null?void 0:r.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=n=>{const{media:r,mediaSource:o}=this;n&&this.log("Media source opened"),!(!r||!o)&&(o.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(L.MEDIA_ATTACHED,{media:r,mediaSource:o}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:r}=this;n!==r&&this.error(`Media element src was set while attaching MediaSource (${r} > ${n})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=OU(zi(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.BUFFER_RESET,this.onBufferReset,this),e.on(L.BUFFER_APPENDING,this.onBufferAppending,this),e.on(L.BUFFER_CODECS,this.onBufferCodecs,this),e.on(L.BUFFER_EOS,this.onBufferEos,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.FRAG_PARSED,this.onFragParsed,this),e.on(L.FRAG_CHANGED,this.onFragChanged,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.BUFFER_RESET,this.onBufferReset,this),e.off(L.BUFFER_APPENDING,this.onBufferAppending,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.BUFFER_EOS,this.onBufferEos,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.FRAG_PARSED,this.onFragParsed,this),e.off(L.FRAG_CHANGED,this.onFragChanged,this),e.off(L.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const o=this.isUpdating();o||this.operationQueue.removeBlockers();const l=this.isQueued();(o||l)&&this.warn(`Transfering MediaSource with${l?" operations in queue":""}${o?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const r=this.transferData;return!this.sourceBufferCount&&r&&r.mediaSource===t?at(n,r.tracks):this.sourceBuffers.forEach(o=>{const[l]=o;l&&(n[l]=at({},this.tracks[l]),this.removeBuffer(l)),o[0]=o[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsTotal=r,this.log(`${r} bufferCodec event(s) expected.`),(n=this.transferData)!=null&&n.mediaSource&&this.sourceBufferCount&&r&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media;this.transferData=this.overrides=void 0;const r=zi(this.appendSource);if(r){const o=!!t.mediaSource;(o||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const l=this.mediaSource=t.mediaSource||new r;if(this.assignMediaSource(l),o)this._objectUrl=n.src,this.attachTransferred();else{const c=this._objectUrl=self.URL.createObjectURL(l);if(this.appendSource)try{n.removeAttribute("src");const f=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||f&&l instanceof f,ob(n),d$(n,c),n.load()}catch{n.src=c}else n.src=c}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(n=e.constructor)==null?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,r=t.tracks,o=r?Object.keys(r):null,l=o?o.length:0,c=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(r&&o&&l){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${ut(n,(f,d)=>f==="initSegment"?void 0:d)};
transfer tracks: ${ut(r,(f,d)=>f==="initSegment"?void 0:d)}}`),!mR(r,n)){t.mediaSource=null,t.tracks=void 0;const f=e.currentTime,d=this.details,m=Math.max(f,d?.fragments[0].start||0);if(m-f>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${f} -> ${m}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(r)}"->"${Object.keys(n)}") start time: ${m} currentTime: ${f}`),this.onMediaDetaching(L.MEDIA_DETACHING,{}),this.onMediaAttaching(L.MEDIA_ATTACHING,t),e.currentTime=m;return}this.transferData=void 0,o.forEach(f=>{const d=f,m=r[d];if(m){const g=m.buffer;if(g){const p=this.fragmentTracker,E=m.id;if(p.hasFragments(E)||p.hasParts(E)){const b=Ie.getBuffered(g);p.detectEvictedFragments(d,b,E,null,!0)}const v=wm(d),S=[d,g];this.sourceBuffers[v]=S,g.updating&&this.operationQueue&&this.operationQueue.prependBlocker(d),this.trackSourceBuffer(d,m)}}}),c(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),c()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:r,mediaSource:o,_objectUrl:l}=this;if(o){if(this.log(`media source ${n?"transferring":"detaching"}`),n)this.sourceBuffers.forEach(([c])=>{c&&this.removeBuffer(c)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const c=o.readyState==="open";try{const f=o.sourceBuffers;for(let d=f.length;d--;)c&&f[d].abort(),o.removeSourceBuffer(f[d]);c&&o.endOfStream()}catch(f){this.warn(`onMediaDetaching: ${f.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}o.removeEventListener("sourceopen",this._onMediaSourceOpen),o.removeEventListener("sourceended",this._onMediaSourceEnded),o.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.removeEventListener("startstreaming",this._onStartStreaming),o.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}r&&(r.removeEventListener("emptied",this._onMediaEmptied),n||(l&&self.URL.revokeObjectURL(l),this.mediaSrc===l?(r.removeAttribute("src"),this.appendSource&&ob(r),r.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(L.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),n)try{var r;(r=this.mediaSource)!=null&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(o){this.warn(`onBufferReset ${e}`,o)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[wm(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new l$(this.tracks)}onBufferCodecs(e,t){var n;const r=this.tracks,o=Object.keys(t);this.log(`BUFFER_CODECS: "${o}" (current SB count ${this.sourceBufferCount})`);const l="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),c=!l&&this.sourceBufferCount&&this.media&&o.some(f=>!r[f]);if(l||c){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${o}" SourceBuffers`);return}o.forEach(f=>{var d,m;const g=t[f],{id:p,codec:E,levelCodec:v,container:S,metadata:b,supplemental:R}=g;let C=r[f];const _=(d=this.transferData)==null||(d=d.tracks)==null?void 0:d[f],D=_!=null&&_.buffer?_:C,N=D?.pendingCodec||D?.codec,B=D?.levelCodec;C||(C=r[f]={buffer:void 0,listeners:[],codec:E,supplemental:R,container:S,levelCodec:v,metadata:b,id:p});const I=Eu(N,B),P=I?.replace(ab,"$1");let M=Eu(E,v);const U=(m=M)==null?void 0:m.replace(ab,"$1");M&&I&&P!==U&&(f.slice(0,5)==="audio"&&(M=ju(M,this.appendSource)),this.log(`switching codec ${N} to ${M}`),M!==(C.pendingCodec||C.codec)&&(C.pendingCodec=M),C.container=S,this.appendChangeType(f,S,M))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((n=t.audio)==null?void 0:n.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const r=`${t};codecs=${n}`,o={label:`change-type=${r}`,execute:()=>{const l=this.tracks[e];if(l){const c=l.buffer;c!=null&&c.changeType&&(this.log(`changing ${e} sourceBuffer type to ${r}`),c.changeType(r),l.codec=n,l.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn(`Failed to change ${e} SourceBuffer type`,l)}};this.append(o,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,r=n+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(n,xe.MAIN))==null?void 0:t.gap)===!0)return;const l={label:"block-audio",execute:()=>{var c;const f=this.tracks.video;(this.lastVideoAppendEnd>r||f!=null&&f.buffer&&Ie.isBuffered(f.buffer,r)||((c=this.fragmentTracker.getAppendedFrag(r,xe.MAIN))==null?void 0:c.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:c=>{this.warn("Error executing block-audio operation",c)}};this.blockedAudioAppend={op:l,frag:e},this.append(l,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:r,type:o,parent:l,frag:c,part:f,chunkMeta:d,offset:m}=t,g=d.buffering[o],{sn:p,cc:E}=c,v=self.performance.now();g.start=v;const S=c.stats.buffering,b=f?f.stats.buffering:null;S.start===0&&(S.start=v),b&&b.start===0&&(b.start=v);const R=n.audio;let C=!1;o==="audio"&&R?.container==="audio/mpeg"&&(C=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const _=n.video,D=_?.buffer;if(D&&p!=="initSegment"){const I=f||c,P=this.blockedAudioAppend;if(o==="audio"&&l!=="main"&&!this.blockedAudioAppend&&!(_.ending||_.ended)){const U=I.start+I.duration*.05,q=D.buffered,V=this.currentOp("video");!q.length&&!V?this.blockAudio(I):!V&&!Ie.isBuffered(D,U)&&this.lastVideoAppendEnd<U&&this.blockAudio(I)}else if(o==="video"){const M=I.end;if(P){const U=P.frag.start;(M>U||M<this.lastVideoAppendEnd||Ie.isBuffered(D,U))&&this.unblockAudio()}this.lastVideoAppendEnd=M}}const N=(f||c).start,B={label:`append-${o}`,execute:()=>{var I;g.executeStart=self.performance.now();const P=(I=this.tracks[o])==null?void 0:I.buffer;P&&(C?this.updateTimestampOffset(P,N,.1,o,p,E):m!==void 0&&ve(m)&&this.updateTimestampOffset(P,m,1e-6,o,p,E)),this.appendExecutor(r,o)},onStart:()=>{},onComplete:()=>{const I=self.performance.now();g.executeEnd=g.end=I,S.first===0&&(S.first=I),b&&b.first===0&&(b.first=I);const P={};this.sourceBuffers.forEach(([M,U])=>{M&&(P[M]=Ie.getBuffered(U))}),this.appendErrors[o]=0,o==="audio"||o==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(L.BUFFER_APPENDED,{type:o,frag:c,part:f,chunkMeta:d,parent:c.type,timeRanges:P})},onError:I=>{var P;const M={type:Ae.MEDIA_ERROR,parent:c.type,details:W.BUFFER_APPEND_ERROR,sourceBufferName:o,frag:c,part:f,chunkMeta:d,error:I,err:I,fatal:!1},U=(P=this.media)==null?void 0:P.error;if(I.code===DOMException.QUOTA_EXCEEDED_ERR||I.name=="QuotaExceededError"||"quota"in I)M.details=W.BUFFER_FULL_ERROR;else if(I.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!U)M.errorAction=_a(!0);else if(I.name===vw&&this.sourceBufferCount===0)M.errorAction=_a(!0);else{const q=++this.appendErrors[o];this.warn(`Failed ${q}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${o}" sourceBuffer (${U||"no media error"})`),(q>=this.hls.config.appendErrorMaxRetry||U)&&(M.fatal=!0)}this.hls.trigger(L.ERROR,M)}};this.log(`queuing "${o}" append sn: ${p}${f?" p: "+f.index:""} of ${c.type===xe.MAIN?"level":"track"} ${c.level} cc: ${E}`),this.append(B,o,this.isPending(this.tracks[o]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(L.BUFFER_FLUSHED,{type:e})},onError:r=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,r)}}}onBufferFlushing(e,t){const{type:n,startOffset:r,endOffset:o}=t;n?this.append(this.getFlushOp(n,r,o),n):this.sourceBuffers.forEach(([l])=>{l&&this.append(this.getFlushOp(l,r,o),l)})}onFragParsed(e,t){const{frag:n,part:r}=t,o=[],l=r?r.elementaryStreams:n.elementaryStreams;l[ct.AUDIOVIDEO]?o.push("audiovideo"):(l[ct.AUDIO]&&o.push("audio"),l[ct.VIDEO]&&o.push("video"));const c=()=>{const f=self.performance.now();n.stats.buffering.end=f,r&&(r.stats.buffering.end=f);const d=r?r.stats:n.stats;this.hls.trigger(L.FRAG_BUFFERED,{frag:n,part:r,stats:d,id:n.type})};o.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(c,o).catch(f=>{this.warn(`Fragment buffered callback ${f}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([l])=>{if(l){const c=this.tracks[l];(!t.type||t.type===l)&&(c.ending=!0,c.ended||(c.ended=!0,this.log(`${l} buffer reached EOS`)))}});const r=((n=this.overrides)==null?void 0:n.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([l])=>{var c;return l&&!((c=this.tracks[l])!=null&&c.ended)})?r?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:l}=this;if(!l||l.readyState!=="open"){l&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${l.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),l.endOfStream(),this.hls.trigger(L.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(L.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===W.BUFFER_APPEND_ERROR&&t.frag){var n;const r=(n=t.errorAction)==null?void 0:n.nextAutoLevel;ve(r)&&r!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.sourceBufferCount)return;const r=e.config,o=n.currentTime,l=t.levelTargetDuration,c=t.live&&r.liveBackBufferLength!==null?r.liveBackBufferLength:r.backBufferLength;if(ve(c)&&c>=0){const d=Math.max(c,l),m=Math.floor(o/l)*l-d;this.flushBackBuffer(o,l,m)}const f=r.frontBufferFlushThreshold;if(ve(f)&&f>0){const d=Math.max(r.maxBufferLength,f),m=Math.max(d,l),g=Math.floor(o/l)*l+m;this.flushFrontBuffer(o,l,g)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([r,o])=>{if(o){const c=Ie.getBuffered(o);if(c.length>0&&n>c.start(0)){var l;this.hls.trigger(L.BACK_BUFFER_REACHED,{bufferEnd:n});const f=this.tracks[r];if((l=this.details)!=null&&l.live)this.hls.trigger(L.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(f!=null&&f.ended){this.log(`Cannot flush ${r} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:r})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([r,o])=>{if(o){const l=Ie.getBuffered(o),c=l.length;if(c<2)return;const f=l.start(c-1),d=l.end(c-1);if(n>f||e>=f&&e<=d)return;this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:f,endOffset:1/0,type:r})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||n?.readyState!=="open")return null;const r=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&n.setLiveSeekableRange){const d=Math.max(0,t.fragmentStart),m=Math.max(d,r);return{duration:1/0,start:d,end:m}}return{duration:1/0}}const o=(e=this.overrides)==null?void 0:e.duration;if(o)return ve(o)?{duration:o}:null;const l=this.media.duration,c=ve(n.duration)?n.duration:0;return r>c&&r>l||!ve(l)?{duration:r}:null}updateMediaSource({duration:e,start:t,end:n}){const r=this.mediaSource;!this.media||!r||r.readyState!=="open"||(r.duration!==e&&(ve(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),t!==void 0&&n!==void 0&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${t}-${n}.`),r.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${ut(n)}`),this.tracksReady){var r;const o=(r=this.transferData)==null?void 0:r.tracks;o&&Object.keys(o).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const r=this.tracks[t];e[t]={buffer:n,container:r.container,codec:r.codec,supplemental:r.supplemental,levelCodec:r.levelCodec,id:r.id,metadata:r.metadata}}}),this.hls.trigger(L.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const o in e){const l=o,c=e[l];if(this.isPending(c)){const f=this.getTrackCodec(c,l),d=`${c.container};codecs=${f}`;c.codec=f,this.log(`creating sourceBuffer(${d})${this.currentOp(l)?" Queued":""} ${ut(c)}`);try{const m=n.addSourceBuffer(d),g=wm(l),p=[l,m];t[g]=p,c.buffer=m}catch(m){var r;this.error(`error while trying to add sourceBuffer: ${m.message}`),this.shiftAndExecuteNext(l),(r=this.operationQueue)==null||r.removeBlockers(),delete this.tracks[l],this.hls.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:m,sourceBufferName:l,mimeType:d,parent:c.id});return}this.trackSourceBuffer(l,c)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let r=e.codec;n&&(t==="video"||t==="audiovideo")&&el(n,"video")&&(r=eB(r,n));const o=Eu(r,e.levelCodec);return o?t.slice(0,5)==="audio"?ju(o,this.appendSource):o:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const r=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:r,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(o,l)=>{const c=l.removedRanges;c!=null&&c.length&&this.hls.trigger(L.BUFFER_FLUSHED,{type:o})})}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n?.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${r}`,t),this.hls.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const o=this.currentOp(e);o&&o.onError(r)}updateTimestampOffset(e,t,n,r,o,l){const c=t-e.timestampOffset;Math.abs(c)>=n&&(this.log(`Updating ${r} SourceBuffer timestampOffset to ${t} (sn: ${o} cc: ${l})`),e.timestampOffset=t)}removeExecutor(e,t,n){const{media:r,mediaSource:o}=this,l=this.tracks[e],c=l?.buffer;if(!r||!o||!c){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const f=ve(r.duration)?r.duration:1/0,d=ve(o.duration)?o.duration:1/0,m=Math.max(0,t),g=Math.min(n,f,d);g>m&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${m},${g}] from the ${e} SourceBuffer`),c.remove(m,g)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],r=n?.buffer;if(!r)throw new c$(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,r.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,r=t.map(l=>this.appendBlocker(l));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(r).then(l=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var n;const r=(n=this.tracks[t])==null?void 0:n.buffer;!r||r.updating||this.shiftAndExecuteNext(t)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const r=this.tracks[e];if(!r)return;const o=r.buffer;if(!o)return;const l=n.bind(this,e);r.listeners.push({event:t,listener:l}),o.addEventListener(t,l)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(r=>{n.removeEventListener(r.event,r.listener)}),t.listeners.length=0)}}function ob(s){const e=s.querySelectorAll("source");[].slice.call(e).forEach(t=>{s.removeChild(t)})}function d$(s,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,s.appendChild(t)}function wm(s){return s==="audio"?1:0}class Pp{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(L.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.BUFFER_CODECS,this.onBufferCodecs,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(L.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&ve(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((r,o)=>this.isLevelAllowed(r)&&o<=e);return this.clientRect=null,Pp.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const r=(c,f)=>f?c.width!==f.width||c.height!==f.height:!0;let o=e.length-1;const l=Math.max(t,n);for(let c=0;c<e.length;c+=1){const f=e[c];if((f.width>=l||f.height>=l)&&r(f,e[c+1])){o=c;break}}return o}}const f$={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},mn=f$,h$={HLS:"h"},m$=h$;class Rs{constructor(e,t){Array.isArray(e)&&(e=e.map(n=>n instanceof Rs?n:new Rs(n))),this.value=e,this.params=t}}const g$="Dict";function p$(s){return Array.isArray(s)?JSON.stringify(s):s instanceof Map?"Map{}":s instanceof Set?"Set{}":typeof s=="object"?JSON.stringify(s):String(s)}function y$(s,e,t,n){return new Error(`failed to ${s} "${p$(e)}" as ${t}`,{cause:n})}function ws(s,e,t){return y$("serialize",s,e,t)}class xw{constructor(e){this.description=e}}const lb="Bare Item",v$="Boolean";function x$(s){if(typeof s!="boolean")throw ws(s,v$);return s?"?1":"?0"}function E$(s){return btoa(String.fromCharCode(...s))}const S$="Byte Sequence";function b$(s){if(ArrayBuffer.isView(s)===!1)throw ws(s,S$);return`:${E$(s)}:`}const T$="Integer";function A$(s){return s<-999999999999999||999999999999999<s}function Ew(s){if(A$(s))throw ws(s,T$);return s.toString()}function R$(s){return`@${Ew(s.getTime()/1e3)}`}function Sw(s,e){if(s<0)return-Sw(-s,e);const t=Math.pow(10,e);if(Math.abs(s*t%1-.5)<Number.EPSILON){const r=Math.floor(s*t);return(r%2===0?r:r+1)/t}else return Math.round(s*t)/t}const w$="Decimal";function L$(s){const e=Sw(s,3);if(Math.floor(Math.abs(e)).toString().length>12)throw ws(s,w$);const t=e.toString();return t.includes(".")?t:`${t}.0`}const C$="String",_$=/[\x00-\x1f\x7f]+/;function D$(s){if(_$.test(s))throw ws(s,C$);return`"${s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function I$(s){return s.description||s.toString().slice(7,-1)}const O$="Token";function cb(s){const e=I$(s);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw ws(e,O$);return e}function bg(s){switch(typeof s){case"number":if(!ve(s))throw ws(s,lb);return Number.isInteger(s)?Ew(s):L$(s);case"string":return D$(s);case"symbol":return cb(s);case"boolean":return x$(s);case"object":if(s instanceof Date)return R$(s);if(s instanceof Uint8Array)return b$(s);if(s instanceof xw)return cb(s);default:throw ws(s,lb)}}const N$="Key";function Tg(s){if(/^[a-z*][a-z0-9\-_.*]*$/.test(s)===!1)throw ws(s,N$);return s}function Fp(s){return s==null?"":Object.entries(s).map(([e,t])=>t===!0?`;${Tg(e)}`:`;${Tg(e)}=${bg(t)}`).join("")}function bw(s){return s instanceof Rs?`${bg(s.value)}${Fp(s.params)}`:bg(s)}function k$(s){return`(${s.value.map(bw).join(" ")})${Fp(s.params)}`}function M$(s,e={whitespace:!0}){if(typeof s!="object"||s==null)throw ws(s,g$);const t=s instanceof Map?s.entries():Object.entries(s),n=e?.whitespace?" ":"";return Array.from(t).map(([r,o])=>{o instanceof Rs||(o=new Rs(o));let l=Tg(r);return o.value===!0?l+=Fp(o.params):(l+="=",Array.isArray(o.value)?l+=k$(o):l+=bw(o)),l}).join(`,${n}`)}function Tw(s,e){return M$(s,e)}const gs="CMCD-Object",bt="CMCD-Request",mr="CMCD-Session",Pi="CMCD-Status",P$={br:gs,ab:gs,d:gs,ot:gs,tb:gs,tpb:gs,lb:gs,tab:gs,lab:gs,url:gs,pb:bt,bl:bt,tbl:bt,dl:bt,ltc:bt,mtp:bt,nor:bt,nrr:bt,rc:bt,sn:bt,sta:bt,su:bt,ttfb:bt,ttfbb:bt,ttlb:bt,cmsdd:bt,cmsds:bt,smrt:bt,df:bt,cs:bt,ts:bt,cid:mr,pr:mr,sf:mr,sid:mr,st:mr,v:mr,msd:mr,bs:Pi,bsd:Pi,cdn:Pi,rtp:Pi,bg:Pi,pt:Pi,ec:Pi,e:Pi},F$={REQUEST:bt};function U$(s){return Object.keys(s).reduce((e,t)=>{var n;return(n=s[t])===null||n===void 0||n.forEach(r=>e[r]=t),e},{})}function B$(s,e){const t={};if(!s)return t;const n=Object.keys(s),r=e?U$(e):{};return n.reduce((o,l)=>{var c;const f=P$[l]||r[l]||F$.REQUEST,d=(c=o[f])!==null&&c!==void 0?c:o[f]={};return d[l]=s[l],o},t)}function $$(s){return["ot","sf","st","e","sta"].includes(s)}function j$(s){return typeof s=="number"?ve(s):s!=null&&s!==""&&s!==!1}const Aw="event";function G$(s,e){const t=new URL(s),n=new URL(e);if(t.origin!==n.origin)return s;const r=t.pathname.split("/").slice(1),o=n.pathname.split("/").slice(1,-1);for(;r[0]===o[0];)r.shift(),o.shift();for(;o.length;)o.shift(),r.unshift("..");return r.join("/")+t.search+t.hash}const Ru=s=>Math.round(s),Ag=(s,e)=>Array.isArray(s)?s.map(t=>Ag(t,e)):s instanceof Rs&&typeof s.value=="string"?new Rs(Ag(s.value,e),s.params):(e.baseUrl&&(s=G$(s,e.baseUrl)),e.version===1?encodeURIComponent(s):s),eu=s=>Ru(s/100)*100,H$=(s,e)=>{let t=s;return e.version>=2&&(s instanceof Rs&&typeof s.value=="string"?t=new Rs([s]):typeof s=="string"&&(t=[s])),Ag(t,e)},z$={br:Ru,d:Ru,bl:eu,dl:eu,mtp:eu,nor:H$,rtp:eu,tb:Ru},Rw="request",ww="response",Up=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],V$=["e"],K$=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Td(s){return K$.test(s)}function q$(s){return Up.includes(s)||V$.includes(s)||Td(s)}const Lw=["d","dl","nor","ot","rtp","su"];function Y$(s){return Up.includes(s)||Lw.includes(s)||Td(s)}const W$=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function X$(s){return Up.includes(s)||Lw.includes(s)||W$.includes(s)||Td(s)}const Q$=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function Z$(s){return Q$.includes(s)||Td(s)}const J$={[ww]:X$,[Aw]:q$,[Rw]:Y$};function Cw(s,e={}){const t={};if(s==null||typeof s!="object")return t;const n=e.version||s.v||1,r=e.reportingMode||Rw,o=n===1?Z$:J$[r];let l=Object.keys(s).filter(o);const c=e.filter;typeof c=="function"&&(l=l.filter(c));const f=r===ww||r===Aw;f&&!l.includes("ts")&&l.push("ts"),n>1&&!l.includes("v")&&l.push("v");const d=at({},z$,e.formatters),m={version:n,reportingMode:r,baseUrl:e.baseUrl};return l.sort().forEach(g=>{let p=s[g];const E=d[g];if(typeof E=="function"&&(p=E(p,m)),g==="v"){if(n===1)return;p=n}g=="pr"&&p===1||(f&&g==="ts"&&!ve(p)&&(p=Date.now()),j$(p)&&($$(g)&&typeof p=="string"&&(p=new xw(p)),t[g]=p))}),t}function e4(s,e={}){const t={};if(!s)return t;const n=Cw(s,e),r=B$(n,e?.customHeaderMap);return Object.entries(r).reduce((o,[l,c])=>{const f=Tw(c,{whitespace:!1});return f&&(o[l]=f),o},t)}function t4(s,e,t){return at(s,e4(e,t))}const n4="CMCD";function s4(s,e={}){return s?Tw(Cw(s,e),{whitespace:!1}):""}function i4(s,e={}){if(!s)return"";const t=s4(s,e);return encodeURIComponent(t)}function r4(s,e={}){if(!s)return"";const t=i4(s,e);return`${n4}=${t}`}const ub=/CMCD=[^&#]+/;function a4(s,e,t){const n=r4(e,t);if(!n)return s;if(ub.test(s))return s.replace(ub,n);const r=s.includes("?")?"&":"?";return`${s}${r}${n}`}class o4{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:mn.MANIFEST,su:!this.initialized})}catch(o){this.hls.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=r=>{try{const{frag:o,part:l}=r,c=this.hls.levels[o.level],f=this.getObjectType(o),d={d:(l||o).duration*1e3,ot:f};(f===mn.VIDEO||f===mn.AUDIO||f==mn.MUXED)&&(d.br=c.bitrate/1e3,d.tb=this.getTopBandwidth(f)/1e3,d.bl=this.getBufferLength(f));const m=l?this.getNextPart(l):this.getNextFrag(o);m!=null&&m.url&&m.url!==o.url&&(d.nor=m.url),this.apply(r,d)}catch(o){this.hls.logger.warn("Could not generate segment CMCD data.",o)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHED,this.onMediaDetached,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHED,this.onMediaDetached,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:m$.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){at(t,this.createData());const n=t.ot===mn.INIT||t.ot===mn.VIDEO||t.ot===mn.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((l,c)=>(r.includes(c)&&(l[c]=t[c]),l),{}));const o={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),t4(e.headers,t,o)):e.url=a4(e.url,t,o)}getNextFrag(e){var t;const n=(t=this.hls.levels[e.level])==null?void 0:t.details;if(n){const r=e.sn-n.startSN;return n.fragments[r+1]}}getNextPart(e){var t;const{index:n,fragment:r}=e,o=(t=this.hls.levels[r.level])==null||(t=t.details)==null?void 0:t.partList;if(o){const{sn:l}=r;for(let c=o.length-1;c>=0;c--){const f=o[c];if(f.index===n&&f.fragment.sn===l)return o[c+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return mn.TIMED_TEXT;if(e.sn==="initSegment")return mn.INIT;if(t==="audio")return mn.AUDIO;if(t==="main")return this.hls.audioTracks.length?mn.VIDEO:mn.MUXED}getTopBandwidth(e){let t=0,n;const r=this.hls;if(e===mn.AUDIO)n=r.audioTracks;else{const o=r.maxAutoLevel,l=o>-1?o+1:r.levels.length;n=r.levels.slice(0,l)}return n.forEach(o=>{o.bitrate>t&&(t=o.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,n=e===mn.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Ie.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new n(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,l,c){t(o),this.loader.load(o,l,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new n(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,l,c){t(o),this.loader.load(o,l,c)}}}}const l4=3e5;class c4 extends Wn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if(n?.action===Xt.SendAlternateToPenaltyBox&&n.flags===Ln.MoveAllAlternatesMatchingHost){const r=this.levels;let o=this._pathwayPriority,l=this.pathwayId;if(t.context){const{groupId:c,pathwayId:f,type:d}=t.context;c&&r?l=this.getPathwayForGroupId(c,d,l):f&&(l=f)}l in this.penalizedPathways||(this.penalizedPathways[l]=performance.now()),!o&&r&&(o=this.pathways()),o&&o.length>1&&(this.updatePathwayPriority(o),n.resolved=this.pathwayId!==l),t.details===W.BUFFER_APPEND_ERROR&&!t.fatal?n.resolved=!0:n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${l} levels: ${r&&r.length} priorities: ${ut(o)} penalized: ${ut(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(o=>{r-n[o]>l4&&delete n[o]});for(let o=0;o<e.length;o++){const l=e[o];if(l in n)continue;if(l===this.pathwayId)return;const c=this.hls.nextLoadLevel,f=this.hls.levels[c];if(t=this.getLevelsForPathway(l),t.length>0){this.log(`Setting Pathway to "${l}"`),this.pathwayId=l,YR(t),this.hls.trigger(L.LEVELS_UPDATED,{levels:t});const d=this.hls.levels[c];f&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==f.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==f.bitrate&&this.log(`Unstable Pathways change from bitrate ${f.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=c);break}}}getPathwayForGroupId(e,t,n){const r=this.getLevelsForPathway(n).concat(this.levels||[]);for(let o=0;o<r.length;o++)if(t===je.AUDIO_TRACK&&r[o].hasAudioGroup(e)||t===je.SUBTITLE_TRACK&&r[o].hasSubtitleGroup(e))return r[o].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach(o=>{const{ID:l,"BASE-ID":c,"URI-REPLACEMENT":f}=o;if(t.some(m=>m.pathwayId===l))return;const d=this.getLevelsForPathway(c).map(m=>{const g=new vt(m.attrs);g["PATHWAY-ID"]=l;const p=g.AUDIO&&`${g.AUDIO}_clone_${l}`,E=g.SUBTITLES&&`${g.SUBTITLES}_clone_${l}`;p&&(n[g.AUDIO]=p,g.AUDIO=p),E&&(r[g.SUBTITLES]=E,g.SUBTITLES=E);const v=_w(m.uri,g["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",f),S=new nl({attrs:g,audioCodec:m.audioCodec,bitrate:m.bitrate,height:m.height,name:m.name,url:v,videoCodec:m.videoCodec,width:m.width});if(m.audioGroups)for(let b=1;b<m.audioGroups.length;b++)S.addGroupId("audio",`${m.audioGroups[b]}_clone_${l}`);if(m.subtitleGroups)for(let b=1;b<m.subtitleGroups.length;b++)S.addGroupId("text",`${m.subtitleGroups[b]}_clone_${l}`);return S});t.push(...d),db(this.audioTracks,n,f,l),db(this.subtitleTracks,r,f,l)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const m=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+m)}const o={responseType:"json",url:r.href},l=t.steeringManifestLoadPolicy.default,c=l.errorRetry||l.timeoutRetry||{},f={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},d={onSuccess:(m,g,p,E)=>{this.log(`Loaded steering manifest: "${r}"`);const v=m.data;if(v?.VERSION!==1){this.log(`Steering VERSION ${v.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=v.TTL;const{"RELOAD-URI":S,"PATHWAY-CLONES":b,"PATHWAY-PRIORITY":R}=v;if(S)try{this.uri=new self.URL(S,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${S}`);return}this.scheduleRefresh(this.uri||p.url),b&&this.clonePathways(b);const C={steeringManifest:v,url:r.toString()};this.hls.trigger(L.STEERING_MANIFEST_LOADED,C),R&&this.updatePathwayPriority(R)},onError:(m,g,p,E)=>{if(this.log(`Error loading steering manifest: ${m.code} ${m.text} (${g.url})`),this.stopLoad(),m.code===410){this.enabled=!1,this.log(`Steering manifest ${g.url} no longer available`);return}let v=this.timeToLoad*1e3;if(m.code===429){const S=this.loader;if(typeof S?.getResponseHeader=="function"){const b=S.getResponseHeader("Retry-After");b&&(v=parseFloat(b)*1e3)}this.log(`Steering manifest ${g.url} rate limited`);return}this.scheduleRefresh(this.uri||g.url,v)},onTimeout:(m,g,p)=>{this.log(`Timeout loading steering manifest (${g.url})`),this.scheduleRefresh(this.uri||g.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(o,f,d)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const r=(n=this.hls)==null?void 0:n.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function db(s,e,t,n){s&&Object.keys(e).forEach(r=>{const o=s.filter(l=>l.groupId===r).map(l=>{const c=at({},l);return c.details=void 0,c.attrs=new vt(c.attrs),c.url=c.attrs.URI=_w(l.url,l.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),c.groupId=c.attrs["GROUP-ID"]=e[r],c.attrs["PATHWAY-ID"]=n,c});s.push(...o)})}function _w(s,e,t,n){const{HOST:r,PARAMS:o,[t]:l}=n;let c;e&&(c=l?.[e],c&&(s=c));const f=new self.URL(s);return r&&!c&&(f.host=r),o&&Object.keys(o).sort().forEach(d=>{d&&f.searchParams.set(d,o[d])}),f.href}class Ia extends Wn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Ia.CDMCleanupPromise?[Ia.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:n,initData:r}=t,o=`"${t.type}" event: init data type: "${n}"`;if(this.debug(o),r!==null){if(!this.keyFormatPromise){let l=Object.keys(this.keySystemAccessPromises);l.length||(l=Ho(this.config));const c=l.map(vm).filter(f=>!!f);this.keyFormatPromise=this.getKeyFormatPromise(c)}this.keyFormatPromise.then(l=>{const c=bu(l);if(n!=="sinf"||c!==xt.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${n}" for selected key-system ${c}`);return}let f;try{const E=Ft(new Uint8Array(r)),v=wp(JSON.parse(E).sinf),S=TR(v);if(!S)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");f=new Uint8Array(S.subarray(8,24))}catch(E){this.warn(`${o} Failed to parse sinf: ${E}`);return}const d=Qt(f),{keyIdToKeySessionPromise:m,mediaKeySessions:g}=this;let p=m[d];for(let E=0;E<g.length;E++){const v=g[E],S=v.decryptdata;if(!S.keyId)continue;const b=Qt(S.keyId);if(Ku(f,S.keyId)||S.uri.replace(/-/g,"").indexOf(d)!==-1){if(p=m[b],!p)continue;if(S.pssh)break;delete m[b],S.pssh=new Uint8Array(r),S.keyId=f,p=m[d]=p.then(()=>this.generateRequestWithPreferredKeySession(v,n,r,"encrypted-event-key-match")),p.catch(R=>this.handleError(R));break}}p||this.handleError(new Error(`Key ID ${d} not encountered in playlist. Key-system sessions ${g.length}.`))}).catch(l=>this.handleError(l))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(L.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(L.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(L.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(L.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t?.[e];if(r)return r.licenseUrl;if(e===xt.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t?.[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(l,c,f)=>!!l&&f.indexOf(l)===c,r=t.map(l=>l.audioCodec).filter(n),o=t.map(l=>l.videoCodec).filter(n);return r.length+o.length===0&&o.push("avc1.42e01e"),new Promise((l,c)=>{const f=d=>{const m=d.shift();this.getMediaKeysPromise(m,r,o).then(g=>l({keySystem:m,mediaKeys:g})).catch(g=>{d.length?f(d):g instanceof wn?c(g):c(new wn({type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_ACCESS,error:g,fatal:!0},g.message))})};f(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${n}`;return $R===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return n(e,t)}getMediaKeysPromise(e,t,n){var r;const o=HB(e,t,n,this.config.drmSystemOptions||{});let l=this.keySystemAccessPromises[e],c=(r=l)==null?void 0:r.keySystemAccess;if(!c){this.log(`Requesting encrypted media "${e}" key-system access with config: ${ut(o)}`),c=this.requestMediaKeySystemAccess(e,o);const f=l=this.keySystemAccessPromises[e]={keySystemAccess:c};return c.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),c.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const m=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const g=f.mediaKeys=d.createMediaKeys().then(p=>(this.log(`Media-keys created for "${e}"`),f.hasMediaKeys=!0,m.then(E=>E?this.setMediaKeysServerCertificate(p,e,E):p)));return g.catch(p=>{this.error(`Failed to create media-keys for "${e}"}: ${p}`)}),g})}return c.then(()=>l.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Qt(e.keyId||[])} keyUri: ${e.uri}`);const r=n.createSession(),o={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),r=tu(t),o="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,o,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyId ${Qt(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>vm(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:n})=>this.attemptSetMediaKeys(t,n))}selectKeySystem(e){return new Promise((t,n)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:r})=>{const o=vm(r);o?t(o):n(new Error(`Unable to find format for key-system "${r}"`))}).catch(n)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Ho(this.config),n=e.map(bu).filter(r=>!!r&&t.indexOf(r)!==-1);return this.selectKeySystem(n)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let n=0;n<t.length;n++){const r=u4(e,t[n]);if(r)return r}}loadKey(e){const t=e.keyInfo.decryptdata,n=tu(t),r=this.bannedKeyIds[n];if(r||this.getKeyStatus(t)==="internal-error"){const c=fb(r||"internal-error",t);return this.handleError(c,e.frag),Promise.reject(c)}const o=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${o}`);const l=this.keyIdToKeySessionPromise[n];if(!l){const c=this.getKeySystemForKeyPromise(t).then(({keySystem:f,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${o}`),this.attemptSetMediaKeys(f,d).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:f,mediaKeys:d,decryptdata:t}))))).then(f=>{const d="cenc",m=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(f,d,m,"playlist-key")});return c.catch(f=>this.handleError(f,e.frag)),this.keyIdToKeySessionPromise[n]=c,c}return l.catch(c=>{if(c instanceof wn){const f=tt({},c.data);this.getKeyStatus(t)==="internal-error"&&(f.decryptdata=t);const d=new wn(f,c.message);this.handleError(d,e.frag)}}),l}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof wn){t&&(e.data.frag=t);const n=e.data.decryptdata;this.error(`${e.message}${n?` (${Qt(n.keyId||[])})`:""}`),this.hls.trigger(L.ERROR,e.data)}else this.error(e.message),this.hls.trigger(L.ERROR,{type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=tu(e),n=this.keyIdToKeySessionPromise[t];if(!n){const r=bu(e.keyFormat),o=r?[r]:Ho(this.config);return this.attemptKeySystemAccess(o)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Ho(this.config)),e.length===0)throw new wn({type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${ut({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(n).then(()=>this.media?this.media.setMediaKeys(t):new Promise((o,l)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return l(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(o).catch(l)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>n.indexOf(o)===-1)})}generateRequestWithPreferredKeySession(e,t,n,r){var o;const l=(o=this.config.drmSystems)==null||(o=o[e.keySystem])==null?void 0:o.generateRequest;if(l)try{const v=l.call(this.hls,t,n,e);if(!v)throw new Error("Invalid response from configured generateRequest filter");t=v.initDataType,n=v.initData?v.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(v){if(this.warn(v.message),this.hls&&this.hls.config.debug)throw v}if(n===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const c=tu(e.decryptdata),f=e.decryptdata.uri;this.log(`Generating key-session request for "${r}" keyId: ${c} URI: ${f} (init data type: ${t} length: ${n.byteLength})`);const d=new Cp,m=e._onmessage=v=>{const S=e.mediaKeysSession;if(!S){d.emit("error",new Error("invalid state"));return}const{messageType:b,message:R}=v;this.log(`"${b}" message event for session "${S.sessionId}" message size: ${R.byteLength}`),b==="license-request"||b==="license-renewal"?this.renewLicense(e,R).catch(C=>{d.eventNames().length?d.emit("error",C):this.handleError(C)}):b==="license-release"?e.keySystem===xt.FAIRPLAY&&this.updateKeySession(e,pg("acknowledged")).then(()=>this.removeSession(e)).catch(C=>this.handleError(C)):this.warn(`unhandled media key message type "${b}"`)},g=(v,S)=>{S.keyStatus=v;let b;v.startsWith("usable")?d.emit("resolved"):v==="internal-error"||v==="output-restricted"||v==="output-downscaled"?b=fb(v,S.decryptdata):v==="expired"?b=new Error(`key expired (keyId: ${c})`):v==="released"?b=new Error("key released"):v==="status-pending"||this.warn(`unhandled key status change "${v}" (keyId: ${c})`),b&&(d.eventNames().length?d.emit("error",b):this.handleError(b))},p=e._onkeystatuseschange=v=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}const b=this.getKeyStatuses(e);if(!Object.keys(b).some(D=>b[D]!=="status-pending"))return;if(b[c]==="expired"){this.log(`Expired key ${ut(b)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let C=b[c];if(C)g(C,e);else{var _;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(_=e.keyStatusTimeouts)[c]||(_[c]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const N=this.getKeyStatus(e.decryptdata);if(N&&N!=="status-pending")return this.log(`No status for keyId ${c} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${N} from other session.`),g(N,e);this.log(`key status for ${c} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),C="internal-error",g(C,e)},1e3)),this.log(`No status for keyId ${c} (${ut(b)}).`)}};an(e.mediaKeysSession,"message",m),an(e.mediaKeysSession,"keystatuseschange",p);const E=new Promise((v,S)=>{d.on("error",S),d.on("resolved",v)});return e.mediaKeysSession.generateRequest(t,n).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${c} URI: ${f}`)}).catch(v=>{throw new wn({type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_NO_SESSION,error:v,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${v}`)}).then(()=>E).catch(v=>(d.removeAllListeners(),this.removeSession(e).then(()=>{throw v}))).then(()=>(d.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((n,r)=>{if(typeof r=="string"&&typeof n=="object"){const c=r;r=n,n=c}const o="buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r);if(e.keySystem===xt.PLAYREADY&&o.length===16){const c=Qt(o);t[c]=n,UR(o)}const l=Qt(o);n==="internal-error"&&(this.bannedKeyIds[l]=n),this.log(`key status change "${n}" for keyStatuses keyId: ${l} key-session "${e.mediaKeysSession.sessionId}"`),t[l]=n}),t}fetchServerCertificate(e){const t=this.config,n=t.loader,r=new n(t),o=this.getServerCertificateUrl(e);return o?(this.log(`Fetching server certificate for "${e}"`),new Promise((l,c)=>{const f={responseType:"arraybuffer",url:o},d=t.certLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(p,E,v,S)=>{l(p.data)},onError:(p,E,v,S)=>{c(new wn({type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:tt({url:f.url,data:void 0},p)},`"${e}" certificate request failed (${o}). Status: ${p.code} (${p.text})`))},onTimeout:(p,E,v)=>{c(new wn({type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:{url:f.url,data:void 0}},`"${e}" certificate request timed out (${o})`))},onAbort:(p,E,v)=>{c(new Error("aborted"))}};r.load(f,m,g)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((r,o)=>{e.setServerCertificate(n).then(l=>{this.log(`setServerCertificate ${l?"success":"not supported by CDM"} (${n.byteLength}) on "${t}"`),r(e)}).catch(l=>{o(new wn({type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:l,fatal:!0},l.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(r=>{throw new wn({type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:r,fatal:!1},r.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(n,"application/xml"),o=r.querySelectorAll("HttpHeader");if(o.length>0){let m;for(let g=0,p=o.length;g<p;g++){var l,c;m=o[g];const E=(l=m.querySelector("name"))==null?void 0:l.textContent,v=(c=m.querySelector("value"))==null?void 0:c.textContent;E&&v&&e.setRequestHeader(E,v)}}const f=r.querySelector("Challenge"),d=f?.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return pg(atob(d))}setupLicenseXHR(e,t,n,r){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return o.call(this.hls,e,t,n,r)}).catch(l=>{if(!n.decryptdata)throw l;return e.open("POST",t,!0),o.call(this.hls,e,t,n,r)}).then(l=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:l||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((r,o)=>{const l=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${l}`);const c=new XMLHttpRequest;c.responseType="arraybuffer",c.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return o(new Error("invalid state"));if(c.readyState===4)if(c.status===200){this._requestLicenseFailureCount=0;let f=c.response;this.log(`License received ${f instanceof ArrayBuffer?f.byteLength:f}`);const d=this.config.licenseResponseCallback;if(d)try{f=d.call(this.hls,c,l,e)}catch(m){this.error(m)}r(f)}else{const f=n.errorRetry,d=f?f.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||c.status>=400&&c.status<500)o(new wn({type:Ae.KEY_SYSTEM_ERROR,details:W.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:c,response:{url:l,data:void 0,code:c.status,text:c.statusText}},`License Request XHR failed (${l}). Status: ${c.status} (${c.statusText})`));else{const m=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${m} attempts left`),this.requestLicense(e,t).then(r,o)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=c,this.setupLicenseXHR(c,l,e,t).then(({xhr:f,licenseChallenge:d})=>{e.keySystem==xt.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(f,d)),f.send(d)}).catch(o)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,an(n,"encrypted",this.onMediaEncrypted),an(n,"waitingforkey",this.onWaitingForKey);const r=this.mediaResolved;r?r():this.mediaKeys=n.mediaKeys}onMediaDetached(){const e=this.media;e&&(gn(e,"encrypted",this.onMediaEncrypted),gn(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const n=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,ji.clearKeyUriToKeyIdMap();const o=r.length;Ia.CDMCleanupPromise=Promise.all(r.map(l=>this.removeSession(l)).concat((n==null||(e=n.setMediaKeys(null))==null?void 0:e.catch(l=>{this.log(`Could not clear media keys: ${l}`),this.hls&&this.hls.trigger(L.ERROR,{type:Ae.OTHER_ERROR,details:W.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${l}`)})}))||Promise.resolve())).catch(l=>{this.log(`Could not close sessions and clear media keys: ${l}`),this.hls&&this.hls.trigger(L.ERROR,{type:Ae.OTHER_ERROR,details:W.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${l}`)})}).then(()=>{o&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((r,o)=>(r.indexOf(o.keyFormat)===-1&&r.push(o.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n,decryptdata:r}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${Qt(r?.keyId||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const o=this.mediaKeySessions.indexOf(e);o>-1&&this.mediaKeySessions.splice(o,1);const{keyStatusTimeouts:l}=e;l&&Object.keys(l).forEach(d=>self.clearTimeout(l[d]));const{drmSystemOptions:c}=this.config;return(VB(c)?new Promise((d,m)=>{self.setTimeout(()=>m(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(d).catch(m)}):Promise.resolve()).catch(d=>{this.log(`Could not remove session: ${d}`),this.hls&&this.hls.trigger(L.ERROR,{type:Ae.OTHER_ERROR,details:W.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${d}`)})}).then(()=>t.close()).catch(d=>{this.log(`Could not close session: ${d}`),this.hls&&this.hls.trigger(L.ERROR,{type:Ae.OTHER_ERROR,details:W.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${d}`)})})}return Promise.resolve()}}Ia.CDMCleanupPromise=void 0;function tu(s){if(!s)throw new Error("Could not read keyId of undefined decryptdata");if(s.keyId===null)throw new Error("keyId is null");return Qt(s.keyId)}function u4(s,e){if(s.keyId&&e.mediaKeysSession.keyStatuses.has(s.keyId))return e.mediaKeysSession.keyStatuses.get(s.keyId);if(s.matches(e.decryptdata))return e.keyStatus}class wn extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function fb(s,e){const t=s==="output-restricted",n=t?W.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:W.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new wn({type:Ae.KEY_SYSTEM_ERROR,details:n,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${s}"`)}class d4{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(L.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(L.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const o=r-this.lastTime,l=n-this.lastDroppedFrames,c=t-this.lastDecodedFrames,f=1e3*l/o,d=this.hls;if(d.trigger(L.FPS_DROP,{currentDropped:l,currentDecoded:c,totalDroppedFrames:n}),f>0&&l>d.config.fpsDroppedMonitoringThreshold*c){let m=d.currentLevel;d.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+m),m>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=m)&&(m=m-1,d.trigger(L.FPS_DROP_LEVEL_CAPPING,{level:m,droppedLevel:d.currentLevel}),d.autoLevelCapping=m,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function Dw(s,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=s,e.dispatchEvent(t)}function Iw(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues&&!s.cues.getCueById(e.id))try{if(s.addCue(e),!s.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){nt.debug(`[texttrack-utils]: ${n}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,s.addCue(r)}catch(r){nt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(s.mode=t)}function Ra(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues)for(let n=s.cues.length;n--;)e&&s.cues[n].removeEventListener("enter",e),s.removeCue(s.cues[n]);t==="disabled"&&(s.mode=t)}function Rg(s,e,t,n){const r=s.mode;if(r==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0){const o=h4(s.cues,e,t);for(let l=0;l<o.length;l++)(!n||n(o[l]))&&s.removeCue(o[l])}r==="disabled"&&(s.mode=r)}function f4(s,e){if(e<=s[0].startTime)return 0;const t=s.length-1;if(e>s[t].endTime)return-1;let n=0,r=t,o;for(;n<=r;)if(o=Math.floor((r+n)/2),e<s[o].startTime)r=o-1;else if(e>s[o].startTime&&n<t)n=o+1;else return o;return s[n].startTime-e<e-s[r].startTime?n:r}function h4(s,e,t){const n=[],r=f4(s,e);if(r>-1)for(let o=r,l=s.length;o<l;o++){const c=s[o];if(c.startTime>=e&&c.endTime<=t)n.push(c);else if(c.startTime>t)return n}return n}function wu(s){const e=[];for(let t=0;t<s.length;t++){const n=s[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(s[t])}return e}class m4 extends Mp{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=wu(this.media.textTracks);for(let o=0;o<n.length;o++)if(n[o].mode==="hidden")t=n[o];else if(n[o].mode==="showing"){t=n[o];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(L.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const r=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,r)return;wu(n.textTracks).forEach(l=>{Ra(l)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:r,details:o}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==r){this.warn(`Subtitle track with id:${n} and group:${r} not found in active group ${l?.groupId}`);return}const c=l.details;l.details=t.details,this.log(`Subtitle track ${n} "${l.name}" lang:${l.lang} group:${r} loaded [${o.startSN}-${o.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,r=this.groupIds;let o=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(l=>r?.indexOf(l)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(m=>!n||n.indexOf(m.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(m=>m.default)&&(this.selectDefaultTrack=!1),l.forEach((m,g)=>{m.id=g});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const c=this.hls.config.subtitlePreference;if(!o&&c){this.selectDefaultTrack=!1;const m=Ss(c,l);if(m>-1)o=l[m];else{const g=Ss(c,this.tracks);o=this.tracks[g]}}let f=this.findTrackId(o);f===-1&&o&&(f=this.findTrackId(null));const d={subtitleTracks:l};this.log(`Updating subtitle tracks, ${l.length} track(s) found in "${n?.join(",")}" group-id`),this.hls.trigger(L.SUBTITLE_TRACKS_UPDATED,d),f!==-1&&this.trackId===-1&&this.setSubtitleTrack(f)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const o=t[r];if(!(n&&!o.default||!n&&!e)&&(!e||Er(o,e)))return r}if(e){for(let r=0;r<t.length;r++){const o=t[r];if(al(e.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const o=t[r];if(al(e.attrs,o.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(Sg(r,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===je.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Er(e,n))return n;const r=Ss(e,this.tracksInGroup);if(r>-1){const o=this.tracksInGroup[r];return this.setSubtitleTrack(r),o}else{if(n)return null;{const o=Ss(e,t);if(o>-1)return t[o]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,r=e.groupId,o=this.getUrlWithDirectives(e.url,t),l=e.details,c=l?.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${c&&l.live?" age "+c.toFixed(1)+(l.type&&" "+l.type||""):""} ${o}`),this.hls.trigger(L.SUBTITLE_TRACK_LOADING,{url:o,id:n,groupId:r,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=wu(e.textTracks),n=this.currentTrack;let r;if(n&&(r=t.filter(o=>Sg(n,o))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(o=>{o.mode!=="disabled"&&o!==r&&(o.mode="disabled")}),r){const o=this.subtitleDisplay?"showing":"hidden";r.mode!==o&&(r.mode=o)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!ve(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(L.SUBTITLE_TRACK_SWITCH,{id:e});return}const o=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&o)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:l,groupId:c="",name:f,type:d,url:m}=r;this.hls.trigger(L.SUBTITLE_TRACK_SWITCH,{id:l,groupId:c,name:f,type:d,url:m});const g=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(g)}}function g4(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const o=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?o:o&3|8).toString(16)})}}}function Yo(s){let e=5381,t=s.length;for(;t;)e=e*33^s.charCodeAt(--t);return(e>>>0).toString()}const Oa=.025;let Xu=(function(s){return s[s.Point=0]="Point",s[s.Range=1]="Range",s})({});function p4(s,e,t){return`${s.identifier}-${t+1}-${Yo(e)}`}class y4{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const n=this.playoutLimit;return e<=0||isNaN(n)?!1:n===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>n}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Lm(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=Lm(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=ve(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Lm(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Oa))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Xu.Range:Xu.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return v4(this)}}function Lm(s,e){return s-e.start<e.duration/2&&!(Math.abs(s-(e.start+e.duration))<Oa)?e.start:e.start+e.duration}function Ow(s,e,t){const n=new self.URL(s,t);return n.protocol!=="data:"&&n.searchParams.set("_HLS_primary_id",e),n}function Cm(s,e){for(;(t=s.assetList[++e])!=null&&t.error;)var t;return e}function v4(s){return`["${s.identifier}" ${s.cue.pre?"<pre>":s.cue.post?"<post>":""}${s.timelineStart.toFixed(2)}-${s.resumeTime.toFixed(2)}]`}function Aa(s){const e=s.timelineStart,t=s.duration||0;return`["${s.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class x4{constructor(e,t,n,r){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(L.PLAYOUT_LIMIT_REACHED,{})};const o=this.hls=new e(t);this.interstitial=n,this.assetItem=r;const l=()=>{this.hasDetails=!0};o.once(L.LEVEL_LOADED,l),o.once(L.AUDIO_TRACK_LOADED,l),o.once(L.SUBTITLE_TRACK_LOADED,l),o.on(L.MEDIA_ATTACHING,(c,{media:f})=>{this.removeMediaListeners(),this.mediaAttached=f,this.interstitial.playoutLimit&&(f.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&o.on(L.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,o.trigger(L.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=Ow(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const n=Math.min(this._bufferedEosTime||1/0,this.duration),r=this.timelineOffset,o=Ie.bufferInfo(e,r,0);return this.getAssetTime(o.end)>=n-.02}reachedPlayout(e){const n=this.interstitial.playoutLimit;return this.startOffset+e>=n}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Ie.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const n=t-this.startOffset;if(n>0&&n<e)return n}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=n=>delete n.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,n){var r;(r=this.hls)==null||r.on(e,t)}once(e,t,n){var r;(r=this.hls)==null||r.once(e,t)}off(e,t,n){var r;(r=this.hls)==null||r.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Aa(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const hb=.033;class E4 extends Wn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,r)=>e<=r.startOffset&&t>r.startOffset?(delete r.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const r=this.items;if(r)for(r[n]||(t===void 0&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&(o=r[n])!=null&&o.event;){var o;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let r=0;r<n.length;r++){let o=n[r];if(t&&t!=="primary"&&(o=o[t]),e===o.start||e>o.start&&e<o.end)return r}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let r=e;r<=t&&n[r];r++){const o=n[r].event;if(o!=null&&o.restrictions.jump&&!o.appendInPlace)return r}return-1}findEventIndex(e){const t=this.items;if(t)for(let r=t.length;r--;){var n;if(((n=t[r].event)==null?void 0:n.identifier)===e)return r}return-1}findAssetIndex(e,t){const n=e.assetList,r=n.length;if(r>1)for(let o=0;o<r;o++){const l=n[o];if(!l.error){const c=l.timelineStart;if(t===c||t>c&&(t<c+(l.duration||0)||o===r-1))return o}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const n=t.assetList,r=n[n.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:r}=n,o=this.events,l=this.parseDateRanges(r,{url:n.url},t),c=Object.keys(r),f=o?o.filter(d=>!c.includes(d.identifier)):[];l.length&&l.sort((d,m)=>{const g=d.cue.pre,p=d.cue.post,E=m.cue.pre,v=m.cue.post;if(g&&!E)return-1;if(E&&!g||p&&!v)return 1;if(v&&!p)return-1;if(!g&&!E&&!p&&!v){const S=d.startTime,b=m.startTime;if(S!==b)return S-b}return d.dateRange.tagOrder-m.dateRange.tagOrder}),this.events=l,f.forEach(d=>{this.removeEvent(d)}),this.updateSchedule(e,f)}updateSchedule(e,t=[],n=!1){const r=this.events||[];if(r.length||t.length||this.length<2){const o=this.items,l=this.parseSchedule(r,e);(n||t.length||o?.length!==l.length||l.some((f,d)=>Math.abs(f.playout.start-o[d].playout.start)>.005||Math.abs(f.playout.end-o[d].playout.end)>.005))&&(this.items=l,this.onScheduleUpdate(t,o))}}parseDateRanges(e,t,n){const r=[],o=Object.keys(e);for(let l=0;l<o.length;l++){const c=o[l],f=e[c];if(f.isInterstitial){let d=this.eventMap[c];d?d.setDateRange(f):(d=new y4(f,t),this.eventMap[c]=d,n===!1&&(d.appendInPlace=n)),r.push(d)}}return r}parseSchedule(e,t){const n=[],r=t.main.details,o=r.live?1/0:r.edge;let l=0;if(e=e.filter(f=>!f.error&&!(f.cue.once&&f.hasPlayed)),e.length){this.resolveOffsets(e,t);let f=0,d=0;if(e.forEach((m,g)=>{const p=m.cue.pre,E=m.cue.post,v=e[g-1]||null,S=m.appendInPlace,b=E?o:m.startOffset,R=m.duration,C=m.timelineOccupancy===Xu.Range?R:0,_=m.resumptionOffset,D=v?.startTime===b,N=b+m.cumulativeDuration;let B=S?N+R:b+_;if(p||!E&&b<=0){const P=d;d+=C,m.timelineStart=N;const M=l;l+=R,n.push({event:m,start:N,end:B,playout:{start:M,end:l},integrated:{start:P,end:d}})}else if(b<=o){if(!D){const U=b-f;if(U>hb){const q=f,V=d;d+=U;const ee=l;l+=U;const Z={previousEvent:e[g-1]||null,nextEvent:m,start:q,end:q+U,playout:{start:ee,end:l},integrated:{start:V,end:d}};n.push(Z)}else U>0&&v&&(v.cumulativeDuration+=U,n[n.length-1].end=b)}E&&(B=N),m.timelineStart=N;const P=d;d+=C;const M=l;l+=R,n.push({event:m,start:N,end:B,playout:{start:M,end:l},integrated:{start:P,end:d}})}else return;const I=m.resumeTime;E||I>o?f=o:f=I}),f<o){var c;const m=f,g=d,p=o-f;d+=p;const E=l;l+=p,n.push({previousEvent:((c=n[n.length-1])==null?void 0:c.event)||null,nextEvent:null,start:f,end:m+p,playout:{start:E,end:l},integrated:{start:g,end:d}})}this.setDurations(o,l,d)}else n.push({previousEvent:null,nextEvent:null,start:0,end:o,playout:{start:0,end:o},integrated:{start:0,end:o}}),this.setDurations(o,o,o);return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,r=n.live?1/0:n.edge;let o=0,l=-1;e.forEach((c,f)=>{const d=c.cue.pre,m=c.cue.post,g=d?0:m?r:c.startTime;this.updateAssetDurations(c),l===g?c.cumulativeDuration=o:(o=0,l=g),!m&&c.snapOptions.in&&(c.resumeAnchor=Ar(null,n.fragments,c.startOffset+c.resumptionOffset,0,0)||void 0),c.appendInPlace&&!c.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(c,t)||(c.appendInPlace=!1)),!c.appendInPlace&&f+1<e.length&&e[f+1].startTime-e[f].resumeTime<hb&&(e[f+1].appendInPlace=!1,e[f+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${c}`));const E=ve(c.resumeOffset)?c.resumeOffset:c.duration;o+=E})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,r=e.startTime+e.resumptionOffset;return Math.abs(n-r)>Oa?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${r}`),!1):!Object.keys(t).some(l=>{const c=t[l].details,f=c.edge;if(n>=f)return this.log(`"${e.identifier}" resumption ${n} past ${l} playlist end ${f}`),!1;const d=Ar(null,c.fragments,n);if(!d)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${l} playlist (${c.fragStart}-${c.fragmentEnd})`),!0;const m=l==="audio"?.175:0;return Math.abs(d.start-n)<Oa+m||Math.abs(d.end-n)<Oa+m?!1:(this.log(`"${e.identifier}" resumption ${n} not aligned with ${l} fragment bounds (${d.start}-${d.end} sn: ${d.sn} cc: ${d.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,r=!1,o=!1;for(let l=0;l<e.assetList.length;l++){const c=e.assetList[l],f=t+n;c.startOffset=n,c.timelineStart=f,r||(r=c.duration===null),o||(o=!!c.error);const d=c.error?0:c.duration||0;n+=d}r&&!o?e.duration=Math.max(n,e.duration):e.duration=n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function es(s){return`[${s.event?'"'+s.event.identifier+'"':"primary"}: ${s.start.toFixed(2)}-${s.end.toFixed(2)}]`}class S4{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let r;try{r=Ow(n,this.hls.sessionId,e.baseUrl)}catch(p){const E=this.assignAssetListError(e,W.ASSET_LIST_LOAD_ERROR,p,n);this.hls.trigger(L.ERROR,E);return}t&&r.protocol!=="data:"&&r.searchParams.set("_HLS_start_offset",""+t);const o=this.hls.config,l=o.loader,c=new l(o),f={responseType:"json",url:r.href},d=o.interstitialAssetListLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(p,E,v,S)=>{const b=p.data,R=b?.ASSETS;if(!Array.isArray(R)){const C=this.assignAssetListError(e,W.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),v.url,E,S);this.hls.trigger(L.ERROR,C);return}e.assetListResponse=b,this.hls.trigger(L.ASSET_LIST_LOADED,{event:e,assetListResponse:b,networkDetails:S})},onError:(p,E,v,S)=>{const b=this.assignAssetListError(e,W.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${p.code} ${p.text} (${E.url})`),E.url,S,v);this.hls.trigger(L.ERROR,b)},onTimeout:(p,E,v)=>{const S=this.assignAssetListError(e,W.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${E.url})`),E.url,p,v);this.hls.trigger(L.ERROR,S)}};return c.load(f,m,g),this.hls.trigger(L.ASSET_LIST_LOADING,{event:e}),c}assignAssetListError(e,t,n,r,o,l){return e.error=n,{type:Ae.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:r,error:n,networkDetails:l,stats:o}}}function mb(s){var e;s==null||(e=s.play())==null||e.catch(()=>{})}function nu(s,e){return`[${s}] Advancing timeline position to ${e}`}class b4 extends Wn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled||!this.schedule)return;const r=n-this.timelinePos;if(Math.abs(r)<1/7056e5)return;const l=r<=-.01;this.timelinePos=n,this.bufferedPos=n;const c=this.playingItem;if(!c){this.checkBuffer();return}if(l&&this.schedule.resetErrorsInRange(n,n-r)&&this.updateSchedule(!0),this.checkBuffer(),l&&n<c.start||n>=c.end){var f;const E=this.findItemIndex(c);let v=this.schedule.findItemIndexAtTime(n);if(v===-1&&(v=E+(l?-1:1),this.log(`seeked ${l?"back ":""}to position not covered by schedule ${n} (resolving from ${E} to ${v})`)),!this.isInterstitial(c)&&(f=this.media)!=null&&f.paused&&(this.shouldPlay=!1),!l&&v>E){const S=this.schedule.findJumpRestrictedIndex(E+1,v);if(S>E){this.setSchedulePosition(S);return}}this.setSchedulePosition(v);return}const d=this.playingAsset;if(!d){if(this.playingLastItem&&this.isInterstitial(c)){const E=c.event.assetList[0];E&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(n,E))}return}const m=d.timelineStart,g=d.duration||0;if(l&&n<m||n>=m+g){var p;(p=c.event)!=null&&p.appendInPlace&&(this.clearAssetPlayers(c.event,c),this.flushFrontBuffer(n)),this.setScheduleToAssetAtTime(n,d)}},this.onTimeupdate=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;if(n>this.timelinePos)this.timelinePos=n,n>this.bufferedPos&&this.checkBuffer();else return;const r=this.playingItem;if(!r||this.playingLastItem)return;if(n>=r.end){this.timelinePos=r.end;const c=this.findItemIndex(r);this.setSchedulePosition(c+1)}const o=this.playingAsset;if(!o)return;const l=o.timelineStart+(o.duration||0);n>=l&&this.setScheduleToAssetAtTime(n,o)},this.onScheduleUpdate=(n,r)=>{const o=this.schedule;if(!o)return;const l=this.playingItem,c=o.events||[],f=o.items||[],d=o.durations,m=n.map(S=>S.identifier),g=!!(c.length||m.length);(g||r)&&this.log(`INTERSTITIALS_UPDATED (${c.length}): ${c}
Schedule: ${f.map(S=>es(S))} pos: ${this.timelinePos}`),m.length&&this.log(`Removed events ${m}`);let p=null,E=null;l&&(p=this.updateItem(l,this.timelinePos),this.itemsMatch(l,p)?this.playingItem=p:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const v=this.bufferingItem;if(v&&(E=this.updateItem(v,this.bufferedPos),this.itemsMatch(v,E)?this.bufferingItem=E:v.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(v.event,null))),n.forEach(S=>{S.assetList.forEach(b=>{this.clearAssetPlayer(b.identifier,null)})}),this.playerQueue.forEach(S=>{if(S.interstitial.appendInPlace){const b=S.assetItem.timelineStart,R=S.timelineOffset-b;if(R)try{S.timelineOffset=b}catch(C){Math.abs(R)>Oa&&this.warn(`${C} ("${S.assetId}" ${S.timelineOffset}->${b})`)}}}),g||r){if(this.hls.trigger(L.INTERSTITIALS_UPDATED,{events:c.slice(0),schedule:f.slice(0),durations:d,removedIds:m}),this.isInterstitial(l)&&m.includes(l.event.identifier)){this.warn(`Interstitial "${l.event.identifier}" removed while playing`),this.primaryFallback(l.event);return}l&&this.trimInPlace(p,l),v&&E!==p&&this.trimInPlace(E,v),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new S4(e),this.schedule=new E4(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(L.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(L.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(L.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(L.BUFFER_APPENDED,this.onBufferAppended,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(L.MEDIA_ENDED,this.onMediaEnded,this),e.on(L.ERROR,this.onError,this),e.on(L.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(L.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(L.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(L.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.BUFFER_APPENDED,this.onBufferAppended,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(L.MEDIA_ENDED,this.onMediaEnded,this),e.off(L.ERROR,this.onError,this),e.off(L.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){gn(e,"play",this.onPlay),gn(e,"pause",this.onPause),gn(e,"seeking",this.onSeeking),gn(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;an(n,"seeking",this.onSeeking),an(n,"timeupdate",this.onTimeupdate),an(n,"play",this.onPlay),an(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,r=this.detachedData;if(this.detachedData=null,n===null)this.checkStart();else if(!r){this.clearScheduleState();const o=this.findItemIndex(n);this.setSchedulePosition(o)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,r=this.media;if(this.media=null,!n&&(r&&this.removeMediaListeners(r),this.detachedData)){const o=this.getBufferingPlayer();o&&(this.log(`Removing schedule state for detachedData and ${o}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,o.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=g=>g&&e.getAssetPlayer(g.identifier),r=(g,p,E,v,S)=>{if(g){let b=g[p].start;const R=g.event;if(R){if(p==="playout"||R.timelineOccupancy!==Xu.Point){const C=n(E);C?.interstitial===R&&(b+=C.assetItem.startOffset+C[S])}}else{const C=v==="bufferedPos"?l():e[v];b+=C-g.start}return b}return 0},o=(g,p)=>{var E;if(g!==0&&p!=="primary"&&(E=e.schedule)!=null&&E.length){var v;const S=e.schedule.findItemIndexAtTime(g),b=(v=e.schedule.items)==null?void 0:v[S];if(b){const R=b[p].start-b.start;return g+R}}return g},l=()=>{const g=e.bufferedPos;return g===Number.MAX_VALUE?c("primary"):Math.max(g,0)},c=g=>{var p,E;return(p=e.primaryDetails)!=null&&p.live?e.primaryDetails.edge:((E=e.schedule)==null?void 0:E.durations[g])||0},f=(g,p)=>{var E,v;const S=e.effectivePlayingItem;if(S!=null&&(E=S.event)!=null&&E.restrictions.skip||!e.schedule)return;e.log(`seek to ${g} "${p}"`);const b=e.effectivePlayingItem,R=e.schedule.findItemIndexAtTime(g,p),C=(v=e.schedule.items)==null?void 0:v[R],_=e.getBufferingPlayer(),D=_?.interstitial,N=D?.appendInPlace,B=b&&e.itemsMatch(b,C);if(b&&(N||B)){const I=n(e.playingAsset),P=I?.media||e.primaryMedia;if(P){const M=p==="primary"?P.currentTime:r(b,p,e.playingAsset,"timelinePos","currentTime"),U=g-M,q=(N?M:P.currentTime)+U;if(q>=0&&(!I||N||q<=I.duration)){P.currentTime=q;return}}}if(C){let I=g;if(p!=="primary"){const M=C[p].start,U=g-M;I=C.start+U}const P=!e.isInterstitial(C);if((!e.isInterstitial(b)||b.event.appendInPlace)&&(P||C.event.appendInPlace)){const M=e.media||(N?_?.media:null);M&&(M.currentTime=I)}else if(b){const M=e.findItemIndex(b);if(R>M){const q=e.schedule.findJumpRestrictedIndex(M+1,R);if(q>M){e.setSchedulePosition(q);return}}let U=0;if(P)e.timelinePos=I,e.checkBuffer();else{const q=C.event.assetList,V=g-(C[p]||C).start;for(let ee=q.length;ee--;){const Z=q[ee];if(Z.duration&&V>=Z.startOffset&&V<Z.startOffset+Z.duration){U=ee;break}}}e.setSchedulePosition(R,U)}}},d=()=>{const g=e.effectivePlayingItem;if(e.isInterstitial(g))return g;const p=t();return e.isInterstitial(p)?p:null},m={get bufferedEnd(){const g=t(),p=e.bufferingItem;if(p&&p===g){var E;return r(p,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-p.playout.start||((E=e.bufferingAsset)==null?void 0:E.startOffset)||0}return 0},get currentTime(){const g=d(),p=e.effectivePlayingItem;return p&&p===g?r(p,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-p.playout.start:0},set currentTime(g){const p=d(),E=e.effectivePlayingItem;E&&E===p&&f(g+E.playout.start,"playout")},get duration(){const g=d();return g?g.playout.end-g.playout.start:0},get assetPlayers(){var g;const p=(g=d())==null?void 0:g.event.assetList;return p?p.map(E=>e.getAssetPlayer(E.identifier)):[]},get playingIndex(){var g;const p=(g=d())==null?void 0:g.event;return p&&e.effectivePlayingAsset?p.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return d()}};return this.manager={get events(){var g;return((g=e.schedule)==null||(g=g.events)==null?void 0:g.slice(0))||[]},get schedule(){var g;return((g=e.schedule)==null||(g=g.items)==null?void 0:g.slice(0))||[]},get interstitialPlayer(){return d()?m:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const g=t();return e.findItemIndex(g)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const g=e.effectivePlayingItem;return e.findItemIndex(g)},primary:{get bufferedEnd(){return l()},get currentTime(){const g=e.timelinePos;return g>0?g:0},set currentTime(g){f(g,"primary")},get duration(){return c("primary")},get seekableStart(){var g;return((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0}},integrated:{get bufferedEnd(){return r(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return r(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(g){f(g,"integrated")},get duration(){return c("integrated")},get seekableStart(){var g;return o(((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0,"integrated")}},skip:()=>{const g=e.effectivePlayingItem,p=g?.event;if(p&&!p.restrictions.skip){const E=e.findItemIndex(g);if(p.appendInPlace){const v=g.playout.start+g.event.duration;f(v+.001,"playout")}else e.advanceAfterAssetEnded(p,E,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!n?!1:this.findItemIndex(t)===n.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let r=this.media;!r&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(r=this.primaryMedia);const o=(t=r)==null?void 0:t.currentTime;if(!(o===void 0||!ve(o)))return o}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,r=e.media;if(n&&r===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&r){this.detachedData={media:r};return}const o=e.transferMedia();this.log(`transfer MediaSource from ${e} ${ut(o)}`),this.detachedData=o}else t&&r&&(this.shouldPlay||(this.shouldPlay=!r.paused))}transferMediaTo(e,t){var n,r;if(e.media===t)return;let o=null;const l=this.hls,c=e!==l,f=c&&e.interstitial.appendInPlace,d=(n=this.detachedData)==null?void 0:n.mediaSource;let m;if(l.media)f&&(o=l.transferMedia(),this.detachedData=o),m="Primary";else if(d){const v=this.getBufferingPlayer();v?(o=v.transferMedia(),m=`${v}`):m="detached MediaSource"}else m="detached media";if(!o){if(d)o=this.detachedData,this.log(`using detachedData: MediaSource ${ut(o)}`);else if(!this.detachedData||l.media===t){const v=this.playerQueue;v.length>1&&v.forEach(S=>{if(c&&S.interstitial.appendInPlace!==f){const b=S.interstitial;this.clearInterstitial(S.interstitial,null),b.appendInPlace=!1,b.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${b}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const g=o&&"mediaSource"in o&&((r=o.mediaSource)==null?void 0:r.readyState)!=="closed",p=g&&o?o:t;this.log(`${g?"transfering MediaSource":"attaching media"} to ${c?e:"Primary"} from ${m} (media.currentTime: ${t.currentTime})`);const E=this.schedule;if(p===o&&E){const v=c&&e.assetId===E.assetIdAtEnd;p.overrides={duration:E.duration,endOfStream:!c||v,cueRemoval:!c}}e.attachMedia(p)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e?.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const n=this.timelinePos,r=this.effectivePlayingItem;if(n===-1){const o=this.hls.startPosition;if(this.log(nu("checkStart",o)),this.timelinePos=o,t.length&&t[0].cue.pre){const l=e.findEventIndex(t[0].identifier);this.setSchedulePosition(l)}else if(o>=0||!this.primaryLive){const l=this.timelinePos=o>0?o:0,c=e.findItemIndexAtTime(l);this.setSchedulePosition(c)}}else if(r&&!this.playingItem){const o=e.findItemIndex(r);this.setSchedulePosition(o)}}advanceAssetBuffering(e,t){const n=e.event,r=n.findAssetIndex(t),o=Cm(n,r);if(!n.isAssetPastPlayoutLimit(o))this.bufferedToEvent(e,o);else if(this.schedule){var l;const c=(l=this.schedule.items)==null?void 0:l[this.findItemIndex(e)+1];c&&this.bufferedToItem(c)}}advanceAfterAssetEnded(e,t,n){const r=Cm(e,n);if(e.isAssetPastPlayoutLimit(r)){if(this.schedule){const o=this.schedule.items;if(o){const l=t+1,c=o.length;if(l>=c){this.setSchedulePosition(-1);return}const f=e.resumeTime;this.timelinePos<f&&(this.log(nu("advanceAfterAssetEnded",f)),this.timelinePos=f,e.appendInPlace&&this.advanceInPlace(f),this.checkBuffer(this.bufferedPos<f)),this.setSchedulePosition(l)}}}else{if(e.appendInPlace){const o=e.assetList[r];o&&this.advanceInPlace(o.timelineStart)}this.setSchedulePosition(t,r)}}setScheduleToAssetAtTime(e,t){const n=this.schedule;if(!n)return;const r=t.parentIdentifier,o=n.getEvent(r);if(o){const l=n.findEventIndex(r),c=n.findAssetIndex(o,e);this.advanceAfterAssetEnded(o,l,c-1)}}setSchedulePosition(e,t){var n;const r=(n=this.schedule)==null?void 0:n.items;if(!r||this.playbackDisabled)return;const o=e>=0?r[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${o&&es(o)}) pos: ${this.timelinePos}`);const l=this.waitingItem||this.playingItem,c=this.playingLastItem;if(this.isInterstitial(l)){const m=l.event,g=this.playingAsset,p=g?.identifier,E=p?this.getAssetPlayer(p):null;if(E&&p&&(!this.eventItemsMatch(l,o)||t!==void 0&&p!==m.assetList[t].identifier)){var f;const v=m.findAssetIndex(g);if(this.log(`INTERSTITIAL_ASSET_ENDED ${v+1}/${m.assetList.length} ${Aa(g)}`),this.endedAsset=g,this.playingAsset=null,this.hls.trigger(L.INTERSTITIAL_ASSET_ENDED,{asset:g,assetListIndex:v,event:m,schedule:r.slice(0),scheduleIndex:e,player:E}),l!==this.playingItem){this.itemsMatch(l,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(m,this.findItemIndex(this.playingItem),v);return}this.retreiveMediaSource(p,o),E.media&&!((f=this.detachedData)!=null&&f.mediaSource)&&E.detachMedia()}if(!this.eventItemsMatch(l,o)&&(this.endedItem=l,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${m} ${es(l)}`),m.hasPlayed=!0,this.hls.trigger(L.INTERSTITIAL_ENDED,{event:m,schedule:r.slice(0),scheduleIndex:e}),m.cue.once)){var d;this.updateSchedule();const v=(d=this.schedule)==null?void 0:d.items;if(o&&v){const S=this.findItemIndex(o);this.advanceSchedule(S,v,t,l,c)}return}}this.advanceSchedule(e,r,t,l,c)}advanceSchedule(e,t,n,r,o){const l=this.schedule;if(!l)return;const c=t[e]||null,f=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(m=>{const g=m.interstitial,p=l.findEventIndex(g.identifier);(p<e||p>e+1)&&this.clearInterstitial(g,c)}),this.isInterstitial(c)){this.timelinePos=Math.min(Math.max(this.timelinePos,c.start),c.end);const m=c.event;if(n===void 0){n=l.findAssetIndex(m,this.timelinePos);const v=Cm(m,n-1);if(m.isAssetPastPlayoutLimit(v)||m.appendInPlace&&this.timelinePos===c.end){this.advanceAfterAssetEnded(m,e,n);return}n=v}const g=this.waitingItem;this.assetsBuffered(c,f)||this.setBufferingItem(c);let p=this.preloadAssets(m,n);if(this.eventItemsMatch(c,g||r)||(this.waitingItem=c,this.log(`INTERSTITIAL_STARTED ${es(c)} ${m.appendInPlace?"append in place":""}`),this.hls.trigger(L.INTERSTITIAL_STARTED,{event:m,schedule:t.slice(0),scheduleIndex:e})),!m.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${m}`);return}if(m.assetListLoader&&(m.assetListLoader.destroy(),m.assetListLoader=void 0),!f){this.log(`Waiting for attachMedia to start Interstitial ${m}`);return}this.waitingItem=this.endedItem=null,this.playingItem=c;const E=m.assetList[n];if(!E){this.advanceAfterAssetEnded(m,e,n||0);return}if(p||(p=this.getAssetPlayer(E.identifier)),p===null||p.destroyed){const v=m.assetList.length;this.warn(`asset ${n+1}/${v} player destroyed ${m}`),p=this.createAssetPlayer(m,E,n),p.loadSource()}if(!this.eventItemsMatch(c,this.bufferingItem)&&m.appendInPlace&&this.isAssetBuffered(E))return;this.startAssetPlayer(p,n,t,e,f),this.shouldPlay&&mb(p.media)}else c?(this.resumePrimary(c,e,r),this.shouldPlay&&mb(this.hls.media)):o&&this.isInterstitial(r)&&(this.endedItem=null,this.playingItem=r,r.event.appendInPlace||this.attachPrimary(l.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,n){var r,o;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${es(e)}`),!((r=this.detachedData)!=null&&r.mediaSource)){let c=this.timelinePos;(c<e.start||c>=e.end)&&(c=this.getPrimaryResumption(e,t),this.log(nu("resumePrimary",c)),this.timelinePos=c),this.attachPrimary(c,e)}if(!n)return;const l=(o=this.schedule)==null?void 0:o.items;l&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${es(e)}`),this.hls.trigger(L.INTERSTITIALS_PRIMARY_RESUMED,{schedule:l.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const r=this.primaryDetails;if(t===0)return this.hls.startPosition;if(r&&(n<r.fragmentStart||n>r.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Ie.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const r=this.primaryMedia;if(!r)return;const o=this.hls;o.media?this.checkBuffer():(this.transferMediaTo(o,r),n&&this.startLoadingPrimaryAt(e,n)),n||(this.log(nu("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const r=this.hls;!r.loadingEnabled||!r.media||Math.abs((((n=r.mainForwardBufferInfo)==null?void 0:n.start)||r.media.currentTime)-e)>.5?r.startLoad(e,t):r.bufferingEnabled||r.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(L.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(L.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const n=this.hls.levels[t.level];if(!n.details)return;const r=tt(tt({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=r,this.schedule.parseInterstitialDateRanges(r,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=tt(tt({},this.altSelection),{},{audio:n});return}const o=tt(tt({},r),{},{audio:n});this.mediaSelection=o}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=tt(tt({},this.altSelection),{},{subtitles:n});return}const o=tt(tt({},r),{},{subtitles:n});this.mediaSelection=o}onAudioTrackSwitching(e,t){const n=TS(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setAudioOption(t)||r.setAudioOption(n)))}onSubtitleTrackSwitch(e,t){const n=TS(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setSubtitleOption(t)||t.id!==-1&&r.setSubtitleOption(n)))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const r=this.timelinePos;this.bufferedPos=r,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let r=0;r<t.length;r++){const o=t[r];if(o.cue.post){var n;const l=this.schedule.findEventIndex(o.identifier),c=(n=this.schedule.items)==null?void 0:n[l];this.isInterstitial(c)&&this.eventItemsMatch(c,this.bufferingItem)&&this.bufferedToItem(c,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const n=this.findItemIndex(t);this.setSchedulePosition(n+1)}else this.shouldPlay=!1}updateItem(e,t){var n;const r=(n=this.schedule)==null?void 0:n.items;if(e&&r){const o=this.findItemIndex(e,t);return r[o]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((o,l)=>{e.event.isAssetPastPlayoutLimit(l)&&this.clearAssetPlayer(o.identifier,null)});const n=e.end+.25,r=Ie.bufferInfo(this.primaryMedia,n,0);(r.end>n||(r.nextStart||0)>n)&&(this.log(`trim buffered interstitial ${es(e)} (was ${es(t)})`),this.attachPrimary(n,null,!0),this.flushFrontBuffer(n))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===((n=t.event)==null?void 0:n.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const n=this.mediaSelection;n&&((t=this.schedule)==null||t.updateSchedule(n,[],e))}checkBuffer(e){var t;const n=(t=this.schedule)==null?void 0:t.items;if(!n)return;const r=Ie.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,n,e)}updateBufferedPos(e,t,n){const r=this.schedule,o=this.bufferingItem;if(this.bufferedPos>e||!r)return;if(t.length===1&&this.itemsMatch(t[0],o)){this.bufferedPos=e;return}const l=this.playingItem,c=this.findItemIndex(l);let f=r.findItemIndexAtTime(e);if(this.bufferedPos<e){var d;const m=this.findItemIndex(o),g=Math.min(m+1,t.length-1),p=t[g];if((f===-1&&o&&e>=o.end||(d=p.event)!=null&&d.appendInPlace&&e+.01>=p.start)&&(f=g),this.isInterstitial(o)){const E=o.event;if(g-c>1&&E.appendInPlace===!1||E.assetList.length===0&&E.assetListLoader)return}if(this.bufferedPos=e,f>m&&f>c)this.bufferedToItem(p);else{const E=this.primaryDetails;this.primaryLive&&E&&e>E.edge-E.targetduration&&p.start<E.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(p)&&this.preloadAssets(p.event,0)}}else n&&l&&!this.itemsMatch(l,o)&&(f===c?this.bufferedToItem(l):f===c+1&&this.bufferedToItem(t[f]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(r=>{const o=this.getAssetPlayer(r.identifier);return!(o!=null&&o.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,t)&&n){const{items:r,events:o}=n;if(!r||!o)return t;const l=this.isInterstitial(e),c=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const f=c?c.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${es(e)}`+(t?` (${f.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(l){const d=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((m,g)=>{const p=this.getAssetPlayer(m.identifier);p&&(g===d&&p.loadSource(),p.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(d=>d.pauseBuffering());this.hls.trigger(L.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:o.slice(0),schedule:r.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(n!==null){this.bufferingAsset=null;const r=this.detachedData;r?r.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,r=n.assetList.length===0&&!n.assetListLoader,o=n.cue.once;if(r||!o){const l=this.preloadAssets(n,t);if(l!=null&&l.interstitial.appendInPlace){const c=this.primaryMedia;c&&this.bufferAssetPlayer(l,c)}}}preloadAssets(e,t){const n=e.assetUrl,r=e.assetList.length,o=r===0&&!e.assetListLoader,l=e.cue.once;if(o){const f=e.timelineStart;if(e.appendInPlace){var c;const p=this.playingItem;!this.isInterstitial(p)&&(p==null||(c=p.nextEvent)==null?void 0:c.identifier)===e.identifier&&this.flushFrontBuffer(f+.25)}let d,m=0;if(!this.playingItem&&this.primaryLive&&(m=this.hls.startPosition,m===-1&&(m=this.hls.liveSyncPosition||0)),m&&!(e.cue.pre||e.cue.post)){const p=m-f;p>0&&(d=Math.round(p*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:r} ${e}${d?` live-start: ${m} start-offset: ${d}`:""}`),n)return this.createAsset(e,0,0,f,e.duration,n);const g=this.assetListLoader.loadAssetList(e,d);g&&(e.assetListLoader=g)}else if(!l&&r){for(let d=t;d<r;d++){const m=e.assetList[d],g=this.getAssetPlayerQueueIndex(m.identifier);(g===-1||this.playerQueue[g].destroyed)&&!m.error&&this.createAssetPlayer(e,m,d)}const f=e.assetList[t];if(f){const d=this.getAssetPlayer(f.identifier);return d&&d.loadSource(),d}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(r=>{this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n]}return null}createAsset(e,t,n,r,o,l){const c={parentIdentifier:e.identifier,identifier:p4(e,l,t),duration:o,startOffset:n,timelineStart:r,uri:l};return this.createAssetPlayer(e,c,t)}createAssetPlayer(e,t,n){const r=this.hls,o=r.userConfig;let l=o.videoPreference;const c=r.loadLevelObj||r.levels[r.currentLevel];(l||c)&&(l=at({},l),c.videoCodec&&(l.videoCodec=c.videoCodec),c.videoRange&&(l.allowedVideoRanges=[c.videoRange]));const f=r.audioTracks[r.audioTrack],d=r.subtitleTracks[r.subtitleTrack];let m=0;if(this.primaryLive||e.appendInPlace){const D=this.timelinePos-t.timelineStart;if(D>1){const N=t.duration;N&&D<N&&(m=D)}}const g=t.identifier,p=tt(tt({},o),{},{maxMaxBufferLength:Math.min(180,r.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:r.sessionId,assetPlayerId:g,abrEwmaDefaultEstimate:r.bandwidthEstimate,interstitialsController:void 0,startPosition:m,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:l,audioPreference:f||o.audioPreference,subtitlePreference:d||o.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(p.timelineOffset=t.timelineStart));const E=p.cmcd;E!=null&&E.sessionId&&E.contentId&&(p.cmcd=at({},E,{contentId:Yo(t.uri)})),this.getAssetPlayer(g)&&this.warn(`Duplicate date range identifier ${e} and asset ${g}`);const v=new x4(this.HlsPlayerClass,p,e,t);this.playerQueue.push(v),e.assetList[n]=t;let S=!0;const b=D=>{if(D.live){var N;const P=new Error(`Interstitials MUST be VOD assets ${e}`),M={fatal:!0,type:Ae.OTHER_ERROR,details:W.INTERSTITIAL_ASSET_ITEM_ERROR,error:P},U=((N=this.schedule)==null?void 0:N.findEventIndex(e.identifier))||-1;this.handleAssetItemError(M,e,U,n,P.message);return}const B=D.edge-D.fragmentStart,I=t.duration;(S||I===null||B>I)&&(S=!1,this.log(`Interstitial asset "${g}" duration change ${I} > ${B}`),t.duration=B,this.updateSchedule())};v.on(L.LEVEL_UPDATED,(D,{details:N})=>b(N)),v.on(L.LEVEL_PTS_UPDATED,(D,{details:N})=>b(N)),v.on(L.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const R=(D,N)=>{const B=this.getAssetPlayer(g);if(B&&N.tracks){B.off(L.BUFFER_CODECS,R),B.tracks=N.tracks;const I=this.primaryMedia;this.bufferingAsset===B.assetItem&&I&&!B.media&&this.bufferAssetPlayer(B,I)}};v.on(L.BUFFER_CODECS,R);const C=()=>{var D;const N=this.getAssetPlayer(g);if(this.log(`buffered to end of asset ${N}`),!N||!this.schedule)return;const B=this.schedule.findEventIndex(e.identifier),I=(D=this.schedule.items)==null?void 0:D[B];this.isInterstitial(I)&&this.advanceAssetBuffering(I,t)};v.on(L.BUFFERED_TO_END,C);const _=D=>()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;this.shouldPlay=!0;const B=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,B,D)};return v.once(L.MEDIA_ENDED,_(n)),v.once(L.PLAYOUT_LIMIT_REACHED,_(1/0)),v.on(L.ERROR,(D,N)=>{if(!this.schedule)return;const B=this.getAssetPlayer(g);if(N.details===W.BUFFER_STALLED_ERROR){if(B!=null&&B.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(N,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${N.error} ${e}`)}),v.on(L.DESTROYING,()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;const N=new Error(`Asset player destroyed unexpectedly ${g}`),B={fatal:!0,type:Ae.OTHER_ERROR,details:W.INTERSTITIAL_ASSET_ITEM_ERROR,error:N};this.handleAssetItemError(B,e,this.schedule.findEventIndex(e.identifier),n,N.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Aa(t)}`),this.hls.trigger(L.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:v}),v}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(n=>{this.clearAssetPlayer(n.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const n=this.playerQueue[t];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){const r=this.playerQueue[n];this.log(`clear ${r} toSegment: ${t&&es(t)}`),this.transferMediaFromPlayer(r,t),this.playerQueue.splice(n,1),r.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,r,o){const{interstitial:l,assetItem:c,assetId:f}=e,d=l.assetList.length,m=this.playingAsset;this.endedAsset=null,this.playingAsset=c,(!m||m.identifier!==f)&&(m&&(this.clearAssetPlayer(m.identifier,n[r]),delete m.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${d} ${Aa(c)}`),this.hls.trigger(L.INTERSTITIAL_ASSET_STARTED,{asset:c,assetListIndex:t,event:l,schedule:n.slice(0),scheduleIndex:r,player:e})),this.bufferAssetPlayer(e,o)}bufferAssetPlayer(e,t){var n,r;if(!this.schedule)return;const{interstitial:o,assetItem:l}=e,c=this.schedule.findEventIndex(o.identifier),f=(n=this.schedule.items)==null?void 0:n[c];if(!f)return;e.loadSource(),this.setBufferingItem(f),this.bufferingAsset=l;const d=this.getBufferingPlayer();if(d===e)return;const m=o.appendInPlace;if(m&&d?.interstitial.appendInPlace===!1)return;const g=d?.tracks||((r=this.detachedData)==null?void 0:r.tracks)||this.requiredTracks;if(m&&l!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(g&&!mR(g,e.tracks)){const p=new Error(`Asset ${Aa(l)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(g)}')`),E={fatal:!0,type:Ae.OTHER_ERROR,details:W.INTERSTITIAL_ASSET_ITEM_ERROR,error:p},v=o.findAssetIndex(l);this.handleAssetItemError(E,o,c,v,p.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,n=this.primaryMedia;if(!t||!n)return;const r=n.currentTime,o=t.findAssetIndex(e,r),l=e.assetList[o];if(l){const c=this.getAssetPlayer(l.identifier);if(c){const f=c.currentTime||r-l.timelineStart,d=c.duration-f;if(this.warn(`Stalled at ${f} of ${f+d} in ${c} ${e} (media.currentTime: ${r})`),f&&(d/n.playbackRate<.5||c.bufferedInPlaceToEnd(n))&&c.hls){const m=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,m,o)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,n,r,o){if(e.details===W.BUFFER_STALLED_ERROR)return;const l=t.assetList[r]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${l&&Aa(l)} ${e.error}`),!this.schedule)return;const c=l?.identifier||"",f=this.getAssetPlayerQueueIndex(c),d=this.playerQueue[f]||null,m=this.schedule.items,g=at({},e,{fatal:!1,errorAction:_a(!0),asset:l,assetListIndex:r,event:t,schedule:m,scheduleIndex:n,player:d});if(this.hls.trigger(L.INTERSTITIAL_ASSET_ERROR,g),!e.fatal)return;const p=this.playingAsset,E=this.bufferingAsset,v=new Error(o);if(l&&(this.clearAssetPlayer(c,null),l.error=v),!t.assetList.some(S=>!S.error))t.error=v;else for(let S=r;S<t.assetList.length;S++)this.resetAssetPlayer(t.assetList[S].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):p&&p.identifier===c?this.advanceAfterAssetEnded(t,n,r):E&&E.identifier===c&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,E)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;let r=this.timelinePos;if(n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${r} playing: ${es(n)} error: ${e.error}`),r===-1&&(r=this.hls.startPosition);const l=this.updateItem(n,r);this.itemsMatch(n,l)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(r===-1){this.checkStart();return}if(!this.schedule)return;const o=this.schedule.findItemIndexAtTime(r);this.setSchedulePosition(o)}onAssetListLoaded(e,t){var n,r;const o=t.event,l=o.identifier,c=t.assetListResponse.ASSETS;if(!((n=this.schedule)!=null&&n.hasEvent(l)))return;const f=o.timelineStart,d=o.duration;let m=0;c.forEach((S,b)=>{const R=parseFloat(S.DURATION);this.createAsset(o,b,m,f+m,R,S.URI),m+=R}),o.duration=m,this.log(`Loaded asset-list with duration: ${m} (was: ${d}) ${o}`);const g=this.waitingItem,p=g?.event.identifier===l;this.updateSchedule();const E=(r=this.bufferingItem)==null?void 0:r.event;if(p){var v;const S=this.schedule.findEventIndex(l),b=(v=this.schedule.items)==null?void 0:v[S];if(b){if(!this.playingItem&&this.timelinePos>b.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==S){o.error=new Error(`Interstitial ${c.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${o}`),this.log(o.error.message),this.updateSchedule(!0),this.primaryFallback(o);return}this.setBufferingItem(b)}this.setSchedulePosition(S)}else if(E?.identifier===l){const S=o.assetList[0];if(S){const b=this.getAssetPlayer(S.identifier);if(E.appendInPlace){const R=this.primaryMedia;b&&R&&this.bufferAssetPlayer(b,R)}else b&&b.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case W.ASSET_LIST_PARSING_ERROR:case W.ASSET_LIST_LOAD_ERROR:case W.ASSET_LIST_LOAD_TIMEOUT:{const n=t.interstitial;n&&(this.updateSchedule(!0),this.primaryFallback(n));break}case W.BUFFER_STALLED_ERROR:{const n=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&n.event.appendInPlace){this.handleInPlaceStall(n.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const gb=500;class T4 extends Lp{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",xe.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(L.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(L.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=ce.IDLE,this.setInterval(gb),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragContextChanged(n)||(Lt(n)&&(this.fragPrevious=n),this.state=ce.IDLE),!r)return;const o=this.tracksBuffered[this.currentTrackId];if(!o)return;let l;const c=n.start;for(let d=0;d<o.length;d++)if(c>=o[d].start&&c<=o[d].end){l=o[d];break}const f=n.start+n.duration;l?l.end=f:(l={start:c,end:f},o.push(l)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(n===0&&r!==Number.POSITIVE_INFINITY){const o=r-1;if(o<=0)return;t.endOffsetSubtitles=Math.max(0,o),this.tracksBuffered.forEach(l=>{for(let c=0;c<l.length;){if(l[c].end<=o){l.shift();continue}else if(l[c].start<o)l[c].start=o;else break;c++}}),this.fragmentTracker.removeFragmentsInRange(n,o,xe.SUBTITLE)}}onError(e,t){const n=t.frag;n?.type===xe.SUBTITLE&&(t.details===W.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ce.STOPPED&&(this.state=ce.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&yw(this.levels,t)){this.levels=t.map(n=>new nl(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const r=new nl(n);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,xe.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.state!==ce.STOPPED&&this.setInterval(gb)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:r,levels:o}=this,{details:l,id:c}=t;if(!o){this.warn(`Subtitle tracks were reset while loading level ${c}`);return}const f=o[c];if(c>=o.length||!f)return;this.log(`Subtitle track ${c} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(l.live||(n=f.details)!=null&&n.live){if(l.deltaUpdateFailed)return;const g=this.mainDetails;if(!g){this.startFragRequested=!1;return}const p=g.fragments[0];if(!f.details)l.hasProgramDateTime&&g.hasProgramDateTime?(Yu(l,g),d=l.fragmentStart):p&&(d=p.start,vg(l,d));else{var m;d=this.alignPlaylists(l,f.details,(m=this.levelLastLoaded)==null?void 0:m.details),d===0&&p&&(d=p.start,vg(l,d))}g&&!this.startFragRequested&&this.setStartPosition(g,d)}f.details=l,this.levelLastLoaded=f,c===r&&(this.hls.trigger(L.SUBTITLE_TRACK_UPDATED,{details:l,id:c,groupId:t.groupId}),this.tick(),l.live&&!this.fragCurrent&&this.media&&this.state===ce.IDLE&&(Ar(null,l.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),f.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,o=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r!=null&&r.key&&r.iv&&Da(r.method)){const l=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer,Rp(r.method)).catch(c=>{throw o.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:t}),c}).then(c=>{const f=performance.now();o.trigger(L.FRAG_DECRYPTED,{frag:t,payload:c,stats:{tstart:l,tdecrypt:f}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state=ce.IDLE})}}doTick(){if(!this.media){this.state=ce.IDLE;return}if(this.state===ce.IDLE){const{currentTrackId:e,levels:t}=this,n=t?.[e];if(!n||!t.length||!n.details||this.waitForLive(n))return;const{config:r}=this,o=this.getLoadPosition(),l=Ie.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o,r.maxBufferHole),{end:c,len:f}=l,d=n.details,m=this.hls.maxBufferLength+d.levelTargetDuration;if(f>m)return;const g=d.fragments,p=g.length,E=d.edge;let v=null;const S=this.fragPrevious;if(c<E){const C=r.maxFragLookUpTolerance,_=c>E-C?0:C;v=Ar(S,g,Math.max(g[0].start,c),_),!v&&S&&S.start<g[0].start&&(v=g[0])}else v=g[p-1];if(v=this.filterReplacedPrimary(v,n.details),!v)return;const b=v.sn-d.startSN,R=g[b-1];if(R&&R.cc===v.cc&&this.fragmentTracker.getState(R)===Ut.NOT_LOADED&&(v=R),this.fragmentTracker.getState(v)===Ut.NOT_LOADED){const C=this.mapToInitFragWhenRequired(v);C&&this.loadFragment(C,n,c)}}}loadFragment(e,t,n){Lt(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new A4(this.tracksBuffered[this.currentTrackId]||[])}}class A4{constructor(e){this.buffered=void 0;const t=(n,r,o)=>{if(r=r>>>0,r>o-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${o})`);return e[r][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const R4={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Nw=s=>String.fromCharCode(R4[s]||s),ts=15,Js=100,w4={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},L4={17:2,18:4,21:6,22:8,23:10,19:13,20:15},C4={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},_4={25:2,26:4,29:6,30:8,31:10,27:13,28:15},D4=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class I4{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;nt.log(`${this.time} [${e}] ${n}`)}}}const gr=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class kw{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class O4{constructor(){this.uchar=" ",this.penState=new kw}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class N4{constructor(e){this.chars=[],this.pos=0,this.currPenState=new kw,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Js;t++)this.chars.push(new O4);this.logger=e}equals(e){for(let t=0;t<Js;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Js;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Js;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Js&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Js)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Nw(e);if(this.pos>=Js){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Js;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Js;n++){const r=this.chars[n].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class _m{constructor(e){this.rows=[],this.currRow=ts-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<ts;t++)this.rows.push(new N4(e));this.logger=e}reset(){for(let e=0;e<ts;e++)this.rows[e].clear();this.currRow=ts-1}equals(e){let t=!0;for(let n=0;n<ts;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<ts;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<ts;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+ut(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let c=0;c<ts;c++)this.rows[c].clear();const o=this.currRow+1-this.nrRollUpRows,l=this.lastOutputScreen;if(l){const c=l.rows[o].cueStartTime,f=this.logger.time;if(c!==null&&f!==null&&c<f)for(let d=0;d<this.nrRollUpRows;d++)this.rows[t-this.nrRollUpRows+d+1].copy(l.rows[o+d])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const o=e.indent,l=Math.max(o-1,0);n.setCursor(e.indent),e.color=n.chars[l].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+ut(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let o=0;o<ts;o++){const l=this.rows[o].getTextString();l&&(r=o+1,e?t.push("Row "+r+": '"+l+"'"):t.push(l.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class pb{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new _m(n),this.nonDisplayedMemory=new _m(n),this.lastOutputScreen=new _m(n),this.currRollUpRow=this.displayedMemory.rows[ts-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[ts-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+ut(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class yb{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=M4(),this.logger=void 0;const r=this.logger=new I4;this.channels=[null,new pb(e,t,r),new pb(e+1,n,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const r=t[n]&127,o=t[n+1]&127;let l=!1,c=null;if(r===0&&o===0)continue;this.logger.log(3,()=>"["+gr([t[n],t[n+1]])+"] -> ("+gr([r,o])+")");const f=this.cmdHistory;if(r>=16&&r<=31){if(k4(r,o,f)){su(null,null,f),this.logger.log(3,()=>"Repeated command ("+gr([r,o])+") is dropped");continue}su(r,o,this.cmdHistory),l=this.parseCmd(r,o),l||(l=this.parseMidrow(r,o)),l||(l=this.parsePAC(r,o)),l||(l=this.parseBackgroundAttributes(r,o))}else su(null,null,f);if(!l&&(c=this.parseChars(r,o),c)){const m=this.currentChannel;m&&m>0?this.channels[m].insertChars(c):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!l&&!c&&this.logger.log(2,()=>"Couldn't parse cleaned data "+gr([r,o])+" orig: "+gr([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(n||r))return!1;const o=e===20||e===21||e===23?1:2,l=this.channels[o];return e===20||e===21||e===28||e===29?t===32?l.ccRCL():t===33?l.ccBS():t===34?l.ccAOF():t===35?l.ccAON():t===36?l.ccDER():t===37?l.ccRU(2):t===38?l.ccRU(3):t===39?l.ccRU(4):t===40?l.ccFON():t===41?l.ccRDC():t===42?l.ccTR():t===43?l.ccRTD():t===44?l.ccEDM():t===45?l.ccCR():t===46?l.ccENM():t===47&&l.ccEOC():l.ccTO(t-32),this.currentChannel=o,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+gr([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,o=(e===16||e===24)&&t>=64&&t<=95;if(!(r||o))return!1;const l=e<=23?1:2;t>=64&&t<=95?n=l===1?w4[e]:C4[e]:n=l===1?L4[e]:_4[e];const c=this.channels[l];return c?(c.setPAC(this.interpretPAC(n,t)),this.currentChannel=l,!0):!1}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,r.underline=(n&1)===1,n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((n-16)/2)*4,r}parseChars(e,t){let n,r=null,o=null;if(e>=25?(n=2,o=e-8):(n=1,o=e),o>=17&&o<=19){let l;o===17?l=t+80:o===18?l=t+112:l=t+144,this.logger.log(2,()=>"Special char '"+Nw(l)+"' in channel "+n),r=[l]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+gr(r).join(",")),r}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(n||r))return!1;let o;const l={};e===16||e===24?(o=Math.floor((t-32)/2),l.background=D4[o],t%2===1&&(l.background=l.background+"_semi")):t===45?l.background="transparent":(l.foreground="black",t===47&&(l.underline=!0));const c=e<=23?1:2;return this.channels[c].setBkgData(l),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}su(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function su(s,e,t){t.a=s,t.b=e}function k4(s,e,t){return t.a===s&&t.b===e}function M4(){return{a:null,b:null}}var Bp=(function(){if(qu!=null&&qu.VTTCue)return self.VTTCue;const s=["","lr","rl"],e=["start","middle","end","left","right"];function t(c,f){if(typeof f!="string"||!Array.isArray(c))return!1;const d=f.toLowerCase();return~c.indexOf(d)?d:!1}function n(c){return t(s,c)}function r(c){return t(e,c)}function o(c,...f){let d=1;for(;d<arguments.length;d++){const m=arguments[d];for(const g in m)c[g]=m[g]}return c}function l(c,f,d){const m=this,g={enumerable:!0};m.hasBeenReset=!1;let p="",E=!1,v=c,S=f,b=d,R=null,C="",_=!0,D="auto",N="start",B=50,I="middle",P=50,M="middle";Object.defineProperty(m,"id",o({},g,{get:function(){return p},set:function(U){p=""+U}})),Object.defineProperty(m,"pauseOnExit",o({},g,{get:function(){return E},set:function(U){E=!!U}})),Object.defineProperty(m,"startTime",o({},g,{get:function(){return v},set:function(U){if(typeof U!="number")throw new TypeError("Start time must be set to a number.");v=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"endTime",o({},g,{get:function(){return S},set:function(U){if(typeof U!="number")throw new TypeError("End time must be set to a number.");S=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"text",o({},g,{get:function(){return b},set:function(U){b=""+U,this.hasBeenReset=!0}})),Object.defineProperty(m,"region",o({},g,{get:function(){return R},set:function(U){R=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"vertical",o({},g,{get:function(){return C},set:function(U){const q=n(U);if(q===!1)throw new SyntaxError("An invalid or illegal string was specified.");C=q,this.hasBeenReset=!0}})),Object.defineProperty(m,"snapToLines",o({},g,{get:function(){return _},set:function(U){_=!!U,this.hasBeenReset=!0}})),Object.defineProperty(m,"line",o({},g,{get:function(){return D},set:function(U){if(typeof U!="number"&&U!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");D=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"lineAlign",o({},g,{get:function(){return N},set:function(U){const q=r(U);if(!q)throw new SyntaxError("An invalid or illegal string was specified.");N=q,this.hasBeenReset=!0}})),Object.defineProperty(m,"position",o({},g,{get:function(){return B},set:function(U){if(U<0||U>100)throw new Error("Position must be between 0 and 100.");B=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"positionAlign",o({},g,{get:function(){return I},set:function(U){const q=r(U);if(!q)throw new SyntaxError("An invalid or illegal string was specified.");I=q,this.hasBeenReset=!0}})),Object.defineProperty(m,"size",o({},g,{get:function(){return P},set:function(U){if(U<0||U>100)throw new Error("Size must be between 0 and 100.");P=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"align",o({},g,{get:function(){return M},set:function(U){const q=r(U);if(!q)throw new SyntaxError("An invalid or illegal string was specified.");M=q,this.hasBeenReset=!0}})),m.displayState=void 0}return l.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},l})();class P4{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Mw(s){function e(n,r,o,l){return(n|0)*3600+(r|0)*60+(o|0)+parseFloat(l||0)}const t=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class F4{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function Pw(s,e,t,n){const r=n?s.split(n):[s];for(const o in r){if(typeof r[o]!="string")continue;const l=r[o].split(t);if(l.length!==2)continue;const c=l[0],f=l[1];e(c,f)}}const wg=new Bp(0,0,""),iu=wg.align==="middle"?"middle":"center";function U4(s,e,t){const n=s;function r(){const c=Mw(s);if(c===null)throw new Error("Malformed timestamp: "+n);return s=s.replace(/^[^\sa-zA-Z-]+/,""),c}function o(c,f){const d=new F4;Pw(c,function(p,E){let v;switch(p){case"region":for(let S=t.length-1;S>=0;S--)if(t[S].id===E){d.set(p,t[S].region);break}break;case"vertical":d.alt(p,E,["rl","lr"]);break;case"line":v=E.split(","),d.integer(p,v[0]),d.percent(p,v[0])&&d.set("snapToLines",!1),d.alt(p,v[0],["auto"]),v.length===2&&d.alt("lineAlign",v[1],["start",iu,"end"]);break;case"position":v=E.split(","),d.percent(p,v[0]),v.length===2&&d.alt("positionAlign",v[1],["start",iu,"end","line-left","line-right","auto"]);break;case"size":d.percent(p,E);break;case"align":d.alt(p,E,["start",iu,"end","left","right"]);break}},/:/,/\s/),f.region=d.get("region",null),f.vertical=d.get("vertical","");let m=d.get("line","auto");m==="auto"&&wg.line===-1&&(m=-1),f.line=m,f.lineAlign=d.get("lineAlign","start"),f.snapToLines=d.get("snapToLines",!0),f.size=d.get("size",100),f.align=d.get("align",iu);let g=d.get("position","auto");g==="auto"&&wg.position===50&&(g=f.align==="start"||f.align==="left"?0:f.align==="end"||f.align==="right"?100:50),f.position=g}function l(){s=s.replace(/^\s+/,"")}if(l(),e.startTime=r(),l(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);s=s.slice(3),l(),e.endTime=r(),l(),o(s,e)}function Fw(s){return s.replace(/<br(?: \/)?>/gi,`
`)}class B4{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new P4,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let o=t.buffer,l=0;for(o=Fw(o);l<o.length&&o[l]!=="\r"&&o[l]!==`
`;)++l;const c=o.slice(0,l);return o[l]==="\r"&&++l,o[l]===`
`&&++l,t.buffer=o.slice(l),c}function r(o){Pw(o,function(l,c){},/:/)}try{let o="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;o=n();const c=o.match(/^()?WEBVTT([ \t].*)?$/);if(!(c!=null&&c[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let l=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(l?l=!1:o=n(),t.state){case"HEADER":/:/.test(o)?r(o):o||(t.state="ID");continue;case"NOTE":o||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){t.state="NOTE";break}if(!o)continue;if(t.cue=new Bp(0,0,""),t.state="CUE",o.indexOf("-->")===-1){t.cue.id=o;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{U4(o,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const c=o.indexOf("-->")!==-1;if(!o||c&&(l=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=o}continue;case"BADCUE":o||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const $4=/\r\n|\n\r|\n|\r/g,Dm=function(e,t,n=0){return e.slice(n,n+t.length)===t},j4=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),o=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!ve(t)||!ve(n)||!ve(r)||!ve(o))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*r,t+=3600*1e3*o,t};function $p(s,e,t){return Yo(s.toString())+Yo(e.toString())+Yo(t)}const G4=function(e,t,n){let r=e[t],o=e[r.prevCC];if(!o||!o.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(l=o)!=null&&l.new;){var l;e.ccOffset+=r.start-o.start,r.new=!1,r=o,o=e[r.prevCC]}e.presentationOffset=n};function H4(s,e,t,n,r,o,l){const c=new B4,f=Nn(new Uint8Array(s)).trim().replace($4,`
`).split(`
`),d=[],m=e?W3(e.baseTime,e.timescale):0;let g="00:00.000",p=0,E=0,v,S=!0;c.oncue=function(b){const R=t[n];let C=t.ccOffset;const _=(p-m)/9e4;if(R!=null&&R.new&&(E!==void 0?C=t.ccOffset=R.start:G4(t,n,_)),_){if(!e){v=new Error("Missing initPTS for VTT MPEGTS");return}C=_-t.presentationOffset}const D=b.endTime-b.startTime,N=Cn((b.startTime+C-E)*9e4,r*9e4)/9e4;b.startTime=Math.max(N,0),b.endTime=Math.max(N+D,0);const B=b.text.trim();b.text=decodeURIComponent(encodeURIComponent(B)),b.id||(b.id=$p(b.startTime,b.endTime,B)),b.endTime>0&&d.push(b)},c.onparsingerror=function(b){v=b},c.onflush=function(){if(v){l(v);return}o(d)},f.forEach(b=>{if(S)if(Dm(b,"X-TIMESTAMP-MAP=")){S=!1,b.slice(16).split(",").forEach(R=>{Dm(R,"LOCAL:")?g=R.slice(6):Dm(R,"MPEGTS:")&&(p=parseInt(R.slice(7)))});try{E=j4(g)/1e3}catch(R){v=R}return}else b===""&&(S=!1);c.parse(b+`
`)}),c.flush()}const Im="stpp.ttml.im1t",Uw=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Bw=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,z4={left:"start",center:"center",right:"end",start:"start",end:"end"};function vb(s,e,t,n){const r=$e(new Uint8Array(s),["mdat"]);if(r.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const o=r.map(c=>Nn(c)),l=Y3(e.baseTime,1,e.timescale);try{o.forEach(c=>t(V4(c,l)))}catch(c){n(c)}}function V4(s,e){const r=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const o={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},l=Object.keys(o).reduce((g,p)=>(g[p]=r.getAttribute(`ttp:${p}`)||o[p],g),{}),c=r.getAttribute("xml:space")!=="preserve",f=xb(Om(r,"styling","style")),d=xb(Om(r,"layout","region")),m=Om(r,"body","[begin]");return[].map.call(m,g=>{const p=$w(g,c);if(!p||!g.hasAttribute("begin"))return null;const E=km(g.getAttribute("begin"),l),v=km(g.getAttribute("dur"),l);let S=km(g.getAttribute("end"),l);if(E===null)throw Eb(g);if(S===null){if(v===null)throw Eb(g);S=E+v}const b=new Bp(E-e,S-e,p);b.id=$p(b.startTime,b.endTime,b.text);const R=d[g.getAttribute("region")],C=f[g.getAttribute("style")],_=K4(R,C,f),{textAlign:D}=_;if(D){const N=z4[D];N&&(b.lineAlign=N),b.align=D}return at(b,_),b}).filter(g=>g!==null)}function Om(s,e,t){const n=s.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function xb(s){return s.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function $w(s,e){return[].slice.call(s.childNodes).reduce((t,n,r)=>{var o;return n.nodeName==="br"&&r?t+`
`:(o=n.childNodes)!=null&&o.length?$w(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function K4(s,e,t){const n="http://www.w3.org/ns/ttml#styling";let r=null;const o=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],l=s!=null&&s.hasAttribute("style")?s.getAttribute("style"):null;return l&&t.hasOwnProperty(l)&&(r=t[l]),o.reduce((c,f)=>{const d=Nm(e,n,f)||Nm(s,n,f)||Nm(r,n,f);return d&&(c[f]=d),c},{})}function Nm(s,e,t){return s&&s.hasAttributeNS(e,t)?s.getAttributeNS(e,t):null}function Eb(s){return new Error(`Could not parse ttml timestamp ${s}`)}function km(s,e){if(!s)return null;let t=Mw(s);return t===null&&(Uw.test(s)?t=q4(s,e):Bw.test(s)&&(t=Y4(s,e))),t}function q4(s,e){const t=Uw.exec(s),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function Y4(s,e){const t=Bw.exec(s),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class ru{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class W4{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=bb(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this),e.on(L.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(L.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(L.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this),e.off(L.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(L.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(L.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new ru(this,"textTrack1"),t=new ru(this,"textTrack2"),n=new ru(this,"textTrack3"),r=new ru(this,"textTrack4");this.cea608Parser1=new yb(1,e,t),this.cea608Parser2=new yb(3,n,r)}addCues(e,t,n,r,o){let l=!1;for(let c=o.length;c--;){const f=o[c],d=X4(f[0],f[1],t,n);if(d>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],n),l=!0,d/(n-t)>.5))return}if(l||o.push([t,n]),this.config.renderTextTracksNatively){const c=this.captionsTracks[e];this.Cues.newCue(c,t,n,r)}else{const c=this.Cues.newCue(null,t,n,r);this.hls.trigger(L.CUES_PARSED,{type:"captions",cues:c,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:o,trackId:l}){const{unparsedVttFrags:c}=this;n===xe.MAIN&&(this.initPTS[t.cc]={baseTime:r,timescale:o,trackId:l}),c.length&&(this.unparsedVttFrags=[],c.forEach(f=>{this.initPTS[f.frag.cc]?this.onFragLoaded(L.FRAG_LOADED,f):this.hls.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let r=0;r<n.textTracks.length;r++){const o=n.textTracks[r];if(Sb(o,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return o}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:o,languageCode:l}=t[e],c=this.getExistingTrack(o,l);if(c)n[e]=c,Ra(n[e]),Dw(n[e],r);else{const f=this.createTextTrack("captions",o,l);f&&(f[e]=!0,n[e]=f)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,r={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(L.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:r}=this;Object.keys(r).forEach(o=>{Ra(r[o]),delete r[o]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=bb(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Ra(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some(o=>o.textCodec===Im);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(yw(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const l=this.media,c=l?wu(l.textTracks):null;if(this.tracks.forEach((f,d)=>{let m;if(c){let g=null;for(let p=0;p<c.length;p++)if(c[p]&&Sb(c[p],f)){g=c[p],c[p]=null;break}g&&(m=g)}if(m)Ra(m);else{const g=jw(f);m=this.createTextTrack(g,f.name,f.lang),m&&(m.mode="disabled")}m&&this.textTracks.push(m)}),c!=null&&c.length){const f=c.filter(d=>d!==null).map(d=>d.label);f.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${f.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const l=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(L.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!r)return;const o=`textTrack${r[1]}`,l=this.captionsProperties[o];l&&(l.label=n.name,n.lang&&(l.languageCode=n.lang),l.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===xe.MAIN){var n,r;const{cea608Parser1:o,cea608Parser2:l,lastSn:c}=this,{cc:f,sn:d}=t.frag,m=(n=(r=t.part)==null?void 0:r.index)!=null?n:-1;o&&l&&(d!==c+1||d===c&&m!==this.lastPartIndex+1||f!==this.lastCc)&&(o.reset(),l.reset()),this.lastCc=f,this.lastSn=d,this.lastPartIndex=m}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===xe.SUBTITLE)if(r.byteLength){const o=n.decryptdata,l="stats"in t;if(o==null||!o.encrypted||l){const c=this.tracks[n.level],f=this.vttCCs;f[n.cc]||(f[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),c&&c.textCodec===Im?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;vb(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),n.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{n.logger.log(`Failed to parse IMSC1: ${r}`),n.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:o,unparsedVttFrags:l}=this,c=o.length-1;if(!o[n.cc]&&c===-1){l.push(e);return}const f=this.hls,d=(t=n.initSegment)!=null&&t.data?qn(n.initSegment.data,new Uint8Array(r)).buffer:r;H4(d,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,m=>{this._appendCues(m,n.level),f.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},m=>{const g=m.message==="Missing initPTS for VTT MPEGTS";g?l.push(e):this._fallbackToIMSC1(n,r),f.logger.log(`Failed to parse VTT cue: ${m}`),!(g&&c>n.cc)&&f.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:m})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||vb(t,this.initPTS[e.cc],()=>{n.textCodec=Im,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(o=>Iw(r,o))}else{const r=this.tracks[t];if(!r)return;const o=r.default?"default":"subtitles"+t;n.trigger(L.CUES_PARSED,{type:"subtitles",cues:e,track:o})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===xe.SUBTITLE&&this.onFragLoaded(L.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:r}=t;if(!(n.type===xe.MAIN&&this.closedCaptionsForLevel(n)==="NONE"))for(let o=0;o<r.length;o++){const l=r[o].bytes;if(l){this.cea608Parser1||this.initCea608Parsers();const c=this.extractCea608Data(l);this.cea608Parser1.addData(r[o].pts,c[0]),this.cea608Parser2.addData(r[o].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:o}){const{media:l}=this;if(!(!l||l.currentTime<n)){if(!o||o==="video"){const{captionsTracks:c}=this;Object.keys(c).forEach(f=>Rg(c[f],t,n))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:c}=this;Object.keys(c).forEach(f=>Rg(c[f],t,r))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let r=2;for(let o=0;o<n;o++){const l=e[r++],c=127&e[r++],f=127&e[r++];if(c===0&&f===0)continue;if((4&l)!==0){const m=3&l;(m===0||m===1)&&(t[m].push(c),t[m].push(f))}}return t}}function jw(s){return s.characteristics&&/transcribes-spoken-dialog/gi.test(s.characteristics)&&/describes-music-and-sound/gi.test(s.characteristics)?"captions":"subtitles"}function Sb(s,e){return!!s&&s.kind===jw(e)&&Sg(e,s)}function X4(s,e,t,n){return Math.min(e,n)-Math.max(s,t)}function bb(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const Q4=/\s/,Z4={newCue(s,e,t,n){const r=[];let o,l,c,f,d;const m=self.VTTCue||self.TextTrackCue;for(let p=0;p<n.rows.length;p++)if(o=n.rows[p],c=!0,f=0,d="",!o.isEmpty()){var g;for(let S=0;S<o.chars.length;S++)Q4.test(o.chars[S].uchar)&&c?f++:(d+=o.chars[S].uchar,c=!1);o.cueStartTime=e,e===t&&(t+=1e-4),f>=16?f--:f++;const E=Fw(d.trim()),v=$p(e,t,E);s!=null&&(g=s.cues)!=null&&g.getCueById(v)||(l=new m(e,t,E),l.id=v,l.line=p+1,l.align="left",l.position=10+Math.min(80,Math.floor(f*8/32)*10),r.push(l))}return s&&r.length&&(r.sort((p,E)=>p.line==="auto"||E.line==="auto"?0:p.line>8&&E.line>8?E.line-p.line:p.line-E.line),r.forEach(p=>Iw(s,p))),r}};function J4(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const ej=/(\d+)-(\d+)\/(\d+)/;class Tb{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||ij,this.controller=new self.AbortController,this.stats=new vp}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const o=tj(e,this.controller.signal),l=e.responseType==="arraybuffer",c=l?"byteLength":"length",{maxTimeToFirstByteMs:f,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,o),self.clearTimeout(this.requestTimeout),t.timeout=f&&ve(f)?f:d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},t.timeout),(rl(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(g=>{var p;this.response=this.loader=g;const E=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},d-(E-r.loading.start)),!g.ok){const{status:S,statusText:b}=g;throw new rj(b||"fetch, bad network response",S,g)}r.loading.first=E,r.total=sj(g.headers)||r.total;const v=(p=this.callbacks)==null?void 0:p.onProgress;return v&&ve(t.highWaterMark)?this.loadProgressively(g,r,e,t.highWaterMark,v):l?g.arrayBuffer():e.responseType==="json"?g.json():g.text()}).then(g=>{var p,E;const v=this.response;if(!v)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const S=g[c];S&&(r.loaded=r.total=S);const b={url:v.url,data:g,code:v.status},R=(p=this.callbacks)==null?void 0:p.onProgress;R&&!ve(t.highWaterMark)&&R(r,e,g,v),(E=this.callbacks)==null||E.onSuccess(b,r,e,v)}).catch(g=>{var p;if(self.clearTimeout(this.requestTimeout),r.aborted)return;const E=g&&g.code||0,v=g?g.message:null;(p=this.callbacks)==null||p.onError({code:E,text:v},e,g?g.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,o){const l=new QR,c=e.body.getReader(),f=()=>c.read().then(d=>{if(d.done)return l.dataLength&&o(t,n,l.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const m=d.value,g=m.length;return t.loaded+=g,g<r||l.dataLength?(l.push(m),l.dataLength>=r&&o(t,n,l.flush().buffer,e)):o(t,n,m.buffer,e),f()}).catch(()=>Promise.reject());return f()}}function tj(s,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(at({},s.headers))};return s.rangeEnd&&t.headers.set("Range","bytes="+s.rangeStart+"-"+String(s.rangeEnd-1)),t}function nj(s){const e=ej.exec(s);if(e)return parseInt(e[2])-parseInt(e[1])+1}function sj(s){const e=s.get("Content-Range");if(e){const n=nj(e);if(ve(n))return n}const t=s.get("Content-Length");if(t)return parseInt(t)}function ij(s,e){return new self.Request(s.url,e)}class rj extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const aj=/^age:\s*[\d.]+\s*$/im;class Gw{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new vp,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const o=this.xhrSetup;o?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return o(n,t.url)}).catch(l=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),o(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(l=>{var c;(c=this.callbacks)==null||c.onError({code:n.status,text:l.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:o,maxLoadTimeMs:l}=n.loadPolicy;if(r)for(const c in r)e.setRequestHeader(c,r[c]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=o&&ve(o)?o:l,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,o=this.config;if(!n.aborted&&r>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),o.timeout!==o.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),o.timeout=o.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),o.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const d=t.status,m=t.responseType==="text"?t.responseText:null;if(d>=200&&d<300){const v=m??t.response;if(v!=null){var l,c;n.loading.end=Math.max(self.performance.now(),n.loading.first);const S=t.responseType==="arraybuffer"?v.byteLength:v.length;n.loaded=n.total=S,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first);const b=(l=this.callbacks)==null?void 0:l.onProgress;b&&b(n,e,v,t);const R={url:t.responseURL,data:v,code:d};(c=this.callbacks)==null||c.onSuccess(R,n,e,t);return}}const g=o.loadPolicy.errorRetry,p=n.retry,E={url:e.url,data:void 0,code:d};if(Vu(g,p,!1,E))this.retry(g);else{var f;nt.error(`${d} while loading ${e.url}`),(f=this.callbacks)==null||f.onError({code:d,text:t.statusText},e,t,n)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Vu(e,t,!0))this.retry(e);else{var n;nt.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=bp(e,n.retry),n.retry++,nt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&aj.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const oj={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},lj=tt(tt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:Gw,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:EB,bufferController:u$,capLevelController:Pp,errorController:RB,fpsController:d4,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:$R,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:oj},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},cj()),{},{subtitleStreamController:T4,subtitleTrackController:m4,timelineController:W4,audioStreamController:a$,audioTrackController:o$,emeController:Ia,cmcdController:o4,contentSteeringController:c4,interstitialsController:b4});function cj(){return{cueHandler:Z4,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function uj(s,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Lg(s),r=["manifest","level","frag"],o=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(l=>{const c=`${l==="level"?"playlist":l}LoadPolicy`,f=e[c]===void 0,d=[];o.forEach(m=>{const g=`${l}Loading${m}`,p=e[g];if(p!==void 0&&f){d.push(g);const E=n[c].default;switch(e[c]={default:E},m){case"TimeOut":E.maxLoadTimeMs=p,E.maxTimeToFirstByteMs=p;break;case"MaxRetry":E.errorRetry.maxNumRetry=p,E.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":E.errorRetry.retryDelayMs=p,E.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":E.errorRetry.maxRetryDelayMs=p,E.timeoutRetry.maxRetryDelayMs=p;break}}}),d.length&&t.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${c}": ${ut(e[c])}`)}),tt(tt({},n),e)}function Lg(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(Lg):Object.keys(s).reduce((e,t)=>(e[t]=Lg(s[t]),e),{}):s}function dj(s,e){const t=s.loader;t!==Tb&&t!==Gw?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):J4()&&(s.loader=Tb,s.progressive=!0,s.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const Lu=2,fj=.1,hj=.05,mj=100;class gj extends MR{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var n;(n=this.media)!=null&&n.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var n;this.ended=((n=this.media)==null?void 0:n.currentTime)||1,this.hls.trigger(L.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(mj),this.mediaSource=t.mediaSource;const n=this.media=t.media;an(n,"playing",this.onMediaPlaying),an(n,"waiting",this.onMediaWaiting),an(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(gn(n,"playing",this.onMediaPlaying),gn(n,"waiting",this.onMediaWaiting),gn(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,r;const o=(n=this.hls)==null?void 0:n.config;if(!o)return;const l=this.media;if(!l)return;const{seeking:c}=l,f=this.seeking&&!c,d=!this.seeking&&c,m=l.paused&&!c||l.ended||l.playbackRate===0;if(this.seeking=c,e!==t){t&&(this.ended=0),this.moved=!0,c||(this.nudgeRetry=0,o.nudgeOnVideoHole&&!m&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(d||f){f&&this.stallResolved(e);return}if(m){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&l.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(L.MEDIA_ENDED,{stalled:!1}));return}if(!Ie.getBuffered(l).length){this.nudgeRetry=0;return}const g=Ie.bufferInfo(l,e,0),p=g.nextStart||0,E=this.fragmentTracker;if(c&&E&&this.hls){const B=Ab(this.hls.inFlightFragments,e),I=g.len>Lu,P=!p||B||p-e>Lu&&!E.getPartialFragment(e);if(I||P)return;this.moved=!1}const v=(r=this.hls)==null?void 0:r.latestLevelDetails;if(!this.moved&&this.stalled!==null&&E){if(!(g.len>0)&&!p)return;const I=Math.max(p,g.start||0)-e,M=!!(v!=null&&v.live)?v.targetduration*2:Lu,U=au(e,E);if(I>0&&(I<=M||U)){l.paused||this._trySkipBufferHole(U);return}}const S=o.detectStallWithCurrentTimeMs,b=self.performance.now(),R=this.waiting;let C=this.stalled;if(C===null)if(R>0&&b-R<S)C=this.stalled=R;else{this.stalled=b;return}const _=b-C;if(!c&&(_>=S||R)&&this.hls){var D;if(((D=this.mediaSource)==null?void 0:D.readyState)==="ended"&&!(v!=null&&v.live)&&Math.abs(e-(v?.edge||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(L.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(g),!this.media||!this.hls)return}const N=Ie.bufferInfo(l,e,o.maxBufferHole);this._tryFixBufferStall(N,_,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(L.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const r=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(n=this.buffered.audio)!=null&&n.length&&r&&r.length>1&&e>r.end(0)){const o=Ie.bufferedInfo(Ie.timeRangesToArray(this.buffered.audio),e,0);if(o.len>1&&t>=o.start){const l=Ie.timeRangesToArray(r),c=Ie.bufferedInfo(l,t,0).bufferedIndex;if(c>-1&&c<l.length-1){const f=Ie.bufferedInfo(l,e,0).bufferedIndex,d=l[c].end,m=l[c+1].start;if((f===-1||f>c)&&m-d<1&&e-d<2){const g=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${d} -> ${m} buffered index: ${f}`);this.warn(g.message),this.media.currentTime+=1e-6;let p=au(e,this.fragmentTracker);p&&"fragment"in p?p=p.fragment:p||(p=void 0);const E=Ie.bufferInfo(this.media,e,0);this.hls.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:g,reason:g.message,frag:p,buffer:E.len,bufferInfo:E})}}}}}_tryFixBufferStall(e,t,n){var r,o;const{fragmentTracker:l,media:c}=this,f=(r=this.hls)==null?void 0:r.config;if(!c||!l||!f)return;const d=(o=this.hls)==null?void 0:o.latestLevelDetails,m=au(n,l);if((m||d!=null&&d.live&&n<d.fragmentStart)&&(this._trySkipBufferHole(m)||!this.media))return;const g=e.buffered,p=this.adjacentTraversal(e,n);(g&&g.length>1&&e.len>f.maxBufferHole||e.nextStart&&(e.nextStart-n<f.maxBufferHole||p))&&(t>f.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const n=this.fragmentTracker,r=e.nextStart;if(n&&r){const o=n.getFragAtPos(t,xe.MAIN),l=n.getFragAtPos(r,xe.MAIN);if(o&&l)return l.sn-o.sn<2}return!1}_reportStall(e){const{hls:t,media:n,stallReported:r,stalled:o}=this;if(!r&&o!==null&&n&&t){this.stallReported=!0;const l=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${ut(e)})`);this.warn(l.message),t.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.BUFFER_STALLED_ERROR,fatal:!1,error:l,buffer:e.len,bufferInfo:e,stalled:{start:o}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:r}=this,o=(t=this.hls)==null?void 0:t.config;if(!r||!n||!o)return 0;const l=r.currentTime,c=Ie.bufferInfo(r,l,0),f=l<c.start?c.start:c.nextStart;if(f&&this.hls){const m=c.len<=o.maxBufferHole,g=c.len>0&&c.len<1&&r.readyState<3,p=f-l;if(p>0&&(m||g)){if(p>o.maxBufferHole){let v=!1;if(l===0){const S=n.getAppendedFrag(0,xe.MAIN);S&&f<S.end&&(v=!0)}if(!v&&e){var d;if(!((d=this.hls.loadLevelObj)!=null&&d.details)||Ab(this.hls.inFlightFragments,f))return 0;let b=!1,R=e.end;for(;R<f;){const C=au(R,n);if(C)R+=C.duration;else{b=!0;break}}if(b)return 0}}const E=Math.max(f+hj,l+fj);if(this.warn(`skipping hole, adjusting currentTime from ${l} to ${E}`),this.moved=!0,r.currentTime=E,!(e!=null&&e.gap)){const v=new Error(`fragment loaded with buffer holes, seeking from ${l} to ${E}`),S={type:Ae.MEDIA_ERROR,details:W.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:v,reason:v.message,buffer:c.len,bufferInfo:c};e&&("fragment"in e?S.part=e:S.frag=e),this.hls.trigger(L.ERROR,S)}return E}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:r}=this,o=t?.config;if(!n||!o)return 0;const l=n.currentTime;if(this.nudgeRetry++,r<o.nudgeMaxRetry){const c=l+(r+1)*o.nudgeOffset,f=new Error(`Nudging 'currentTime' from ${l} to ${c}`);this.warn(f.message),n.currentTime=c,t.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.BUFFER_NUDGE_ON_STALL,error:f,fatal:!1,buffer:e.len,bufferInfo:e})}else{const c=new Error(`Playhead still not moving while enough data buffered @${l} after ${o.nudgeMaxRetry} nudges`);this.error(c.message),t.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.BUFFER_STALLED_ERROR,error:c,fatal:!0,buffer:e.len,bufferInfo:e})}}}function Ab(s,e){const t=Rb(s.main);if(t&&t.start<=e)return t;const n=Rb(s.audio);return n&&n.start<=e?n:null}function Rb(s){if(!s)return null;switch(s.state){case ce.IDLE:case ce.STOPPED:case ce.ENDED:case ce.ERROR:return null}return s.frag}function au(s,e){return e.getAppendedFrag(s,xe.MAIN)||e.getPartialFragment(s)}const pj=.25;function Cg(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Mm(s,e,t,n,r){let o=new s(e,t,"");try{o.value=n,r&&(o.type=r)}catch{o=new s(e,t,ut(r?tt({type:r},n):n))}return o}const ou=(()=>{const s=Cg();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class yj{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(L.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var n;this.media=t.media,((n=t.overrides)==null?void 0:n.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&Ra(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return Dw(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:n,enableID3MetadataCues:r}=this.hls.config;if(!n&&!r)return;const{samples:o}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=Cg();if(l)for(let c=0;c<o.length;c++){const f=o[c].type;if(f===Dn.emsg&&!n||!r)continue;const d=iw(o[c].data),m=o[c].pts;let g=m+o[c].duration;g>ou&&(g=ou),g-m<=0&&(g=m+pj);for(let E=0;E<d.length;E++){const v=d[E];if(!rw(v)){this.updateId3CueEnds(m,f);const S=Mm(l,m,g,v,f);S&&this.id3Track.addCue(S)}}}}updateId3CueEnds(e,t){var n;const r=(n=this.id3Track)==null?void 0:n.cues;if(r)for(let o=r.length;o--;){const l=r[o];l.type===t&&l.startTime<e&&l.endTime===ou&&(l.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:o,hls:l}=this;if(!l)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:f}}=l;if(o&&(c||f)){let d;r==="audio"?d=m=>m.type===Dn.audioId3&&f:r==="video"?d=m=>m.type===Dn.emsg&&c:d=m=>m.type===Dn.audioId3&&f||m.type===Dn.emsg&&c,Rg(o,t,n,d)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:n,timelineOffset:r,enableDateRangeMetadataCues:o,interstitialsController:l}=this.hls.config;if(!o)return;const c=Cg();if(n&&r&&!l){const{fragmentStart:S,fragmentEnd:b}=e;let R=this.assetCue;R?(R.startTime=S,R.endTime=b):c&&(R=this.assetCue=Mm(c,S,b,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),R&&(R.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(R),R.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:f}=this,{dateRanges:d}=e,m=Object.keys(d);let g=this.dateRangeCuesAppended;if(f&&t){var p;if((p=f.cues)!=null&&p.length){const S=Object.keys(g).filter(b=>!m.includes(b));for(let b=S.length;b--;){var E;const R=S[b],C=(E=g[R])==null?void 0:E.cues;delete g[R],C&&Object.keys(C).forEach(_=>{const D=C[_];if(D){D.removeEventListener("enter",this.onEventCueEnter);try{f.removeCue(D)}catch{}}})}}else g=this.dateRangeCuesAppended={}}const v=e.fragments[e.fragments.length-1];if(!(m.length===0||!ve(v?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let S=0;S<m.length;S++){const b=m[S],R=d[b],C=R.startTime,_=g[b],D=_?.cues||{};let N=_?.durationKnown||!1,B=ou;const{duration:I,endDate:P}=R;if(P&&I!==null)B=C+I,N=!0;else if(R.endOnNext&&!N){const U=m.reduce((q,V)=>{if(V!==R.id){const ee=d[V];if(ee.class===R.class&&ee.startDate>R.startDate&&(!q||R.startDate<q.startDate))return ee}return q},null);U&&(B=U.startTime,N=!0)}const M=Object.keys(R.attr);for(let U=0;U<M.length;U++){const q=M[U];if(!UB(q))continue;const V=D[q];if(V)N&&!(_!=null&&_.durationKnown)?V.endTime=B:Math.abs(V.startTime-C)>.01&&(V.startTime=C,V.endTime=B);else if(c){let ee=R.attr[q];BB(q)&&(ee=gR(ee));const re=Mm(c,C,B,{key:q,data:ee},Dn.dateRange);re&&(re.id=b,this.id3Track.addCue(re),D[q]=re,l&&(q==="X-ASSET-LIST"||q==="X-ASSET-URL")&&re.addEventListener("enter",this.onEventCueEnter))}}g[b]={cues:D,dateRange:R,durationKnown:N}}}}}class vj{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,n=this.levelDetails;if(!t||!n)return;this.currentTime=t.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:o,maxLiveSyncPlaybackRate:l}=this.config;if(!o||l===1||!n.live)return;const c=this.targetLatency;if(c===null)return;const f=r-c,d=Math.min(this.maxLatency,c+n.targetduration);if(f<d&&f>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,l)),p=Math.round(2/(1+Math.exp(-.75*f-this.edgeStalled))*20)/20,E=Math.min(g,Math.max(1,p));this.changeMediaPlaybackRate(t,E)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:o,liveSyncDurationCount:l,lowLatencyMode:c}=this.config,f=this.hls.userConfig;let d=c&&n||t;(this._targetLatencyUpdated||f.liveSyncDuration||f.liveSyncDurationCount||d===0)&&(d=o!==void 0?o:l*r);const m=r;return d+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,m)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const n=this.levelDetails;if(n===null)return null;const r=n.edge,o=e-t-this.edgeStalled,l=r-n.totalduration,c=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(l,o),c)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===W.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(n=this.levelDetails)!=null&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,r;e.playbackRate!==t&&((n=this.hls)==null||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(r=this.targetLatency)==null?void 0:r.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class xj extends Mp{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,r=[],o={},l={};let c=!1,f=!1,d=!1;t.levels.forEach(m=>{const g=m.attrs;let{audioCodec:p,videoCodec:E}=m;p&&(m.audioCodec=p=ju(p,n)||void 0),E&&(E=m.videoCodec=tB(E));const{width:v,height:S,unknownCodecs:b}=m,R=b?.length||0;if(c||(c=!!(v&&S)),f||(f=!!E),d||(d=!!p),R||p&&!this.isAudioSupported(p)||E&&!this.isVideoSupported(E)){this.log(`Some or all CODECS not supported "${g.CODECS}"`);return}const{CODECS:C,"FRAME-RATE":_,"HDCP-LEVEL":D,"PATHWAY-ID":N,RESOLUTION:B,"VIDEO-RANGE":I}=g,M=`${`${N||"."}-`}${m.bitrate}-${B}-${_}-${C}-${I}-${D}`;if(o[M])if(o[M].uri!==m.url&&!m.attrs["PATHWAY-ID"]){const U=l[M]+=1;m.attrs["PATHWAY-ID"]=new Array(U+1).join(".");const q=this.createLevel(m);o[M]=q,r.push(q)}else o[M].addGroupId("audio",g.AUDIO),o[M].addGroupId("text",g.SUBTITLES);else{const U=this.createLevel(m);o[M]=U,l[M]=1,r.push(U)}}),this.filterAndSortMediaOptions(r,t,c,f,d)}createLevel(e){const t=new nl(e),n=e.supplemental;if(n!=null&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const r=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(r.message),t.supportedResult=LR(r,[])}return t}isAudioSupported(e){return el(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return el(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,r,o){var l;let c=[],f=[],d=e;const m=((l=t.stats)==null?void 0:l.parsing)||{};if((n||r)&&o&&(d=d.filter(({videoCodec:C,videoRange:_,width:D,height:N})=>(!!C||!!(D&&N))&&dB(_))),d.length===0){Promise.resolve().then(()=>{if(this.hls){let C="no level with compatible codecs found in manifest",_=C;t.levels.length&&(_=`one or more CODECS in variant not supported: ${ut(t.levels.map(N=>N.attrs.CODECS).filter((N,B,I)=>I.indexOf(N)===B))}`,this.warn(_),C+=` (${_})`);const D=new Error(C);this.hls.trigger(L.ERROR,{type:Ae.MEDIA_ERROR,details:W.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:D,reason:_})}}),m.end=performance.now();return}t.audioTracks&&(c=t.audioTracks.filter(C=>!C.audioCodec||this.isAudioSupported(C.audioCodec)),wb(c)),t.subtitles&&(f=t.subtitles,wb(f));const g=d.slice(0);d.sort((C,_)=>{if(C.attrs["HDCP-LEVEL"]!==_.attrs["HDCP-LEVEL"])return(C.attrs["HDCP-LEVEL"]||"")>(_.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&C.height!==_.height)return C.height-_.height;if(C.frameRate!==_.frameRate)return C.frameRate-_.frameRate;if(C.videoRange!==_.videoRange)return Gu.indexOf(C.videoRange)-Gu.indexOf(_.videoRange);if(C.videoCodec!==_.videoCodec){const D=yS(C.videoCodec),N=yS(_.videoCodec);if(D!==N)return N-D}if(C.uri===_.uri&&C.codecSet!==_.codecSet){const D=$u(C.codecSet),N=$u(_.codecSet);if(D!==N)return N-D}return C.averageBitrate!==_.averageBitrate?C.averageBitrate-_.averageBitrate:0});let p=g[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==g.length)){for(let C=0;C<g.length;C++)if(g[C].pathwayId===d[0].pathwayId){p=g[C];break}}this._levels=d;for(let C=0;C<d.length;C++)if(d[C]===p){var E;this._firstLevel=C;const _=p.bitrate,D=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${_}`),((E=this.hls.userConfig)==null?void 0:E.abrEwmaDefaultEstimate)===void 0){const N=Math.min(_,this.hls.config.abrEwmaDefaultEstimateMax);N>D&&D===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=N)}break}const v=o&&!r,S=this.hls.config,b=!!(S.audioStreamController&&S.audioTrackController),R={levels:d,audioTracks:c,subtitleTracks:f,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:r,altAudio:b&&!v&&c.some(C=>!!C.url)};m.end=performance.now(),this.hls.trigger(L.MANIFEST_PARSED,R)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const m=new Error("invalid level idx"),g=e<0;if(this.hls.trigger(L.ERROR,{type:Ae.OTHER_ERROR,details:W.LEVEL_SWITCH_ERROR,level:e,fatal:g,error:m,reason:m.message}),g)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,o=r?r.attrs["PATHWAY-ID"]:void 0,l=t[e],c=l.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=l,n===e&&r&&o===c)return;this.log(`Switching to level ${e} (${l.height?l.height+"p ":""}${l.videoRange?l.videoRange+" ":""}${l.codecSet?l.codecSet+" ":""}@${l.bitrate})${c?" with Pathway "+c:""} from level ${n}${o?" with Pathway "+o:""}`);const f={level:e,attrs:l.attrs,details:l.details,bitrate:l.bitrate,averageBitrate:l.averageBitrate,maxBitrate:l.maxBitrate,realBitrate:l.realBitrate,width:l.width,height:l.height,codecSet:l.codecSet,audioCodec:l.audioCodec,videoCodec:l.videoCodec,audioGroups:l.audioGroups,subtitleGroups:l.subtitleGroups,loaded:l.loaded,loadError:l.loadError,fragmentError:l.fragmentError,name:l.name,id:l.id,uri:l.uri,url:l.url,urlId:0,audioGroupIds:l.audioGroupIds,textGroupIds:l.textGroupIds};this.hls.trigger(L.LEVEL_SWITCHING,f);const d=l.details;if(!d||d.live){const m=this.switchParams(l.uri,r?.details,d);this.loadPlaylist(m)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(r=>t.indexOf(r)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=n}}onError(e,t){t.fatal||!t.context||t.context.type===je.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===xe.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(o=>!!n[o]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:o}=t,l=t.levelInfo;if(!l){var c;this.warn(`Invalid level index ${r}`),(c=t.deliveryDirectives)!=null&&c.skip&&(o.deltaUpdateFailed=!0);return}if(l===this.currentLevel||t.withoutMultiVariant){l.fragmentError===0&&(l.loadError=0);let f=l.details;f===t.details&&f.advanced&&(f=void 0),this.playlistLoaded(r,t,f)}else(n=t.deliveryDirectives)!=null&&n.skip&&(o.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),r=this.currentLevelIndex,o=e.attrs["PATHWAY-ID"],l=e.details,c=l?.age;this.log(`Loading level index ${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${o?" Pathway "+o:""}${c&&l.live?" age "+c.toFixed(1)+(l.type&&" "+l.type||""):""} ${n}`),this.hls.trigger(L.LEVEL_LOADING,{url:n,level:r,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const n=this._levels.filter((o,l)=>l!==e?!0:(this.steering&&this.steering.removeLevel(o),o===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,o.details&&o.details.fragments.forEach(c=>c.level=-1)),!1));YR(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const r=n.length-1;this._firstLevel=Math.min(this._firstLevel,r),this._startLevel&&(this._startLevel=Math.min(this._startLevel,r)),this.hls.trigger(L.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(L.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function wb(s){const e={};s.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}function Hw(){return self.SourceBuffer||self.WebKitSourceBuffer}function zw(){if(!zi())return!1;const e=Hw();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function Ej(){if(!zw())return!1;const s=zi();return typeof s?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>s.isTypeSupported(tl(e,"video")))||["mp4a.40.2","fLaC"].some(e=>s.isTypeSupported(tl(e,"audio"))))}function Sj(){var s;const e=Hw();return typeof(e==null||(s=e.prototype)==null?void 0:s.changeType)=="function"}const bj=100;class Tj extends Lp{constructor(e,t,n){super(e,t,n,"stream-controller",xe.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const r=this.media,o=r?r.currentTime:null;if(o===null||!ve(o)||(this.log(`Media seeked to ${o.toFixed(3)}`),!this.getBufferedFrag(o)))return;const l=this.getFwdBufferInfoAtPos(r,o,xe.MAIN,0);if(l===null||l.len===0){this.warn(`Main forward buffer length at ${o} on "seeked" event ${l?l.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:r}=this;if(this.stopLoad(),this.setInterval(bj),this.level=-1,!this.startFragRequested){let o=r.startLevel;o===-1&&(r.config.testBandwidth&&this.levels.length>1?(o=0,this.bitrateTest=!0):o=r.firstAutoLevel),r.nextLoadLevel=o,this.level=r.loadLevel,this._hasEnoughToStart=!!t}n>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=ce.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=ce.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ce.WAITING_LEVEL:{const{levels:e,level:t}=this,n=e?.[t],r=n?.details;if(r&&(!r.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(r))break;this.state=ce.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ce.IDLE;break}break}case ce.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===ce.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this;if(t===null||!r&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const o=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[o]))return;const l=n[o],c=this.getMainFwdBufferInfo();if(c===null)return;const f=this.getLevelDetails();if(f&&this._streamEnded(c,f)){const S={};this.altAudio===2&&(S.type="video"),this.hls.trigger(L.BUFFER_EOS,S),this.state=ce.ENDED;return}if(!this.buffering)return;e.loadLevel!==o&&e.manualLevel===-1&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const d=l.details;if(!d||this.state===ce.WAITING_LEVEL||this.waitForLive(l)){this.level=o,this.state=ce.WAITING_LEVEL,this.startFragRequested=!1;return}const m=c.len,g=this.getMaxBufferLength(l.maxBitrate);if(m>=g)return;this.backtrackFragment&&this.backtrackFragment.start>c.end&&(this.backtrackFragment=null);const p=this.backtrackFragment?this.backtrackFragment.start:c.end;let E=this.getNextFragment(p,d);if(this.couldBacktrack&&!this.fragPrevious&&E&&Lt(E)&&this.fragmentTracker.getState(E)!==Ut.OK){var v;const b=((v=this.backtrackFragment)!=null?v:E).sn-d.startSN,R=d.fragments[b-1];R&&E.cc===R.cc&&(E=R,this.fragmentTracker.removeFragment(R))}else this.backtrackFragment&&c.len&&(this.backtrackFragment=null);if(E&&this.isLoopLoading(E,p)){if(!E.gap){const b=this.audioOnly&&!this.altAudio?ct.AUDIO:ct.VIDEO,R=(b===ct.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;R&&this.afterBufferFlushed(R,b,xe.MAIN)}E=this.getNextFragmentLoopLoading(E,d,c,xe.MAIN,g)}E&&(E.initSegment&&!E.initSegment.data&&!this.bitrateTest&&(E=E.initSegment),this.loadFragment(E,l,p))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);r===Ut.NOT_LOADED||r===Ut.PARTIAL?Lt(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,xe.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const o=this.getLevelDetails();if(o!=null&&o.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<o.targetduration*2)return}if(!t.paused&&e){const c=this.hls.nextLoadLevel,f=e[c],d=this.fragLastKbps;d&&this.fragCurrent?n=this.fragCurrent.duration*f.maxBitrate/(1e3*d)+1:n=0}else n=0;const l=this.getBufferedFrag(t.currentTime+n);if(l){const c=this.followingBufferedFrag(l);if(c){this.abortCurrentFrag();const f=c.maxStartPTS?c.maxStartPTS:c.start,d=c.duration,m=Math.max(l.end,f+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ce.KEY_LOADING:case ce.FRAG_LOADING:case ce.FRAG_LOADING_WAITING_RETRY:case ce.PARSING:case ce.PARSED:this.state=ce.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;an(n,"playing",this.onMediaPlaying),an(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(gn(n,"playing",this.onMediaPlaying),gn(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(L.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,r=!1;for(let o=0;o<t.levels.length;o++){const l=t.levels[o].audioCodec;l&&(n=n||l.indexOf("mp4a.40.2")!==-1,r=r||l.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=n&&r&&!Sj(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==ce.IDLE)return;const r=t.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=ce.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:r,startFragRequested:o}=this,l=t.level,c=t.details,f=c.totalduration;if(!r){this.warn(`Levels were reset while loading level ${l}`);return}this.log(`Level ${l} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""}, cc [${c.startCC}, ${c.endCC}] duration:${f}`);const d=t.levelInfo,m=this.fragCurrent;m&&(this.state===ce.FRAG_LOADING||this.state===ce.FRAG_LOADING_WAITING_RETRY)&&m.level!==t.level&&m.loader&&this.abortCurrentFrag();let g=0;if(c.live||(n=d.details)!=null&&n.live){var p;if(this.checkLiveUpdate(c),c.deltaUpdateFailed)return;g=this.alignPlaylists(c,d.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(d.details=c,this.levelLastLoaded=d,o||this.setStartPosition(c,g),this.hls.trigger(L.LEVEL_UPDATED,{details:c,level:l}),this.state===ce.WAITING_LEVEL){if(this.waitForCdnTuneIn(c))return;this.state=ce.IDLE}o&&c.live&&this.synchronizeToLiveEdge(c),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,o=this.getLoadPosition(),l=e.fragmentStart,c=e.edge,f=o>=l-t.maxFragLookUpTolerance&&o<=c;if(r!==null&&n.duration>r&&(o<r||!f)){const m=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!f&&n.readyState<4||o<c-m)&&(this._hasEnoughToStart||(this.nextLoadPosition=r),n.readyState))if(this.warn(`Playback: ${o.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${r.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var d;const g=Ie.bufferInfo(n,r,0);if(!((d=g.buffered)!=null&&d.length)){n.currentTime=r;return}if(g.start<=o){n.currentTime=r;return}const{nextStart:E}=Ie.bufferedInfo(g.buffered,o,0);E&&(n.currentTime=E)}else n.currentTime=r}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:r,payload:o}=e,{levels:l}=this;if(!l){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const c=l[n.level];if(!c){this.warn(`Level ${n.level} not found on progress`);return}const f=c.details;if(!f){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const d=c.videoCodec,m=f.PTSKnown||!f.live,g=(t=n.initSegment)==null?void 0:t.data,p=this._getAudioCodec(c),E=this.transmuxer=this.transmuxer||new pw(this.hls,xe.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),v=r?r.index:-1,S=v!==-1,b=new Ap(n.level,n.sn,n.stats.chunkCount,o.byteLength,v,S),R=this.initPTS[n.cc];E.push(o,g,p,d,n,r,f.totalduration,m,b,R)}onAudioTrackSwitching(e,t){const n=this.hls,r=this.altAudio!==0;if(Hu(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const l=this.fragCurrent;l&&(this.log("Switching to main audio track, cancel main fragment load"),l.abortRequests(),this.fragmentTracker.removeFragment(l)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(r){this.altAudio=0,this.fragmentTracker.removeAllFragments(),n.once(L.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(L.AUDIO_TRACK_SWITCHED,t)}),n.trigger(L.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}n.trigger(L.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=Hu(t.url,this.hls);if(n){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,o,l=!1;for(const c in n){const f=n[c];if(f.id==="main"){if(o=c,r=f,c==="video"){const d=n[c];d&&(this.videoBuffer=d.buffer)}}else l=!0}l&&r?(this.log(`Alternate track found, use ${o}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t,o=n.type===xe.MAIN;if(o){if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ce.PARSED&&(this.state=ce.IDLE);return}const c=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*c.total/(c.buffering.end-c.loading.first)),Lt(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}const l=this.media;l&&(!this._hasEnoughToStart&&Ie.getBuffered(l).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),o&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal){this.state=ce.ERROR;return}switch(t.details){case W.FRAG_GAP:case W.FRAG_PARSING_ERROR:case W.FRAG_DECRYPT_ERROR:case W.FRAG_LOAD_ERROR:case W.FRAG_LOAD_TIMEOUT:case W.KEY_LOAD_ERROR:case W.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(xe.MAIN,t);break;case W.LEVEL_LOAD_ERROR:case W.LEVEL_LOAD_TIMEOUT:case W.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ce.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===je.LEVEL&&(this.state=ce.IDLE);break;case W.BUFFER_ADD_CODEC_ERROR:case W.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case W.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case W.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=ce.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==ct.AUDIO||!this.altAudio){const n=(t===ct.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,t,xe.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const r=this.timelineOffset;r&&n&&(n+=r);const o=this.getLevelDetails(),l=Ie.getBuffered(e),c=l.length?l.start(0):0,f=c-n,d=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||f>0&&(f<d||this.loadingParts&&f<2*(o?.partTarget||0)))&&(this.log(`adjusting start position by ${f} to match buffer start`),n+=f,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${c}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:r}=this,o=n?.frag;if(!o||this.fragContextChanged(o))return;t.fragmentError=0,this.state=ce.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const l=o.stats;l.parsing.start=l.parsing.end=l.buffering.start=l.buffering.end=self.performance.now(),r.trigger(L.FRAG_LOADED,n),o.bitrateTest=!1}).catch(n=>{this.state===ce.STOPPED||this.state===ce.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:n}=this,{remuxResult:r,chunkMeta:o}=e,l=this.getCurrentContext(o);if(!l){this.resetWhenMissingContext(o);return}const{frag:c,part:f,level:d}=l,{video:m,text:g,id3:p,initSegment:E}=r,{details:v}=d,S=this.altAudio?void 0:r.audio;if(this.fragContextChanged(c)){this.fragmentTracker.removeFragment(c);return}if(this.state=ce.PARSING,E){const b=E.tracks;if(b){const D=c.initSegment||c;if(this.unhandledEncryptionError(E,c))return;this._bufferInitSegment(d,b,D,o),n.trigger(L.FRAG_PARSING_INIT_SEGMENT,{frag:D,id:t,tracks:b})}const R=E.initPTS,C=E.timescale,_=this.initPTS[c.cc];if(ve(R)&&(!_||_.baseTime!==R||_.timescale!==C)){const D=E.trackId;this.initPTS[c.cc]={baseTime:R,timescale:C,trackId:D},n.trigger(L.INIT_PTS_FOUND,{frag:c,id:t,initPTS:R,timescale:C,trackId:D})}}if(m&&v){S&&m.type==="audiovideo"&&this.logMuxedErr(c);const b=v.fragments[c.sn-1-v.startSN],R=c.sn===v.startSN,C=!b||c.cc>b.cc;if(r.independent!==!1){const{startPTS:_,endPTS:D,startDTS:N,endDTS:B}=m;if(f)f.elementaryStreams[m.type]={startPTS:_,endPTS:D,startDTS:N,endDTS:B};else if(m.firstKeyFrame&&m.independent&&o.id===1&&!C&&(this.couldBacktrack=!0),m.dropped&&m.independent){const I=this.getMainFwdBufferInfo(),P=(I?I.end:this.getLoadPosition())+this.config.maxBufferHole,M=m.firstKeyFramePTS?m.firstKeyFramePTS:_;if(!R&&P<M-this.config.maxBufferHole&&!C){this.backtrack(c);return}else C&&(c.gap=!0);c.setElementaryStreamInfo(m.type,c.start,D,c.start,B,!0)}else R&&_-(v.appliedTimelineOffset||0)>Lu&&(c.gap=!0);c.setElementaryStreamInfo(m.type,_,D,N,B),this.backtrackFragment&&(this.backtrackFragment=c),this.bufferFragmentData(m,c,f,o,R||C)}else if(R||C)c.gap=!0;else{this.backtrack(c);return}}if(S){const{startPTS:b,endPTS:R,startDTS:C,endDTS:_}=S;f&&(f.elementaryStreams[ct.AUDIO]={startPTS:b,endPTS:R,startDTS:C,endDTS:_}),c.setElementaryStreamInfo(ct.AUDIO,b,R,C,_),this.bufferFragmentData(S,c,f,o)}if(v&&p!=null&&p.samples.length){const b={id:t,frag:c,details:v,samples:p.samples};n.trigger(L.FRAG_PARSING_METADATA,b)}if(v&&g){const b={id:t,frag:c,details:v,samples:g.samples};n.trigger(L.FRAG_PARSING_USERDATA,b)}}logMuxedErr(e){this.warn(`${Lt(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,r){if(this.state!==ce.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:o,video:l,audiovideo:c}=t;if(o){const d=e.audioCodec;let m=Eu(o.codec,d);m==="mp4a"&&(m="mp4a.40.5");const g=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){m&&(m.indexOf("mp4a.40.5")!==-1?m="mp4a.40.2":m="mp4a.40.5");const p=o.metadata;p&&"channelCount"in p&&(p.channelCount||1)!==1&&g.indexOf("firefox")===-1&&(m="mp4a.40.5")}m&&m.indexOf("mp4a.40.5")!==-1&&g.indexOf("android")!==-1&&o.container!=="audio/mpeg"&&(m="mp4a.40.2",this.log(`Android: force audio codec to ${m}`)),d&&d!==m&&this.log(`Swapping manifest audio codec "${d}" for "${m}"`),o.levelCodec=m,o.id=xe.MAIN,this.log(`Init audio buffer, container:${o.container}, codecs[selected/level/parsed]=[${m||""}/${d||""}/${o.codec}]`),delete t.audiovideo}if(l){l.levelCodec=e.videoCodec,l.id=xe.MAIN;const d=l.codec;if(d?.length===4)switch(d){case"hvc1":case"hev1":l.codec="hvc1.1.6.L120.90";break;case"av01":l.codec="av01.0.04M.08";break;case"avc1":l.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${l.container}, codecs[level/parsed]=[${e.videoCodec||""}/${d}]${l.codec!==d?" parsed-corrected="+l.codec:""}${l.supplemental?" supplemental="+l.supplemental:""}`),delete t.audiovideo}c&&(this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${e.codecs}/${c.codec}]`),delete t.video,delete t.audio);const f=Object.keys(t);if(f.length){if(this.hls.trigger(L.BUFFER_CODECS,t),!this.hls)return;f.forEach(d=>{const g=t[d].initSegment;g!=null&&g.byteLength&&this.hls.trigger(L.BUFFER_APPENDING,{type:d,data:g,frag:n,part:null,chunkMeta:r,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,xe.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=e?.[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ce.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Ie.isBuffered(e,n)?t=this.getAppendedFrag(n):Ie.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,o=t.level;(!r||t.sn!==r.sn||r.level!==o)&&(this.fragPlaying=t,this.hls.trigger(L.FRAG_CHANGED,{frag:t}),(!r||r.level!==o)&&this.hls.trigger(L.LEVEL_SWITCHED,{level:o}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return ve(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(ve(t)){const n=this.getLevelDetails(),r=this.currentFrag||(n?Ar(null,n.fragments,t):null);if(r){const o=r.programDateTime;if(o!==null){const l=o+(t-r.start)*1e3;return new Date(l)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Aj extends Wn{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyIdToKeyInfo){const r=this.keyIdToKeyInfo[n].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=W.KEY_LOAD_ERROR,n,r,o){return new ei({type:Ae.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:o,error:n,networkDetails:r})}loadClear(e,t,n){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let r=0,o=t.length;r<o;r++){const l=t[r];if(e.cc<=l.cc&&(!Lt(e)||!Lt(l)||e.sn<l.sn)||!n&&r==o-1)return this.emeController.selectKeySystemFormat(l).then(c=>{if(!this.emeController)return;l.setKeyFormat(c);const f=bu(c);if(f)return this.emeController.getKeySystemAccess([f])})}if(this.config.requireKeySystemAccessOnStart){const r=Ho(this.config);if(r.length)return this.emeController.getKeySystemAccess(r)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const o=e.decryptdata;if(!o){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,W.KEY_LOAD_ERROR,d))}const l=o.uri;if(!l)return Promise.reject(this.createKeyLoadError(e,W.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${l}"`)));const c=Pm(o);let f=this.keyIdToKeyInfo[c];if((n=f)!=null&&n.decryptdata.key)return o.key=f.decryptdata.key,Promise.resolve({frag:e,keyInfo:f});if(this.emeController&&(r=f)!=null&&r.keyLoadPromise)switch(this.emeController.getKeyStatus(f.decryptdata)){case"usable":case"usable-in-future":return f.keyLoadPromise.then(m=>{const{keyInfo:g}=m;return o.key=g.decryptdata.key,{frag:e,keyInfo:g}})}switch(this.log(`${this.keyIdToKeyInfo[c]?"Rel":"L"}oading${o.keyId?" keyId: "+Qt(o.keyId):""} URI: ${o.uri} from ${e.type} ${e.level}`),f=this.keyIdToKeyInfo[c]={decryptdata:o,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},o.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return o.keyFormat==="identity"?this.loadKeyHTTP(f,e):this.loadKeyEME(f,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(f,e);default:return Promise.reject(this.createKeyLoadError(e,W.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${o.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var r;if(!e.decryptdata.keyId&&(r=t.initSegment)!=null&&r.data){const l=HU(t.initSegment.data);if(l.length){let c=l[0];c.some(f=>f!==0)?(this.log(`Using keyId found in init segment ${Qt(c)}`),ji.setKeyIdForUri(e.decryptdata.uri,c)):(c=ji.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${Qt(c)}`)),e.decryptdata.keyId=c}}if(!e.decryptdata.keyId&&!Lt(t))return Promise.resolve(n);const o=this.emeController.loadKey(n);return(e.keyLoadPromise=o.then(l=>(e.mediaKeySessionContext=l,n))).catch(l=>{throw e.keyLoadPromise=null,"data"in l&&(l.data.frag=t),l})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,r=n.loader,o=new r(n);return t.keyLoader=e.loader=o,e.keyLoadPromise=new Promise((l,c)=>{const f={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},d=n.keyLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(p,E,v,S)=>{const{frag:b,keyInfo:R}=v,C=Pm(R.decryptdata);if(!b.decryptdata||R!==this.keyIdToKeyInfo[C])return c(this.createKeyLoadError(b,W.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),S));R.decryptdata.key=b.decryptdata.key=new Uint8Array(p.data),b.keyLoader=null,R.loader=null,l({frag:b,keyInfo:R})},onError:(p,E,v,S)=>{this.resetLoader(E),c(this.createKeyLoadError(t,W.KEY_LOAD_ERROR,new Error(`HTTP Error ${p.code} loading key ${p.text}`),v,tt({url:f.url,data:void 0},p)))},onTimeout:(p,E,v)=>{this.resetLoader(E),c(this.createKeyLoadError(t,W.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),v))},onAbort:(p,E,v)=>{this.resetLoader(E),c(this.createKeyLoadError(t,W.INTERNAL_ABORTED,new Error("key loading aborted"),v))}};o.load(f,m,g)})}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,o=n.loader;t.keyLoader===o&&(t.keyLoader=null,n.loader=null);const l=Pm(n.decryptdata)||r;delete this.keyIdToKeyInfo[l],o&&o.destroy()}}function Pm(s){if(s.keyFormat!==Zt.FAIRPLAY){const e=s.keyId;if(e)return Qt(e)}return s.uri}function Lb(s){const{type:e}=s;switch(e){case je.AUDIO_TRACK:return xe.AUDIO;case je.SUBTITLE_TRACK:return xe.SUBTITLE;default:return xe.MAIN}}function Fm(s,e){let t=s.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class Rj{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(L.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(L.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,r=t.loader,o=n||r,l=new o(t);return this.loaders[e.type]=l,l}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:je.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:r,pathwayId:o,url:l,deliveryDirectives:c,levelInfo:f}=t;this.load({id:n,level:r,pathwayId:o,responseType:"text",type:je.LEVEL,url:l,deliveryDirectives:c,levelOrTrack:f})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:o,deliveryDirectives:l,track:c}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:je.AUDIO_TRACK,url:o,deliveryDirectives:l,levelOrTrack:c})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:o,deliveryDirectives:l,track:c}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:je.SUBTITLE_TRACK,url:o,deliveryDirectives:l,levelOrTrack:c})}onLevelsUpdated(e,t){const n=this.loaders[je.LEVEL];if(n){const r=n.context;r&&!t.levels.some(o=>o===r.levelOrTrack)&&(n.abort(),delete this.loaders[je.LEVEL])}}load(e){var t;const n=this.hls.config;let r=this.getInternalLoader(e);if(r){const d=this.hls.logger,m=r.context;if(m&&m.levelOrTrack===e.levelOrTrack&&(m.url===e.url||m.deliveryDirectives&&!e.deliveryDirectives)){m.url===e.url?d.log(`[playlist-loader]: ignore ${e.url} ongoing request`):d.log(`[playlist-loader]: ignore ${e.url} in favor of ${m.url}`);return}d.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let o;if(e.type===je.MANIFEST?o=n.manifestLoadPolicy.default:o=at({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),ve((t=e.deliveryDirectives)==null?void 0:t.part)){let d;if(e.type===je.LEVEL&&e.level!==null?d=this.hls.levels[e.level].details:e.type===je.AUDIO_TRACK&&e.id!==null?d=this.hls.audioTracks[e.id].details:e.type===je.SUBTITLE_TRACK&&e.id!==null&&(d=this.hls.subtitleTracks[e.id].details),d){const m=d.partTarget,g=d.targetduration;if(m&&g){const p=Math.max(m*3,g*.8)*1e3;o=at({},o,{maxTimeToFirstByteMs:Math.min(p,o.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,o.maxTimeToFirstByteMs)})}}}const l=o.errorRetry||o.timeoutRetry||{},c={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},f={onSuccess:(d,m,g,p)=>{const E=this.getInternalLoader(g);this.resetInternalLoader(g.type);const v=d.data;m.parsing.start=performance.now(),bs.isMediaPlaylist(v)||g.type!==je.MANIFEST?this.handleTrackOrLevelPlaylist(d,m,g,p||null,E):this.handleMasterPlaylist(d,m,g,p)},onError:(d,m,g,p)=>{this.handleNetworkError(m,g,!1,d,p)},onTimeout:(d,m,g)=>{this.handleNetworkError(m,g,!0,void 0,d)}};r.load(e,c,f)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,r){const o=this.hls,l=e.data,c=Fm(e,n),f=bs.parseMasterPlaylist(l,c);if(f.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,n,f.playlistParsingError,r,t);return}const{contentSteering:d,levels:m,sessionData:g,sessionKeys:p,startTimeOffset:E,variableList:v}=f;this.variableList=v,m.forEach(C=>{const{unknownCodecs:_}=C;if(_){const{preferManagedMediaSource:D}=this.hls.config;let{audioCodec:N,videoCodec:B}=C;for(let I=_.length;I--;){const P=_[I];el(P,"audio",D)?(C.audioCodec=N=N?`${N},${P}`:P,Fa.audio[N.substring(0,4)]=2,_.splice(I,1)):el(P,"video",D)&&(C.videoCodec=B=B?`${B},${P}`:P,Fa.video[B.substring(0,4)]=2,_.splice(I,1))}}});const{AUDIO:S=[],SUBTITLES:b,"CLOSED-CAPTIONS":R}=bs.parseMasterPlaylistMedia(l,c,f);S.length&&!S.some(_=>!_.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),S.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new vt({}),bitrate:0,url:""})),o.trigger(L.MANIFEST_LOADED,{levels:m,audioTracks:S,subtitles:b,captions:R,contentSteering:d,url:c,stats:t,networkDetails:r,sessionData:g,sessionKeys:p,startTimeOffset:E,variableList:v})}handleTrackOrLevelPlaylist(e,t,n,r,o){const l=this.hls,{id:c,level:f,type:d}=n,m=Fm(e,n),g=ve(f)?f:ve(c)?c:0,p=Lb(n),E=bs.parseLevelPlaylist(e.data,m,g,p,0,this.variableList);if(d===je.MANIFEST){const v={attrs:new vt({}),bitrate:0,details:E,name:"",url:m};E.requestScheduled=t.loading.start+VR(E,0),l.trigger(L.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:m,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=E,this.handlePlaylistLoaded(E,e,t,n,r,o)}handleManifestParsingError(e,t,n,r,o){this.hls.trigger(L.ERROR,{type:Ae.NETWORK_ERROR,details:W.MANIFEST_PARSING_ERROR,fatal:t.type===je.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:o})}handleNetworkError(e,t,n=!1,r,o){let l=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===je.LEVEL?l+=`: ${e.level} id: ${e.id}`:(e.type===je.AUDIO_TRACK||e.type===je.SUBTITLE_TRACK)&&(l+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(l);this.hls.logger.warn(`[playlist-loader]: ${l}`);let f=W.UNKNOWN,d=!1;const m=this.getInternalLoader(e);switch(e.type){case je.MANIFEST:f=n?W.MANIFEST_LOAD_TIMEOUT:W.MANIFEST_LOAD_ERROR,d=!0;break;case je.LEVEL:f=n?W.LEVEL_LOAD_TIMEOUT:W.LEVEL_LOAD_ERROR,d=!1;break;case je.AUDIO_TRACK:f=n?W.AUDIO_TRACK_LOAD_TIMEOUT:W.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case je.SUBTITLE_TRACK:f=n?W.SUBTITLE_TRACK_LOAD_TIMEOUT:W.SUBTITLE_LOAD_ERROR,d=!1;break}m&&this.resetInternalLoader(e.type);const g={type:Ae.NETWORK_ERROR,details:f,fatal:d,url:e.url,loader:m,context:e,error:c,networkDetails:t,stats:o};if(r){const p=t?.url||e.url;g.response=tt({url:p,data:void 0},r)}this.hls.trigger(L.ERROR,g)}handlePlaylistLoaded(e,t,n,r,o,l){const c=this.hls,{type:f,level:d,levelOrTrack:m,id:g,groupId:p,deliveryDirectives:E}=r,v=Fm(t,r),S=Lb(r);let b=typeof r.level=="number"&&S===xe.MAIN?d:void 0;const R=e.playlistParsingError;if(R){if(this.hls.logger.warn(`${R} ${e.url}`),!c.config.ignorePlaylistParsingErrors){c.trigger(L.ERROR,{type:Ae.NETWORK_ERROR,details:W.LEVEL_PARSING_ERROR,fatal:!1,url:v,error:R,reason:R.message,response:t,context:r,level:b,parent:S,networkDetails:o,stats:n});return}e.playlistParsingError=null}if(!e.fragments.length){const C=e.playlistParsingError=new Error("No Segments found in Playlist");c.trigger(L.ERROR,{type:Ae.NETWORK_ERROR,details:W.LEVEL_EMPTY_ERROR,fatal:!1,url:v,error:C,reason:C.message,response:t,context:r,level:b,parent:S,networkDetails:o,stats:n});return}switch(e.live&&l&&(l.getCacheAge&&(e.ageHeader=l.getCacheAge()||0),(!l.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),f){case je.MANIFEST:case je.LEVEL:if(b){if(!m)b=0;else if(m!==c.levels[b]){const C=c.levels.indexOf(m);C>-1&&(b=C)}}c.trigger(L.LEVEL_LOADED,{details:e,levelInfo:m||c.levels[0],level:b||0,id:g||0,stats:n,networkDetails:o,deliveryDirectives:E,withoutMultiVariant:f===je.MANIFEST});break;case je.AUDIO_TRACK:c.trigger(L.AUDIO_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:p||"",stats:n,networkDetails:o,deliveryDirectives:E});break;case je.SUBTITLE_TRACK:c.trigger(L.SUBTITLE_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:p||"",stats:n,networkDetails:o,deliveryDirectives:E});break}}}class ss{static get version(){return sl}static isMSESupported(){return zw()}static isSupported(){return Ej()}static getMediaSource(){return zi()}static get Events(){return L}static get MetadataSchema(){return Dn}static get ErrorTypes(){return Ae}static get ErrorDetails(){return W}static get DefaultConfig(){return ss.defaultConfig?ss.defaultConfig:lj}static set DefaultConfig(e){ss.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Cp,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=IU(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=uj(ss.DefaultConfig,e,t);this.userConfig=e,n.progressive&&dj(n,t);const{abrController:r,bufferController:o,capLevelController:l,errorController:c,fpsController:f}=n,d=new c(this),m=this.abrController=new r(this),g=new wB(this),p=n.interstitialsController,E=p?this.interstitialsController=new p(this,ss):null,v=this.bufferController=new o(this,g),S=this.capLevelController=new l(this),b=new f(this),R=new Rj(this),C=n.contentSteeringController,_=C?new C(this):null,D=this.levelController=new xj(this,_),N=new yj(this),B=new Aj(this.config,this.logger),I=this.streamController=new Tj(this,g,B),P=this.gapController=new gj(this,g);S.setStreamController(I),b.setStreamController(I);const M=[R,D,I];E&&M.splice(1,0,E),_&&M.splice(1,0,_),this.networkControllers=M;const U=[m,v,P,S,b,N,g];this.audioTrackController=this.createController(n.audioTrackController,M);const q=n.audioStreamController;q&&M.push(this.audioStreamController=new q(this,g,B)),this.subtitleTrackController=this.createController(n.subtitleTrackController,M);const V=n.subtitleStreamController;V&&M.push(this.subtititleStreamController=new V(this,g,B)),this.createController(n.timelineController,U),B.emeController=this.emeController=this.createController(n.emeController,U),this.cmcdController=this.createController(n.cmcdController,U),this.latencyController=this.createController(vj,U),this.coreComponents=U,M.push(d);const ee=d.onErrorOut;typeof ee=="function"&&this.on(L.ERROR,ee,d),this.on(L.MANIFEST_LOADED,R.onManifestLoaded,R)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const r=e===L.ERROR;this.trigger(L.ERROR,{type:Ae.OTHER_ERROR,details:W.INTERNAL_EXCEPTION,fatal:r,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(L.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const o=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(L.ERROR,{type:Ae.OTHER_ERROR,details:W.ATTACH_MEDIA_ERROR,fatal:!0,error:o});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,r=t?e:{media:n};this._media=n,this.trigger(L.MEDIA_ATTACHING,r)}detachMedia(){this.logger.log("detachMedia"),this.trigger(L.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(L.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,r=this._url=yp.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${r}`),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(L.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),!(!this.started||!this.networkControllers));n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[xe.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[xe.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[xe.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=g4()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){uB(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,n)for(let o=r;o--;){const l=e[o].attrs["HDCP-LEVEL"];if(l&&l<=n)return o}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=DR(t);return CR(e,n,navigator.mediaCapabilities)}}ss.defaultConfig=void 0;function wj({src:s,hlsSrc:e,poster:t,title:n,videoMetadata:r,startTime:o}){const l=A.useRef(null),c=A.useRef(null),f=A.useRef(null),d=A.useRef(null),m=A.useRef(0),g=A.useRef(null),p=A.useRef(!1),[E,v]=A.useState(!1),[S,b]=A.useState(!1),[R,C]=A.useState(!1),[_,D]=A.useState(!0),[N,B]=A.useState(0),[I,P]=A.useState(0),[M,U]=A.useState(0),[q,V]=A.useState(!0),[ee,Z]=A.useState(!1),[re,F]=A.useState(1),[z,j]=A.useState(!1),[oe,fe]=A.useState([]),[k,G]=A.useState(-1),[te,le]=A.useState(null),[he,pe]=A.useState(0),[ye,Ne]=A.useState(!1),De=A.useRef(null),dt=e||s,ot=A.useCallback(async(ie,me,ge=!1)=>{if(!r)return;(!me||me===0||!isFinite(me)||me===1/0)&&(me=ie>0?ie*2:600),(!isFinite(ie)||ie<0)&&(ie=0);const Ce=Math.min(ie/me*100,100),He=Ce>=95;try{await pu.addOrUpdate({videoUrl:r.videoUrl,title:r.title,thumbnailUrl:r.thumbnailUrl,author:r.author,duration:r.duration,currentTime:ie,totalDuration:me,progress:Ce,completed:He,lastWatchedAt:Date.now()}),window.dispatchEvent(new CustomEvent("watchHistoryUpdated"))}catch(ft){console.error("Failed to save watch progress:",ft)}},[r]);A.useEffect(()=>{const ie=()=>{const ge=l.current;if(ge&&r&&ge.currentTime>0){const Ce=isFinite(ge.duration)?ge.duration:ge.currentTime*2;ot(ge.currentTime,Ce,!0)}},me=()=>{if(document.visibilityState==="hidden"){const ge=l.current;if(ge&&r&&ge.currentTime>0){const Ce=isFinite(ge.duration)?ge.duration:ge.currentTime*2;ot(ge.currentTime,Ce,!0)}}};return window.addEventListener("beforeunload",ie),document.addEventListener("visibilitychange",me),()=>{window.removeEventListener("beforeunload",ie),document.removeEventListener("visibilitychange",me)}},[r,ot]);const we=A.useCallback(()=>{d.current&&clearTimeout(d.current),E&&_&&(d.current=setTimeout(()=>{D(!1)},3e3))},[E,_]),nn=A.useCallback(ie=>{if(ie.preventDefault(),ie.stopPropagation(),"touches"in ie){const Ce=Date.now();if(Ce-m.current<300){m.current=Ce;return}m.current=Ce}const me=ie.target;if("touches"in ie){const Ce=ie.touches[0];if(document.elementsFromPoint(Ce.clientX,Ce.clientY).some(Ye=>Ye.closest('[data-testid="button-play-pause"]')||Ye.closest('[data-testid="button-skip-back"]')||Ye.closest('[data-testid="button-skip-forward"]')||Ye.closest('[data-testid="button-mute"]')||Ye.closest('[data-testid="button-fullscreen"]')||Ye.closest('[data-testid="progress-bar"]')||Ye.closest('[data-testid="input-volume"]'))){D(!0),we();return}}else if(me.closest('[data-testid="button-play-pause"]')||me.closest('[data-testid="button-skip-back"]')||me.closest('[data-testid="button-skip-forward"]')||me.closest('[data-testid="button-mute"]')||me.closest('[data-testid="button-fullscreen"]')||me.closest('[data-testid="progress-bar"]')||me.closest('[data-testid="input-volume"]')){D(!0),we();return}const ge=!_;D(ge),ge&&E&&we()},[_,E,we]),vn=A.useCallback(ie=>{ie.preventDefault(),ie.stopPropagation();const me=Date.now();if(me-m.current<300){m.current=me;return}m.current=me;const ge=ie.changedTouches[0];if(document.elementsFromPoint(ge.clientX,ge.clientY).some(Ye=>Ye.closest('[data-testid="button-play-pause"]')||Ye.closest('[data-testid="button-skip-back"]')||Ye.closest('[data-testid="button-skip-forward"]')||Ye.closest('[data-testid="button-mute"]')||Ye.closest('[data-testid="button-fullscreen"]')||Ye.closest('[data-testid="progress-bar"]')||Ye.closest('[data-testid="input-volume"]'))){D(!0),we();return}const ft=!_;D(ft),ft&&E&&we()},[_,E,we]);A.useEffect(()=>{we()},[we]),A.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]),A.useEffect(()=>{const ie=l.current;if(!ie||!dt)return;V(!0),Z(!1);const me=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);if(e&&ss.isSupported()){const ge=new ss({enableWorker:!0,lowLatencyMode:!me,startLevel:me?0:-1,capLevelToPlayerSize:!0,maxBufferLength:me?15:30,maxMaxBufferLength:me?30:600,maxBufferSize:me?3e7:6e7,maxBufferHole:.5,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:4,fragLoadingRetryDelay:1e3,levelLoadingTimeOut:1e4,manifestLoadingTimeOut:1e4});return De.current=ge,ge.loadSource(e),ge.attachMedia(ie),ge.on(ss.Events.MANIFEST_PARSED,()=>{V(!1);const Ce=ge.levels;if(Ce&&Ce.length>1){const He=Ce.map((ft,Ye)=>({index:Ye,height:ft.height,label:`${ft.height}p`})).sort((ft,Ye)=>Ye.height-ft.height);fe([{index:-1,height:0,label:"Auto"},...He]),G(-1)}else fe([])}),ge.on(ss.Events.ERROR,(Ce,He)=>{He.fatal&&(console.error("HLS fatal error:",He),s?ie.src=s:Z(!0))}),()=>{ge.destroy(),De.current=null}}else ie.canPlayType("application/vnd.apple.mpegurl")&&e?ie.src=e:s&&(ie.src=s)},[e,s,dt]),A.useEffect(()=>{const ie=l.current;if(!ie)return;const me=()=>{B(ie.currentTime),ie.buffered.length>0&&U(ie.buffered.end(ie.buffered.length-1)),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{if(ie.currentTime>0){const zt=isFinite(ie.duration)?ie.duration:ie.currentTime*2;ot(ie.currentTime,zt)}},500)},ge=()=>{const zt=isFinite(ie.duration)?ie.duration:0;if(P(zt),V(!1),o&&!p.current&&zt>0){const Yi=Math.min(o,zt-1);Yi>0&&(ie.currentTime=Yi,p.current=!0)}},Ce=()=>{if(v(!0),_&&we(),r&&ie.currentTime>=0){const zt=isFinite(ie.duration)?ie.duration:ie.currentTime*2||600;ot(ie.currentTime,zt)}},He=()=>{if(v(!1),d.current&&clearTimeout(d.current),D(!0),r&&ie.currentTime>0){const zt=isFinite(ie.duration)?ie.duration:ie.currentTime*2;ot(ie.currentTime,zt)}},ft=()=>{if(r){const zt=isFinite(ie.duration)?ie.duration:ie.currentTime;ot(zt,zt)}},Ye=()=>V(!0),ci=()=>V(!1),qi=()=>{Z(!0),V(!1)};return ie.addEventListener("timeupdate",me),ie.addEventListener("loadedmetadata",ge),ie.addEventListener("play",Ce),ie.addEventListener("pause",He),ie.addEventListener("ended",ft),ie.addEventListener("waiting",Ye),ie.addEventListener("canplay",ci),ie.addEventListener("error",qi),()=>{ie.removeEventListener("timeupdate",me),ie.removeEventListener("loadedmetadata",ge),ie.removeEventListener("play",Ce),ie.removeEventListener("pause",He),ie.removeEventListener("ended",ft),ie.removeEventListener("waiting",Ye),ie.removeEventListener("canplay",ci),ie.removeEventListener("error",qi),g.current&&clearTimeout(g.current)}},[_,we,o,r,ot]),A.useEffect(()=>{const ie=()=>{C(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",ie),()=>document.removeEventListener("fullscreenchange",ie)},[]),A.useEffect(()=>{const ie=me=>{const ge=l.current;if(!ge)return;const Ce=document.activeElement;if(!(Ce&&(Ce.tagName==="INPUT"||Ce.tagName==="TEXTAREA"||Ce.tagName==="SELECT"||Ce.isContentEditable||Ce.getAttribute("role")==="textbox")))switch(me.key.toLowerCase()){case" ":case"k":me.preventDefault(),ge.paused?ge.play():ge.pause(),D(!0),we();break;case"arrowleft":case"j":me.preventDefault(),ge.currentTime=Math.max(0,ge.currentTime-10),D(!0),we();break;case"arrowright":case"l":me.preventDefault(),ge.currentTime=Math.min(I,ge.currentTime+10),D(!0),we();break;case"arrowup":me.preventDefault();{const Ye=Math.min(1,Math.round((re+.1)*10)/10);ge.volume=Ye,F(Ye),Ye>0&&(b(!1),ge.muted=!1)}D(!0),we();break;case"arrowdown":me.preventDefault();{const Ye=Math.max(0,Math.round((re-.1)*10)/10);ge.volume=Ye,F(Ye),Ye===0&&(b(!0),ge.muted=!0)}D(!0),we();break;case"m":me.preventDefault(),ge.muted=!ge.muted,b(ge.muted),D(!0),we();break;case"f":me.preventDefault();const He=c.current;He&&(document.fullscreenElement?document.exitFullscreen().catch(console.error):He.requestFullscreen().catch(console.error)),D(!0),we();break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":me.preventDefault();const ft=parseInt(me.key)/10;ge.currentTime=I*ft,D(!0),we();break}};return window.addEventListener("keydown",ie),()=>window.removeEventListener("keydown",ie)},[I,re,we]);const Ki=A.useCallback(ie=>{ie.preventDefault(),ie.stopPropagation();const me=l.current;me&&(me.paused?me.play():me.pause(),D(!0),we())},[we]),Ue=A.useCallback(ie=>{ie.preventDefault(),ie.stopPropagation();const me=l.current;me&&(me.muted=!me.muted,b(me.muted),D(!0),we())},[we]),At=A.useCallback(async ie=>{ie.preventDefault(),ie.stopPropagation();const me=c.current;if(me){try{document.fullscreenElement?await document.exitFullscreen():await me.requestFullscreen()}catch(ge){console.error("Fullscreen error:",ge)}D(!0),we()}},[we]),_t=A.useCallback(ie=>{ie.preventDefault(),ie.stopPropagation();const me=l.current,ge=f.current;if(!me||!ge||!I)return;const Ce=ge.getBoundingClientRect(),ft=(("touches"in ie?ie.touches[0].clientX:ie.clientX)-Ce.left)/Ce.width;me.currentTime=ft*I,D(!0),we()},[I,we]),Jt=A.useCallback(ie=>me=>{me.preventDefault(),me.stopPropagation();const ge=l.current;ge&&(ge.currentTime=Math.max(0,Math.min(ge.currentTime+ie,I)),D(!0),we())},[I,we]),Ht=A.useCallback(ie=>{const me=f.current;if(!me||!I)return;const ge=me.getBoundingClientRect(),Ce=(ie.clientX-ge.left)/ge.width,He=Math.max(0,Math.min(Ce*I,I));le(He),pe(Math.max(0,Math.min(Ce*100,100)))},[I]),Mn=A.useCallback(()=>{ye||le(null)},[ye]),Xn=A.useCallback(ie=>{ie.preventDefault(),Ne(!0),_t(ie);const me=Ce=>{const He=f.current,ft=l.current;if(!He||!ft||!I)return;const Ye=He.getBoundingClientRect(),ci=Math.max(0,Math.min((Ce.clientX-Ye.left)/Ye.width,1));ft.currentTime=ci*I,le(ci*I),pe(ci*100)},ge=()=>{Ne(!1),le(null),document.removeEventListener("mousemove",me),document.removeEventListener("mouseup",ge)};document.addEventListener("mousemove",me),document.addEventListener("mouseup",ge)},[I,_t]),wr=A.useCallback(ie=>{const me=f.current,ge=l.current;if(!me||!ge||!I)return;const Ce=ie.touches[0],He=me.getBoundingClientRect(),ft=Math.max(0,Math.min((Ce.clientX-He.left)/He.width,1));ge.currentTime=ft*I,le(ft*I),pe(ft*100),Ne(!0)},[I]),Dt=A.useCallback(()=>{Ne(!1),le(null)},[]),Lr=A.useCallback(ie=>{ie.stopPropagation();const me=l.current;if(!me)return;const ge=parseFloat(ie.target.value);me.volume=ge,F(ge),b(ge===0),me.muted=ge===0,D(!0),we()},[we]),ls=A.useCallback(ie=>{De.current&&(De.current.currentLevel=ie,G(ie)),j(!1),D(!0),we()},[we]),ai=A.useCallback(ie=>{ie.preventDefault(),ie.stopPropagation(),j(me=>!me),D(!0),we()},[we]),Is=A.useCallback(async ie=>{ie.preventDefault(),ie.stopPropagation();const me=c.current;if(me){try{if(document.fullscreenElement||await me.requestFullscreen(),screen.orientation&&"lock"in screen.orientation)try{await screen.orientation.lock("landscape")}catch{console.log("Screen orientation lock not supported or denied")}}catch(ge){console.error("Rotate fullscreen error:",ge)}D(!0),we()}},[we]),oi=ie=>{if(isNaN(ie)||!isFinite(ie))return"0:00";const me=Math.floor(ie/60),ge=Math.floor(ie%60);return`${me}:${ge.toString().padStart(2,"0")}`},li=I?N/I*100:0,Os=I?M/I*100:0;return ee?T.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-black text-white gap-4",children:[T.jsx(RT,{className:"h-12 w-12 text-red-500"}),T.jsx("p",{className:"text-lg",children:"Video could not be loaded"}),T.jsx("p",{className:"text-sm text-gray-400",children:"Try opening the video directly"})]}):T.jsxs("div",{ref:c,className:"relative w-full h-full bg-black select-none",onClick:nn,onTouchStart:nn,onTouchEnd:vn,"data-testid":"custom-video-player",children:[T.jsx("video",{ref:l,className:"w-full h-full object-contain pointer-events-none",poster:t,playsInline:!0,"webkit-playsinline":"true",disablePictureInPicture:!0,controlsList:"nodownload nofullscreen noremoteplayback",onContextMenu:ie=>ie.preventDefault(),onClick:ie=>{ie.preventDefault(),ie.stopPropagation(),nn(ie)},onTouchEnd:ie=>{ie.preventDefault(),ie.stopPropagation()},"data-testid":"video-element"}),q&&T.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10 pointer-events-none",children:T.jsx($g,{className:"h-12 w-12 animate-spin text-primary"})}),T.jsxs("div",{className:`absolute inset-0 transition-opacity duration-300 z-20 ${_?"opacity-100":"opacity-0 pointer-events-none"}`,children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-black/40 pointer-events-none"}),n&&T.jsx("div",{className:"absolute top-0 left-0 right-0 p-4",children:T.jsx("p",{className:"text-white text-sm font-medium line-clamp-1 pointer-events-none",children:n})}),T.jsxs("div",{className:"absolute inset-0 flex items-center justify-center gap-8",children:[T.jsx("button",{onClick:Jt(-10),onTouchEnd:Jt(-10),className:"p-3 rounded-full bg-white/20 hover:bg-white/30 transition-colors touch-manipulation","data-testid":"button-skip-back",children:T.jsx(eO,{className:"h-6 w-6 text-white"})}),T.jsx("button",{onClick:Ki,onTouchEnd:Ki,className:"p-5 rounded-full bg-primary hover:bg-primary/90 transition-colors touch-manipulation shadow-lg","data-testid":"button-play-pause",children:E?T.jsx(HI,{className:"h-10 w-10 text-white",fill:"white"}):T.jsx(ni,{className:"h-10 w-10 text-white",fill:"white"})}),T.jsx("button",{onClick:Jt(10),onTouchEnd:Jt(10),className:"p-3 rounded-full bg-white/20 hover:bg-white/30 transition-colors touch-manipulation","data-testid":"button-skip-forward",children:T.jsx(nO,{className:"h-6 w-6 text-white"})})]}),T.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 space-y-3",children:[T.jsxs("div",{ref:f,className:"relative h-2 bg-white/30 rounded-full cursor-pointer touch-manipulation group/progress",onClick:_t,onTouchStart:_t,onTouchMove:wr,onTouchEnd:Dt,onMouseMove:Ht,onMouseLeave:Mn,onMouseDown:Xn,"data-testid":"progress-bar",children:[T.jsx("div",{className:"absolute h-full bg-white/50 rounded-full",style:{width:`${Os}%`}}),T.jsx("div",{className:"absolute h-full bg-primary rounded-full",style:{width:`${li}%`}}),T.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-primary rounded-full shadow-lg border-2 border-white transition-transform group-hover/progress:scale-125",style:{left:`calc(${li}% - 8px)`}}),te!==null&&T.jsxs("div",{className:"absolute -top-12 transform -translate-x-1/2 bg-black/90 text-white text-sm font-medium px-3 py-1.5 rounded-lg shadow-lg backdrop-blur-sm border border-white/20 pointer-events-none z-50",style:{left:`${he}%`},children:[T.jsx("div",{className:"flex flex-col items-center gap-0.5",children:T.jsx("span",{className:"tabular-nums",children:oi(te)})}),T.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-1/2 rotate-45 w-2 h-2 bg-black/90 border-r border-b border-white/20"})]})]}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("div",{className:"flex items-center gap-4",children:T.jsxs("span",{className:"text-white text-sm font-medium tabular-nums","data-testid":"text-time",children:[oi(N)," / ",oi(I)]})}),T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("button",{onClick:Ue,onTouchEnd:Ue,className:"p-2 rounded-full hover:bg-white/20 transition-colors touch-manipulation","data-testid":"button-mute",children:S||re===0?T.jsx(dO,{className:"h-5 w-5 text-white"}):T.jsx(cO,{className:"h-5 w-5 text-white"})}),T.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:S?0:re,onChange:Lr,className:"w-20 h-1 bg-white/30 rounded-full appearance-none cursor-pointer hidden md:block [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:rounded-full","data-testid":"input-volume"})]}),oe.length>0&&T.jsxs("div",{className:"relative",children:[T.jsx("button",{onClick:ai,onTouchEnd:ai,className:"p-2 rounded-full hover:bg-white/20 transition-colors touch-manipulation","data-testid":"button-quality",children:T.jsx(XI,{className:"h-5 w-5 text-white"})}),z&&T.jsx("div",{className:"absolute bottom-12 right-0 bg-black/90 rounded-lg shadow-lg py-2 min-w-[100px] backdrop-blur-sm border border-white/20",children:oe.map(ie=>T.jsx("button",{onClick:me=>{me.preventDefault(),me.stopPropagation(),ls(ie.index)},className:`w-full px-4 py-2 text-left text-sm hover:bg-white/20 transition-colors ${k===ie.index?"text-primary font-bold":"text-white"}`,children:ie.label},ie.index))})]}),T.jsx("button",{onClick:Is,onTouchEnd:Is,className:"p-2 rounded-full hover:bg-white/20 transition-colors touch-manipulation","data-testid":"button-rotate-fullscreen",title:"Rotate to landscape fullscreen",children:T.jsx(qI,{className:"h-5 w-5 text-white"})}),T.jsx("button",{onClick:At,onTouchEnd:At,className:"p-2 rounded-full hover:bg-white/20 transition-colors touch-manipulation","data-testid":"button-fullscreen",children:R?T.jsx(jI,{className:"h-5 w-5 text-white"}):T.jsx(PI,{className:"h-5 w-5 text-white"})})]})]})]})]})]})}function lu({className:s,...e}){return T.jsx("div",{className:Oe("animate-pulse rounded-md bg-primary/10",s),...e})}function Lj(){const[s,e]=Ig(),t=new URLSearchParams(window.location.search),n=t.get("url"),r=t.get("t"),{toast:o}=Kb(),l=A.useMemo(()=>{if(!r)return;const V=parseInt(r,10);return isNaN(V)?void 0:V},[r]),[c,f]=A.useState(null),[d,m]=A.useState([]),[g,p]=A.useState(!0),[E,v]=A.useState(!0),[S,b]=A.useState(!1),[R,C]=A.useState(0),[_,D]=A.useState(!1),[N,B]=A.useState(new Set),I=A.useRef(null);A.useEffect(()=>{if(!n)return;(async()=>{p(!0);try{const ee=await $i.getVideoDetails(n);f(ee),p(!1),v(!0);const Z=ee.title?ee.title.split(" ")[0]:"trending",re=await $i.getSimilarVideos(Z);m(re),v(!1)}catch(ee){console.error(ee),p(!1),v(!1)}})()},[n]);const P=()=>{const V=c?.content_url||c?.m3u8_base_url;if(!V){o({title:"Error",description:"Download link not available",variant:"destructive"});return}b(!0),C(0),D(!1);const ee=setInterval(()=>{C(re=>re>=90?re:re+Math.random()*15)},200),Z=`https://teugqirxznhfegcwwnzh.supabase.co/functions/v1/download?url=${encodeURIComponent(V)}`;I.current&&(I.current.src=Z),setTimeout(()=>{clearInterval(ee),C(100),D(!0),setTimeout(()=>{b(!1),C(0),D(!1)},2e3)},2500)},M=()=>{window.history.length>1?window.history.back():e("/")},U=V=>{if(V==null)return"New";const ee=typeof V=="number"?V:parseInt(String(V).replace(/,/g,""));return isNaN(ee)?String(V):ee===0?"New":ee>1e6?(ee/1e6).toFixed(1)+"M":ee>1e3?(ee/1e3).toFixed(1)+"k":ee.toString()};if(g)return T.jsx(gu,{children:T.jsxs("div",{className:"flex h-screen flex-col items-center justify-center bg-background gap-6",children:[T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-primary/20"}),T.jsx("div",{className:"absolute inset-0 w-24 h-24 rounded-full border-4 border-transparent border-t-primary animate-spin-fast"}),T.jsx("div",{className:"absolute inset-2 w-20 h-20 rounded-full border-4 border-transparent border-r-primary/70 animate-spin-medium"}),T.jsx("div",{className:"absolute inset-4 w-16 h-16 rounded-full border-4 border-transparent border-b-primary/50 animate-spin-medium",style:{animationDirection:"reverse"}}),T.jsx("div",{className:"absolute inset-0 m-auto w-10 h-10 rounded-full bg-primary animate-pulse flex items-center justify-center",children:T.jsx(ni,{className:"h-5 w-5 text-white fill-white"})})]}),T.jsxs("div",{className:"text-center space-y-2",children:[T.jsx("p",{className:"text-lg font-medium text-primary animate-pulse",children:"Loading video..."}),T.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we fetch the content"}),T.jsx("div",{className:"flex justify-center gap-1.5 pt-2",children:[0,1,2,3,4].map(V=>T.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-bounce",style:{animationDelay:`${V*.1}s`,opacity:1-V*.15}},V))})]})]})});if(!c)return T.jsx(gu,{children:T.jsxs("div",{className:"flex h-screen flex-col items-center justify-center gap-4",children:[T.jsx(Vm,{className:"h-12 w-12 text-destructive"}),T.jsx("h2",{className:"text-xl",children:"Video not found"}),T.jsxs(ht,{onClick:M,variant:"outline",className:"gap-2",children:[T.jsx(_u,{className:"h-4 w-4"})," Go Back"]})]})});const q=c?.m3u8_base_url||c?.content_url;return T.jsxs(gu,{children:[T.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 p-0 lg:p-6",children:[T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsxs("div",{className:"sticky top-16 lg:static z-20 bg-black w-full aspect-video lg:rounded-xl overflow-hidden shadow-2xl relative",children:[T.jsxs(ht,{onClick:M,variant:"ghost",size:"sm",className:"absolute top-4 left-4 z-40 bg-gradient-to-r from-primary/90 to-primary/70 hover:from-primary hover:to-primary/80 text-white rounded-full shadow-lg shadow-primary/30 gap-2 px-4 py-2 backdrop-blur-sm border border-white/10 hidden md:flex","data-testid":"button-back",children:[T.jsx(_u,{className:"h-4 w-4"}),T.jsx("span",{className:"font-medium",children:"Back"})]}),q?T.jsx(wj,{src:c?.content_url,hlsSrc:c?.m3u8_base_url,poster:c?.thumbnail_url,title:c?.title,startTime:l,videoMetadata:n&&c?{videoUrl:n,title:c.title||"Untitled",thumbnailUrl:c.thumbnail_url||"",author:c.author||"Unknown",duration:c.length||"0 min"}:void 0}):T.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center gap-4 bg-black",children:[T.jsx(Vm,{className:"h-16 w-16 text-destructive"}),T.jsx("p",{className:"text-white text-lg",children:"Unable to play video"}),T.jsxs(ht,{onClick:P,className:"gap-2",children:[T.jsx(gE,{className:"h-4 w-4"})," Open Video Directly"]})]})]}),T.jsxs("div",{className:"p-4 lg:p-0 lg:mt-4 space-y-4",children:[T.jsx("div",{className:"flex items-start gap-3",children:T.jsx("h1",{className:"text-xl md:text-2xl font-heading font-bold leading-tight flex-1","data-testid":"text-video-title",children:c.title})}),T.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 pb-4 border-b border-border",children:[T.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-muted-foreground",children:[T.jsxs("span",{className:"flex items-center gap-1.5 bg-secondary/50 px-2 py-1 rounded","data-testid":"text-views",children:[T.jsx(Du,{className:"h-4 w-4"})," ",U(c.views)," views"]}),T.jsxs("span",{className:"flex items-center gap-1.5 bg-secondary/50 px-2 py-1 rounded",children:[T.jsx(ni,{className:"h-4 w-4"})," ",c.length]}),c.publish_date&&T.jsxs("span",{className:"flex items-center gap-1.5 bg-secondary/50 px-2 py-1 rounded",children:[T.jsx(uI,{className:"h-4 w-4"})," ",c.publish_date]})]}),T.jsx("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:T.jsx(ht,{onClick:P,disabled:S,className:"flex-1 sm:flex-none gap-2 bg-primary hover:bg-primary/90 text-white relative overflow-hidden min-w-[140px]","data-testid":"button-download",children:S?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"absolute inset-0 bg-green-500/30 transition-all duration-200",style:{width:`${R}%`}}),T.jsx("div",{className:"relative flex items-center gap-2",children:_?T.jsxs(T.Fragment,{children:[T.jsx(yI,{className:"h-4 w-4 animate-bounce"}),T.jsx("span",{children:"Done!"})]}):T.jsxs(T.Fragment,{children:[T.jsx($g,{className:"h-4 w-4 animate-spin"}),T.jsx("span",{children:"Downloading..."})]})})]}):T.jsxs(T.Fragment,{children:[T.jsx(gE,{className:"h-4 w-4"})," Download"]})})})]}),T.jsxs("div",{className:"bg-card/50 rounded-lg p-4 text-sm text-gray-300 space-y-3",children:[T.jsxs("div",{className:"flex items-center gap-2 cursor-pointer hover:text-primary transition-colors group",onClick:()=>window.location.href=`/?q=${encodeURIComponent(c.author)}`,children:[T.jsx(oO,{className:"h-4 w-4 text-primary"}),T.jsx("p",{className:"font-bold text-white group-hover:text-primary transition-colors",children:c.author}),T.jsx(du,{className:"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity text-primary"})]}),T.jsx("p",{children:c.description||"No description available."}),c.pornstars&&c.pornstars.length>0&&T.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-border/50",children:[T.jsx("span",{className:"text-xs text-muted-foreground",children:"Stars:"}),c.pornstars.map((V,ee)=>T.jsx("span",{className:"text-xs bg-primary/20 text-primary px-2 py-1 rounded-full cursor-pointer hover:bg-primary hover:text-white transition-colors",onClick:()=>window.location.href=`/?q=${encodeURIComponent(V)}`,children:V},ee))]}),c.tags&&c.tags.length>0&&T.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-border/50",children:[T.jsx(jg,{className:"h-4 w-4 text-muted-foreground"}),c.tags.map((V,ee)=>T.jsxs("span",{className:"text-xs bg-secondary px-2 py-1 rounded-full text-secondary-foreground hover:bg-primary hover:text-white cursor-pointer transition-colors",onClick:()=>window.location.href=`/?q=${encodeURIComponent(V)}`,children:["#",V]},ee))]})]})]})]}),T.jsxs("div",{className:"w-full lg:w-[400px] px-4 lg:px-0 pb-8",children:[T.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[T.jsx(ni,{className:"h-5 w-5 text-primary"})," Similar Videos"]}),T.jsx("div",{className:"flex flex-col gap-3",children:E?[...Array(5)].map((V,ee)=>T.jsxs("div",{className:"flex gap-3 p-2",children:[T.jsx(lu,{className:"w-40 aspect-video flex-shrink-0 rounded"}),T.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[T.jsx(lu,{className:"h-4 w-full"}),T.jsx(lu,{className:"h-3 w-3/4"}),T.jsx(lu,{className:"h-3 w-1/2"})]})]},ee)):d.filter(V=>!(!V.thumbnail_url||V.thumbnail_url===""||!V.thumbnail_url.startsWith("http")||V.thumbnail_url.includes("THUMBNUM")||N.has(V.url))).map((V,ee)=>T.jsxs("div",{className:"flex gap-3 group cursor-pointer hover:bg-card/50 p-2 rounded transition-colors",onClick:()=>window.location.href=Qo(V.url),"data-testid":`card-related-${ee}`,children:[T.jsxs("div",{className:"relative w-40 aspect-video flex-shrink-0 rounded overflow-hidden",children:[T.jsx("img",{src:V.thumbnail_url,className:"w-full h-full object-cover",alt:V.title,onError:()=>B(Z=>new Set(Z).add(V.url))}),T.jsx("span",{className:"absolute bottom-1 right-1 bg-black/80 text-white text-[10px] px-1 rounded",children:V.length}),T.jsx("div",{className:"absolute inset-0 bg-black/30 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:T.jsx(ni,{className:"h-8 w-8 text-white"})})]}),T.jsxs("div",{className:"flex flex-col gap-1 min-w-0",children:[T.jsx("h4",{className:"text-sm font-medium line-clamp-2 leading-snug group-hover:text-primary transition-colors",children:V.title}),T.jsx("p",{className:"text-xs text-muted-foreground",children:V.author}),T.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[T.jsx(Du,{className:"h-3 w-3"})," ",U(V.views)," views"]})]})]},ee))})]})]}),T.jsx("iframe",{ref:I,style:{display:"none"},title:"download-frame"})]})}function Cj(){return T.jsxs(P_,{children:[T.jsx(Vh,{path:"/",component:bU}),T.jsx(Vh,{path:"/watch",component:Lj}),T.jsx(Vh,{component:r2})]})}function _j(){return T.jsx(aD,{client:cD,children:T.jsxs(cM,{children:[T.jsx(QO,{}),T.jsx(e2,{children:T.jsx(Cj,{})})]})})}const Dj=h_.createRoot(document.getElementById("root"));Dj.render(T.jsx(_j,{}));const Um=document.getElementById("splash-loader");Um&&(Um.classList.add("hidden"),setTimeout(()=>Um.remove(),300));
